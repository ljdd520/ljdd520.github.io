<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="前言每天一小步，进步一大步。一次对浏览器解析和XSS的深度探究 一，需要了解的一些基本知识为什么要进行编码？主要是因为某些数据不适合传输。原因多种多样，如 Size 过大，包含隐私数据，另外重要的一点就是有些字符会引起歧义。对于 URL： &amp;amp;用于分割多个参数，倘若有某个参数键值为 name=v&amp;amp;lue，就会因为 name 参数的值 v&amp;amp;lue 中携带了&amp;amp;而造成歧义。">
<meta property="og:type" content="article">
<meta property="og:title" content="读书日记六">
<meta property="og:url" content="http://yoursite.com/2020/01/30/读书日记六/index.html">
<meta property="og:site_name" content="L&#39;s Blog">
<meta property="og:description" content="前言每天一小步，进步一大步。一次对浏览器解析和XSS的深度探究 一，需要了解的一些基本知识为什么要进行编码？主要是因为某些数据不适合传输。原因多种多样，如 Size 过大，包含隐私数据，另外重要的一点就是有些字符会引起歧义。对于 URL： &amp;amp;用于分割多个参数，倘若有某个参数键值为 name=v&amp;amp;lue，就会因为 name 参数的值 v&amp;amp;lue 中携带了&amp;amp;而造成歧义。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/2020-1-29-xss-1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/2020-1-29-xss-2.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/2020-1-29-xss-3.png">
<meta property="og:updated_time" content="2020-01-30T09:08:39.574Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="读书日记六">
<meta name="twitter:description" content="前言每天一小步，进步一大步。一次对浏览器解析和XSS的深度探究 一，需要了解的一些基本知识为什么要进行编码？主要是因为某些数据不适合传输。原因多种多样，如 Size 过大，包含隐私数据，另外重要的一点就是有些字符会引起歧义。对于 URL： &amp;amp;用于分割多个参数，倘若有某个参数键值为 name=v&amp;amp;lue，就会因为 name 参数的值 v&amp;amp;lue 中携带了&amp;amp;而造成歧义。">
<meta name="twitter:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/2020-1-29-xss-1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/01/30/读书日记六/">





  <title>读书日记六 | L's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">L's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">share with you</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/30/读书日记六/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ljdd520">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">读书日记六</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-30T16:57:46+08:00">
                2020-01-30
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/读书日记/" itemprop="url" rel="index">
                    <span itemprop="name">读书日记</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/读书日记/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4.9k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  20
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>每天一小步，进步一大步。一次对浏览器解析和XSS的深度探究</p>
<h5 id="一，需要了解的一些基本知识"><a href="#一，需要了解的一些基本知识" class="headerlink" title="一，需要了解的一些基本知识"></a>一，需要了解的一些基本知识</h5><h6 id="为什么要进行编码？"><a href="#为什么要进行编码？" class="headerlink" title="为什么要进行编码？"></a>为什么要进行编码？</h6><h6 id="主要是因为某些数据不适合传输。原因多种多样，如-Size-过大，包含隐私数据，另外重要的一点就是有些字符会引起歧义。"><a href="#主要是因为某些数据不适合传输。原因多种多样，如-Size-过大，包含隐私数据，另外重要的一点就是有些字符会引起歧义。" class="headerlink" title="主要是因为某些数据不适合传输。原因多种多样，如 Size 过大，包含隐私数据，另外重要的一点就是有些字符会引起歧义。"></a>主要是因为某些数据不适合传输。原因多种多样，如 Size 过大，包含隐私数据，另外重要的一点就是有些字符会引起歧义。</h6><h6 id="对于-URL：-amp-用于分割多个参数，倘若有某个参数键值为-name-v-amp-lue，就会因为-name-参数的值-v-amp-lue-中携带了-amp-而造成歧义。因此需要对-amp-进行-URL-编码。url编码后，服务端会把紧跟在”-”后的字节当成普通的字节，就是不会把它当成各个参数或键值对的分隔符。"><a href="#对于-URL：-amp-用于分割多个参数，倘若有某个参数键值为-name-v-amp-lue，就会因为-name-参数的值-v-amp-lue-中携带了-amp-而造成歧义。因此需要对-amp-进行-URL-编码。url编码后，服务端会把紧跟在”-”后的字节当成普通的字节，就是不会把它当成各个参数或键值对的分隔符。" class="headerlink" title="对于 URL： &amp;用于分割多个参数，倘若有某个参数键值为 name=v&amp;lue，就会因为 name 参数的值 v&amp;lue 中携带了&amp;而造成歧义。因此需要对&amp;进行 URL 编码。url编码后，服务端会把紧跟在”%”后的字节当成普通的字节，就是不会把它当成各个参数或键值对的分隔符。"></a>对于 URL： &amp;用于分割多个参数，倘若有某个参数键值为 name=v&amp;lue，就会因为 name 参数的值 v&amp;lue 中携带了&amp;而造成歧义。因此需要对&amp;进行 URL 编码。url编码后，服务端会把紧跟在”%”后的字节当成普通的字节，就是不会把它当成各个参数或键值对的分隔符。</h6><h6 id="对于-HTML：-当浏览器遇到-lt-会识别为元素定义的开始，-gt-会识别为元素的结束。倘若有-lt-div-id-”1-gt-“-gt-lt-div-gt-，由于标签的属性值携带了-gt-，同样会造成歧义。因此需要属性值的-gt-需要-进行-HTML-编码，即使用字符实体。"><a href="#对于-HTML：-当浏览器遇到-lt-会识别为元素定义的开始，-gt-会识别为元素的结束。倘若有-lt-div-id-”1-gt-“-gt-lt-div-gt-，由于标签的属性值携带了-gt-，同样会造成歧义。因此需要属性值的-gt-需要-进行-HTML-编码，即使用字符实体。" class="headerlink" title="对于 HTML： 当浏览器遇到&lt;会识别为元素定义的开始，&gt;会识别为元素的结束。倘若有&lt;div id=”1&gt;“&gt;&lt;/div&gt;，由于标签的属性值携带了&gt;，同样会造成歧义。因此需要属性值的&gt;需要 进行 HTML 编码，即使用字符实体。"></a>对于 HTML： 当浏览器遇到&lt;会识别为元素定义的开始，&gt;会识别为元素的结束。倘若有&lt;div id=”1&gt;“&gt;&lt;/div&gt;，由于标签的属性值携带了&gt;，同样会造成歧义。因此需要属性值的&gt;需要 进行 HTML 编码，即使用字符实体。</h6><h5 id="二，三种编码"><a href="#二，三种编码" class="headerlink" title="二，三种编码"></a>二，三种编码</h5><h6 id="2-1HTML编码-字符实体"><a href="#2-1HTML编码-字符实体" class="headerlink" title="2.1HTML编码(字符实体)"></a>2.1HTML编码(字符实体)</h6><h6 id="字符实体是一个预先定义好的转义序列。字符实体有两种表示方法："><a href="#字符实体是一个预先定义好的转义序列。字符实体有两种表示方法：" class="headerlink" title="字符实体是一个预先定义好的转义序列。字符实体有两种表示方法："></a>字符实体是一个预先定义好的转义序列。字符实体有两种表示方法：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1、 字符实体以&amp;开头+预先定义的实体名称+;分号结束，如“&lt;”的实体名称为&amp;lt;</span><br><span class="line"></span><br><span class="line">2、 字符实体还可以以&amp;开头+#符号+字符在 ASCII 对应的十进制数字+;分号结束，如&lt;的实体编号为&amp;#60;</span><br></pre></td></tr></table></figure>

<h6 id="字符都是有实体编号的，但有些字符是没有实体名称"><a href="#字符都是有实体编号的，但有些字符是没有实体名称" class="headerlink" title="字符都是有实体编号的，但有些字符是没有实体名称"></a>字符都是有实体编号的，但有些字符是没有实体名称</h6><table>
<thead>
<tr>
<th align="center">显示结果</th>
<th align="center">描述</th>
<th align="center">实体名称</th>
<th align="center">实体编号</th>
</tr>
</thead>
<tbody><tr>
<td align="center"></td>
<td align="center">空格</td>
<td align="center">&amp;nbsp;</td>
<td align="center">&amp;#160;</td>
</tr>
<tr>
<td align="center">&lt;</td>
<td align="center">小于号</td>
<td align="center">&amp;lt;</td>
<td align="center">&amp;#60;</td>
</tr>
<tr>
<td align="center">&gt;</td>
<td align="center">大于号</td>
<td align="center">&amp;gt;</td>
<td align="center">&amp;#62;</td>
</tr>
<tr>
<td align="center">&amp;</td>
<td align="center">和号</td>
<td align="center">&amp;amp;</td>
<td align="center">&amp;#38;</td>
</tr>
<tr>
<td align="center">”</td>
<td align="center">引号</td>
<td align="center">&amp;quot;</td>
<td align="center">&amp;#34;</td>
</tr>
<tr>
<td align="center">‘</td>
<td align="center">撇号</td>
<td align="center">&amp;apos;(IE不支持)</td>
<td align="center">&amp;#39;</td>
</tr>
<tr>
<td align="center">￠</td>
<td align="center">分(cent)</td>
<td align="center">&amp;cent;</td>
<td align="center">&amp;#162;</td>
</tr>
<tr>
<td align="center">£</td>
<td align="center">镑(pound)</td>
<td align="center">&amp;pound;</td>
<td align="center">&amp;#163;</td>
</tr>
<tr>
<td align="center">¥</td>
<td align="center">元(yen)</td>
<td align="center">&amp;yen;</td>
<td align="center">&amp;#165;</td>
</tr>
<tr>
<td align="center">€</td>
<td align="center">欧元(euro)</td>
<td align="center">&amp;euro;</td>
<td align="center">&amp;#8364;</td>
</tr>
<tr>
<td align="center">§</td>
<td align="center">小节</td>
<td align="center">&amp;sect;</td>
<td align="center">&amp;#167;</td>
</tr>
<tr>
<td align="center">©</td>
<td align="center">版权(copyright)</td>
<td align="center">&amp;copy;</td>
<td align="center">&amp;#169;</td>
</tr>
<tr>
<td align="center">®</td>
<td align="center">注册商标</td>
<td align="center">&amp;reg;</td>
<td align="center">&amp;#174;</td>
</tr>
<tr>
<td align="center">™</td>
<td align="center">商标</td>
<td align="center">&amp;trade;</td>
<td align="center">&amp;#8482;</td>
</tr>
<tr>
<td align="center">×</td>
<td align="center">乘号</td>
<td align="center">&amp;times;</td>
<td align="center">&amp;#215;</td>
</tr>
<tr>
<td align="center">÷</td>
<td align="center">除号</td>
<td align="center">&amp;divide;</td>
<td align="center">&amp;#247;</td>
</tr>
</tbody></table>
<h6 id="2-2-JavaScript编码"><a href="#2-2-JavaScript编码" class="headerlink" title="2.2 JavaScript编码"></a>2.2 JavaScript编码</h6><h6 id="最常用的，如-uXXXX-这种写法的Unicode-转义序列，表示一个字符，其中-XXXX-表示一个-16-进制数字，如-lt-的Unicode-编码为-u003c。"><a href="#最常用的，如-uXXXX-这种写法的Unicode-转义序列，表示一个字符，其中-XXXX-表示一个-16-进制数字，如-lt-的Unicode-编码为-u003c。" class="headerlink" title="最常用的，如\uXXXX 这种写法的Unicode 转义序列，表示一个字符，其中 XXXX 表示一个 16 进制数字，如&lt;的Unicode 编码为\u003c。"></a>最常用的，如\uXXXX 这种写法的Unicode 转义序列，表示一个字符，其中 XXXX 表示一个 16 进制数字，如&lt;的Unicode 编码为\u003c。</h6><h6 id="2-3-URL编码"><a href="#2-3-URL编码" class="headerlink" title="2.3 URL编码"></a>2.3 URL编码</h6><h6 id="RFC3986-文档规定，URL-中只允许包含英文字母（a-zA-Z）、数字（0-9）、-4-个特殊字-符以及所有保留字符。-RFC3986-中指定了以下字符为保留字符：-‘-amp"><a href="#RFC3986-文档规定，URL-中只允许包含英文字母（a-zA-Z）、数字（0-9）、-4-个特殊字-符以及所有保留字符。-RFC3986-中指定了以下字符为保留字符：-‘-amp" class="headerlink" title="RFC3986 文档规定，URL 中只允许包含英文字母（a-zA-Z）、数字（0-9）、-_.~4 个特殊字 符以及所有保留字符。 RFC3986 中指定了以下字符为保留字符：! * ‘ ( ) ; : @ &amp; = + $ , / ? # [ ]"></a>RFC3986 文档规定，URL 中只允许包含英文字母（a-zA-Z）、数字（0-9）、-_.~4 个特殊字 符以及所有保留字符。 RFC3986 中指定了以下字符为保留字符：! * ‘ ( ) ; : @ &amp; = + $ , / ? # [ ]</h6><h6 id="编码方式-加字符在-ASCII-码表中的十六进制值。例如，-在-ASCII-码表中十六进制为-0x2f，那么它对应的-URL-编码为-2f。"><a href="#编码方式-加字符在-ASCII-码表中的十六进制值。例如，-在-ASCII-码表中十六进制为-0x2f，那么它对应的-URL-编码为-2f。" class="headerlink" title="编码方式 %加字符在 ASCII 码表中的十六进制值。例如，/在 ASCII 码表中十六进制为 0x2f，那么它对应的 URL 编码为%2f。"></a>编码方式 %加字符在 ASCII 码表中的十六进制值。例如，/在 ASCII 码表中十六进制为 0x2f，那么它对应的 URL 编码为%2f。</h6><h6 id="JavaScript-中提供了-3-个函数用来对-URL-编码以得到合法的-URL："><a href="#JavaScript-中提供了-3-个函数用来对-URL-编码以得到合法的-URL：" class="headerlink" title="JavaScript 中提供了 3 个函数用来对 URL 编码以得到合法的 URL："></a>JavaScript 中提供了 3 个函数用来对 URL 编码以得到合法的 URL：</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、 escape()</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、 encodeURI（）</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、 encodeURIComponent（）</span><br></pre></td></tr></table></figure>

<h5 id="三，浏览器解码规则"><a href="#三，浏览器解码规则" class="headerlink" title="三，浏览器解码规则"></a>三，浏览器解码规则</h5><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/2020-1-29-xss-1.png" alt></p>
<h6 id="浏览器无论什么情况都会遵守一个这样的解码规则："><a href="#浏览器无论什么情况都会遵守一个这样的解码规则：" class="headerlink" title="浏览器无论什么情况都会遵守一个这样的解码规则："></a>浏览器无论什么情况都会遵守一个这样的解码规则：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、 HTML 解析器对 HTML 文档进行解析，完成 HTML 解码并且创建 DOM 树</span><br><span class="line"></span><br><span class="line">2、 JavaScript 或者 CSS 解析器对内联脚本进行解析，完成 JS、CSS 解码</span><br><span class="line"></span><br><span class="line">3、 URL 解码会根据 URL 所在的顺序不同而在 JS 解码前或者解码后</span><br></pre></td></tr></table></figure>

<h6 id="3-1HTML解码器"><a href="#3-1HTML解码器" class="headerlink" title="3.1HTML解码器"></a>3.1HTML解码器</h6><h6 id="3-1-1HTML-中有五类元素："><a href="#3-1-1HTML-中有五类元素：" class="headerlink" title="3.1.1HTML 中有五类元素："></a>3.1.1HTML 中有五类元素：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1、 空元素(Voidelements)，有 area、base、br、col、command、embed、hr、img、input、 keygen、link、meta、param、source、track、wbr</span><br><span class="line"></span><br><span class="line">2、 原始文本元素(Raw textelements)，有&lt;script&gt;和&lt;style&gt;</span><br><span class="line"></span><br><span class="line">3、 RCDATA 元素(RCDATA elements)，有&lt;textarea&gt;和&lt;title&gt;</span><br><span class="line"></span><br><span class="line">4、 外部元素(Foreignelements)，例如 MathML 命名空间或者 SVG 命名空间的元素</span><br><span class="line"></span><br><span class="line">5、 基本元素(Normal elements)，即除了以上 4 种元素以外的元素</span><br></pre></td></tr></table></figure>

<h6 id="五类元素的区别如下："><a href="#五类元素的区别如下：" class="headerlink" title="五类元素的区别如下："></a>五类元素的区别如下：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1、 空元素，不能容纳任何内容（因为它们没有闭合标签，没有内容能够放在开始标签和闭合标签中间）。</span><br><span class="line"></span><br><span class="line">2、 原始文本元素，可以容纳文本。</span><br><span class="line"></span><br><span class="line">3、 RCDATA 元素，可以容纳文本和字符引用。</span><br><span class="line"></span><br><span class="line">4、 外部元素，可以容纳文本、字符引用、CDATA 段、其他元素和注释</span><br><span class="line"></span><br><span class="line">5、 基本元素，可以容纳文本、字符引用、其他元素和注释</span><br></pre></td></tr></table></figure>

<h6 id="3-1-2-HTML编解码"><a href="#3-1-2-HTML编解码" class="headerlink" title="3.1.2 HTML编解码"></a>3.1.2 HTML编解码</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/2020-1-29-xss-2.png" alt></p>
<h6 id="HTML-解析器以状态机的方式运行，它从文档输入流中消耗字符并根据其转换规则转换到不同的状态。"><a href="#HTML-解析器以状态机的方式运行，它从文档输入流中消耗字符并根据其转换规则转换到不同的状态。" class="headerlink" title="HTML 解析器以状态机的方式运行，它从文档输入流中消耗字符并根据其转换规则转换到不同的状态。"></a>HTML 解析器以状态机的方式运行，它从文档输入流中消耗字符并根据其转换规则转换到不同的状态。</h6><h6 id="示例："><a href="#示例：" class="headerlink" title="示例："></a>示例：</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    Hello world</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="1、初始状态为”DataState”，当遇到”-lt-”字符，状态变为”Tag-open-state”，读取一个-a-z-的字符将产生一个开始标签符号，状态相应变为”Tag-name-state”，一直保持这个状态直到读取到”-gt-”，每个字符都附加到这个符号名上，例子中创建的是一个-html-符号。"><a href="#1、初始状态为”DataState”，当遇到”-lt-”字符，状态变为”Tag-open-state”，读取一个-a-z-的字符将产生一个开始标签符号，状态相应变为”Tag-name-state”，一直保持这个状态直到读取到”-gt-”，每个字符都附加到这个符号名上，例子中创建的是一个-html-符号。" class="headerlink" title="1、初始状态为”DataState”，当遇到”&lt;”字符，状态变为”Tag open state”，读取一个 a-z 的字符将产生一个开始标签符号，状态相应变为”Tag name state”，一直保持这个状态直到读取到”&gt;”，每个字符都附加到这个符号名上，例子中创建的是一个 html 符号。"></a>1、初始状态为”DataState”，当遇到”&lt;”字符，状态变为”Tag open state”，读取一个 a-z 的字符将产生一个开始标签符号，状态相应变为”Tag name state”，一直保持这个状态直到读取到”&gt;”，每个字符都附加到这个符号名上，例子中创建的是一个 html 符号。</h6><h6 id="2、当读取到”-gt-”，当前的符号就完成了，此时，状态回到”Data-state”，”-lt-body-gt-”重复这一处理过程。到这里，html-和-body-标签都识别出来了。现在，回到”Data-state”，读取”Helloworld”中的字符”H”将创建并识别出一个字符符号，这里会为”Hello-world”中的每个字符-生成一个字符符号。"><a href="#2、当读取到”-gt-”，当前的符号就完成了，此时，状态回到”Data-state”，”-lt-body-gt-”重复这一处理过程。到这里，html-和-body-标签都识别出来了。现在，回到”Data-state”，读取”Helloworld”中的字符”H”将创建并识别出一个字符符号，这里会为”Hello-world”中的每个字符-生成一个字符符号。" class="headerlink" title="2、当读取到”&gt;”，当前的符号就完成了，此时，状态回到”Data state”，”&lt;body&gt;”重复这一处理过程。到这里，html 和 body 标签都识别出来了。现在，回到”Data state”，读取”Helloworld”中的字符”H”将创建并识别出一个字符符号，这里会为”Hello world”中的每个字符 生成一个字符符号。"></a>2、当读取到”&gt;”，当前的符号就完成了，此时，状态回到”Data state”，”&lt;body&gt;”重复这一处理过程。到这里，html 和 body 标签都识别出来了。现在，回到”Data state”，读取”Helloworld”中的字符”H”将创建并识别出一个字符符号，这里会为”Hello world”中的每个字符 生成一个字符符号。</h6><h6 id="3、这样直到遇到”-lt-body-gt-”中的”-lt-”。现在，又回到了”Tag-openstate”，读取下一个字符”-”-将创建一个闭合标签符号，并且状态转移到”Tag-name-state”，还是保持这一状态，直到-遇到”-gt-”。然后，产生一个新的标签符号并回到”Data-state”。后面的”-lt-html-gt-”将和-“-lt-body-gt-”一样处理。"><a href="#3、这样直到遇到”-lt-body-gt-”中的”-lt-”。现在，又回到了”Tag-openstate”，读取下一个字符”-”-将创建一个闭合标签符号，并且状态转移到”Tag-name-state”，还是保持这一状态，直到-遇到”-gt-”。然后，产生一个新的标签符号并回到”Data-state”。后面的”-lt-html-gt-”将和-“-lt-body-gt-”一样处理。" class="headerlink" title="3、这样直到遇到”&lt;/body&gt;”中的”&lt;”。现在，又回到了”Tag openstate”，读取下一个字符”/” 将创建一个闭合标签符号，并且状态转移到”Tag name state”，还是保持这一状态，直到 遇到”&gt;”。然后，产生一个新的标签符号并回到”Data state”。后面的”&lt;/html&gt;”将和 “&lt;/body&gt;”一样处理。"></a>3、这样直到遇到”&lt;/body&gt;”中的”&lt;”。现在，又回到了”Tag openstate”，读取下一个字符”/” 将创建一个闭合标签符号，并且状态转移到”Tag name state”，还是保持这一状态，直到 遇到”&gt;”。然后，产生一个新的标签符号并回到”Data state”。后面的”&lt;/html&gt;”将和 “&lt;/body&gt;”一样处理。</h6><h6 id="总结：当HTML-解析器处于数据状态（DataState）、RCDATA-状态（RCDATA-State）、属性值状态（Attribute-Value-State）时，字符实体会被解码为对应的字符。"><a href="#总结：当HTML-解析器处于数据状态（DataState）、RCDATA-状态（RCDATA-State）、属性值状态（Attribute-Value-State）时，字符实体会被解码为对应的字符。" class="headerlink" title="总结：当HTML 解析器处于数据状态（DataState）、RCDATA 状态（RCDATA State）、属性值状态（Attribute Value State）时，字符实体会被解码为对应的字符。"></a>总结：当HTML 解析器处于数据状态（DataState）、RCDATA 状态（RCDATA State）、属性值状态（Attribute Value State）时，字符实体会被解码为对应的字符。</h6><h6 id="示例：-1"><a href="#示例：-1" class="headerlink" title="示例："></a>示例：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;&amp;#60;img src=x onerror=alert(4)&amp;#62;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h6 id="lt-和-gt-被编码为字符实体-amp-60-和-amp-62-。-当-HTML-解析器解析完-lt-div-gt-时，会进入数据状态（Data-State）并发布标签令牌。接着解析到实体-amp-60-时因为处在数据状态（Data-State）就会对实体进行解码为-lt-，后面-的-amp-62-同样道理被解码为-gt-。"><a href="#lt-和-gt-被编码为字符实体-amp-60-和-amp-62-。-当-HTML-解析器解析完-lt-div-gt-时，会进入数据状态（Data-State）并发布标签令牌。接着解析到实体-amp-60-时因为处在数据状态（Data-State）就会对实体进行解码为-lt-，后面-的-amp-62-同样道理被解码为-gt-。" class="headerlink" title="&lt;和&gt;被编码为字符实体&amp;#60;和&amp;#62;。 当 HTML 解析器解析完&lt;div&gt;时，会进入数据状态（Data State）并发布标签令牌。接着解析到实体&amp;#60;时因为处在数据状态（Data State）就会对实体进行解码为&lt;，后面 的&amp;#62;同样道理被解码为&gt;。"></a>&lt;和&gt;被编码为字符实体&amp;#60;和&amp;#62;。 当 HTML 解析器解析完&lt;div&gt;时，会进入数据状态（Data State）并发布标签令牌。接着解析到实体&amp;#60;时因为处在数据状态（Data State）就会对实体进行解码为&lt;，后面 的&amp;#62;同样道理被解码为&gt;。</h6><h6 id="这里会有个问题，被解码后，img是否会被解析为-HTML-标签而导致-JS-执行呢？"><a href="#这里会有个问题，被解码后，img是否会被解析为-HTML-标签而导致-JS-执行呢？" class="headerlink" title="这里会有个问题，被解码后，img是否会被解析为 HTML 标签而导致 JS 执行呢？"></a>这里会有个问题，被解码后，img是否会被解析为 HTML 标签而导致 JS 执行呢？</h6><h6 id="答案是否定的。因为解析器在使用字符引用后不会转换到标签打开状态（Tag-OpenState），不进入标签打开状态就不会被发布为-HTML-标签。因此，不会创建新-HTML-标签，-只会将其作为数据来处理。-这也是为什么我们可以使用字符实体来避免用户不安全输入导致-XSS-的原因。"><a href="#答案是否定的。因为解析器在使用字符引用后不会转换到标签打开状态（Tag-OpenState），不进入标签打开状态就不会被发布为-HTML-标签。因此，不会创建新-HTML-标签，-只会将其作为数据来处理。-这也是为什么我们可以使用字符实体来避免用户不安全输入导致-XSS-的原因。" class="headerlink" title="答案是否定的。因为解析器在使用字符引用后不会转换到标签打开状态（Tag OpenState），不进入标签打开状态就不会被发布为 HTML 标签。因此，不会创建新 HTML 标签， 只会将其作为数据来处理。 这也是为什么我们可以使用字符实体来避免用户不安全输入导致 XSS 的原因。"></a>答案是否定的。因为解析器在使用字符引用后不会转换到标签打开状态（Tag OpenState），不进入标签打开状态就不会被发布为 HTML 标签。因此，不会创建新 HTML 标签， 只会将其作为数据来处理。 这也是为什么我们可以使用字符实体来避免用户不安全输入导致 XSS 的原因。</h6><h6 id="3-1-3-原始文本元素-Raw-text-elements"><a href="#3-1-3-原始文本元素-Raw-text-elements" class="headerlink" title="3.1.3 原始文本元素(Raw text elements)"></a>3.1.3 原始文本元素(Raw text elements)</h6><h6 id="在-HTML-中，属于-Rawtext-elements-的标签有两个：script、style。在-Raw-text-elements-类型标签下的所有内容块都属于该标签。"><a href="#在-HTML-中，属于-Rawtext-elements-的标签有两个：script、style。在-Raw-text-elements-类型标签下的所有内容块都属于该标签。" class="headerlink" title="在 HTML 中，属于 Rawtext elements 的标签有两个：script、style。在 Raw text elements 类型标签下的所有内容块都属于该标签。"></a>在 HTML 中，属于 Rawtext elements 的标签有两个：script、style。在 Raw text elements 类型标签下的所有内容块都属于该标签。</h6><h6 id="存在一条特性：-Raw-text-elements-类型标签下的所有字符实体编码都不会被-HTML-解码。HTML-解析器-解析到-script、style-标签的内容块（数据）部分时，状态会进入-Script-Data-State，该状态并-不在我们前面说的会解码字符实体的三条状态之中。"><a href="#存在一条特性：-Raw-text-elements-类型标签下的所有字符实体编码都不会被-HTML-解码。HTML-解析器-解析到-script、style-标签的内容块（数据）部分时，状态会进入-Script-Data-State，该状态并-不在我们前面说的会解码字符实体的三条状态之中。" class="headerlink" title="存在一条特性： Raw text elements 类型标签下的所有字符实体编码都不会被 HTML 解码。HTML 解析器 解析到 script、style 标签的内容块（数据）部分时，状态会进入 Script Data State，该状态并 不在我们前面说的会解码字符实体的三条状态之中。"></a>存在一条特性： Raw text elements 类型标签下的所有字符实体编码都不会被 HTML 解码。HTML 解析器 解析到 script、style 标签的内容块（数据）部分时，状态会进入 Script Data State，该状态并 不在我们前面说的会解码字符实体的三条状态之中。</h6><h6 id="因此，-lt-script-gt-amp-97-amp-108-amp-101-amp-114-amp-116-amp-40-amp-57-amp-41-amp-59-这样字符实体并不会被解码，也就不会执行-JS。"><a href="#因此，-lt-script-gt-amp-97-amp-108-amp-101-amp-114-amp-116-amp-40-amp-57-amp-41-amp-59-这样字符实体并不会被解码，也就不会执行-JS。" class="headerlink" title="因此，&lt;script&gt;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116&amp;#40;&amp;#57;&amp;#41;&amp;#59;这样字符实体并不会被解码，也就不会执行 JS。"></a>因此，&lt;script&gt;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116&amp;#40;&amp;#57;&amp;#41;&amp;#59;这样字符实体并不会被解码，也就不会执行 JS。</h6><h6 id="3-1-4-RCDATA"><a href="#3-1-4-RCDATA" class="headerlink" title="3.1.4 RCDATA"></a>3.1.4 RCDATA</h6><h6 id="在-HTML-中，属于RCDATAElements的标签有两个：textarea、title。"><a href="#在-HTML-中，属于RCDATAElements的标签有两个：textarea、title。" class="headerlink" title="在 HTML 中，属于RCDATAElements的标签有两个：textarea、title。"></a>在 HTML 中，属于RCDATAElements的标签有两个：textarea、title。</h6><h6 id="RCDATA-Elements-类型的标签可以包含文本内容和字符实体。"><a href="#RCDATA-Elements-类型的标签可以包含文本内容和字符实体。" class="headerlink" title="RCDATA Elements 类型的标签可以包含文本内容和字符实体。"></a>RCDATA Elements 类型的标签可以包含文本内容和字符实体。</h6><h6 id="解析器解析到-textarea、title标签的数据部分时，状态会进入-RCDATA-State。"><a href="#解析器解析到-textarea、title标签的数据部分时，状态会进入-RCDATA-State。" class="headerlink" title="解析器解析到 textarea、title标签的数据部分时，状态会进入 RCDATA State。"></a>解析器解析到 textarea、title标签的数据部分时，状态会进入 RCDATA State。</h6><h6 id="前面我们提到，处于-RCDATA-State-状态时，字符实体是会被解析器解码的。"><a href="#前面我们提到，处于-RCDATA-State-状态时，字符实体是会被解析器解码的。" class="headerlink" title="前面我们提到，处于 RCDATA State 状态时，字符实体是会被解析器解码的。"></a>前面我们提到，处于 RCDATA State 状态时，字符实体是会被解析器解码的。</h6><h6 id="示例：-2"><a href="#示例：-2" class="headerlink" title="示例："></a>示例：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;textarea&gt;&amp;#60;script&amp;#62;alert(5)&amp;#60;/script&amp;#62;&lt;/textarea&gt;</span><br></pre></td></tr></table></figure>

<h6 id="lt-和-gt-被编码为实体-amp-60-和-amp-62-。-解析器解析到它们时会进行解码，最终得到-lt-textarea-gt-lt-script-gt-alert-5-lt-script-gt-lt-textarea-gt-。但是里面的-JS-同样还是不会被执-行，原因还是因为解码字符实体状态机不会进入标签打开状态（TagOpen-State），因此里面的-lt-script-gt-并不会被解析为-HTML-标签。"><a href="#lt-和-gt-被编码为实体-amp-60-和-amp-62-。-解析器解析到它们时会进行解码，最终得到-lt-textarea-gt-lt-script-gt-alert-5-lt-script-gt-lt-textarea-gt-。但是里面的-JS-同样还是不会被执-行，原因还是因为解码字符实体状态机不会进入标签打开状态（TagOpen-State），因此里面的-lt-script-gt-并不会被解析为-HTML-标签。" class="headerlink" title="&lt;和&gt;被编码为实体&amp;#60;和&amp;#62;。 解析器解析到它们时会进行解码，最终得到&lt;textarea&gt;&lt;script&gt;alert(5)&lt;/script&gt;&lt;/textarea&gt;。但是里面的 JS 同样还是不会被执 行，原因还是因为解码字符实体状态机不会进入标签打开状态（TagOpen State），因此里面的&lt;script&gt;并不会被解析为 HTML 标签。"></a>&lt;和&gt;被编码为实体&amp;#60;和&amp;#62;。 解析器解析到它们时会进行解码，最终得到&lt;textarea&gt;&lt;script&gt;alert(5)&lt;/script&gt;&lt;/textarea&gt;。但是里面的 JS 同样还是不会被执 行，原因还是因为解码字符实体状态机不会进入标签打开状态（TagOpen State），因此里面的&lt;script&gt;并不会被解析为 HTML 标签。</h6><h6 id="3-1-5-外部元素-Foreign-elements"><a href="#3-1-5-外部元素-Foreign-elements" class="headerlink" title="3.1.5 外部元素(Foreign elements)"></a>3.1.5 外部元素(Foreign elements)</h6><h6 id="来源于-MathML-和-SVG-命名空间"><a href="#来源于-MathML-和-SVG-命名空间" class="headerlink" title="来源于 MathML 和 SVG 命名空间"></a>来源于 MathML 和 SVG 命名空间</h6><h6 id="lt-svg-gt-遵循-XML-和-SVG-的定义"><a href="#lt-svg-gt-遵循-XML-和-SVG-的定义" class="headerlink" title="&lt;svg&gt;遵循 XML 和 SVG 的定义"></a>&lt;svg&gt;遵循 XML 和 SVG 的定义</h6><h6 id="实例："><a href="#实例：" class="headerlink" title="实例："></a>实例：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert&amp;#40;1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h6 id="不能弹窗，Raw-text-elements-类型标签下的所有字符实体编码都不会被-HTML-解码"><a href="#不能弹窗，Raw-text-elements-类型标签下的所有字符实体编码都不会被-HTML-解码" class="headerlink" title="不能弹窗，Raw text elements 类型标签下的所有字符实体编码都不会被 HTML 解码"></a>不能弹窗，Raw text elements 类型标签下的所有字符实体编码都不会被 HTML 解码</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg&gt;&lt;script&gt;alert&amp;#40;1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h6 id="能弹窗，在-XML-中，-amp-40-会被解析成-，在-XML-中实体会自动转义-除了-lt-CDATA-和-gt-包含的实体"><a href="#能弹窗，在-XML-中，-amp-40-会被解析成-，在-XML-中实体会自动转义-除了-lt-CDATA-和-gt-包含的实体" class="headerlink" title="能弹窗，在 XML 中，&amp;#40;会被解析成(，在 XML 中实体会自动转义,除了&lt;![CDATA[和]]&gt; 包含的实体"></a>能弹窗，在 XML 中，&amp;#40;会被解析成(，在 XML 中实体会自动转义,除了&lt;![CDATA[和]]&gt; 包含的实体</h6><h6 id="3-2-JavaScript-解析器"><a href="#3-2-JavaScript-解析器" class="headerlink" title="3.2 JavaScript 解析器"></a>3.2 JavaScript 解析器</h6><h6 id="形如-uXXXX-这样的-Unicode-字符转义序列或-Hex-编码是否能被解码需要看情况。-首先，JavaScript-中有三个地方可以出现-Unicode-字符转义序列："><a href="#形如-uXXXX-这样的-Unicode-字符转义序列或-Hex-编码是否能被解码需要看情况。-首先，JavaScript-中有三个地方可以出现-Unicode-字符转义序列：" class="headerlink" title="形如 \uXXXX 这样的 Unicode 字符转义序列或 Hex 编码是否能被解码需要看情况。 首先，JavaScript 中有三个地方可以出现 Unicode 字符转义序列："></a>形如 \uXXXX 这样的 Unicode 字符转义序列或 Hex 编码是否能被解码需要看情况。 首先，JavaScript 中有三个地方可以出现 Unicode 字符转义序列：</h6><h6 id="1、字符串中（in-String）"><a href="#1、字符串中（in-String）" class="headerlink" title="1、字符串中（in String）"></a>1、字符串中（in String）</h6><h6 id="Unicode-转义序列出现在字符串中时，它只会被解释为普通字符，而不会破坏字符串的上下文。"><a href="#Unicode-转义序列出现在字符串中时，它只会被解释为普通字符，而不会破坏字符串的上下文。" class="headerlink" title="Unicode 转义序列出现在字符串中时，它只会被解释为普通字符，而不会破坏字符串的上下文。"></a>Unicode 转义序列出现在字符串中时，它只会被解释为普通字符，而不会破坏字符串的上下文。</h6><h6 id="例如，-lt-script-gt-alert-“-u0031-u0030″-lt-script-gt"><a href="#例如，-lt-script-gt-alert-“-u0031-u0030″-lt-script-gt" class="headerlink" title="例如，&lt;script&gt;alert(“\u0031\u0030″);&lt;/script&gt;"></a>例如，&lt;script&gt;alert(“\u0031\u0030″);&lt;/script&gt;</h6><h6 id="被编码转义的部分为-10，是字符串，会被正常解码，JS-代码也会被执行。"><a href="#被编码转义的部分为-10，是字符串，会被正常解码，JS-代码也会被执行。" class="headerlink" title="被编码转义的部分为 10，是字符串，会被正常解码，JS 代码也会被执行。"></a>被编码转义的部分为 10，是字符串，会被正常解码，JS 代码也会被执行。</h6><h6 id="2、标识符中（in-identifier-names）"><a href="#2、标识符中（in-identifier-names）" class="headerlink" title="2、标识符中（in identifier names）"></a>2、标识符中（in identifier names）</h6><h6 id="若-Unicode-转义序列存在于标识符中，即变量名（如函数名等…），它会被进行解码。"><a href="#若-Unicode-转义序列存在于标识符中，即变量名（如函数名等…），它会被进行解码。" class="headerlink" title="若 Unicode 转义序列存在于标识符中，即变量名（如函数名等…），它会被进行解码。"></a>若 Unicode 转义序列存在于标识符中，即变量名（如函数名等…），它会被进行解码。</h6><h6 id="例如，-lt-script-gt-u0061-u006c-u0065-u0072-u0074-10-lt-script-gt"><a href="#例如，-lt-script-gt-u0061-u006c-u0065-u0072-u0074-10-lt-script-gt" class="headerlink" title="例如，&lt;script&gt;\u0061\u006c\u0065\u0072\u0074(10);&lt;/script&gt;"></a>例如，&lt;script&gt;\u0061\u006c\u0065\u0072\u0074(10);&lt;/script&gt;</h6><h6 id="被编码转义的部分为-alert-字符，是函数名，属于在标识符中的情况，因此会被正常解码，JS-代码也会被执行。"><a href="#被编码转义的部分为-alert-字符，是函数名，属于在标识符中的情况，因此会被正常解码，JS-代码也会被执行。" class="headerlink" title="被编码转义的部分为 alert 字符，是函数名，属于在标识符中的情况，因此会被正常解码，JS 代码也会被执行。"></a>被编码转义的部分为 alert 字符，是函数名，属于在标识符中的情况，因此会被正常解码，JS 代码也会被执行。</h6><h6 id="3、控制字符中（in-control-characters）"><a href="#3、控制字符中（in-control-characters）" class="headerlink" title="3、控制字符中（in control characters）"></a>3、控制字符中（in control characters）</h6><h6 id="若-Unicode-转义序列存在于控制字符中，那么它会被解码但不会被解释为控制字符，而会被解释为标识符或字符串字符的一部分。-控制字符即’、”、-等。"><a href="#若-Unicode-转义序列存在于控制字符中，那么它会被解码但不会被解释为控制字符，而会被解释为标识符或字符串字符的一部分。-控制字符即’、”、-等。" class="headerlink" title="若 Unicode 转义序列存在于控制字符中，那么它会被解码但不会被解释为控制字符，而会被解释为标识符或字符串字符的一部分。 控制字符即’、”、()等。"></a>若 Unicode 转义序列存在于控制字符中，那么它会被解码但不会被解释为控制字符，而会被解释为标识符或字符串字符的一部分。 控制字符即’、”、()等。</h6><h6 id="例如，-lt-script-gt-alert-u0028″xss”-lt-script-gt-，-进行了-Unicode-编码，那么解码后它不再是作为控制字符，而是作为标识符的一部分alert-。"><a href="#例如，-lt-script-gt-alert-u0028″xss”-lt-script-gt-，-进行了-Unicode-编码，那么解码后它不再是作为控制字符，而是作为标识符的一部分alert-。" class="headerlink" title="例如，&lt;script&gt;alert\u0028″xss”);&lt;/script&gt;，(进行了 Unicode 编码，那么解码后它不再是作为控制字符，而是作为标识符的一部分alert(。"></a>例如，&lt;script&gt;alert\u0028″xss”);&lt;/script&gt;，(进行了 Unicode 编码，那么解码后它不再是作为控制字符，而是作为标识符的一部分alert(。</h6><h6 id="因此函数的括号之类的控制字符进行Unicode-转义后是不能被正常解释的。"><a href="#因此函数的括号之类的控制字符进行Unicode-转义后是不能被正常解释的。" class="headerlink" title="因此函数的括号之类的控制字符进行Unicode 转义后是不能被正常解释的。"></a>因此函数的括号之类的控制字符进行Unicode 转义后是不能被正常解释的。</h6><h6 id="总结：Unicode-序列不能出现在控制字符中，否则不能被解释。"><a href="#总结：Unicode-序列不能出现在控制字符中，否则不能被解释。" class="headerlink" title="总结：Unicode 序列不能出现在控制字符中，否则不能被解释。"></a>总结：Unicode 序列不能出现在控制字符中，否则不能被解释。</h6><h6 id="示例-1："><a href="#示例-1：" class="headerlink" title="示例 1："></a>示例 1：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;\u0061\u006c\u0065\u0072\u0074\u0028\u0031\u0031\u0029&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h6 id="被编码部分为-alert-11-。"><a href="#被编码部分为-alert-11-。" class="headerlink" title="被编码部分为 alert(11)。"></a>被编码部分为 alert(11)。</h6><h6 id="该例子中的-JS-不会被执行，因为控制字符被编码了。"><a href="#该例子中的-JS-不会被执行，因为控制字符被编码了。" class="headerlink" title="该例子中的 JS 不会被执行，因为控制字符被编码了。"></a>该例子中的 JS 不会被执行，因为控制字符被编码了。</h6><h6 id="示例2："><a href="#示例2：" class="headerlink" title="示例2："></a>示例2：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;\u0061\u006c\u0065\u0072\u0074(\u0031\u0032)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h6 id="被编码部分为-alert-及括号内为12。"><a href="#被编码部分为-alert-及括号内为12。" class="headerlink" title="被编码部分为 alert 及括号内为12。"></a>被编码部分为 alert 及括号内为12。</h6><h6 id="该例子中-JS-不会被执行，原因在于括号内被编码的部分不能被正常解释，即使反编码之后为数字，但是仍然按照字符串来处理（这里的12为字符串12，并不是int整数）。要么使用-ASCII-数字，要么加””或”使其变为字符串，作为字符串也只能作为普通字符。"><a href="#该例子中-JS-不会被执行，原因在于括号内被编码的部分不能被正常解释，即使反编码之后为数字，但是仍然按照字符串来处理（这里的12为字符串12，并不是int整数）。要么使用-ASCII-数字，要么加””或”使其变为字符串，作为字符串也只能作为普通字符。" class="headerlink" title="该例子中 JS 不会被执行，原因在于括号内被编码的部分不能被正常解释，即使反编码之后为数字，但是仍然按照字符串来处理（这里的12为字符串12，并不是int整数）。要么使用 ASCII 数字，要么加””或”使其变为字符串，作为字符串也只能作为普通字符。"></a>该例子中 JS 不会被执行，原因在于括号内被编码的部分不能被正常解释，即使反编码之后为数字，但是仍然按照字符串来处理（这里的12为字符串12，并不是int整数）。要么使用 ASCII 数字，要么加””或”使其变为字符串，作为字符串也只能作为普通字符。</h6><h6 id="示例-3："><a href="#示例-3：" class="headerlink" title="示例 3："></a>示例 3：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(&apos;13\u0027)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h6 id="被编码处为-39"><a href="#被编码处为-39" class="headerlink" title="被编码处为&#39;"></a>被编码处为<code>&#39;</code></h6><h6 id="该例的-JS-不会执行，因为控制字符被编码了，解码后的’将变为字符串的一部分，而不再解释为控制字符。因此该例中字符串是不完整的，因为没有’来结束字符串。"><a href="#该例的-JS-不会执行，因为控制字符被编码了，解码后的’将变为字符串的一部分，而不再解释为控制字符。因此该例中字符串是不完整的，因为没有’来结束字符串。" class="headerlink" title="该例的 JS 不会执行，因为控制字符被编码了，解码后的’将变为字符串的一部分，而不再解释为控制字符。因此该例中字符串是不完整的，因为没有’来结束字符串。"></a>该例的 JS 不会执行，因为控制字符被编码了，解码后的’将变为字符串的一部分，而不再解释为控制字符。因此该例中字符串是不完整的，因为没有’来结束字符串。</h6><h6 id="示例-4："><a href="#示例-4：" class="headerlink" title="示例 4："></a>示例 4：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(&apos;14\u000a&apos;)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h6 id="该例的-JS-会被执行，因为被编码的部分处于字符串内，只会被解释为普通字符，不会突破字符串上下文。"><a href="#该例的-JS-会被执行，因为被编码的部分处于字符串内，只会被解释为普通字符，不会突破字符串上下文。" class="headerlink" title="该例的 JS 会被执行，因为被编码的部分处于字符串内，只会被解释为普通字符，不会突破字符串上下文。"></a>该例的 JS 会被执行，因为被编码的部分处于字符串内，只会被解释为普通字符，不会突破字符串上下文。</h6><h6 id="示例-5："><a href="#示例-5：" class="headerlink" title="示例 5："></a>示例 5：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;1&quot; onerror=\u0061\u006c\u0065\u0072\u0074\u0028\u0031\u0029&gt;</span><br></pre></td></tr></table></figure>

<h6 id="此例无法执行。我们以浏览器的视角来看：首先读到-lt-开始读取标签，然后读到-onerror-调用-JS-解析器。-在JS中，单引号，双引号和圆括号等属于控制字符，编码后将无法识别。所以对于防御来说，应该编码这些控制字符。"><a href="#此例无法执行。我们以浏览器的视角来看：首先读到-lt-开始读取标签，然后读到-onerror-调用-JS-解析器。-在JS中，单引号，双引号和圆括号等属于控制字符，编码后将无法识别。所以对于防御来说，应该编码这些控制字符。" class="headerlink" title="此例无法执行。我们以浏览器的视角来看：首先读到&lt;开始读取标签，然后读到 onerror 调用 JS 解析器。 在JS中，单引号，双引号和圆括号等属于控制字符，编码后将无法识别。所以对于防御来说，应该编码这些控制字符。"></a>此例无法执行。我们以浏览器的视角来看：首先读到&lt;开始读取标签，然后读到 onerror 调用 JS 解析器。 在JS中，单引号，双引号和圆括号等属于控制字符，编码后将无法识别。所以对于防御来说，应该编码这些控制字符。</h6><h6 id="下面这种方式可以解析："><a href="#下面这种方式可以解析：" class="headerlink" title="下面这种方式可以解析："></a>下面这种方式可以解析：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;1&quot; onerror=\u0061\u006c\u0065\u0072\u0074(&apos;\u0031&apos;)&gt;</span><br></pre></td></tr></table></figure>

<h6 id="可以结合上面的-HTML-编码-按照解析顺序反过去，先-JS-编码然后-HTML-解码："><a href="#可以结合上面的-HTML-编码-按照解析顺序反过去，先-JS-编码然后-HTML-解码：" class="headerlink" title="可以结合上面的 HTML 编码 按照解析顺序反过去，先 JS 编码然后 HTML 解码："></a>可以结合上面的 HTML 编码 按照解析顺序反过去，先 JS 编码然后 HTML 解码：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;1&quot; onerror=&amp;#92;&amp;#117;&amp;#48;&amp;#48;&amp;#54;&amp;#49;&amp;#92;&amp;#117;&amp;#48;&amp;#48;&amp;#54;&amp;#99;&amp;#92;&amp;#117;&amp;#48;&amp;#48;&amp;#54;&amp;#53;&amp;#92;&amp;#117;&amp;#48;&amp;#48;&amp;#55;&amp;#50;&amp;#92;&amp;#117;&amp;#48;&amp;#48;&amp;#55;&amp;#52;&amp;#40;&amp;#39;&amp;#92;&amp;#117;&amp;#48;&amp;#48;&amp;#51;&amp;#49;&amp;#39;&amp;#41;&gt;</span><br></pre></td></tr></table></figure>

<h6 id="浏览器读到了-lt-标签开始构造语法树，然后-HTML-解码，解码之后发现-onerror-于是进行-一个-JS-解码，成功弹窗"><a href="#浏览器读到了-lt-标签开始构造语法树，然后-HTML-解码，解码之后发现-onerror-于是进行-一个-JS-解码，成功弹窗" class="headerlink" title="浏览器读到了&lt;标签开始构造语法树，然后 HTML 解码，解码之后发现 onerror 于是进行 一个 JS 解码，成功弹窗"></a>浏览器读到了&lt;标签开始构造语法树，然后 HTML 解码，解码之后发现 onerror 于是进行 一个 JS 解码，成功弹窗</h6><h6 id="延伸："><a href="#延伸：" class="headerlink" title="延伸："></a>延伸：</h6><h6 id="开发人员单纯的设置-HTML-实体编码为防御-xss-的手段，但是用户输入点在-alert-中-lt-img-src-“https-text-com”-onclick-‘alert-“输入点”-’-gt"><a href="#开发人员单纯的设置-HTML-实体编码为防御-xss-的手段，但是用户输入点在-alert-中-lt-img-src-“https-text-com”-onclick-‘alert-“输入点”-’-gt" class="headerlink" title="开发人员单纯的设置 HTML 实体编码为防御 xss 的手段，但是用户输入点在 alert 中 &lt;img src = “https://text.com” onclick = ‘alert(“输入点”)’&gt;"></a>开发人员单纯的设置 HTML 实体编码为防御 xss 的手段，但是用户输入点在 alert 中 &lt;img src = “<a href="https://text.com”" target="_blank" rel="noopener">https://text.com”</a> onclick = ‘alert(“输入点”)’&gt;</h6><h6 id="如果用户正常输入的话凡是存在-lt-”-等都能被转码"><a href="#如果用户正常输入的话凡是存在-lt-”-等都能被转码" class="headerlink" title="如果用户正常输入的话凡是存在&lt; ,” 等都能被转码"></a>如果用户正常输入的话凡是存在&lt; ,” 等都能被转码</h6><h6 id="攻击者可以通过语句-“-alert-“test，在服务端被转码："><a href="#攻击者可以通过语句-“-alert-“test，在服务端被转码：" class="headerlink" title="攻击者可以通过语句 “);alert(“test，在服务端被转码："></a>攻击者可以通过语句 “);alert(“test，在服务端被转码：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src =&quot;https://gss1.bdstatic.com&quot; onclick = &apos;alert(&quot;FIRSTXSS&amp;#34;&amp;#41;&amp;#59;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#34;&amp;#116;&amp;#101;&amp;#115;&amp;#116;&quot;)&apos;&gt;</span><br></pre></td></tr></table></figure>

<h6 id="弹窗两次，是因为浏览器进行-HTML-解码发现存在两个-alert"><a href="#弹窗两次，是因为浏览器进行-HTML-解码发现存在两个-alert" class="headerlink" title="弹窗两次，是因为浏览器进行 HTML 解码发现存在两个 alert()"></a>弹窗两次，是因为浏览器进行 HTML 解码发现存在两个 alert()</h6><h6 id="所以对于这种情况，正确防御-XSS-的方法："><a href="#所以对于这种情况，正确防御-XSS-的方法：" class="headerlink" title="所以对于这种情况，正确防御 XSS 的方法："></a>所以对于这种情况，正确防御 XSS 的方法：</h6><h6 id="应该是先-JavaScript-编码然后再进行-HTML-编码用户输入-“-alert-“test-后在服务端先-JavaScript-编码然后再进行-HTML-编码到浏览器端：首先经过第一步-HTML-解码后变为-u0022-u0029-u003B-u0061-u006C-u0065-u0072-u0074-u0028-u0022-u0074-u0065-u0073-u0074。JavaScript-解析器工作，变为”-alert-“test-，刚才已经讲过-JavaScript-解析时只有标识符名称不会被当做字符串，控制字符仅会被解析为标示符名称或者字符串，因此-u0022-被解释成双引号文本，-u0028-和-u0029-被解释成为圆括号文本，不会变为控制-字符被解析执行。"><a href="#应该是先-JavaScript-编码然后再进行-HTML-编码用户输入-“-alert-“test-后在服务端先-JavaScript-编码然后再进行-HTML-编码到浏览器端：首先经过第一步-HTML-解码后变为-u0022-u0029-u003B-u0061-u006C-u0065-u0072-u0074-u0028-u0022-u0074-u0065-u0073-u0074。JavaScript-解析器工作，变为”-alert-“test-，刚才已经讲过-JavaScript-解析时只有标识符名称不会被当做字符串，控制字符仅会被解析为标示符名称或者字符串，因此-u0022-被解释成双引号文本，-u0028-和-u0029-被解释成为圆括号文本，不会变为控制-字符被解析执行。" class="headerlink" title="应该是先 JavaScript 编码然后再进行 HTML 编码用户输入 “);alert(“test 后在服务端先 JavaScript 编码然后再进行 HTML 编码到浏览器端：首先经过第一步 HTML 解码后变为\u0022\u0029\u003B\u0061\u006C\u0065\u0072\u0074\u0028\u0022\u0074\u0065\u0073\u0074。JavaScript 解析器工作，变为”);alert(“test ，刚才已经讲过 JavaScript 解析时只有标识符名称不会被当做字符串，控制字符仅会被解析为标示符名称或者字符串，因此 \u0022 被解释成双引号文本，\u0028 和\u0029 被解释成为圆括号文本，不会变为控制 字符被解析执行。"></a>应该是先 JavaScript 编码然后再进行 HTML 编码用户输入 “);alert(“test 后在服务端先 JavaScript 编码然后再进行 HTML 编码到浏览器端：首先经过第一步 HTML 解码后变为\u0022\u0029\u003B\u0061\u006C\u0065\u0072\u0074\u0028\u0022\u0074\u0065\u0073\u0074。JavaScript 解析器工作，变为”);alert(“test ，刚才已经讲过 JavaScript 解析时只有标识符名称不会被当做字符串，控制字符仅会被解析为标示符名称或者字符串，因此 \u0022 被解释成双引号文本，\u0028 和\u0029 被解释成为圆括号文本，不会变为控制 字符被解析执行。</h6><h6 id="在这里采用的先-JS-编码后-HTML-编码中只弹窗了一次。"><a href="#在这里采用的先-JS-编码后-HTML-编码中只弹窗了一次。" class="headerlink" title="在这里采用的先 JS 编码后 HTML 编码中只弹窗了一次。"></a>在这里采用的先 JS 编码后 HTML 编码中只弹窗了一次。</h6><h6 id="3-3-URL-解析器"><a href="#3-3-URL-解析器" class="headerlink" title="3.3 URL 解析器"></a>3.3 URL 解析器</h6><h6 id="通用-URI-的格式如下："><a href="#通用-URI-的格式如下：" class="headerlink" title="通用 URI 的格式如下："></a>通用 URI 的格式如下：</h6><h6 id="协议名-用户名-密码-主机名-端口-路径-查询参数-片段-ID"><a href="#协议名-用户名-密码-主机名-端口-路径-查询参数-片段-ID" class="headerlink" title="[协议名]://[用户名]:[密码]@[主机名]:[端口]/[路径]?[查询参数]#[片段 ID]"></a>[协议名]://[用户名]:[密码]@[主机名]:[端口]/[路径]?[查询参数]#[片段 ID]</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/2020-1-29-xss-3.png" alt></p>
<h6 id="首先，要注意的是-URL-的-Scheme-部分（协议部分）必须为-ASCII-字符，即不能被任何编码，否则-URL-解析器的状态机将进入-No-Scheme-状态。"><a href="#首先，要注意的是-URL-的-Scheme-部分（协议部分）必须为-ASCII-字符，即不能被任何编码，否则-URL-解析器的状态机将进入-No-Scheme-状态。" class="headerlink" title="首先，要注意的是 URL 的 Scheme 部分（协议部分）必须为 ASCII 字符，即不能被任何编码，否则 URL 解析器的状态机将进入 No Scheme 状态。"></a>首先，要注意的是 URL 的 Scheme 部分（协议部分）必须为 ASCII 字符，即不能被任何编码，否则 URL 解析器的状态机将进入 No Scheme 状态。</h6><h6 id="示例1："><a href="#示例1：" class="headerlink" title="示例1："></a>示例1：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ahref=&quot;%6a%61%76%61%73%63%72%69%70%74:%61%6c%65%72%74%28%31%29&quot;&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<h6 id="URL-编码部分的是javascript-alert-1-。"><a href="#URL-编码部分的是javascript-alert-1-。" class="headerlink" title="URL 编码部分的是javascript:alert(1)。"></a>URL 编码部分的是javascript:alert(1)。</h6><h6 id="JS-不会被执行，因为作为Scheme-部分的”javascript”这个字符串被编码（其中javascript是一种伪协议），导致-URL-解析-器状态机进入-No-Scheme-状态。"><a href="#JS-不会被执行，因为作为Scheme-部分的”javascript”这个字符串被编码（其中javascript是一种伪协议），导致-URL-解析-器状态机进入-No-Scheme-状态。" class="headerlink" title="JS 不会被执行，因为作为Scheme 部分的”javascript”这个字符串被编码（其中javascript是一种伪协议），导致 URL 解析 器状态机进入 No Scheme 状态。"></a>JS 不会被执行，因为作为Scheme 部分的”javascript”这个字符串被编码（其中javascript是一种伪协议），导致 URL 解析 器状态机进入 No Scheme 状态。</h6><h6 id="URL-中的-也不能被以任何方式编码，否则-URL-解析器的状态机也将进入-No-Scheme-状态。"><a href="#URL-中的-也不能被以任何方式编码，否则-URL-解析器的状态机也将进入-No-Scheme-状态。" class="headerlink" title="URL 中的:也不能被以任何方式编码，否则 URL 解析器的状态机也将进入 No Scheme 状态。"></a>URL 中的:也不能被以任何方式编码，否则 URL 解析器的状态机也将进入 No Scheme 状态。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ahref=&quot;javascript%3aalert(3)&quot;&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<h6 id="由于-被-URL-编码为-3a，导致-URL-状态机进入-NoScheme-状态，JS-代码不能执行。"><a href="#由于-被-URL-编码为-3a，导致-URL-状态机进入-NoScheme-状态，JS-代码不能执行。" class="headerlink" title="由于:被 URL 编码为%3a，导致 URL 状态机进入 NoScheme 状态，JS 代码不能执行。"></a>由于:被 URL 编码为%3a，导致 URL 状态机进入 NoScheme 状态，JS 代码不能执行。</h6><h6 id="示例2：-1"><a href="#示例2：-1" class="headerlink" title="示例2："></a>示例2：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ahref=&quot;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:%61%6c%65%72%74%28%32%29&quot;&gt;</span><br></pre></td></tr></table></figure>

<h6 id="“javascript”这个字符串被实体化编码，-没有被编码，alert-2-被-URL编码。-成功执行-首先，在-HTML-解析器中我们谈到过，HTML状态机处于属性值状态（Attribute-Value-State）时，字符实体时会被解码的，此处在-href-属性中，所以被实体化编码的-“javascript”字符串会被解码。其次，HTML-解析是在URL解析之前的，所以在进行-URL-解析之前，Scheme-部分的”javascript”字符串已被解码，而并不再是被实体编码的状态。"><a href="#“javascript”这个字符串被实体化编码，-没有被编码，alert-2-被-URL编码。-成功执行-首先，在-HTML-解析器中我们谈到过，HTML状态机处于属性值状态（Attribute-Value-State）时，字符实体时会被解码的，此处在-href-属性中，所以被实体化编码的-“javascript”字符串会被解码。其次，HTML-解析是在URL解析之前的，所以在进行-URL-解析之前，Scheme-部分的”javascript”字符串已被解码，而并不再是被实体编码的状态。" class="headerlink" title="“javascript”这个字符串被实体化编码，:没有被编码，alert(2)被 URL编码。 成功执行 首先，在 HTML 解析器中我们谈到过，HTML状态机处于属性值状态（Attribute Value State）时，字符实体时会被解码的，此处在 href 属性中，所以被实体化编码的 “javascript”字符串会被解码。其次，HTML 解析是在URL解析之前的，所以在进行 URL 解析之前，Scheme 部分的”javascript”字符串已被解码，而并不再是被实体编码的状态。"></a>“javascript”这个字符串被实体化编码，:没有被编码，alert(2)被 URL编码。 成功执行 首先，在 HTML 解析器中我们谈到过，HTML状态机处于属性值状态（Attribute Value State）时，字符实体时会被解码的，此处在 href 属性中，所以被实体化编码的 “javascript”字符串会被解码。其次，HTML 解析是在URL解析之前的，所以在进行 URL 解析之前，Scheme 部分的”javascript”字符串已被解码，而并不再是被实体编码的状态。</h6><h5 id="四，解析顺序"><a href="#四，解析顺序" class="headerlink" title="四，解析顺序"></a>四，解析顺序</h5><h6 id="首先浏览器接收到一个-HTML-文档时，会触发-HTML-解析器对-HTML-文档进行词法解析，这一过程完成-HTML-解码并创建-DOM-树。"><a href="#首先浏览器接收到一个-HTML-文档时，会触发-HTML-解析器对-HTML-文档进行词法解析，这一过程完成-HTML-解码并创建-DOM-树。" class="headerlink" title="首先浏览器接收到一个 HTML 文档时，会触发 HTML 解析器对 HTML 文档进行词法解析，这一过程完成 HTML 解码并创建 DOM 树。"></a>首先浏览器接收到一个 HTML 文档时，会触发 HTML 解析器对 HTML 文档进行词法解析，这一过程完成 HTML 解码并创建 DOM 树。</h6><h6 id="接下来-JavaScript-解析器会介入对内联脚本进行解析，这一过程完成-JS-的解码工作。"><a href="#接下来-JavaScript-解析器会介入对内联脚本进行解析，这一过程完成-JS-的解码工作。" class="headerlink" title="接下来 JavaScript 解析器会介入对内联脚本进行解析，这一过程完成 JS 的解码工作。"></a>接下来 JavaScript 解析器会介入对内联脚本进行解析，这一过程完成 JS 的解码工作。</h6><h6 id="如果浏览器遇到需要-URL-的上下文环境，这时-URL-解析器也会介入完成-URL-的解码工-作，URL-解析器的解码顺序会根据-URL-所在位置不同，可能在-JavaScript-解析器之前或之后解析。"><a href="#如果浏览器遇到需要-URL-的上下文环境，这时-URL-解析器也会介入完成-URL-的解码工-作，URL-解析器的解码顺序会根据-URL-所在位置不同，可能在-JavaScript-解析器之前或之后解析。" class="headerlink" title="如果浏览器遇到需要 URL 的上下文环境，这时 URL 解析器也会介入完成 URL 的解码工 作，URL 解析器的解码顺序会根据 URL 所在位置不同，可能在 JavaScript 解析器之前或之后解析。"></a>如果浏览器遇到需要 URL 的上下文环境，这时 URL 解析器也会介入完成 URL 的解码工 作，URL 解析器的解码顺序会根据 URL 所在位置不同，可能在 JavaScript 解析器之前或之后解析。</h6><h6 id="总之HTML-解析总是第一步。URL-解析和-JavaScript-解析，它们的解析顺序要根据情况而定。"><a href="#总之HTML-解析总是第一步。URL-解析和-JavaScript-解析，它们的解析顺序要根据情况而定。" class="headerlink" title="总之HTML 解析总是第一步。URL 解析和 JavaScript 解析，它们的解析顺序要根据情况而定。"></a>总之HTML 解析总是第一步。URL 解析和 JavaScript 解析，它们的解析顺序要根据情况而定。</h6><h6 id="示例-1：-1"><a href="#示例-1：-1" class="headerlink" title="示例 1："></a>示例 1：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;UserInput&quot;&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<h6 id="该例子中，首先由-HTML-解析器对UserInput-部分进行字符实体解码；"><a href="#该例子中，首先由-HTML-解析器对UserInput-部分进行字符实体解码；" class="headerlink" title="该例子中，首先由 HTML 解析器对UserInput 部分进行字符实体解码；"></a>该例子中，首先由 HTML 解析器对UserInput 部分进行字符实体解码；</h6><h6 id="接着-URL-解析器对UserInput-进行-URL-decode；"><a href="#接着-URL-解析器对UserInput-进行-URL-decode；" class="headerlink" title="接着 URL 解析器对UserInput 进行 URL decode；"></a>接着 URL 解析器对UserInput 进行 URL decode；</h6><h6 id="如果-URL-的-Scheme-部分为-javascript-的话，JavaScript-解析器会再对-UserInput-进行解-码。"><a href="#如果-URL-的-Scheme-部分为-javascript-的话，JavaScript-解析器会再对-UserInput-进行解-码。" class="headerlink" title="如果 URL 的 Scheme 部分为 javascript 的话，JavaScript 解析器会再对 UserInput 进行解 码。"></a>如果 URL 的 Scheme 部分为 javascript 的话，JavaScript 解析器会再对 UserInput 进行解 码。</h6><h6 id="所以解析顺序是：HTML-解析-gt-URL解析-gt-JavaScript-解析。"><a href="#所以解析顺序是：HTML-解析-gt-URL解析-gt-JavaScript-解析。" class="headerlink" title="所以解析顺序是：HTML 解析-&gt;URL解析-&gt;JavaScript 解析。"></a>所以解析顺序是：HTML 解析-&gt;URL解析-&gt;JavaScript 解析。</h6><h6 id="示例-2："><a href="#示例-2：" class="headerlink" title="示例 2："></a>示例 2：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=# onclick=&quot;window.open(&apos;UserInput&apos;)&quot;&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<h6 id="该例子中，首先由-HTML-解析器对UserInput-部分进行字符实体解码；-1"><a href="#该例子中，首先由-HTML-解析器对UserInput-部分进行字符实体解码；-1" class="headerlink" title="该例子中，首先由 HTML 解析器对UserInput 部分进行字符实体解码；"></a>该例子中，首先由 HTML 解析器对UserInput 部分进行字符实体解码；</h6><h6 id="接着由-JavaScript-解析器会再对-onclick-部分的-JS-进行解析并执行-JS；"><a href="#接着由-JavaScript-解析器会再对-onclick-部分的-JS-进行解析并执行-JS；" class="headerlink" title="接着由 JavaScript 解析器会再对 onclick 部分的 JS 进行解析并执行 JS；"></a>接着由 JavaScript 解析器会再对 onclick 部分的 JS 进行解析并执行 JS；</h6><h6 id="执行-JS-后window-open-‘UserInput’-函数的参数会传入-URL，所以再由-URL-解析器对-UserInput-部分进行解码。"><a href="#执行-JS-后window-open-‘UserInput’-函数的参数会传入-URL，所以再由-URL-解析器对-UserInput-部分进行解码。" class="headerlink" title="执行 JS 后window.open(‘UserInput’)函数的参数会传入 URL，所以再由 URL 解析器对 UserInput 部分进行解码。"></a>执行 JS 后window.open(‘UserInput’)函数的参数会传入 URL，所以再由 URL 解析器对 UserInput 部分进行解码。</h6><h6 id="因此解析顺序为：HTML-解析-gt-JavaScript解析-gt-URL-解析。"><a href="#因此解析顺序为：HTML-解析-gt-JavaScript解析-gt-URL-解析。" class="headerlink" title="因此解析顺序为：HTML 解析-&gt;JavaScript解析-&gt;URL 解析。"></a>因此解析顺序为：HTML 解析-&gt;JavaScript解析-&gt;URL 解析。</h6><h6 id="示例-3：-1"><a href="#示例-3：-1" class="headerlink" title="示例 3："></a>示例 3：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;javascript:window.open(&apos;UserInput&apos;)&quot;&gt;</span><br></pre></td></tr></table></figure>

<h6 id="该例子中，首先还是由-HTML-解析器对-UserInput-部分进行字符实体解码；"><a href="#该例子中，首先还是由-HTML-解析器对-UserInput-部分进行字符实体解码；" class="headerlink" title="该例子中，首先还是由 HTML 解析器对 UserInput 部分进行字符实体解码；"></a>该例子中，首先还是由 HTML 解析器对 UserInput 部分进行字符实体解码；</h6><h6 id="接着由-URL-解析器解析-href-的属性值；"><a href="#接着由-URL-解析器解析-href-的属性值；" class="headerlink" title="接着由 URL 解析器解析 href 的属性值；"></a>接着由 URL 解析器解析 href 的属性值；</h6><h6 id="然后由于Scheme为javascript，所以由-JavaScript-解析；"><a href="#然后由于Scheme为javascript，所以由-JavaScript-解析；" class="headerlink" title="然后由于Scheme为javascript，所以由 JavaScript 解析；"></a>然后由于Scheme为javascript，所以由 JavaScript 解析；</h6><h6 id="解析执行-JS-后window-open-‘UserInput’-函数传入-URL，所以再由-URL-解析器解析。"><a href="#解析执行-JS-后window-open-‘UserInput’-函数传入-URL，所以再由-URL-解析器解析。" class="headerlink" title="解析执行 JS 后window.open(‘UserInput’)函数传入 URL，所以再由 URL 解析器解析。"></a>解析执行 JS 后window.open(‘UserInput’)函数传入 URL，所以再由 URL 解析器解析。</h6><h6 id="所以解析顺序为：HTML-解析-gt-URL解析-gt-JavaScript-解析-gt-URL-解析。"><a href="#所以解析顺序为：HTML-解析-gt-URL解析-gt-JavaScript-解析-gt-URL-解析。" class="headerlink" title="所以解析顺序为：HTML 解析-&gt;URL解析-&gt;JavaScript 解析-&gt;URL 解析。"></a>所以解析顺序为：HTML 解析-&gt;URL解析-&gt;JavaScript 解析-&gt;URL 解析。</h6><h6 id="综合实例："><a href="#综合实例：" class="headerlink" title="综合实例："></a>综合实例：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3a;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x33;&amp;#x31;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x36;&amp;#x33;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x33;&amp;#x35;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x37;&amp;#x25;&amp;#x33;&amp;#x32;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x37;&amp;#x25;&amp;#x33;&amp;#x34;&amp;#x28;&amp;#x31;&amp;#x35;&amp;#x29;&quot;&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<h6 id="首先-HTML-解析器进行解析，解析到href-属性的值时，状态机进入属性值状态（Attribute-Value-State），该状态会解码字符实体；"><a href="#首先-HTML-解析器进行解析，解析到href-属性的值时，状态机进入属性值状态（Attribute-Value-State），该状态会解码字符实体；" class="headerlink" title="首先 HTML 解析器进行解析，解析到href 属性的值时，状态机进入属性值状态（Attribute Value State），该状态会解码字符实体；"></a>首先 HTML 解析器进行解析，解析到href 属性的值时，状态机进入属性值状态（Attribute Value State），该状态会解码字符实体；</h6><h6 id="接着由-URL-解析器进行解析并解码；"><a href="#接着由-URL-解析器进行解析并解码；" class="headerlink" title="接着由 URL 解析器进行解析并解码；"></a>接着由 URL 解析器进行解析并解码；</h6><h6 id="再接着由于-Scheme-为javascript，因此由-JavaScript-解析器解析并解码，加上编码部分是函-数名，属于标识符，因此可以正常解码解释；"><a href="#再接着由于-Scheme-为javascript，因此由-JavaScript-解析器解析并解码，加上编码部分是函-数名，属于标识符，因此可以正常解码解释；" class="headerlink" title="再接着由于 Scheme 为javascript，因此由 JavaScript 解析器解析并解码，加上编码部分是函 数名，属于标识符，因此可以正常解码解释；"></a>再接着由于 Scheme 为javascript，因此由 JavaScript 解析器解析并解码，加上编码部分是函 数名，属于标识符，因此可以正常解码解释；</h6><h6 id="经过三轮解析解码后得到结果：-lt-a-href-”javascript-alert-15-”-gt-lt-a-gt"><a href="#经过三轮解析解码后得到结果：-lt-a-href-”javascript-alert-15-”-gt-lt-a-gt" class="headerlink" title="经过三轮解析解码后得到结果：&lt;a href=”javascript:alert(15)”&gt;&lt;/a&gt;"></a>经过三轮解析解码后得到结果：&lt;a href=”javascript:alert(15)”&gt;&lt;/a&gt;</h6><h6 id="这里推荐一款解码工具：CyberChef（此工具可以在自己的主机进行搭建）"><a href="#这里推荐一款解码工具：CyberChef（此工具可以在自己的主机进行搭建）" class="headerlink" title="这里推荐一款解码工具：CyberChef（此工具可以在自己的主机进行搭建）"></a>这里推荐一款解码工具：CyberChef（此工具可以在自己的主机进行搭建）</h6><h5 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h5><h6 id="https-www-freebuf-com-articles-web-222849-html"><a href="#https-www-freebuf-com-articles-web-222849-html" class="headerlink" title="https://www.freebuf.com/articles/web/222849.html"></a><a href="https://www.freebuf.com/articles/web/222849.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/222849.html</a></h6><h6 id="https-sakuxa-com-2019-03-07-0×00-XSS学习系列之解析HTML文档"><a href="#https-sakuxa-com-2019-03-07-0×00-XSS学习系列之解析HTML文档" class="headerlink" title="https://sakuxa.com/2019/03/07/0×00-XSS学习系列之解析HTML文档/"></a><a href="https://sakuxa.com/2019/03/07/0x00-XSS" target="_blank" rel="noopener">https://sakuxa.com/2019/03/07/0×00-XSS</a>学习系列之解析HTML文档/</h6><h6 id="https-www-cnblogs-com-jerrysion-p-5522673-html"><a href="#https-www-cnblogs-com-jerrysion-p-5522673-html" class="headerlink" title="https://www.cnblogs.com/jerrysion/p/5522673.html"></a><a href="https://www.cnblogs.com/jerrysion/p/5522673.html" target="_blank" rel="noopener">https://www.cnblogs.com/jerrysion/p/5522673.html</a></h6><h6 id="https-xz-aliyun-com-t-5863"><a href="#https-xz-aliyun-com-t-5863" class="headerlink" title="https://xz.aliyun.com/t/5863"></a><a href="https://xz.aliyun.com/t/5863" target="_blank" rel="noopener">https://xz.aliyun.com/t/5863</a></h6><h6 id="https-www-w3-org-html-ig-zh-wiki-HTML5-syntax"><a href="#https-www-w3-org-html-ig-zh-wiki-HTML5-syntax" class="headerlink" title="https://www.w3.org/html/ig/zh/wiki/HTML5/syntax"></a><a href="https://www.w3.org/html/ig/zh/wiki/HTML5/syntax" target="_blank" rel="noopener">https://www.w3.org/html/ig/zh/wiki/HTML5/syntax</a></h6><h6 id="https-developer-mozilla-org-zh-CN-docs-Web-HTML-Element"><a href="#https-developer-mozilla-org-zh-CN-docs-Web-HTML-Element" class="headerlink" title="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element"></a><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element</a></h6><h6 id="文章来源："><a href="#文章来源：" class="headerlink" title="文章来源："></a>文章来源：</h6><h6 id="https-mp-weixin-qq-com-s-liODgY4NjYqdWg3JgPXMdA"><a href="#https-mp-weixin-qq-com-s-liODgY4NjYqdWg3JgPXMdA" class="headerlink" title="https://mp.weixin.qq.com/s/liODgY4NjYqdWg3JgPXMdA"></a><a href="https://mp.weixin.qq.com/s/liODgY4NjYqdWg3JgPXMdA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/liODgY4NjYqdWg3JgPXMdA</a></h6>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/01/29/读书日记五/" rel="next" title="读书日记五">
                <i class="fa fa-chevron-left"></i> 读书日记五
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/02/09/HackTM-CTF-Quals-2020的部分web题复现/" rel="prev" title="HackTM CTF Quals 2020的部分web题复现">
                HackTM CTF Quals 2020的部分web题复现 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Ljdd520">
            
              <p class="site-author-name" itemprop="name">Ljdd520</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">48</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/yourname" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:yourname@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.wonderkun.cc/" title="wonderkun" target="_blank">wonderkun</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://example.com/" title="Title" target="_blank">Title</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#一，需要了解的一些基本知识"><span class="nav-number">1.0.1.</span> <span class="nav-text">一，需要了解的一些基本知识</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#为什么要进行编码？"><span class="nav-number">1.0.1.1.</span> <span class="nav-text">为什么要进行编码？</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#主要是因为某些数据不适合传输。原因多种多样，如-Size-过大，包含隐私数据，另外重要的一点就是有些字符会引起歧义。"><span class="nav-number">1.0.1.2.</span> <span class="nav-text">主要是因为某些数据不适合传输。原因多种多样，如 Size 过大，包含隐私数据，另外重要的一点就是有些字符会引起歧义。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#对于-URL：-amp-用于分割多个参数，倘若有某个参数键值为-name-v-amp-lue，就会因为-name-参数的值-v-amp-lue-中携带了-amp-而造成歧义。因此需要对-amp-进行-URL-编码。url编码后，服务端会把紧跟在”-”后的字节当成普通的字节，就是不会把它当成各个参数或键值对的分隔符。"><span class="nav-number">1.0.1.3.</span> <span class="nav-text">对于 URL： &amp;用于分割多个参数，倘若有某个参数键值为 name=v&amp;lue，就会因为 name 参数的值 v&amp;lue 中携带了&amp;而造成歧义。因此需要对&amp;进行 URL 编码。url编码后，服务端会把紧跟在”%”后的字节当成普通的字节，就是不会把它当成各个参数或键值对的分隔符。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#对于-HTML：-当浏览器遇到-lt-会识别为元素定义的开始，-gt-会识别为元素的结束。倘若有-lt-div-id-”1-gt-“-gt-lt-div-gt-，由于标签的属性值携带了-gt-，同样会造成歧义。因此需要属性值的-gt-需要-进行-HTML-编码，即使用字符实体。"><span class="nav-number">1.0.1.4.</span> <span class="nav-text">对于 HTML： 当浏览器遇到&lt;会识别为元素定义的开始，&gt;会识别为元素的结束。倘若有&lt;div id=”1&gt;“&gt;&lt;/div&gt;，由于标签的属性值携带了&gt;，同样会造成歧义。因此需要属性值的&gt;需要 进行 HTML 编码，即使用字符实体。</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#二，三种编码"><span class="nav-number">1.0.2.</span> <span class="nav-text">二，三种编码</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#2-1HTML编码-字符实体"><span class="nav-number">1.0.2.1.</span> <span class="nav-text">2.1HTML编码(字符实体)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#字符实体是一个预先定义好的转义序列。字符实体有两种表示方法："><span class="nav-number">1.0.2.2.</span> <span class="nav-text">字符实体是一个预先定义好的转义序列。字符实体有两种表示方法：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#字符都是有实体编号的，但有些字符是没有实体名称"><span class="nav-number">1.0.2.3.</span> <span class="nav-text">字符都是有实体编号的，但有些字符是没有实体名称</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-2-JavaScript编码"><span class="nav-number">1.0.2.4.</span> <span class="nav-text">2.2 JavaScript编码</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#最常用的，如-uXXXX-这种写法的Unicode-转义序列，表示一个字符，其中-XXXX-表示一个-16-进制数字，如-lt-的Unicode-编码为-u003c。"><span class="nav-number">1.0.2.5.</span> <span class="nav-text">最常用的，如\uXXXX 这种写法的Unicode 转义序列，表示一个字符，其中 XXXX 表示一个 16 进制数字，如&lt;的Unicode 编码为\u003c。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-3-URL编码"><span class="nav-number">1.0.2.6.</span> <span class="nav-text">2.3 URL编码</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#RFC3986-文档规定，URL-中只允许包含英文字母（a-zA-Z）、数字（0-9）、-4-个特殊字-符以及所有保留字符。-RFC3986-中指定了以下字符为保留字符：-‘-amp"><span class="nav-number">1.0.2.7.</span> <span class="nav-text">RFC3986 文档规定，URL 中只允许包含英文字母（a-zA-Z）、数字（0-9）、-_.~4 个特殊字 符以及所有保留字符。 RFC3986 中指定了以下字符为保留字符：! * ‘ ( ) ; : @ &amp; = + $ , / ? # [ ]</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#编码方式-加字符在-ASCII-码表中的十六进制值。例如，-在-ASCII-码表中十六进制为-0x2f，那么它对应的-URL-编码为-2f。"><span class="nav-number">1.0.2.8.</span> <span class="nav-text">编码方式 %加字符在 ASCII 码表中的十六进制值。例如，/在 ASCII 码表中十六进制为 0x2f，那么它对应的 URL 编码为%2f。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#JavaScript-中提供了-3-个函数用来对-URL-编码以得到合法的-URL："><span class="nav-number">1.0.2.9.</span> <span class="nav-text">JavaScript 中提供了 3 个函数用来对 URL 编码以得到合法的 URL：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#三，浏览器解码规则"><span class="nav-number">1.0.3.</span> <span class="nav-text">三，浏览器解码规则</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#浏览器无论什么情况都会遵守一个这样的解码规则："><span class="nav-number">1.0.3.1.</span> <span class="nav-text">浏览器无论什么情况都会遵守一个这样的解码规则：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-1HTML解码器"><span class="nav-number">1.0.3.2.</span> <span class="nav-text">3.1HTML解码器</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-1-1HTML-中有五类元素："><span class="nav-number">1.0.3.3.</span> <span class="nav-text">3.1.1HTML 中有五类元素：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#五类元素的区别如下："><span class="nav-number">1.0.3.4.</span> <span class="nav-text">五类元素的区别如下：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-1-2-HTML编解码"><span class="nav-number">1.0.3.5.</span> <span class="nav-text">3.1.2 HTML编解码</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#HTML-解析器以状态机的方式运行，它从文档输入流中消耗字符并根据其转换规则转换到不同的状态。"><span class="nav-number">1.0.3.6.</span> <span class="nav-text">HTML 解析器以状态机的方式运行，它从文档输入流中消耗字符并根据其转换规则转换到不同的状态。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#示例："><span class="nav-number">1.0.3.7.</span> <span class="nav-text">示例：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1、初始状态为”DataState”，当遇到”-lt-”字符，状态变为”Tag-open-state”，读取一个-a-z-的字符将产生一个开始标签符号，状态相应变为”Tag-name-state”，一直保持这个状态直到读取到”-gt-”，每个字符都附加到这个符号名上，例子中创建的是一个-html-符号。"><span class="nav-number">1.0.3.8.</span> <span class="nav-text">1、初始状态为”DataState”，当遇到”&lt;”字符，状态变为”Tag open state”，读取一个 a-z 的字符将产生一个开始标签符号，状态相应变为”Tag name state”，一直保持这个状态直到读取到”&gt;”，每个字符都附加到这个符号名上，例子中创建的是一个 html 符号。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2、当读取到”-gt-”，当前的符号就完成了，此时，状态回到”Data-state”，”-lt-body-gt-”重复这一处理过程。到这里，html-和-body-标签都识别出来了。现在，回到”Data-state”，读取”Helloworld”中的字符”H”将创建并识别出一个字符符号，这里会为”Hello-world”中的每个字符-生成一个字符符号。"><span class="nav-number">1.0.3.9.</span> <span class="nav-text">2、当读取到”&gt;”，当前的符号就完成了，此时，状态回到”Data state”，”&lt;body&gt;”重复这一处理过程。到这里，html 和 body 标签都识别出来了。现在，回到”Data state”，读取”Helloworld”中的字符”H”将创建并识别出一个字符符号，这里会为”Hello world”中的每个字符 生成一个字符符号。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3、这样直到遇到”-lt-body-gt-”中的”-lt-”。现在，又回到了”Tag-openstate”，读取下一个字符”-”-将创建一个闭合标签符号，并且状态转移到”Tag-name-state”，还是保持这一状态，直到-遇到”-gt-”。然后，产生一个新的标签符号并回到”Data-state”。后面的”-lt-html-gt-”将和-“-lt-body-gt-”一样处理。"><span class="nav-number">1.0.3.10.</span> <span class="nav-text">3、这样直到遇到”&lt;/body&gt;”中的”&lt;”。现在，又回到了”Tag openstate”，读取下一个字符”/” 将创建一个闭合标签符号，并且状态转移到”Tag name state”，还是保持这一状态，直到 遇到”&gt;”。然后，产生一个新的标签符号并回到”Data state”。后面的”&lt;/html&gt;”将和 “&lt;/body&gt;”一样处理。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#总结：当HTML-解析器处于数据状态（DataState）、RCDATA-状态（RCDATA-State）、属性值状态（Attribute-Value-State）时，字符实体会被解码为对应的字符。"><span class="nav-number">1.0.3.11.</span> <span class="nav-text">总结：当HTML 解析器处于数据状态（DataState）、RCDATA 状态（RCDATA State）、属性值状态（Attribute Value State）时，字符实体会被解码为对应的字符。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#示例：-1"><span class="nav-number">1.0.3.12.</span> <span class="nav-text">示例：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#lt-和-gt-被编码为字符实体-amp-60-和-amp-62-。-当-HTML-解析器解析完-lt-div-gt-时，会进入数据状态（Data-State）并发布标签令牌。接着解析到实体-amp-60-时因为处在数据状态（Data-State）就会对实体进行解码为-lt-，后面-的-amp-62-同样道理被解码为-gt-。"><span class="nav-number">1.0.3.13.</span> <span class="nav-text">&lt;和&gt;被编码为字符实体&amp;#60;和&amp;#62;。 当 HTML 解析器解析完&lt;div&gt;时，会进入数据状态（Data State）并发布标签令牌。接着解析到实体&amp;#60;时因为处在数据状态（Data State）就会对实体进行解码为&lt;，后面 的&amp;#62;同样道理被解码为&gt;。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#这里会有个问题，被解码后，img是否会被解析为-HTML-标签而导致-JS-执行呢？"><span class="nav-number">1.0.3.14.</span> <span class="nav-text">这里会有个问题，被解码后，img是否会被解析为 HTML 标签而导致 JS 执行呢？</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#答案是否定的。因为解析器在使用字符引用后不会转换到标签打开状态（Tag-OpenState），不进入标签打开状态就不会被发布为-HTML-标签。因此，不会创建新-HTML-标签，-只会将其作为数据来处理。-这也是为什么我们可以使用字符实体来避免用户不安全输入导致-XSS-的原因。"><span class="nav-number">1.0.3.15.</span> <span class="nav-text">答案是否定的。因为解析器在使用字符引用后不会转换到标签打开状态（Tag OpenState），不进入标签打开状态就不会被发布为 HTML 标签。因此，不会创建新 HTML 标签， 只会将其作为数据来处理。 这也是为什么我们可以使用字符实体来避免用户不安全输入导致 XSS 的原因。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-1-3-原始文本元素-Raw-text-elements"><span class="nav-number">1.0.3.16.</span> <span class="nav-text">3.1.3 原始文本元素(Raw text elements)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#在-HTML-中，属于-Rawtext-elements-的标签有两个：script、style。在-Raw-text-elements-类型标签下的所有内容块都属于该标签。"><span class="nav-number">1.0.3.17.</span> <span class="nav-text">在 HTML 中，属于 Rawtext elements 的标签有两个：script、style。在 Raw text elements 类型标签下的所有内容块都属于该标签。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#存在一条特性：-Raw-text-elements-类型标签下的所有字符实体编码都不会被-HTML-解码。HTML-解析器-解析到-script、style-标签的内容块（数据）部分时，状态会进入-Script-Data-State，该状态并-不在我们前面说的会解码字符实体的三条状态之中。"><span class="nav-number">1.0.3.18.</span> <span class="nav-text">存在一条特性： Raw text elements 类型标签下的所有字符实体编码都不会被 HTML 解码。HTML 解析器 解析到 script、style 标签的内容块（数据）部分时，状态会进入 Script Data State，该状态并 不在我们前面说的会解码字符实体的三条状态之中。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#因此，-lt-script-gt-amp-97-amp-108-amp-101-amp-114-amp-116-amp-40-amp-57-amp-41-amp-59-这样字符实体并不会被解码，也就不会执行-JS。"><span class="nav-number">1.0.3.19.</span> <span class="nav-text">因此，&lt;script&gt;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116&amp;#40;&amp;#57;&amp;#41;&amp;#59;这样字符实体并不会被解码，也就不会执行 JS。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-1-4-RCDATA"><span class="nav-number">1.0.3.20.</span> <span class="nav-text">3.1.4 RCDATA</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#在-HTML-中，属于RCDATAElements的标签有两个：textarea、title。"><span class="nav-number">1.0.3.21.</span> <span class="nav-text">在 HTML 中，属于RCDATAElements的标签有两个：textarea、title。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#RCDATA-Elements-类型的标签可以包含文本内容和字符实体。"><span class="nav-number">1.0.3.22.</span> <span class="nav-text">RCDATA Elements 类型的标签可以包含文本内容和字符实体。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#解析器解析到-textarea、title标签的数据部分时，状态会进入-RCDATA-State。"><span class="nav-number">1.0.3.23.</span> <span class="nav-text">解析器解析到 textarea、title标签的数据部分时，状态会进入 RCDATA State。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#前面我们提到，处于-RCDATA-State-状态时，字符实体是会被解析器解码的。"><span class="nav-number">1.0.3.24.</span> <span class="nav-text">前面我们提到，处于 RCDATA State 状态时，字符实体是会被解析器解码的。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#示例：-2"><span class="nav-number">1.0.3.25.</span> <span class="nav-text">示例：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#lt-和-gt-被编码为实体-amp-60-和-amp-62-。-解析器解析到它们时会进行解码，最终得到-lt-textarea-gt-lt-script-gt-alert-5-lt-script-gt-lt-textarea-gt-。但是里面的-JS-同样还是不会被执-行，原因还是因为解码字符实体状态机不会进入标签打开状态（TagOpen-State），因此里面的-lt-script-gt-并不会被解析为-HTML-标签。"><span class="nav-number">1.0.3.26.</span> <span class="nav-text">&lt;和&gt;被编码为实体&amp;#60;和&amp;#62;。 解析器解析到它们时会进行解码，最终得到&lt;textarea&gt;&lt;script&gt;alert(5)&lt;/script&gt;&lt;/textarea&gt;。但是里面的 JS 同样还是不会被执 行，原因还是因为解码字符实体状态机不会进入标签打开状态（TagOpen State），因此里面的&lt;script&gt;并不会被解析为 HTML 标签。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-1-5-外部元素-Foreign-elements"><span class="nav-number">1.0.3.27.</span> <span class="nav-text">3.1.5 外部元素(Foreign elements)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#来源于-MathML-和-SVG-命名空间"><span class="nav-number">1.0.3.28.</span> <span class="nav-text">来源于 MathML 和 SVG 命名空间</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#lt-svg-gt-遵循-XML-和-SVG-的定义"><span class="nav-number">1.0.3.29.</span> <span class="nav-text">&lt;svg&gt;遵循 XML 和 SVG 的定义</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#实例："><span class="nav-number">1.0.3.30.</span> <span class="nav-text">实例：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#不能弹窗，Raw-text-elements-类型标签下的所有字符实体编码都不会被-HTML-解码"><span class="nav-number">1.0.3.31.</span> <span class="nav-text">不能弹窗，Raw text elements 类型标签下的所有字符实体编码都不会被 HTML 解码</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#能弹窗，在-XML-中，-amp-40-会被解析成-，在-XML-中实体会自动转义-除了-lt-CDATA-和-gt-包含的实体"><span class="nav-number">1.0.3.32.</span> <span class="nav-text">能弹窗，在 XML 中，&amp;#40;会被解析成(，在 XML 中实体会自动转义,除了&lt;![CDATA[和]]&gt; 包含的实体</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-2-JavaScript-解析器"><span class="nav-number">1.0.3.33.</span> <span class="nav-text">3.2 JavaScript 解析器</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#形如-uXXXX-这样的-Unicode-字符转义序列或-Hex-编码是否能被解码需要看情况。-首先，JavaScript-中有三个地方可以出现-Unicode-字符转义序列："><span class="nav-number">1.0.3.34.</span> <span class="nav-text">形如 \uXXXX 这样的 Unicode 字符转义序列或 Hex 编码是否能被解码需要看情况。 首先，JavaScript 中有三个地方可以出现 Unicode 字符转义序列：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1、字符串中（in-String）"><span class="nav-number">1.0.3.35.</span> <span class="nav-text">1、字符串中（in String）</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Unicode-转义序列出现在字符串中时，它只会被解释为普通字符，而不会破坏字符串的上下文。"><span class="nav-number">1.0.3.36.</span> <span class="nav-text">Unicode 转义序列出现在字符串中时，它只会被解释为普通字符，而不会破坏字符串的上下文。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#例如，-lt-script-gt-alert-“-u0031-u0030″-lt-script-gt"><span class="nav-number">1.0.3.37.</span> <span class="nav-text">例如，&lt;script&gt;alert(“\u0031\u0030″);&lt;/script&gt;</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#被编码转义的部分为-10，是字符串，会被正常解码，JS-代码也会被执行。"><span class="nav-number">1.0.3.38.</span> <span class="nav-text">被编码转义的部分为 10，是字符串，会被正常解码，JS 代码也会被执行。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2、标识符中（in-identifier-names）"><span class="nav-number">1.0.3.39.</span> <span class="nav-text">2、标识符中（in identifier names）</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#若-Unicode-转义序列存在于标识符中，即变量名（如函数名等…），它会被进行解码。"><span class="nav-number">1.0.3.40.</span> <span class="nav-text">若 Unicode 转义序列存在于标识符中，即变量名（如函数名等…），它会被进行解码。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#例如，-lt-script-gt-u0061-u006c-u0065-u0072-u0074-10-lt-script-gt"><span class="nav-number">1.0.3.41.</span> <span class="nav-text">例如，&lt;script&gt;\u0061\u006c\u0065\u0072\u0074(10);&lt;/script&gt;</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#被编码转义的部分为-alert-字符，是函数名，属于在标识符中的情况，因此会被正常解码，JS-代码也会被执行。"><span class="nav-number">1.0.3.42.</span> <span class="nav-text">被编码转义的部分为 alert 字符，是函数名，属于在标识符中的情况，因此会被正常解码，JS 代码也会被执行。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3、控制字符中（in-control-characters）"><span class="nav-number">1.0.3.43.</span> <span class="nav-text">3、控制字符中（in control characters）</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#若-Unicode-转义序列存在于控制字符中，那么它会被解码但不会被解释为控制字符，而会被解释为标识符或字符串字符的一部分。-控制字符即’、”、-等。"><span class="nav-number">1.0.3.44.</span> <span class="nav-text">若 Unicode 转义序列存在于控制字符中，那么它会被解码但不会被解释为控制字符，而会被解释为标识符或字符串字符的一部分。 控制字符即’、”、()等。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#例如，-lt-script-gt-alert-u0028″xss”-lt-script-gt-，-进行了-Unicode-编码，那么解码后它不再是作为控制字符，而是作为标识符的一部分alert-。"><span class="nav-number">1.0.3.45.</span> <span class="nav-text">例如，&lt;script&gt;alert\u0028″xss”);&lt;/script&gt;，(进行了 Unicode 编码，那么解码后它不再是作为控制字符，而是作为标识符的一部分alert(。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#因此函数的括号之类的控制字符进行Unicode-转义后是不能被正常解释的。"><span class="nav-number">1.0.3.46.</span> <span class="nav-text">因此函数的括号之类的控制字符进行Unicode 转义后是不能被正常解释的。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#总结：Unicode-序列不能出现在控制字符中，否则不能被解释。"><span class="nav-number">1.0.3.47.</span> <span class="nav-text">总结：Unicode 序列不能出现在控制字符中，否则不能被解释。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#示例-1："><span class="nav-number">1.0.3.48.</span> <span class="nav-text">示例 1：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#被编码部分为-alert-11-。"><span class="nav-number">1.0.3.49.</span> <span class="nav-text">被编码部分为 alert(11)。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#该例子中的-JS-不会被执行，因为控制字符被编码了。"><span class="nav-number">1.0.3.50.</span> <span class="nav-text">该例子中的 JS 不会被执行，因为控制字符被编码了。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#示例2："><span class="nav-number">1.0.3.51.</span> <span class="nav-text">示例2：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#被编码部分为-alert-及括号内为12。"><span class="nav-number">1.0.3.52.</span> <span class="nav-text">被编码部分为 alert 及括号内为12。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#该例子中-JS-不会被执行，原因在于括号内被编码的部分不能被正常解释，即使反编码之后为数字，但是仍然按照字符串来处理（这里的12为字符串12，并不是int整数）。要么使用-ASCII-数字，要么加””或”使其变为字符串，作为字符串也只能作为普通字符。"><span class="nav-number">1.0.3.53.</span> <span class="nav-text">该例子中 JS 不会被执行，原因在于括号内被编码的部分不能被正常解释，即使反编码之后为数字，但是仍然按照字符串来处理（这里的12为字符串12，并不是int整数）。要么使用 ASCII 数字，要么加””或”使其变为字符串，作为字符串也只能作为普通字符。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#示例-3："><span class="nav-number">1.0.3.54.</span> <span class="nav-text">示例 3：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#被编码处为-39"><span class="nav-number">1.0.3.55.</span> <span class="nav-text">被编码处为&#39;</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#该例的-JS-不会执行，因为控制字符被编码了，解码后的’将变为字符串的一部分，而不再解释为控制字符。因此该例中字符串是不完整的，因为没有’来结束字符串。"><span class="nav-number">1.0.3.56.</span> <span class="nav-text">该例的 JS 不会执行，因为控制字符被编码了，解码后的’将变为字符串的一部分，而不再解释为控制字符。因此该例中字符串是不完整的，因为没有’来结束字符串。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#示例-4："><span class="nav-number">1.0.3.57.</span> <span class="nav-text">示例 4：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#该例的-JS-会被执行，因为被编码的部分处于字符串内，只会被解释为普通字符，不会突破字符串上下文。"><span class="nav-number">1.0.3.58.</span> <span class="nav-text">该例的 JS 会被执行，因为被编码的部分处于字符串内，只会被解释为普通字符，不会突破字符串上下文。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#示例-5："><span class="nav-number">1.0.3.59.</span> <span class="nav-text">示例 5：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#此例无法执行。我们以浏览器的视角来看：首先读到-lt-开始读取标签，然后读到-onerror-调用-JS-解析器。-在JS中，单引号，双引号和圆括号等属于控制字符，编码后将无法识别。所以对于防御来说，应该编码这些控制字符。"><span class="nav-number">1.0.3.60.</span> <span class="nav-text">此例无法执行。我们以浏览器的视角来看：首先读到&lt;开始读取标签，然后读到 onerror 调用 JS 解析器。 在JS中，单引号，双引号和圆括号等属于控制字符，编码后将无法识别。所以对于防御来说，应该编码这些控制字符。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#下面这种方式可以解析："><span class="nav-number">1.0.3.61.</span> <span class="nav-text">下面这种方式可以解析：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#可以结合上面的-HTML-编码-按照解析顺序反过去，先-JS-编码然后-HTML-解码："><span class="nav-number">1.0.3.62.</span> <span class="nav-text">可以结合上面的 HTML 编码 按照解析顺序反过去，先 JS 编码然后 HTML 解码：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#浏览器读到了-lt-标签开始构造语法树，然后-HTML-解码，解码之后发现-onerror-于是进行-一个-JS-解码，成功弹窗"><span class="nav-number">1.0.3.63.</span> <span class="nav-text">浏览器读到了&lt;标签开始构造语法树，然后 HTML 解码，解码之后发现 onerror 于是进行 一个 JS 解码，成功弹窗</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#延伸："><span class="nav-number">1.0.3.64.</span> <span class="nav-text">延伸：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#开发人员单纯的设置-HTML-实体编码为防御-xss-的手段，但是用户输入点在-alert-中-lt-img-src-“https-text-com”-onclick-‘alert-“输入点”-’-gt"><span class="nav-number">1.0.3.65.</span> <span class="nav-text">开发人员单纯的设置 HTML 实体编码为防御 xss 的手段，但是用户输入点在 alert 中 &lt;img src = “https://text.com” onclick = ‘alert(“输入点”)’&gt;</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#如果用户正常输入的话凡是存在-lt-”-等都能被转码"><span class="nav-number">1.0.3.66.</span> <span class="nav-text">如果用户正常输入的话凡是存在&lt; ,” 等都能被转码</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#攻击者可以通过语句-“-alert-“test，在服务端被转码："><span class="nav-number">1.0.3.67.</span> <span class="nav-text">攻击者可以通过语句 “);alert(“test，在服务端被转码：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#弹窗两次，是因为浏览器进行-HTML-解码发现存在两个-alert"><span class="nav-number">1.0.3.68.</span> <span class="nav-text">弹窗两次，是因为浏览器进行 HTML 解码发现存在两个 alert()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#所以对于这种情况，正确防御-XSS-的方法："><span class="nav-number">1.0.3.69.</span> <span class="nav-text">所以对于这种情况，正确防御 XSS 的方法：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#应该是先-JavaScript-编码然后再进行-HTML-编码用户输入-“-alert-“test-后在服务端先-JavaScript-编码然后再进行-HTML-编码到浏览器端：首先经过第一步-HTML-解码后变为-u0022-u0029-u003B-u0061-u006C-u0065-u0072-u0074-u0028-u0022-u0074-u0065-u0073-u0074。JavaScript-解析器工作，变为”-alert-“test-，刚才已经讲过-JavaScript-解析时只有标识符名称不会被当做字符串，控制字符仅会被解析为标示符名称或者字符串，因此-u0022-被解释成双引号文本，-u0028-和-u0029-被解释成为圆括号文本，不会变为控制-字符被解析执行。"><span class="nav-number">1.0.3.70.</span> <span class="nav-text">应该是先 JavaScript 编码然后再进行 HTML 编码用户输入 “);alert(“test 后在服务端先 JavaScript 编码然后再进行 HTML 编码到浏览器端：首先经过第一步 HTML 解码后变为\u0022\u0029\u003B\u0061\u006C\u0065\u0072\u0074\u0028\u0022\u0074\u0065\u0073\u0074。JavaScript 解析器工作，变为”);alert(“test ，刚才已经讲过 JavaScript 解析时只有标识符名称不会被当做字符串，控制字符仅会被解析为标示符名称或者字符串，因此 \u0022 被解释成双引号文本，\u0028 和\u0029 被解释成为圆括号文本，不会变为控制 字符被解析执行。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#在这里采用的先-JS-编码后-HTML-编码中只弹窗了一次。"><span class="nav-number">1.0.3.71.</span> <span class="nav-text">在这里采用的先 JS 编码后 HTML 编码中只弹窗了一次。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-3-URL-解析器"><span class="nav-number">1.0.3.72.</span> <span class="nav-text">3.3 URL 解析器</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#通用-URI-的格式如下："><span class="nav-number">1.0.3.73.</span> <span class="nav-text">通用 URI 的格式如下：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#协议名-用户名-密码-主机名-端口-路径-查询参数-片段-ID"><span class="nav-number">1.0.3.74.</span> <span class="nav-text">[协议名]://[用户名]:[密码]@[主机名]:[端口]/[路径]?[查询参数]#[片段 ID]</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#首先，要注意的是-URL-的-Scheme-部分（协议部分）必须为-ASCII-字符，即不能被任何编码，否则-URL-解析器的状态机将进入-No-Scheme-状态。"><span class="nav-number">1.0.3.75.</span> <span class="nav-text">首先，要注意的是 URL 的 Scheme 部分（协议部分）必须为 ASCII 字符，即不能被任何编码，否则 URL 解析器的状态机将进入 No Scheme 状态。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#示例1："><span class="nav-number">1.0.3.76.</span> <span class="nav-text">示例1：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#URL-编码部分的是javascript-alert-1-。"><span class="nav-number">1.0.3.77.</span> <span class="nav-text">URL 编码部分的是javascript:alert(1)。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#JS-不会被执行，因为作为Scheme-部分的”javascript”这个字符串被编码（其中javascript是一种伪协议），导致-URL-解析-器状态机进入-No-Scheme-状态。"><span class="nav-number">1.0.3.78.</span> <span class="nav-text">JS 不会被执行，因为作为Scheme 部分的”javascript”这个字符串被编码（其中javascript是一种伪协议），导致 URL 解析 器状态机进入 No Scheme 状态。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#URL-中的-也不能被以任何方式编码，否则-URL-解析器的状态机也将进入-No-Scheme-状态。"><span class="nav-number">1.0.3.79.</span> <span class="nav-text">URL 中的:也不能被以任何方式编码，否则 URL 解析器的状态机也将进入 No Scheme 状态。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#由于-被-URL-编码为-3a，导致-URL-状态机进入-NoScheme-状态，JS-代码不能执行。"><span class="nav-number">1.0.3.80.</span> <span class="nav-text">由于:被 URL 编码为%3a，导致 URL 状态机进入 NoScheme 状态，JS 代码不能执行。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#示例2：-1"><span class="nav-number">1.0.3.81.</span> <span class="nav-text">示例2：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#“javascript”这个字符串被实体化编码，-没有被编码，alert-2-被-URL编码。-成功执行-首先，在-HTML-解析器中我们谈到过，HTML状态机处于属性值状态（Attribute-Value-State）时，字符实体时会被解码的，此处在-href-属性中，所以被实体化编码的-“javascript”字符串会被解码。其次，HTML-解析是在URL解析之前的，所以在进行-URL-解析之前，Scheme-部分的”javascript”字符串已被解码，而并不再是被实体编码的状态。"><span class="nav-number">1.0.3.82.</span> <span class="nav-text">“javascript”这个字符串被实体化编码，:没有被编码，alert(2)被 URL编码。 成功执行 首先，在 HTML 解析器中我们谈到过，HTML状态机处于属性值状态（Attribute Value State）时，字符实体时会被解码的，此处在 href 属性中，所以被实体化编码的 “javascript”字符串会被解码。其次，HTML 解析是在URL解析之前的，所以在进行 URL 解析之前，Scheme 部分的”javascript”字符串已被解码，而并不再是被实体编码的状态。</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#四，解析顺序"><span class="nav-number">1.0.4.</span> <span class="nav-text">四，解析顺序</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#首先浏览器接收到一个-HTML-文档时，会触发-HTML-解析器对-HTML-文档进行词法解析，这一过程完成-HTML-解码并创建-DOM-树。"><span class="nav-number">1.0.4.1.</span> <span class="nav-text">首先浏览器接收到一个 HTML 文档时，会触发 HTML 解析器对 HTML 文档进行词法解析，这一过程完成 HTML 解码并创建 DOM 树。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#接下来-JavaScript-解析器会介入对内联脚本进行解析，这一过程完成-JS-的解码工作。"><span class="nav-number">1.0.4.2.</span> <span class="nav-text">接下来 JavaScript 解析器会介入对内联脚本进行解析，这一过程完成 JS 的解码工作。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#如果浏览器遇到需要-URL-的上下文环境，这时-URL-解析器也会介入完成-URL-的解码工-作，URL-解析器的解码顺序会根据-URL-所在位置不同，可能在-JavaScript-解析器之前或之后解析。"><span class="nav-number">1.0.4.3.</span> <span class="nav-text">如果浏览器遇到需要 URL 的上下文环境，这时 URL 解析器也会介入完成 URL 的解码工 作，URL 解析器的解码顺序会根据 URL 所在位置不同，可能在 JavaScript 解析器之前或之后解析。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#总之HTML-解析总是第一步。URL-解析和-JavaScript-解析，它们的解析顺序要根据情况而定。"><span class="nav-number">1.0.4.4.</span> <span class="nav-text">总之HTML 解析总是第一步。URL 解析和 JavaScript 解析，它们的解析顺序要根据情况而定。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#示例-1：-1"><span class="nav-number">1.0.4.5.</span> <span class="nav-text">示例 1：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#该例子中，首先由-HTML-解析器对UserInput-部分进行字符实体解码；"><span class="nav-number">1.0.4.6.</span> <span class="nav-text">该例子中，首先由 HTML 解析器对UserInput 部分进行字符实体解码；</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#接着-URL-解析器对UserInput-进行-URL-decode；"><span class="nav-number">1.0.4.7.</span> <span class="nav-text">接着 URL 解析器对UserInput 进行 URL decode；</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#如果-URL-的-Scheme-部分为-javascript-的话，JavaScript-解析器会再对-UserInput-进行解-码。"><span class="nav-number">1.0.4.8.</span> <span class="nav-text">如果 URL 的 Scheme 部分为 javascript 的话，JavaScript 解析器会再对 UserInput 进行解 码。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#所以解析顺序是：HTML-解析-gt-URL解析-gt-JavaScript-解析。"><span class="nav-number">1.0.4.9.</span> <span class="nav-text">所以解析顺序是：HTML 解析-&gt;URL解析-&gt;JavaScript 解析。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#示例-2："><span class="nav-number">1.0.4.10.</span> <span class="nav-text">示例 2：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#该例子中，首先由-HTML-解析器对UserInput-部分进行字符实体解码；-1"><span class="nav-number">1.0.4.11.</span> <span class="nav-text">该例子中，首先由 HTML 解析器对UserInput 部分进行字符实体解码；</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#接着由-JavaScript-解析器会再对-onclick-部分的-JS-进行解析并执行-JS；"><span class="nav-number">1.0.4.12.</span> <span class="nav-text">接着由 JavaScript 解析器会再对 onclick 部分的 JS 进行解析并执行 JS；</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#执行-JS-后window-open-‘UserInput’-函数的参数会传入-URL，所以再由-URL-解析器对-UserInput-部分进行解码。"><span class="nav-number">1.0.4.13.</span> <span class="nav-text">执行 JS 后window.open(‘UserInput’)函数的参数会传入 URL，所以再由 URL 解析器对 UserInput 部分进行解码。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#因此解析顺序为：HTML-解析-gt-JavaScript解析-gt-URL-解析。"><span class="nav-number">1.0.4.14.</span> <span class="nav-text">因此解析顺序为：HTML 解析-&gt;JavaScript解析-&gt;URL 解析。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#示例-3：-1"><span class="nav-number">1.0.4.15.</span> <span class="nav-text">示例 3：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#该例子中，首先还是由-HTML-解析器对-UserInput-部分进行字符实体解码；"><span class="nav-number">1.0.4.16.</span> <span class="nav-text">该例子中，首先还是由 HTML 解析器对 UserInput 部分进行字符实体解码；</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#接着由-URL-解析器解析-href-的属性值；"><span class="nav-number">1.0.4.17.</span> <span class="nav-text">接着由 URL 解析器解析 href 的属性值；</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#然后由于Scheme为javascript，所以由-JavaScript-解析；"><span class="nav-number">1.0.4.18.</span> <span class="nav-text">然后由于Scheme为javascript，所以由 JavaScript 解析；</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#解析执行-JS-后window-open-‘UserInput’-函数传入-URL，所以再由-URL-解析器解析。"><span class="nav-number">1.0.4.19.</span> <span class="nav-text">解析执行 JS 后window.open(‘UserInput’)函数传入 URL，所以再由 URL 解析器解析。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#所以解析顺序为：HTML-解析-gt-URL解析-gt-JavaScript-解析-gt-URL-解析。"><span class="nav-number">1.0.4.20.</span> <span class="nav-text">所以解析顺序为：HTML 解析-&gt;URL解析-&gt;JavaScript 解析-&gt;URL 解析。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#综合实例："><span class="nav-number">1.0.4.21.</span> <span class="nav-text">综合实例：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#首先-HTML-解析器进行解析，解析到href-属性的值时，状态机进入属性值状态（Attribute-Value-State），该状态会解码字符实体；"><span class="nav-number">1.0.4.22.</span> <span class="nav-text">首先 HTML 解析器进行解析，解析到href 属性的值时，状态机进入属性值状态（Attribute Value State），该状态会解码字符实体；</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#接着由-URL-解析器进行解析并解码；"><span class="nav-number">1.0.4.23.</span> <span class="nav-text">接着由 URL 解析器进行解析并解码；</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#再接着由于-Scheme-为javascript，因此由-JavaScript-解析器解析并解码，加上编码部分是函-数名，属于标识符，因此可以正常解码解释；"><span class="nav-number">1.0.4.24.</span> <span class="nav-text">再接着由于 Scheme 为javascript，因此由 JavaScript 解析器解析并解码，加上编码部分是函 数名，属于标识符，因此可以正常解码解释；</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#经过三轮解析解码后得到结果：-lt-a-href-”javascript-alert-15-”-gt-lt-a-gt"><span class="nav-number">1.0.4.25.</span> <span class="nav-text">经过三轮解析解码后得到结果：&lt;a href=”javascript:alert(15)”&gt;&lt;/a&gt;</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#这里推荐一款解码工具：CyberChef（此工具可以在自己的主机进行搭建）"><span class="nav-number">1.0.4.26.</span> <span class="nav-text">这里推荐一款解码工具：CyberChef（此工具可以在自己的主机进行搭建）</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#参考资料"><span class="nav-number">1.0.5.</span> <span class="nav-text">参考资料</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#https-www-freebuf-com-articles-web-222849-html"><span class="nav-number">1.0.5.1.</span> <span class="nav-text">https://www.freebuf.com/articles/web/222849.html</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-sakuxa-com-2019-03-07-0×00-XSS学习系列之解析HTML文档"><span class="nav-number">1.0.5.2.</span> <span class="nav-text">https://sakuxa.com/2019/03/07/0×00-XSS学习系列之解析HTML文档/</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-www-cnblogs-com-jerrysion-p-5522673-html"><span class="nav-number">1.0.5.3.</span> <span class="nav-text">https://www.cnblogs.com/jerrysion/p/5522673.html</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-xz-aliyun-com-t-5863"><span class="nav-number">1.0.5.4.</span> <span class="nav-text">https://xz.aliyun.com/t/5863</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-www-w3-org-html-ig-zh-wiki-HTML5-syntax"><span class="nav-number">1.0.5.5.</span> <span class="nav-text">https://www.w3.org/html/ig/zh/wiki/HTML5/syntax</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-developer-mozilla-org-zh-CN-docs-Web-HTML-Element"><span class="nav-number">1.0.5.6.</span> <span class="nav-text">https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#文章来源："><span class="nav-number">1.0.5.7.</span> <span class="nav-text">文章来源：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-mp-weixin-qq-com-s-liODgY4NjYqdWg3JgPXMdA"><span class="nav-number">1.0.5.8.</span> <span class="nav-text">https://mp.weixin.qq.com/s/liODgY4NjYqdWg3JgPXMdA</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ljdd520</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">176.7k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
